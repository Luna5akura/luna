(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var tf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Pb(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Db={exports:{}},Jl={},Tb={exports:{}},ge={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Go=Symbol.for("react.element"),Q_=Symbol.for("react.portal"),J_=Symbol.for("react.fragment"),e3=Symbol.for("react.strict_mode"),t3=Symbol.for("react.profiler"),n3=Symbol.for("react.provider"),r3=Symbol.for("react.context"),i3=Symbol.for("react.forward_ref"),a3=Symbol.for("react.suspense"),o3=Symbol.for("react.memo"),s3=Symbol.for("react.lazy"),nf=Symbol.iterator;function l3(e){return e===null||typeof e!="object"?null:(e=nf&&e[nf]||e["@@iterator"],typeof e=="function"?e:null)}var Ab={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},zb=Object.assign,Mb={};function ya(e,t,n){this.props=e,this.context=t,this.refs=Mb,this.updater=n||Ab}ya.prototype.isReactComponent={};ya.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ya.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Fb(){}Fb.prototype=ya.prototype;function R0(e,t,n){this.props=e,this.context=t,this.refs=Mb,this.updater=n||Ab}var N0=R0.prototype=new Fb;N0.constructor=R0;zb(N0,ya.prototype);N0.isPureReactComponent=!0;var rf=Array.isArray,qb=Object.prototype.hasOwnProperty,I0={current:null},Rb={key:!0,ref:!0,__self:!0,__source:!0};function Nb(e,t,n){var r,i={},a=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(a=""+t.key),t)qb.call(t,r)&&!Rb.hasOwnProperty(r)&&(i[r]=t[r]);var s=arguments.length-2;if(s===1)i.children=n;else if(1<s){for(var l=Array(s),u=0;u<s;u++)l[u]=arguments[u+2];i.children=l}if(e&&e.defaultProps)for(r in s=e.defaultProps,s)i[r]===void 0&&(i[r]=s[r]);return{$$typeof:Go,type:e,key:a,ref:o,props:i,_owner:I0.current}}function u3(e,t){return{$$typeof:Go,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function B0(e){return typeof e=="object"&&e!==null&&e.$$typeof===Go}function h3(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var af=/\/+/g;function Nu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?h3(""+e.key):t.toString(36)}function Us(e,t,n,r,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Go:case Q_:o=!0}}if(o)return o=e,i=i(o),e=r===""?"."+Nu(o,0):r,rf(i)?(n="",e!=null&&(n=e.replace(af,"$&/")+"/"),Us(i,t,n,"",function(u){return u})):i!=null&&(B0(i)&&(i=u3(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(af,"$&/")+"/")+e)),t.push(i)),1;if(o=0,r=r===""?".":r+":",rf(e))for(var s=0;s<e.length;s++){a=e[s];var l=r+Nu(a,s);o+=Us(a,t,n,l,i)}else if(l=l3(e),typeof l=="function")for(e=l.call(e),s=0;!(a=e.next()).done;)a=a.value,l=r+Nu(a,s++),o+=Us(a,t,n,l,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function ms(e,t,n){if(e==null)return e;var r=[],i=0;return Us(e,r,"","",function(a){return t.call(n,a,i++)}),r}function c3(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var wt={current:null},Hs={transition:null},m3={ReactCurrentDispatcher:wt,ReactCurrentBatchConfig:Hs,ReactCurrentOwner:I0};function Ib(){throw Error("act(...) is not supported in production builds of React.")}ge.Children={map:ms,forEach:function(e,t,n){ms(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return ms(e,function(){t++}),t},toArray:function(e){return ms(e,function(t){return t})||[]},only:function(e){if(!B0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ge.Component=ya;ge.Fragment=J_;ge.Profiler=t3;ge.PureComponent=R0;ge.StrictMode=e3;ge.Suspense=a3;ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=m3;ge.act=Ib;ge.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=zb({},e.props),i=e.key,a=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,o=I0.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(l in t)qb.call(t,l)&&!Rb.hasOwnProperty(l)&&(r[l]=t[l]===void 0&&s!==void 0?s[l]:t[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){s=Array(l);for(var u=0;u<l;u++)s[u]=arguments[u+2];r.children=s}return{$$typeof:Go,type:e.type,key:i,ref:a,props:r,_owner:o}};ge.createContext=function(e){return e={$$typeof:r3,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:n3,_context:e},e.Consumer=e};ge.createElement=Nb;ge.createFactory=function(e){var t=Nb.bind(null,e);return t.type=e,t};ge.createRef=function(){return{current:null}};ge.forwardRef=function(e){return{$$typeof:i3,render:e}};ge.isValidElement=B0;ge.lazy=function(e){return{$$typeof:s3,_payload:{_status:-1,_result:e},_init:c3}};ge.memo=function(e,t){return{$$typeof:o3,type:e,compare:t===void 0?null:t}};ge.startTransition=function(e){var t=Hs.transition;Hs.transition={};try{e()}finally{Hs.transition=t}};ge.unstable_act=Ib;ge.useCallback=function(e,t){return wt.current.useCallback(e,t)};ge.useContext=function(e){return wt.current.useContext(e)};ge.useDebugValue=function(){};ge.useDeferredValue=function(e){return wt.current.useDeferredValue(e)};ge.useEffect=function(e,t){return wt.current.useEffect(e,t)};ge.useId=function(){return wt.current.useId()};ge.useImperativeHandle=function(e,t,n){return wt.current.useImperativeHandle(e,t,n)};ge.useInsertionEffect=function(e,t){return wt.current.useInsertionEffect(e,t)};ge.useLayoutEffect=function(e,t){return wt.current.useLayoutEffect(e,t)};ge.useMemo=function(e,t){return wt.current.useMemo(e,t)};ge.useReducer=function(e,t,n){return wt.current.useReducer(e,t,n)};ge.useRef=function(e){return wt.current.useRef(e)};ge.useState=function(e){return wt.current.useState(e)};ge.useSyncExternalStore=function(e,t,n){return wt.current.useSyncExternalStore(e,t,n)};ge.useTransition=function(){return wt.current.useTransition()};ge.version="18.3.1";Tb.exports=ge;var S=Tb.exports;const Bb=Pb(S);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var d3=S,f3=Symbol.for("react.element"),p3=Symbol.for("react.fragment"),g3=Object.prototype.hasOwnProperty,b3=d3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,y3={key:!0,ref:!0,__self:!0,__source:!0};function Lb(e,t,n){var r,i={},a=null,o=null;n!==void 0&&(a=""+n),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)g3.call(t,r)&&!y3.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:f3,type:e,key:a,ref:o,props:i,_owner:b3.current}}Jl.Fragment=p3;Jl.jsx=Lb;Jl.jsxs=Lb;Db.exports=Jl;var M=Db.exports,Qh={},Ob={exports:{}},Wt={},jb={exports:{}},Vb={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(j,J){var k=j.length;j.push(J);e:for(;0<k;){var ne=k-1>>>1,de=j[ne];if(0<i(de,J))j[ne]=J,j[k]=de,k=ne;else break e}}function n(j){return j.length===0?null:j[0]}function r(j){if(j.length===0)return null;var J=j[0],k=j.pop();if(k!==J){j[0]=k;e:for(var ne=0,de=j.length,A=de>>>1;ne<A;){var Re=2*(ne+1)-1,nt=j[Re],ke=Re+1,at=j[ke];if(0>i(nt,k))ke<de&&0>i(at,nt)?(j[ne]=at,j[ke]=k,ne=ke):(j[ne]=nt,j[Re]=k,ne=Re);else if(ke<de&&0>i(at,k))j[ne]=at,j[ke]=k,ne=ke;else break e}}return J}function i(j,J){var k=j.sortIndex-J.sortIndex;return k!==0?k:j.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,s=o.now();e.unstable_now=function(){return o.now()-s}}var l=[],u=[],h=1,c=null,m=3,d=!1,b=!1,$=!1,w=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(j){for(var J=n(u);J!==null;){if(J.callback===null)r(u);else if(J.startTime<=j)r(u),J.sortIndex=J.expirationTime,t(l,J);else break;J=n(u)}}function T(j){if($=!1,_(j),!b)if(n(l)!==null)b=!0,be(D);else{var J=n(u);J!==null&&le(T,J.startTime-j)}}function D(j,J){b=!1,$&&($=!1,g(R),R=-1),d=!0;var k=m;try{for(_(J),c=n(l);c!==null&&(!(c.expirationTime>J)||j&&!U());){var ne=c.callback;if(typeof ne=="function"){c.callback=null,m=c.priorityLevel;var de=ne(c.expirationTime<=J);J=e.unstable_now(),typeof de=="function"?c.callback=de:c===n(l)&&r(l),_(J)}else r(l);c=n(l)}if(c!==null)var A=!0;else{var Re=n(u);Re!==null&&le(T,Re.startTime-J),A=!1}return A}finally{c=null,m=k,d=!1}}var C=!1,F=null,R=-1,N=5,O=-1;function U(){return!(e.unstable_now()-O<N)}function B(){if(F!==null){var j=e.unstable_now();O=j;var J=!0;try{J=F(!0,j)}finally{J?he():(C=!1,F=null)}}else C=!1}var he;if(typeof y=="function")he=function(){y(B)};else if(typeof MessageChannel<"u"){var ue=new MessageChannel,ae=ue.port2;ue.port1.onmessage=B,he=function(){ae.postMessage(null)}}else he=function(){w(B,0)};function be(j){F=j,C||(C=!0,he())}function le(j,J){R=w(function(){j(e.unstable_now())},J)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(j){j.callback=null},e.unstable_continueExecution=function(){b||d||(b=!0,be(D))},e.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<j?Math.floor(1e3/j):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(j){switch(m){case 1:case 2:case 3:var J=3;break;default:J=m}var k=m;m=J;try{return j()}finally{m=k}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(j,J){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var k=m;m=j;try{return J()}finally{m=k}},e.unstable_scheduleCallback=function(j,J,k){var ne=e.unstable_now();switch(typeof k=="object"&&k!==null?(k=k.delay,k=typeof k=="number"&&0<k?ne+k:ne):k=ne,j){case 1:var de=-1;break;case 2:de=250;break;case 5:de=1073741823;break;case 4:de=1e4;break;default:de=5e3}return de=k+de,j={id:h++,callback:J,priorityLevel:j,startTime:k,expirationTime:de,sortIndex:-1},k>ne?(j.sortIndex=k,t(u,j),n(l)===null&&j===n(u)&&($?(g(R),R=-1):$=!0,le(T,k-ne))):(j.sortIndex=de,t(l,j),b||d||(b=!0,be(D))),j},e.unstable_shouldYield=U,e.unstable_wrapCallback=function(j){var J=m;return function(){var k=m;m=J;try{return j.apply(this,arguments)}finally{m=k}}}})(Vb);jb.exports=Vb;var $3=jb.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var v3=S,Vt=$3;function W(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Wb=new Set,$o={};function yi(e,t){sa(e,t),sa(e+"Capture",t)}function sa(e,t){for($o[e]=t,e=0;e<t.length;e++)Wb.add(t[e])}var tr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Jh=Object.prototype.hasOwnProperty,_3=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,of={},sf={};function x3(e){return Jh.call(sf,e)?!0:Jh.call(of,e)?!1:_3.test(e)?sf[e]=!0:(of[e]=!0,!1)}function w3(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function k3(e,t,n,r){if(t===null||typeof t>"u"||w3(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function kt(e,t,n,r,i,a,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var ut={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ut[e]=new kt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ut[t]=new kt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ut[e]=new kt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ut[e]=new kt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ut[e]=new kt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ut[e]=new kt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ut[e]=new kt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ut[e]=new kt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ut[e]=new kt(e,5,!1,e.toLowerCase(),null,!1,!1)});var L0=/[\-:]([a-z])/g;function O0(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(L0,O0);ut[t]=new kt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(L0,O0);ut[t]=new kt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(L0,O0);ut[t]=new kt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ut[e]=new kt(e,1,!1,e.toLowerCase(),null,!1,!1)});ut.xlinkHref=new kt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ut[e]=new kt(e,1,!1,e.toLowerCase(),null,!0,!0)});function j0(e,t,n,r){var i=ut.hasOwnProperty(t)?ut[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(k3(t,n,i,r)&&(n=null),r||i===null?x3(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var ur=v3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ds=Symbol.for("react.element"),zi=Symbol.for("react.portal"),Mi=Symbol.for("react.fragment"),V0=Symbol.for("react.strict_mode"),ec=Symbol.for("react.profiler"),Xb=Symbol.for("react.provider"),Ub=Symbol.for("react.context"),W0=Symbol.for("react.forward_ref"),tc=Symbol.for("react.suspense"),nc=Symbol.for("react.suspense_list"),X0=Symbol.for("react.memo"),$r=Symbol.for("react.lazy"),Hb=Symbol.for("react.offscreen"),lf=Symbol.iterator;function Fa(e){return e===null||typeof e!="object"?null:(e=lf&&e[lf]||e["@@iterator"],typeof e=="function"?e:null)}var Ve=Object.assign,Iu;function Ga(e){if(Iu===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Iu=t&&t[1]||""}return`
`+Iu+e}var Bu=!1;function Lu(e,t){if(!e||Bu)return"";Bu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),a=r.stack.split(`
`),o=i.length-1,s=a.length-1;1<=o&&0<=s&&i[o]!==a[s];)s--;for(;1<=o&&0<=s;o--,s--)if(i[o]!==a[s]){if(o!==1||s!==1)do if(o--,s--,0>s||i[o]!==a[s]){var l=`
`+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=o&&0<=s);break}}}finally{Bu=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Ga(e):""}function S3(e){switch(e.tag){case 5:return Ga(e.type);case 16:return Ga("Lazy");case 13:return Ga("Suspense");case 19:return Ga("SuspenseList");case 0:case 2:case 15:return e=Lu(e.type,!1),e;case 11:return e=Lu(e.type.render,!1),e;case 1:return e=Lu(e.type,!0),e;default:return""}}function rc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Mi:return"Fragment";case zi:return"Portal";case ec:return"Profiler";case V0:return"StrictMode";case tc:return"Suspense";case nc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ub:return(e.displayName||"Context")+".Consumer";case Xb:return(e._context.displayName||"Context")+".Provider";case W0:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case X0:return t=e.displayName||null,t!==null?t:rc(e.type)||"Memo";case $r:t=e._payload,e=e._init;try{return rc(e(t))}catch{}}return null}function E3(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return rc(t);case 8:return t===V0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Fr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Gb(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function C3(e){var t=Gb(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,a.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function fs(e){e._valueTracker||(e._valueTracker=C3(e))}function Kb(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Gb(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function fl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function ic(e,t){var n=t.checked;return Ve({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function uf(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Fr(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Zb(e,t){t=t.checked,t!=null&&j0(e,"checked",t,!1)}function ac(e,t){Zb(e,t);var n=Fr(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?oc(e,t.type,n):t.hasOwnProperty("defaultValue")&&oc(e,t.type,Fr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function hf(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function oc(e,t,n){(t!=="number"||fl(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Ka=Array.isArray;function Zi(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Fr(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function sc(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(W(91));return Ve({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function cf(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(W(92));if(Ka(n)){if(1<n.length)throw Error(W(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Fr(n)}}function Yb(e,t){var n=Fr(t.value),r=Fr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function mf(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Qb(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lc(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Qb(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ps,Jb=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ps=ps||document.createElement("div"),ps.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ps.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function vo(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var to={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},P3=["Webkit","ms","Moz","O"];Object.keys(to).forEach(function(e){P3.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),to[t]=to[e]})});function ey(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||to.hasOwnProperty(e)&&to[e]?(""+t).trim():t+"px"}function ty(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=ey(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var D3=Ve({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function uc(e,t){if(t){if(D3[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(W(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(W(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(W(61))}if(t.style!=null&&typeof t.style!="object")throw Error(W(62))}}function hc(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var cc=null;function U0(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var mc=null,Yi=null,Qi=null;function df(e){if(e=Yo(e)){if(typeof mc!="function")throw Error(W(280));var t=e.stateNode;t&&(t=iu(t),mc(e.stateNode,e.type,t))}}function ny(e){Yi?Qi?Qi.push(e):Qi=[e]:Yi=e}function ry(){if(Yi){var e=Yi,t=Qi;if(Qi=Yi=null,df(e),t)for(e=0;e<t.length;e++)df(t[e])}}function iy(e,t){return e(t)}function ay(){}var Ou=!1;function oy(e,t,n){if(Ou)return e(t,n);Ou=!0;try{return iy(e,t,n)}finally{Ou=!1,(Yi!==null||Qi!==null)&&(ay(),ry())}}function _o(e,t){var n=e.stateNode;if(n===null)return null;var r=iu(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(W(231,t,typeof n));return n}var dc=!1;if(tr)try{var qa={};Object.defineProperty(qa,"passive",{get:function(){dc=!0}}),window.addEventListener("test",qa,qa),window.removeEventListener("test",qa,qa)}catch{dc=!1}function T3(e,t,n,r,i,a,o,s,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(h){this.onError(h)}}var no=!1,pl=null,gl=!1,fc=null,A3={onError:function(e){no=!0,pl=e}};function z3(e,t,n,r,i,a,o,s,l){no=!1,pl=null,T3.apply(A3,arguments)}function M3(e,t,n,r,i,a,o,s,l){if(z3.apply(this,arguments),no){if(no){var u=pl;no=!1,pl=null}else throw Error(W(198));gl||(gl=!0,fc=u)}}function $i(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function sy(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ff(e){if($i(e)!==e)throw Error(W(188))}function F3(e){var t=e.alternate;if(!t){if(t=$i(e),t===null)throw Error(W(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var a=i.alternate;if(a===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return ff(i),e;if(a===r)return ff(i),t;a=a.sibling}throw Error(W(188))}if(n.return!==r.return)n=i,r=a;else{for(var o=!1,s=i.child;s;){if(s===n){o=!0,n=i,r=a;break}if(s===r){o=!0,r=i,n=a;break}s=s.sibling}if(!o){for(s=a.child;s;){if(s===n){o=!0,n=a,r=i;break}if(s===r){o=!0,r=a,n=i;break}s=s.sibling}if(!o)throw Error(W(189))}}if(n.alternate!==r)throw Error(W(190))}if(n.tag!==3)throw Error(W(188));return n.stateNode.current===n?e:t}function ly(e){return e=F3(e),e!==null?uy(e):null}function uy(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=uy(e);if(t!==null)return t;e=e.sibling}return null}var hy=Vt.unstable_scheduleCallback,pf=Vt.unstable_cancelCallback,q3=Vt.unstable_shouldYield,R3=Vt.unstable_requestPaint,Ge=Vt.unstable_now,N3=Vt.unstable_getCurrentPriorityLevel,H0=Vt.unstable_ImmediatePriority,cy=Vt.unstable_UserBlockingPriority,bl=Vt.unstable_NormalPriority,I3=Vt.unstable_LowPriority,my=Vt.unstable_IdlePriority,eu=null,Tn=null;function B3(e){if(Tn&&typeof Tn.onCommitFiberRoot=="function")try{Tn.onCommitFiberRoot(eu,e,void 0,(e.current.flags&128)===128)}catch{}}var yn=Math.clz32?Math.clz32:j3,L3=Math.log,O3=Math.LN2;function j3(e){return e>>>=0,e===0?32:31-(L3(e)/O3|0)|0}var gs=64,bs=4194304;function Za(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function yl(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,o=n&268435455;if(o!==0){var s=o&~i;s!==0?r=Za(s):(a&=o,a!==0&&(r=Za(a)))}else o=n&~i,o!==0?r=Za(o):a!==0&&(r=Za(a));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-yn(t),i=1<<n,r|=e[n],t&=~i;return r}function V3(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function W3(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-yn(a),s=1<<o,l=i[o];l===-1?(!(s&n)||s&r)&&(i[o]=V3(s,t)):l<=t&&(e.expiredLanes|=s),a&=~s}}function pc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function dy(){var e=gs;return gs<<=1,!(gs&4194240)&&(gs=64),e}function ju(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ko(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-yn(t),e[t]=n}function X3(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-yn(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}function G0(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-yn(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var we=0;function fy(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var py,K0,gy,by,yy,gc=!1,ys=[],Er=null,Cr=null,Pr=null,xo=new Map,wo=new Map,_r=[],U3="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gf(e,t){switch(e){case"focusin":case"focusout":Er=null;break;case"dragenter":case"dragleave":Cr=null;break;case"mouseover":case"mouseout":Pr=null;break;case"pointerover":case"pointerout":xo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":wo.delete(t.pointerId)}}function Ra(e,t,n,r,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},t!==null&&(t=Yo(t),t!==null&&K0(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function H3(e,t,n,r,i){switch(t){case"focusin":return Er=Ra(Er,e,t,n,r,i),!0;case"dragenter":return Cr=Ra(Cr,e,t,n,r,i),!0;case"mouseover":return Pr=Ra(Pr,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return xo.set(a,Ra(xo.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,wo.set(a,Ra(wo.get(a)||null,e,t,n,r,i)),!0}return!1}function $y(e){var t=ii(e.target);if(t!==null){var n=$i(t);if(n!==null){if(t=n.tag,t===13){if(t=sy(n),t!==null){e.blockedOn=t,yy(e.priority,function(){gy(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Gs(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=bc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);cc=r,n.target.dispatchEvent(r),cc=null}else return t=Yo(n),t!==null&&K0(t),e.blockedOn=n,!1;t.shift()}return!0}function bf(e,t,n){Gs(e)&&n.delete(t)}function G3(){gc=!1,Er!==null&&Gs(Er)&&(Er=null),Cr!==null&&Gs(Cr)&&(Cr=null),Pr!==null&&Gs(Pr)&&(Pr=null),xo.forEach(bf),wo.forEach(bf)}function Na(e,t){e.blockedOn===t&&(e.blockedOn=null,gc||(gc=!0,Vt.unstable_scheduleCallback(Vt.unstable_NormalPriority,G3)))}function ko(e){function t(i){return Na(i,e)}if(0<ys.length){Na(ys[0],e);for(var n=1;n<ys.length;n++){var r=ys[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Er!==null&&Na(Er,e),Cr!==null&&Na(Cr,e),Pr!==null&&Na(Pr,e),xo.forEach(t),wo.forEach(t),n=0;n<_r.length;n++)r=_r[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<_r.length&&(n=_r[0],n.blockedOn===null);)$y(n),n.blockedOn===null&&_r.shift()}var Ji=ur.ReactCurrentBatchConfig,$l=!0;function K3(e,t,n,r){var i=we,a=Ji.transition;Ji.transition=null;try{we=1,Z0(e,t,n,r)}finally{we=i,Ji.transition=a}}function Z3(e,t,n,r){var i=we,a=Ji.transition;Ji.transition=null;try{we=4,Z0(e,t,n,r)}finally{we=i,Ji.transition=a}}function Z0(e,t,n,r){if($l){var i=bc(e,t,n,r);if(i===null)Qu(e,t,r,vl,n),gf(e,r);else if(H3(i,e,t,n,r))r.stopPropagation();else if(gf(e,r),t&4&&-1<U3.indexOf(e)){for(;i!==null;){var a=Yo(i);if(a!==null&&py(a),a=bc(e,t,n,r),a===null&&Qu(e,t,r,vl,n),a===i)break;i=a}i!==null&&r.stopPropagation()}else Qu(e,t,r,null,n)}}var vl=null;function bc(e,t,n,r){if(vl=null,e=U0(r),e=ii(e),e!==null)if(t=$i(e),t===null)e=null;else if(n=t.tag,n===13){if(e=sy(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return vl=e,null}function vy(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(N3()){case H0:return 1;case cy:return 4;case bl:case I3:return 16;case my:return 536870912;default:return 16}default:return 16}}var wr=null,Y0=null,Ks=null;function _y(){if(Ks)return Ks;var e,t=Y0,n=t.length,r,i="value"in wr?wr.value:wr.textContent,a=i.length;for(e=0;e<n&&t[e]===i[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===i[a-r];r++);return Ks=i.slice(e,1<r?1-r:void 0)}function Zs(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function $s(){return!0}function yf(){return!1}function Xt(e){function t(n,r,i,a,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var s in e)e.hasOwnProperty(s)&&(n=e[s],this[s]=n?n(a):a[s]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?$s:yf,this.isPropagationStopped=yf,this}return Ve(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=$s)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=$s)},persist:function(){},isPersistent:$s}),t}var $a={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Q0=Xt($a),Zo=Ve({},$a,{view:0,detail:0}),Y3=Xt(Zo),Vu,Wu,Ia,tu=Ve({},Zo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:J0,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ia&&(Ia&&e.type==="mousemove"?(Vu=e.screenX-Ia.screenX,Wu=e.screenY-Ia.screenY):Wu=Vu=0,Ia=e),Vu)},movementY:function(e){return"movementY"in e?e.movementY:Wu}}),$f=Xt(tu),Q3=Ve({},tu,{dataTransfer:0}),J3=Xt(Q3),ex=Ve({},Zo,{relatedTarget:0}),Xu=Xt(ex),tx=Ve({},$a,{animationName:0,elapsedTime:0,pseudoElement:0}),nx=Xt(tx),rx=Ve({},$a,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ix=Xt(rx),ax=Ve({},$a,{data:0}),vf=Xt(ax),ox={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ux(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=lx[e])?!!t[e]:!1}function J0(){return ux}var hx=Ve({},Zo,{key:function(e){if(e.key){var t=ox[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Zs(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?sx[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:J0,charCode:function(e){return e.type==="keypress"?Zs(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Zs(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),cx=Xt(hx),mx=Ve({},tu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_f=Xt(mx),dx=Ve({},Zo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:J0}),fx=Xt(dx),px=Ve({},$a,{propertyName:0,elapsedTime:0,pseudoElement:0}),gx=Xt(px),bx=Ve({},tu,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),yx=Xt(bx),$x=[9,13,27,32],em=tr&&"CompositionEvent"in window,ro=null;tr&&"documentMode"in document&&(ro=document.documentMode);var vx=tr&&"TextEvent"in window&&!ro,xy=tr&&(!em||ro&&8<ro&&11>=ro),xf=" ",wf=!1;function wy(e,t){switch(e){case"keyup":return $x.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ky(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Fi=!1;function _x(e,t){switch(e){case"compositionend":return ky(t);case"keypress":return t.which!==32?null:(wf=!0,xf);case"textInput":return e=t.data,e===xf&&wf?null:e;default:return null}}function xx(e,t){if(Fi)return e==="compositionend"||!em&&wy(e,t)?(e=_y(),Ks=Y0=wr=null,Fi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return xy&&t.locale!=="ko"?null:t.data;default:return null}}var wx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function kf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!wx[e.type]:t==="textarea"}function Sy(e,t,n,r){ny(r),t=_l(t,"onChange"),0<t.length&&(n=new Q0("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var io=null,So=null;function kx(e){Ry(e,0)}function nu(e){var t=Ni(e);if(Kb(t))return e}function Sx(e,t){if(e==="change")return t}var Ey=!1;if(tr){var Uu;if(tr){var Hu="oninput"in document;if(!Hu){var Sf=document.createElement("div");Sf.setAttribute("oninput","return;"),Hu=typeof Sf.oninput=="function"}Uu=Hu}else Uu=!1;Ey=Uu&&(!document.documentMode||9<document.documentMode)}function Ef(){io&&(io.detachEvent("onpropertychange",Cy),So=io=null)}function Cy(e){if(e.propertyName==="value"&&nu(So)){var t=[];Sy(t,So,e,U0(e)),oy(kx,t)}}function Ex(e,t,n){e==="focusin"?(Ef(),io=t,So=n,io.attachEvent("onpropertychange",Cy)):e==="focusout"&&Ef()}function Cx(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return nu(So)}function Px(e,t){if(e==="click")return nu(t)}function Dx(e,t){if(e==="input"||e==="change")return nu(t)}function Tx(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var _n=typeof Object.is=="function"?Object.is:Tx;function Eo(e,t){if(_n(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Jh.call(t,i)||!_n(e[i],t[i]))return!1}return!0}function Cf(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Pf(e,t){var n=Cf(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Cf(n)}}function Py(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Py(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Dy(){for(var e=window,t=fl();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=fl(e.document)}return t}function tm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Ax(e){var t=Dy(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Py(n.ownerDocument.documentElement,n)){if(r!==null&&tm(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=r.end===void 0?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=Pf(n,a);var o=Pf(n,r);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var zx=tr&&"documentMode"in document&&11>=document.documentMode,qi=null,yc=null,ao=null,$c=!1;function Df(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;$c||qi==null||qi!==fl(r)||(r=qi,"selectionStart"in r&&tm(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ao&&Eo(ao,r)||(ao=r,r=_l(yc,"onSelect"),0<r.length&&(t=new Q0("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=qi)))}function vs(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ri={animationend:vs("Animation","AnimationEnd"),animationiteration:vs("Animation","AnimationIteration"),animationstart:vs("Animation","AnimationStart"),transitionend:vs("Transition","TransitionEnd")},Gu={},Ty={};tr&&(Ty=document.createElement("div").style,"AnimationEvent"in window||(delete Ri.animationend.animation,delete Ri.animationiteration.animation,delete Ri.animationstart.animation),"TransitionEvent"in window||delete Ri.transitionend.transition);function ru(e){if(Gu[e])return Gu[e];if(!Ri[e])return e;var t=Ri[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Ty)return Gu[e]=t[n];return e}var Ay=ru("animationend"),zy=ru("animationiteration"),My=ru("animationstart"),Fy=ru("transitionend"),qy=new Map,Tf="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function jr(e,t){qy.set(e,t),yi(t,[e])}for(var Ku=0;Ku<Tf.length;Ku++){var Zu=Tf[Ku],Mx=Zu.toLowerCase(),Fx=Zu[0].toUpperCase()+Zu.slice(1);jr(Mx,"on"+Fx)}jr(Ay,"onAnimationEnd");jr(zy,"onAnimationIteration");jr(My,"onAnimationStart");jr("dblclick","onDoubleClick");jr("focusin","onFocus");jr("focusout","onBlur");jr(Fy,"onTransitionEnd");sa("onMouseEnter",["mouseout","mouseover"]);sa("onMouseLeave",["mouseout","mouseover"]);sa("onPointerEnter",["pointerout","pointerover"]);sa("onPointerLeave",["pointerout","pointerover"]);yi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));yi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));yi("onBeforeInput",["compositionend","keypress","textInput","paste"]);yi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));yi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));yi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ya="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qx=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ya));function Af(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,M3(r,t,void 0,e),e.currentTarget=null}function Ry(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],l=s.instance,u=s.currentTarget;if(s=s.listener,l!==a&&i.isPropagationStopped())break e;Af(i,s,u),a=l}else for(o=0;o<r.length;o++){if(s=r[o],l=s.instance,u=s.currentTarget,s=s.listener,l!==a&&i.isPropagationStopped())break e;Af(i,s,u),a=l}}}if(gl)throw e=fc,gl=!1,fc=null,e}function ze(e,t){var n=t[kc];n===void 0&&(n=t[kc]=new Set);var r=e+"__bubble";n.has(r)||(Ny(t,e,2,!1),n.add(r))}function Yu(e,t,n){var r=0;t&&(r|=4),Ny(n,e,r,t)}var _s="_reactListening"+Math.random().toString(36).slice(2);function Co(e){if(!e[_s]){e[_s]=!0,Wb.forEach(function(n){n!=="selectionchange"&&(qx.has(n)||Yu(n,!1,e),Yu(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[_s]||(t[_s]=!0,Yu("selectionchange",!1,t))}}function Ny(e,t,n,r){switch(vy(t)){case 1:var i=K3;break;case 4:i=Z3;break;default:i=Z0}n=i.bind(null,t,n,e),i=void 0,!dc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Qu(e,t,n,r,i){var a=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var s=r.stateNode.containerInfo;if(s===i||s.nodeType===8&&s.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;s!==null;){if(o=ii(s),o===null)return;if(l=o.tag,l===5||l===6){r=a=o;continue e}s=s.parentNode}}r=r.return}oy(function(){var u=a,h=U0(n),c=[];e:{var m=qy.get(e);if(m!==void 0){var d=Q0,b=e;switch(e){case"keypress":if(Zs(n)===0)break e;case"keydown":case"keyup":d=cx;break;case"focusin":b="focus",d=Xu;break;case"focusout":b="blur",d=Xu;break;case"beforeblur":case"afterblur":d=Xu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=$f;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=J3;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=fx;break;case Ay:case zy:case My:d=nx;break;case Fy:d=gx;break;case"scroll":d=Y3;break;case"wheel":d=yx;break;case"copy":case"cut":case"paste":d=ix;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=_f}var $=(t&4)!==0,w=!$&&e==="scroll",g=$?m!==null?m+"Capture":null:m;$=[];for(var y=u,_;y!==null;){_=y;var T=_.stateNode;if(_.tag===5&&T!==null&&(_=T,g!==null&&(T=_o(y,g),T!=null&&$.push(Po(y,T,_)))),w)break;y=y.return}0<$.length&&(m=new d(m,b,null,n,h),c.push({event:m,listeners:$}))}}if(!(t&7)){e:{if(m=e==="mouseover"||e==="pointerover",d=e==="mouseout"||e==="pointerout",m&&n!==cc&&(b=n.relatedTarget||n.fromElement)&&(ii(b)||b[nr]))break e;if((d||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,d?(b=n.relatedTarget||n.toElement,d=u,b=b?ii(b):null,b!==null&&(w=$i(b),b!==w||b.tag!==5&&b.tag!==6)&&(b=null)):(d=null,b=u),d!==b)){if($=$f,T="onMouseLeave",g="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&($=_f,T="onPointerLeave",g="onPointerEnter",y="pointer"),w=d==null?m:Ni(d),_=b==null?m:Ni(b),m=new $(T,y+"leave",d,n,h),m.target=w,m.relatedTarget=_,T=null,ii(h)===u&&($=new $(g,y+"enter",b,n,h),$.target=_,$.relatedTarget=w,T=$),w=T,d&&b)t:{for($=d,g=b,y=0,_=$;_;_=Di(_))y++;for(_=0,T=g;T;T=Di(T))_++;for(;0<y-_;)$=Di($),y--;for(;0<_-y;)g=Di(g),_--;for(;y--;){if($===g||g!==null&&$===g.alternate)break t;$=Di($),g=Di(g)}$=null}else $=null;d!==null&&zf(c,m,d,$,!1),b!==null&&w!==null&&zf(c,w,b,$,!0)}}e:{if(m=u?Ni(u):window,d=m.nodeName&&m.nodeName.toLowerCase(),d==="select"||d==="input"&&m.type==="file")var D=Sx;else if(kf(m))if(Ey)D=Dx;else{D=Cx;var C=Ex}else(d=m.nodeName)&&d.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(D=Px);if(D&&(D=D(e,u))){Sy(c,D,n,h);break e}C&&C(e,m,u),e==="focusout"&&(C=m._wrapperState)&&C.controlled&&m.type==="number"&&oc(m,"number",m.value)}switch(C=u?Ni(u):window,e){case"focusin":(kf(C)||C.contentEditable==="true")&&(qi=C,yc=u,ao=null);break;case"focusout":ao=yc=qi=null;break;case"mousedown":$c=!0;break;case"contextmenu":case"mouseup":case"dragend":$c=!1,Df(c,n,h);break;case"selectionchange":if(zx)break;case"keydown":case"keyup":Df(c,n,h)}var F;if(em)e:{switch(e){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else Fi?wy(e,n)&&(R="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(R="onCompositionStart");R&&(xy&&n.locale!=="ko"&&(Fi||R!=="onCompositionStart"?R==="onCompositionEnd"&&Fi&&(F=_y()):(wr=h,Y0="value"in wr?wr.value:wr.textContent,Fi=!0)),C=_l(u,R),0<C.length&&(R=new vf(R,e,null,n,h),c.push({event:R,listeners:C}),F?R.data=F:(F=ky(n),F!==null&&(R.data=F)))),(F=vx?_x(e,n):xx(e,n))&&(u=_l(u,"onBeforeInput"),0<u.length&&(h=new vf("onBeforeInput","beforeinput",null,n,h),c.push({event:h,listeners:u}),h.data=F))}Ry(c,t)})}function Po(e,t,n){return{instance:e,listener:t,currentTarget:n}}function _l(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=_o(e,n),a!=null&&r.unshift(Po(e,a,i)),a=_o(e,t),a!=null&&r.push(Po(e,a,i))),e=e.return}return r}function Di(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function zf(e,t,n,r,i){for(var a=t._reactName,o=[];n!==null&&n!==r;){var s=n,l=s.alternate,u=s.stateNode;if(l!==null&&l===r)break;s.tag===5&&u!==null&&(s=u,i?(l=_o(n,a),l!=null&&o.unshift(Po(n,l,s))):i||(l=_o(n,a),l!=null&&o.push(Po(n,l,s)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var Rx=/\r\n?/g,Nx=/\u0000|\uFFFD/g;function Mf(e){return(typeof e=="string"?e:""+e).replace(Rx,`
`).replace(Nx,"")}function xs(e,t,n){if(t=Mf(t),Mf(e)!==t&&n)throw Error(W(425))}function xl(){}var vc=null,_c=null;function xc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var wc=typeof setTimeout=="function"?setTimeout:void 0,Ix=typeof clearTimeout=="function"?clearTimeout:void 0,Ff=typeof Promise=="function"?Promise:void 0,Bx=typeof queueMicrotask=="function"?queueMicrotask:typeof Ff<"u"?function(e){return Ff.resolve(null).then(e).catch(Lx)}:wc;function Lx(e){setTimeout(function(){throw e})}function Ju(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),ko(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);ko(t)}function Dr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function qf(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var va=Math.random().toString(36).slice(2),Cn="__reactFiber$"+va,Do="__reactProps$"+va,nr="__reactContainer$"+va,kc="__reactEvents$"+va,Ox="__reactListeners$"+va,jx="__reactHandles$"+va;function ii(e){var t=e[Cn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[nr]||n[Cn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=qf(e);e!==null;){if(n=e[Cn])return n;e=qf(e)}return t}e=n,n=e.parentNode}return null}function Yo(e){return e=e[Cn]||e[nr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ni(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(W(33))}function iu(e){return e[Do]||null}var Sc=[],Ii=-1;function Vr(e){return{current:e}}function Me(e){0>Ii||(e.current=Sc[Ii],Sc[Ii]=null,Ii--)}function Pe(e,t){Ii++,Sc[Ii]=e.current,e.current=t}var qr={},pt=Vr(qr),Tt=Vr(!1),di=qr;function la(e,t){var n=e.type.contextTypes;if(!n)return qr;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in n)i[a]=t[a];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function At(e){return e=e.childContextTypes,e!=null}function wl(){Me(Tt),Me(pt)}function Rf(e,t,n){if(pt.current!==qr)throw Error(W(168));Pe(pt,t),Pe(Tt,n)}function Iy(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(W(108,E3(e)||"Unknown",i));return Ve({},n,r)}function kl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||qr,di=pt.current,Pe(pt,e),Pe(Tt,Tt.current),!0}function Nf(e,t,n){var r=e.stateNode;if(!r)throw Error(W(169));n?(e=Iy(e,t,di),r.__reactInternalMemoizedMergedChildContext=e,Me(Tt),Me(pt),Pe(pt,e)):Me(Tt),Pe(Tt,n)}var Xn=null,au=!1,eh=!1;function By(e){Xn===null?Xn=[e]:Xn.push(e)}function Vx(e){au=!0,By(e)}function Wr(){if(!eh&&Xn!==null){eh=!0;var e=0,t=we;try{var n=Xn;for(we=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Xn=null,au=!1}catch(i){throw Xn!==null&&(Xn=Xn.slice(e+1)),hy(H0,Wr),i}finally{we=t,eh=!1}}return null}var Bi=[],Li=0,Sl=null,El=0,Kt=[],Zt=0,fi=null,Hn=1,Gn="";function Jr(e,t){Bi[Li++]=El,Bi[Li++]=Sl,Sl=e,El=t}function Ly(e,t,n){Kt[Zt++]=Hn,Kt[Zt++]=Gn,Kt[Zt++]=fi,fi=e;var r=Hn;e=Gn;var i=32-yn(r)-1;r&=~(1<<i),n+=1;var a=32-yn(t)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Hn=1<<32-yn(t)+i|n<<i|r,Gn=a+e}else Hn=1<<a|n<<i|r,Gn=e}function nm(e){e.return!==null&&(Jr(e,1),Ly(e,1,0))}function rm(e){for(;e===Sl;)Sl=Bi[--Li],Bi[Li]=null,El=Bi[--Li],Bi[Li]=null;for(;e===fi;)fi=Kt[--Zt],Kt[Zt]=null,Gn=Kt[--Zt],Kt[Zt]=null,Hn=Kt[--Zt],Kt[Zt]=null}var Ot=null,Bt=null,Fe=!1,bn=null;function Oy(e,t){var n=Jt(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function If(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ot=e,Bt=Dr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ot=e,Bt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=fi!==null?{id:Hn,overflow:Gn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Jt(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Ot=e,Bt=null,!0):!1;default:return!1}}function Ec(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Cc(e){if(Fe){var t=Bt;if(t){var n=t;if(!If(e,t)){if(Ec(e))throw Error(W(418));t=Dr(n.nextSibling);var r=Ot;t&&If(e,t)?Oy(r,n):(e.flags=e.flags&-4097|2,Fe=!1,Ot=e)}}else{if(Ec(e))throw Error(W(418));e.flags=e.flags&-4097|2,Fe=!1,Ot=e}}}function Bf(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ot=e}function ws(e){if(e!==Ot)return!1;if(!Fe)return Bf(e),Fe=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!xc(e.type,e.memoizedProps)),t&&(t=Bt)){if(Ec(e))throw jy(),Error(W(418));for(;t;)Oy(e,t),t=Dr(t.nextSibling)}if(Bf(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(W(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Bt=Dr(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Bt=null}}else Bt=Ot?Dr(e.stateNode.nextSibling):null;return!0}function jy(){for(var e=Bt;e;)e=Dr(e.nextSibling)}function ua(){Bt=Ot=null,Fe=!1}function im(e){bn===null?bn=[e]:bn.push(e)}var Wx=ur.ReactCurrentBatchConfig;function Ba(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(W(309));var r=n.stateNode}if(!r)throw Error(W(147,e));var i=r,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(o){var s=i.refs;o===null?delete s[a]:s[a]=o},t._stringRef=a,t)}if(typeof e!="string")throw Error(W(284));if(!n._owner)throw Error(W(290,e))}return e}function ks(e,t){throw e=Object.prototype.toString.call(t),Error(W(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Lf(e){var t=e._init;return t(e._payload)}function Vy(e){function t(g,y){if(e){var _=g.deletions;_===null?(g.deletions=[y],g.flags|=16):_.push(y)}}function n(g,y){if(!e)return null;for(;y!==null;)t(g,y),y=y.sibling;return null}function r(g,y){for(g=new Map;y!==null;)y.key!==null?g.set(y.key,y):g.set(y.index,y),y=y.sibling;return g}function i(g,y){return g=Mr(g,y),g.index=0,g.sibling=null,g}function a(g,y,_){return g.index=_,e?(_=g.alternate,_!==null?(_=_.index,_<y?(g.flags|=2,y):_):(g.flags|=2,y)):(g.flags|=1048576,y)}function o(g){return e&&g.alternate===null&&(g.flags|=2),g}function s(g,y,_,T){return y===null||y.tag!==6?(y=sh(_,g.mode,T),y.return=g,y):(y=i(y,_),y.return=g,y)}function l(g,y,_,T){var D=_.type;return D===Mi?h(g,y,_.props.children,T,_.key):y!==null&&(y.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===$r&&Lf(D)===y.type)?(T=i(y,_.props),T.ref=Ba(g,y,_),T.return=g,T):(T=rl(_.type,_.key,_.props,null,g.mode,T),T.ref=Ba(g,y,_),T.return=g,T)}function u(g,y,_,T){return y===null||y.tag!==4||y.stateNode.containerInfo!==_.containerInfo||y.stateNode.implementation!==_.implementation?(y=lh(_,g.mode,T),y.return=g,y):(y=i(y,_.children||[]),y.return=g,y)}function h(g,y,_,T,D){return y===null||y.tag!==7?(y=ci(_,g.mode,T,D),y.return=g,y):(y=i(y,_),y.return=g,y)}function c(g,y,_){if(typeof y=="string"&&y!==""||typeof y=="number")return y=sh(""+y,g.mode,_),y.return=g,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case ds:return _=rl(y.type,y.key,y.props,null,g.mode,_),_.ref=Ba(g,null,y),_.return=g,_;case zi:return y=lh(y,g.mode,_),y.return=g,y;case $r:var T=y._init;return c(g,T(y._payload),_)}if(Ka(y)||Fa(y))return y=ci(y,g.mode,_,null),y.return=g,y;ks(g,y)}return null}function m(g,y,_,T){var D=y!==null?y.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return D!==null?null:s(g,y,""+_,T);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case ds:return _.key===D?l(g,y,_,T):null;case zi:return _.key===D?u(g,y,_,T):null;case $r:return D=_._init,m(g,y,D(_._payload),T)}if(Ka(_)||Fa(_))return D!==null?null:h(g,y,_,T,null);ks(g,_)}return null}function d(g,y,_,T,D){if(typeof T=="string"&&T!==""||typeof T=="number")return g=g.get(_)||null,s(y,g,""+T,D);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case ds:return g=g.get(T.key===null?_:T.key)||null,l(y,g,T,D);case zi:return g=g.get(T.key===null?_:T.key)||null,u(y,g,T,D);case $r:var C=T._init;return d(g,y,_,C(T._payload),D)}if(Ka(T)||Fa(T))return g=g.get(_)||null,h(y,g,T,D,null);ks(y,T)}return null}function b(g,y,_,T){for(var D=null,C=null,F=y,R=y=0,N=null;F!==null&&R<_.length;R++){F.index>R?(N=F,F=null):N=F.sibling;var O=m(g,F,_[R],T);if(O===null){F===null&&(F=N);break}e&&F&&O.alternate===null&&t(g,F),y=a(O,y,R),C===null?D=O:C.sibling=O,C=O,F=N}if(R===_.length)return n(g,F),Fe&&Jr(g,R),D;if(F===null){for(;R<_.length;R++)F=c(g,_[R],T),F!==null&&(y=a(F,y,R),C===null?D=F:C.sibling=F,C=F);return Fe&&Jr(g,R),D}for(F=r(g,F);R<_.length;R++)N=d(F,g,R,_[R],T),N!==null&&(e&&N.alternate!==null&&F.delete(N.key===null?R:N.key),y=a(N,y,R),C===null?D=N:C.sibling=N,C=N);return e&&F.forEach(function(U){return t(g,U)}),Fe&&Jr(g,R),D}function $(g,y,_,T){var D=Fa(_);if(typeof D!="function")throw Error(W(150));if(_=D.call(_),_==null)throw Error(W(151));for(var C=D=null,F=y,R=y=0,N=null,O=_.next();F!==null&&!O.done;R++,O=_.next()){F.index>R?(N=F,F=null):N=F.sibling;var U=m(g,F,O.value,T);if(U===null){F===null&&(F=N);break}e&&F&&U.alternate===null&&t(g,F),y=a(U,y,R),C===null?D=U:C.sibling=U,C=U,F=N}if(O.done)return n(g,F),Fe&&Jr(g,R),D;if(F===null){for(;!O.done;R++,O=_.next())O=c(g,O.value,T),O!==null&&(y=a(O,y,R),C===null?D=O:C.sibling=O,C=O);return Fe&&Jr(g,R),D}for(F=r(g,F);!O.done;R++,O=_.next())O=d(F,g,R,O.value,T),O!==null&&(e&&O.alternate!==null&&F.delete(O.key===null?R:O.key),y=a(O,y,R),C===null?D=O:C.sibling=O,C=O);return e&&F.forEach(function(B){return t(g,B)}),Fe&&Jr(g,R),D}function w(g,y,_,T){if(typeof _=="object"&&_!==null&&_.type===Mi&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case ds:e:{for(var D=_.key,C=y;C!==null;){if(C.key===D){if(D=_.type,D===Mi){if(C.tag===7){n(g,C.sibling),y=i(C,_.props.children),y.return=g,g=y;break e}}else if(C.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===$r&&Lf(D)===C.type){n(g,C.sibling),y=i(C,_.props),y.ref=Ba(g,C,_),y.return=g,g=y;break e}n(g,C);break}else t(g,C);C=C.sibling}_.type===Mi?(y=ci(_.props.children,g.mode,T,_.key),y.return=g,g=y):(T=rl(_.type,_.key,_.props,null,g.mode,T),T.ref=Ba(g,y,_),T.return=g,g=T)}return o(g);case zi:e:{for(C=_.key;y!==null;){if(y.key===C)if(y.tag===4&&y.stateNode.containerInfo===_.containerInfo&&y.stateNode.implementation===_.implementation){n(g,y.sibling),y=i(y,_.children||[]),y.return=g,g=y;break e}else{n(g,y);break}else t(g,y);y=y.sibling}y=lh(_,g.mode,T),y.return=g,g=y}return o(g);case $r:return C=_._init,w(g,y,C(_._payload),T)}if(Ka(_))return b(g,y,_,T);if(Fa(_))return $(g,y,_,T);ks(g,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,y!==null&&y.tag===6?(n(g,y.sibling),y=i(y,_),y.return=g,g=y):(n(g,y),y=sh(_,g.mode,T),y.return=g,g=y),o(g)):n(g,y)}return w}var ha=Vy(!0),Wy=Vy(!1),Cl=Vr(null),Pl=null,Oi=null,am=null;function om(){am=Oi=Pl=null}function sm(e){var t=Cl.current;Me(Cl),e._currentValue=t}function Pc(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function ea(e,t){Pl=e,am=Oi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Dt=!0),e.firstContext=null)}function rn(e){var t=e._currentValue;if(am!==e)if(e={context:e,memoizedValue:t,next:null},Oi===null){if(Pl===null)throw Error(W(308));Oi=e,Pl.dependencies={lanes:0,firstContext:e}}else Oi=Oi.next=e;return t}var ai=null;function lm(e){ai===null?ai=[e]:ai.push(e)}function Xy(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,lm(t)):(n.next=i.next,i.next=n),t.interleaved=n,rr(e,r)}function rr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var vr=!1;function um(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Uy(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Kn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Tr(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,$e&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,rr(e,n)}return i=r.interleaved,i===null?(t.next=t,lm(r)):(t.next=i.next,i.next=t),r.interleaved=t,rr(e,n)}function Ys(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,G0(e,n)}}function Of(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?i=a=o:a=a.next=o,n=n.next}while(n!==null);a===null?i=a=t:a=a.next=t}else i=a=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Dl(e,t,n,r){var i=e.updateQueue;vr=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,s=i.shared.pending;if(s!==null){i.shared.pending=null;var l=s,u=l.next;l.next=null,o===null?a=u:o.next=u,o=l;var h=e.alternate;h!==null&&(h=h.updateQueue,s=h.lastBaseUpdate,s!==o&&(s===null?h.firstBaseUpdate=u:s.next=u,h.lastBaseUpdate=l))}if(a!==null){var c=i.baseState;o=0,h=u=l=null,s=a;do{var m=s.lane,d=s.eventTime;if((r&m)===m){h!==null&&(h=h.next={eventTime:d,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var b=e,$=s;switch(m=t,d=n,$.tag){case 1:if(b=$.payload,typeof b=="function"){c=b.call(d,c,m);break e}c=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=$.payload,m=typeof b=="function"?b.call(d,c,m):b,m==null)break e;c=Ve({},c,m);break e;case 2:vr=!0}}s.callback!==null&&s.lane!==0&&(e.flags|=64,m=i.effects,m===null?i.effects=[s]:m.push(s))}else d={eventTime:d,lane:m,tag:s.tag,payload:s.payload,callback:s.callback,next:null},h===null?(u=h=d,l=c):h=h.next=d,o|=m;if(s=s.next,s===null){if(s=i.shared.pending,s===null)break;m=s,s=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);if(h===null&&(l=c),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=h,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);gi|=o,e.lanes=o,e.memoizedState=c}}function jf(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(W(191,i));i.call(r)}}}var Qo={},An=Vr(Qo),To=Vr(Qo),Ao=Vr(Qo);function oi(e){if(e===Qo)throw Error(W(174));return e}function hm(e,t){switch(Pe(Ao,t),Pe(To,e),Pe(An,Qo),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:lc(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=lc(t,e)}Me(An),Pe(An,t)}function ca(){Me(An),Me(To),Me(Ao)}function Hy(e){oi(Ao.current);var t=oi(An.current),n=lc(t,e.type);t!==n&&(Pe(To,e),Pe(An,n))}function cm(e){To.current===e&&(Me(An),Me(To))}var Ie=Vr(0);function Tl(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var th=[];function mm(){for(var e=0;e<th.length;e++)th[e]._workInProgressVersionPrimary=null;th.length=0}var Qs=ur.ReactCurrentDispatcher,nh=ur.ReactCurrentBatchConfig,pi=0,Oe=null,Je=null,rt=null,Al=!1,oo=!1,zo=0,Xx=0;function ht(){throw Error(W(321))}function dm(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!_n(e[n],t[n]))return!1;return!0}function fm(e,t,n,r,i,a){if(pi=a,Oe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Qs.current=e===null||e.memoizedState===null?Kx:Zx,e=n(r,i),oo){a=0;do{if(oo=!1,zo=0,25<=a)throw Error(W(301));a+=1,rt=Je=null,t.updateQueue=null,Qs.current=Yx,e=n(r,i)}while(oo)}if(Qs.current=zl,t=Je!==null&&Je.next!==null,pi=0,rt=Je=Oe=null,Al=!1,t)throw Error(W(300));return e}function pm(){var e=zo!==0;return zo=0,e}function kn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rt===null?Oe.memoizedState=rt=e:rt=rt.next=e,rt}function an(){if(Je===null){var e=Oe.alternate;e=e!==null?e.memoizedState:null}else e=Je.next;var t=rt===null?Oe.memoizedState:rt.next;if(t!==null)rt=t,Je=e;else{if(e===null)throw Error(W(310));Je=e,e={memoizedState:Je.memoizedState,baseState:Je.baseState,baseQueue:Je.baseQueue,queue:Je.queue,next:null},rt===null?Oe.memoizedState=rt=e:rt=rt.next=e}return rt}function Mo(e,t){return typeof t=="function"?t(e):t}function rh(e){var t=an(),n=t.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=e;var r=Je,i=r.baseQueue,a=n.pending;if(a!==null){if(i!==null){var o=i.next;i.next=a.next,a.next=o}r.baseQueue=i=a,n.pending=null}if(i!==null){a=i.next,r=r.baseState;var s=o=null,l=null,u=a;do{var h=u.lane;if((pi&h)===h)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var c={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(s=l=c,o=r):l=l.next=c,Oe.lanes|=h,gi|=h}u=u.next}while(u!==null&&u!==a);l===null?o=r:l.next=s,_n(r,t.memoizedState)||(Dt=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=l,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do a=i.lane,Oe.lanes|=a,gi|=a,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function ih(e){var t=an(),n=t.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do a=e(a,o.action),o=o.next;while(o!==i);_n(a,t.memoizedState)||(Dt=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function Gy(){}function Ky(e,t){var n=Oe,r=an(),i=t(),a=!_n(r.memoizedState,i);if(a&&(r.memoizedState=i,Dt=!0),r=r.queue,gm(Qy.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||rt!==null&&rt.memoizedState.tag&1){if(n.flags|=2048,Fo(9,Yy.bind(null,n,r,i,t),void 0,null),it===null)throw Error(W(349));pi&30||Zy(n,t,i)}return i}function Zy(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Oe.updateQueue,t===null?(t={lastEffect:null,stores:null},Oe.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Yy(e,t,n,r){t.value=n,t.getSnapshot=r,Jy(t)&&e2(e)}function Qy(e,t,n){return n(function(){Jy(t)&&e2(e)})}function Jy(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!_n(e,n)}catch{return!0}}function e2(e){var t=rr(e,1);t!==null&&$n(t,e,1,-1)}function Vf(e){var t=kn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Mo,lastRenderedState:e},t.queue=e,e=e.dispatch=Gx.bind(null,Oe,e),[t.memoizedState,e]}function Fo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Oe.updateQueue,t===null?(t={lastEffect:null,stores:null},Oe.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function t2(){return an().memoizedState}function Js(e,t,n,r){var i=kn();Oe.flags|=e,i.memoizedState=Fo(1|t,n,void 0,r===void 0?null:r)}function ou(e,t,n,r){var i=an();r=r===void 0?null:r;var a=void 0;if(Je!==null){var o=Je.memoizedState;if(a=o.destroy,r!==null&&dm(r,o.deps)){i.memoizedState=Fo(t,n,a,r);return}}Oe.flags|=e,i.memoizedState=Fo(1|t,n,a,r)}function Wf(e,t){return Js(8390656,8,e,t)}function gm(e,t){return ou(2048,8,e,t)}function n2(e,t){return ou(4,2,e,t)}function r2(e,t){return ou(4,4,e,t)}function i2(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function a2(e,t,n){return n=n!=null?n.concat([e]):null,ou(4,4,i2.bind(null,t,e),n)}function bm(){}function o2(e,t){var n=an();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&dm(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function s2(e,t){var n=an();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&dm(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function l2(e,t,n){return pi&21?(_n(n,t)||(n=dy(),Oe.lanes|=n,gi|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Dt=!0),e.memoizedState=n)}function Ux(e,t){var n=we;we=n!==0&&4>n?n:4,e(!0);var r=nh.transition;nh.transition={};try{e(!1),t()}finally{we=n,nh.transition=r}}function u2(){return an().memoizedState}function Hx(e,t,n){var r=zr(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},h2(e))c2(t,n);else if(n=Xy(e,t,n,r),n!==null){var i=xt();$n(n,e,r,i),m2(n,t,r)}}function Gx(e,t,n){var r=zr(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(h2(e))c2(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,s=a(o,n);if(i.hasEagerState=!0,i.eagerState=s,_n(s,o)){var l=t.interleaved;l===null?(i.next=i,lm(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}n=Xy(e,t,i,r),n!==null&&(i=xt(),$n(n,e,r,i),m2(n,t,r))}}function h2(e){var t=e.alternate;return e===Oe||t!==null&&t===Oe}function c2(e,t){oo=Al=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function m2(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,G0(e,n)}}var zl={readContext:rn,useCallback:ht,useContext:ht,useEffect:ht,useImperativeHandle:ht,useInsertionEffect:ht,useLayoutEffect:ht,useMemo:ht,useReducer:ht,useRef:ht,useState:ht,useDebugValue:ht,useDeferredValue:ht,useTransition:ht,useMutableSource:ht,useSyncExternalStore:ht,useId:ht,unstable_isNewReconciler:!1},Kx={readContext:rn,useCallback:function(e,t){return kn().memoizedState=[e,t===void 0?null:t],e},useContext:rn,useEffect:Wf,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Js(4194308,4,i2.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Js(4194308,4,e,t)},useInsertionEffect:function(e,t){return Js(4,2,e,t)},useMemo:function(e,t){var n=kn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=kn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Hx.bind(null,Oe,e),[r.memoizedState,e]},useRef:function(e){var t=kn();return e={current:e},t.memoizedState=e},useState:Vf,useDebugValue:bm,useDeferredValue:function(e){return kn().memoizedState=e},useTransition:function(){var e=Vf(!1),t=e[0];return e=Ux.bind(null,e[1]),kn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Oe,i=kn();if(Fe){if(n===void 0)throw Error(W(407));n=n()}else{if(n=t(),it===null)throw Error(W(349));pi&30||Zy(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,Wf(Qy.bind(null,r,a,e),[e]),r.flags|=2048,Fo(9,Yy.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=kn(),t=it.identifierPrefix;if(Fe){var n=Gn,r=Hn;n=(r&~(1<<32-yn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=zo++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Xx++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Zx={readContext:rn,useCallback:o2,useContext:rn,useEffect:gm,useImperativeHandle:a2,useInsertionEffect:n2,useLayoutEffect:r2,useMemo:s2,useReducer:rh,useRef:t2,useState:function(){return rh(Mo)},useDebugValue:bm,useDeferredValue:function(e){var t=an();return l2(t,Je.memoizedState,e)},useTransition:function(){var e=rh(Mo)[0],t=an().memoizedState;return[e,t]},useMutableSource:Gy,useSyncExternalStore:Ky,useId:u2,unstable_isNewReconciler:!1},Yx={readContext:rn,useCallback:o2,useContext:rn,useEffect:gm,useImperativeHandle:a2,useInsertionEffect:n2,useLayoutEffect:r2,useMemo:s2,useReducer:ih,useRef:t2,useState:function(){return ih(Mo)},useDebugValue:bm,useDeferredValue:function(e){var t=an();return Je===null?t.memoizedState=e:l2(t,Je.memoizedState,e)},useTransition:function(){var e=ih(Mo)[0],t=an().memoizedState;return[e,t]},useMutableSource:Gy,useSyncExternalStore:Ky,useId:u2,unstable_isNewReconciler:!1};function fn(e,t){if(e&&e.defaultProps){t=Ve({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Dc(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Ve({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var su={isMounted:function(e){return(e=e._reactInternals)?$i(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=xt(),i=zr(e),a=Kn(r,i);a.payload=t,n!=null&&(a.callback=n),t=Tr(e,a,i),t!==null&&($n(t,e,i,r),Ys(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=xt(),i=zr(e),a=Kn(r,i);a.tag=1,a.payload=t,n!=null&&(a.callback=n),t=Tr(e,a,i),t!==null&&($n(t,e,i,r),Ys(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=xt(),r=zr(e),i=Kn(n,r);i.tag=2,t!=null&&(i.callback=t),t=Tr(e,i,r),t!==null&&($n(t,e,r,n),Ys(t,e,r))}};function Xf(e,t,n,r,i,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,a,o):t.prototype&&t.prototype.isPureReactComponent?!Eo(n,r)||!Eo(i,a):!0}function d2(e,t,n){var r=!1,i=qr,a=t.contextType;return typeof a=="object"&&a!==null?a=rn(a):(i=At(t)?di:pt.current,r=t.contextTypes,a=(r=r!=null)?la(e,i):qr),t=new t(n,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=su,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function Uf(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&su.enqueueReplaceState(t,t.state,null)}function Tc(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},um(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=rn(a):(a=At(t)?di:pt.current,i.context=la(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Dc(e,t,a,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&su.enqueueReplaceState(i,i.state,null),Dl(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function ma(e,t){try{var n="",r=t;do n+=S3(r),r=r.return;while(r);var i=n}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function ah(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Ac(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Qx=typeof WeakMap=="function"?WeakMap:Map;function f2(e,t,n){n=Kn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Fl||(Fl=!0,Oc=r),Ac(e,t)},n}function p2(e,t,n){n=Kn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){Ac(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){Ac(e,t),typeof r!="function"&&(Ar===null?Ar=new Set([this]):Ar.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function Hf(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new Qx;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=m5.bind(null,e,t,n),t.then(e,e))}function Gf(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Kf(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Kn(-1,1),t.tag=2,Tr(n,t,1))),n.lanes|=1),e)}var Jx=ur.ReactCurrentOwner,Dt=!1;function $t(e,t,n,r){t.child=e===null?Wy(t,null,n,r):ha(t,e.child,n,r)}function Zf(e,t,n,r,i){n=n.render;var a=t.ref;return ea(t,i),r=fm(e,t,n,r,a,i),n=pm(),e!==null&&!Dt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ir(e,t,i)):(Fe&&n&&nm(t),t.flags|=1,$t(e,t,r,i),t.child)}function Yf(e,t,n,r,i){if(e===null){var a=n.type;return typeof a=="function"&&!Sm(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=a,g2(e,t,a,r,i)):(e=rl(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var o=a.memoizedProps;if(n=n.compare,n=n!==null?n:Eo,n(o,r)&&e.ref===t.ref)return ir(e,t,i)}return t.flags|=1,e=Mr(a,r),e.ref=t.ref,e.return=t,t.child=e}function g2(e,t,n,r,i){if(e!==null){var a=e.memoizedProps;if(Eo(a,r)&&e.ref===t.ref)if(Dt=!1,t.pendingProps=r=a,(e.lanes&i)!==0)e.flags&131072&&(Dt=!0);else return t.lanes=e.lanes,ir(e,t,i)}return zc(e,t,n,r,i)}function b2(e,t,n){var r=t.pendingProps,i=r.children,a=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pe(Vi,Nt),Nt|=n;else{if(!(n&1073741824))return e=a!==null?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Pe(Vi,Nt),Nt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,Pe(Vi,Nt),Nt|=r}else a!==null?(r=a.baseLanes|n,t.memoizedState=null):r=n,Pe(Vi,Nt),Nt|=r;return $t(e,t,i,n),t.child}function y2(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function zc(e,t,n,r,i){var a=At(n)?di:pt.current;return a=la(t,a),ea(t,i),n=fm(e,t,n,r,a,i),r=pm(),e!==null&&!Dt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ir(e,t,i)):(Fe&&r&&nm(t),t.flags|=1,$t(e,t,n,i),t.child)}function Qf(e,t,n,r,i){if(At(n)){var a=!0;kl(t)}else a=!1;if(ea(t,i),t.stateNode===null)el(e,t),d2(t,n,r),Tc(t,n,r,i),r=!0;else if(e===null){var o=t.stateNode,s=t.memoizedProps;o.props=s;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=rn(u):(u=At(n)?di:pt.current,u=la(t,u));var h=n.getDerivedStateFromProps,c=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";c||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(s!==r||l!==u)&&Uf(t,o,r,u),vr=!1;var m=t.memoizedState;o.state=m,Dl(t,r,o,i),l=t.memoizedState,s!==r||m!==l||Tt.current||vr?(typeof h=="function"&&(Dc(t,n,h,r),l=t.memoizedState),(s=vr||Xf(t,n,s,r,m,l,u))?(c||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=u,r=s):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Uy(e,t),s=t.memoizedProps,u=t.type===t.elementType?s:fn(t.type,s),o.props=u,c=t.pendingProps,m=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=rn(l):(l=At(n)?di:pt.current,l=la(t,l));var d=n.getDerivedStateFromProps;(h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(s!==c||m!==l)&&Uf(t,o,r,l),vr=!1,m=t.memoizedState,o.state=m,Dl(t,r,o,i);var b=t.memoizedState;s!==c||m!==b||Tt.current||vr?(typeof d=="function"&&(Dc(t,n,d,r),b=t.memoizedState),(u=vr||Xf(t,n,u,r,m,b,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,b,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,b,l)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||s===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=b),o.props=r,o.state=b,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||s===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),r=!1)}return Mc(e,t,n,r,a,i)}function Mc(e,t,n,r,i,a){y2(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return i&&Nf(t,n,!1),ir(e,t,a);r=t.stateNode,Jx.current=t;var s=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=ha(t,e.child,null,a),t.child=ha(t,null,s,a)):$t(e,t,s,a),t.memoizedState=r.state,i&&Nf(t,n,!0),t.child}function $2(e){var t=e.stateNode;t.pendingContext?Rf(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Rf(e,t.context,!1),hm(e,t.containerInfo)}function Jf(e,t,n,r,i){return ua(),im(i),t.flags|=256,$t(e,t,n,r),t.child}var Fc={dehydrated:null,treeContext:null,retryLane:0};function qc(e){return{baseLanes:e,cachePool:null,transitions:null}}function v2(e,t,n){var r=t.pendingProps,i=Ie.current,a=!1,o=(t.flags&128)!==0,s;if((s=o)||(s=e!==null&&e.memoizedState===null?!1:(i&2)!==0),s?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Pe(Ie,i&1),e===null)return Cc(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,a?(r=t.mode,a=t.child,o={mode:"hidden",children:o},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=hu(o,r,0,null),e=ci(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=qc(n),t.memoizedState=Fc,e):ym(t,o));if(i=e.memoizedState,i!==null&&(s=i.dehydrated,s!==null))return e5(e,t,o,r,s,i,n);if(a){a=r.fallback,o=t.mode,i=e.child,s=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=l,t.deletions=null):(r=Mr(i,l),r.subtreeFlags=i.subtreeFlags&14680064),s!==null?a=Mr(s,a):(a=ci(a,o,n,null),a.flags|=2),a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,o=e.child.memoizedState,o=o===null?qc(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=e.childLanes&~n,t.memoizedState=Fc,r}return a=e.child,e=a.sibling,r=Mr(a,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function ym(e,t){return t=hu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ss(e,t,n,r){return r!==null&&im(r),ha(t,e.child,null,n),e=ym(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function e5(e,t,n,r,i,a,o){if(n)return t.flags&256?(t.flags&=-257,r=ah(Error(W(422))),Ss(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=hu({mode:"visible",children:r.children},i,0,null),a=ci(a,i,o,null),a.flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,t.mode&1&&ha(t,e.child,null,o),t.child.memoizedState=qc(o),t.memoizedState=Fc,a);if(!(t.mode&1))return Ss(e,t,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var s=r.dgst;return r=s,a=Error(W(419)),r=ah(a,r,void 0),Ss(e,t,o,r)}if(s=(o&e.childLanes)!==0,Dt||s){if(r=it,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,rr(e,i),$n(r,e,i,-1))}return km(),r=ah(Error(W(421))),Ss(e,t,o,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=d5.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,Bt=Dr(i.nextSibling),Ot=t,Fe=!0,bn=null,e!==null&&(Kt[Zt++]=Hn,Kt[Zt++]=Gn,Kt[Zt++]=fi,Hn=e.id,Gn=e.overflow,fi=t),t=ym(t,r.children),t.flags|=4096,t)}function ep(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Pc(e.return,t,n)}function oh(e,t,n,r,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function _2(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if($t(e,t,r.children,n),r=Ie.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&ep(e,n,t);else if(e.tag===19)ep(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Pe(Ie,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&Tl(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),oh(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Tl(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}oh(t,!0,n,null,a);break;case"together":oh(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function el(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ir(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),gi|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(W(153));if(t.child!==null){for(e=t.child,n=Mr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Mr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function t5(e,t,n){switch(t.tag){case 3:$2(t),ua();break;case 5:Hy(t);break;case 1:At(t.type)&&kl(t);break;case 4:hm(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Pe(Cl,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Pe(Ie,Ie.current&1),t.flags|=128,null):n&t.child.childLanes?v2(e,t,n):(Pe(Ie,Ie.current&1),e=ir(e,t,n),e!==null?e.sibling:null);Pe(Ie,Ie.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return _2(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Pe(Ie,Ie.current),r)break;return null;case 22:case 23:return t.lanes=0,b2(e,t,n)}return ir(e,t,n)}var x2,Rc,w2,k2;x2=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Rc=function(){};w2=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,oi(An.current);var a=null;switch(n){case"input":i=ic(e,i),r=ic(e,r),a=[];break;case"select":i=Ve({},i,{value:void 0}),r=Ve({},r,{value:void 0}),a=[];break;case"textarea":i=sc(e,i),r=sc(e,r),a=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=xl)}uc(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var s=i[u];for(o in s)s.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&($o.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var l=r[u];if(s=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==s&&(l!=null||s!=null))if(u==="style")if(s){for(o in s)!s.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&s[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(a||(a=[]),a.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,s=s?s.__html:void 0,l!=null&&s!==l&&(a=a||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&($o.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&ze("scroll",e),a||s===l||(a=[])):(a=a||[]).push(u,l))}n&&(a=a||[]).push("style",n);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};k2=function(e,t,n,r){n!==r&&(t.flags|=4)};function La(e,t){if(!Fe)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function ct(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function n5(e,t,n){var r=t.pendingProps;switch(rm(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ct(t),null;case 1:return At(t.type)&&wl(),ct(t),null;case 3:return r=t.stateNode,ca(),Me(Tt),Me(pt),mm(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(ws(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,bn!==null&&(Wc(bn),bn=null))),Rc(e,t),ct(t),null;case 5:cm(t);var i=oi(Ao.current);if(n=t.type,e!==null&&t.stateNode!=null)w2(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(W(166));return ct(t),null}if(e=oi(An.current),ws(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[Cn]=t,r[Do]=a,e=(t.mode&1)!==0,n){case"dialog":ze("cancel",r),ze("close",r);break;case"iframe":case"object":case"embed":ze("load",r);break;case"video":case"audio":for(i=0;i<Ya.length;i++)ze(Ya[i],r);break;case"source":ze("error",r);break;case"img":case"image":case"link":ze("error",r),ze("load",r);break;case"details":ze("toggle",r);break;case"input":uf(r,a),ze("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},ze("invalid",r);break;case"textarea":cf(r,a),ze("invalid",r)}uc(n,a),i=null;for(var o in a)if(a.hasOwnProperty(o)){var s=a[o];o==="children"?typeof s=="string"?r.textContent!==s&&(a.suppressHydrationWarning!==!0&&xs(r.textContent,s,e),i=["children",s]):typeof s=="number"&&r.textContent!==""+s&&(a.suppressHydrationWarning!==!0&&xs(r.textContent,s,e),i=["children",""+s]):$o.hasOwnProperty(o)&&s!=null&&o==="onScroll"&&ze("scroll",r)}switch(n){case"input":fs(r),hf(r,a,!0);break;case"textarea":fs(r),mf(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=xl)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Qb(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[Cn]=t,e[Do]=r,x2(e,t,!1,!1),t.stateNode=e;e:{switch(o=hc(n,r),n){case"dialog":ze("cancel",e),ze("close",e),i=r;break;case"iframe":case"object":case"embed":ze("load",e),i=r;break;case"video":case"audio":for(i=0;i<Ya.length;i++)ze(Ya[i],e);i=r;break;case"source":ze("error",e),i=r;break;case"img":case"image":case"link":ze("error",e),ze("load",e),i=r;break;case"details":ze("toggle",e),i=r;break;case"input":uf(e,r),i=ic(e,r),ze("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=Ve({},r,{value:void 0}),ze("invalid",e);break;case"textarea":cf(e,r),i=sc(e,r),ze("invalid",e);break;default:i=r}uc(n,i),s=i;for(a in s)if(s.hasOwnProperty(a)){var l=s[a];a==="style"?ty(e,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Jb(e,l)):a==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&vo(e,l):typeof l=="number"&&vo(e,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&($o.hasOwnProperty(a)?l!=null&&a==="onScroll"&&ze("scroll",e):l!=null&&j0(e,a,l,o))}switch(n){case"input":fs(e),hf(e,r,!1);break;case"textarea":fs(e),mf(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Fr(r.value));break;case"select":e.multiple=!!r.multiple,a=r.value,a!=null?Zi(e,!!r.multiple,a,!1):r.defaultValue!=null&&Zi(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=xl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ct(t),null;case 6:if(e&&t.stateNode!=null)k2(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(W(166));if(n=oi(Ao.current),oi(An.current),ws(t)){if(r=t.stateNode,n=t.memoizedProps,r[Cn]=t,(a=r.nodeValue!==n)&&(e=Ot,e!==null))switch(e.tag){case 3:xs(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&xs(r.nodeValue,n,(e.mode&1)!==0)}a&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Cn]=t,t.stateNode=r}return ct(t),null;case 13:if(Me(Ie),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Fe&&Bt!==null&&t.mode&1&&!(t.flags&128))jy(),ua(),t.flags|=98560,a=!1;else if(a=ws(t),r!==null&&r.dehydrated!==null){if(e===null){if(!a)throw Error(W(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(W(317));a[Cn]=t}else ua(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ct(t),a=!1}else bn!==null&&(Wc(bn),bn=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Ie.current&1?et===0&&(et=3):km())),t.updateQueue!==null&&(t.flags|=4),ct(t),null);case 4:return ca(),Rc(e,t),e===null&&Co(t.stateNode.containerInfo),ct(t),null;case 10:return sm(t.type._context),ct(t),null;case 17:return At(t.type)&&wl(),ct(t),null;case 19:if(Me(Ie),a=t.memoizedState,a===null)return ct(t),null;if(r=(t.flags&128)!==0,o=a.rendering,o===null)if(r)La(a,!1);else{if(et!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Tl(e),o!==null){for(t.flags|=128,La(a,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)a=n,e=r,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,e=o.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Pe(Ie,Ie.current&1|2),t.child}e=e.sibling}a.tail!==null&&Ge()>da&&(t.flags|=128,r=!0,La(a,!1),t.lanes=4194304)}else{if(!r)if(e=Tl(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),La(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!Fe)return ct(t),null}else 2*Ge()-a.renderingStartTime>da&&n!==1073741824&&(t.flags|=128,r=!0,La(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(n=a.last,n!==null?n.sibling=o:t.child=o,a.last=o)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Ge(),t.sibling=null,n=Ie.current,Pe(Ie,r?n&1|2:n&1),t):(ct(t),null);case 22:case 23:return wm(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Nt&1073741824&&(ct(t),t.subtreeFlags&6&&(t.flags|=8192)):ct(t),null;case 24:return null;case 25:return null}throw Error(W(156,t.tag))}function r5(e,t){switch(rm(t),t.tag){case 1:return At(t.type)&&wl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ca(),Me(Tt),Me(pt),mm(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return cm(t),null;case 13:if(Me(Ie),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(W(340));ua()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Me(Ie),null;case 4:return ca(),null;case 10:return sm(t.type._context),null;case 22:case 23:return wm(),null;case 24:return null;default:return null}}var Es=!1,dt=!1,i5=typeof WeakSet=="function"?WeakSet:Set,Q=null;function ji(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ue(e,t,r)}else n.current=null}function Nc(e,t,n){try{n()}catch(r){Ue(e,t,r)}}var tp=!1;function a5(e,t){if(vc=$l,e=Dy(),tm(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var o=0,s=-1,l=-1,u=0,h=0,c=e,m=null;t:for(;;){for(var d;c!==n||i!==0&&c.nodeType!==3||(s=o+i),c!==a||r!==0&&c.nodeType!==3||(l=o+r),c.nodeType===3&&(o+=c.nodeValue.length),(d=c.firstChild)!==null;)m=c,c=d;for(;;){if(c===e)break t;if(m===n&&++u===i&&(s=o),m===a&&++h===r&&(l=o),(d=c.nextSibling)!==null)break;c=m,m=c.parentNode}c=d}n=s===-1||l===-1?null:{start:s,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(_c={focusedElem:e,selectionRange:n},$l=!1,Q=t;Q!==null;)if(t=Q,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Q=e;else for(;Q!==null;){t=Q;try{var b=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var $=b.memoizedProps,w=b.memoizedState,g=t.stateNode,y=g.getSnapshotBeforeUpdate(t.elementType===t.type?$:fn(t.type,$),w);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var _=t.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(W(163))}}catch(T){Ue(t,t.return,T)}if(e=t.sibling,e!==null){e.return=t.return,Q=e;break}Q=t.return}return b=tp,tp=!1,b}function so(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&Nc(t,n,a)}i=i.next}while(i!==r)}}function lu(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Ic(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function S2(e){var t=e.alternate;t!==null&&(e.alternate=null,S2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Cn],delete t[Do],delete t[kc],delete t[Ox],delete t[jx])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function E2(e){return e.tag===5||e.tag===3||e.tag===4}function np(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||E2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Bc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=xl));else if(r!==4&&(e=e.child,e!==null))for(Bc(e,t,n),e=e.sibling;e!==null;)Bc(e,t,n),e=e.sibling}function Lc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Lc(e,t,n),e=e.sibling;e!==null;)Lc(e,t,n),e=e.sibling}var ot=null,pn=!1;function mr(e,t,n){for(n=n.child;n!==null;)C2(e,t,n),n=n.sibling}function C2(e,t,n){if(Tn&&typeof Tn.onCommitFiberUnmount=="function")try{Tn.onCommitFiberUnmount(eu,n)}catch{}switch(n.tag){case 5:dt||ji(n,t);case 6:var r=ot,i=pn;ot=null,mr(e,t,n),ot=r,pn=i,ot!==null&&(pn?(e=ot,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):ot.removeChild(n.stateNode));break;case 18:ot!==null&&(pn?(e=ot,n=n.stateNode,e.nodeType===8?Ju(e.parentNode,n):e.nodeType===1&&Ju(e,n),ko(e)):Ju(ot,n.stateNode));break;case 4:r=ot,i=pn,ot=n.stateNode.containerInfo,pn=!0,mr(e,t,n),ot=r,pn=i;break;case 0:case 11:case 14:case 15:if(!dt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var a=i,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&Nc(n,t,o),i=i.next}while(i!==r)}mr(e,t,n);break;case 1:if(!dt&&(ji(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Ue(n,t,s)}mr(e,t,n);break;case 21:mr(e,t,n);break;case 22:n.mode&1?(dt=(r=dt)||n.memoizedState!==null,mr(e,t,n),dt=r):mr(e,t,n);break;default:mr(e,t,n)}}function rp(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new i5),t.forEach(function(r){var i=f5.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function mn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,o=t,s=o;e:for(;s!==null;){switch(s.tag){case 5:ot=s.stateNode,pn=!1;break e;case 3:ot=s.stateNode.containerInfo,pn=!0;break e;case 4:ot=s.stateNode.containerInfo,pn=!0;break e}s=s.return}if(ot===null)throw Error(W(160));C2(a,o,i),ot=null,pn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){Ue(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)P2(t,e),t=t.sibling}function P2(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(mn(t,e),wn(e),r&4){try{so(3,e,e.return),lu(3,e)}catch($){Ue(e,e.return,$)}try{so(5,e,e.return)}catch($){Ue(e,e.return,$)}}break;case 1:mn(t,e),wn(e),r&512&&n!==null&&ji(n,n.return);break;case 5:if(mn(t,e),wn(e),r&512&&n!==null&&ji(n,n.return),e.flags&32){var i=e.stateNode;try{vo(i,"")}catch($){Ue(e,e.return,$)}}if(r&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,o=n!==null?n.memoizedProps:a,s=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{s==="input"&&a.type==="radio"&&a.name!=null&&Zb(i,a),hc(s,o);var u=hc(s,a);for(o=0;o<l.length;o+=2){var h=l[o],c=l[o+1];h==="style"?ty(i,c):h==="dangerouslySetInnerHTML"?Jb(i,c):h==="children"?vo(i,c):j0(i,h,c,u)}switch(s){case"input":ac(i,a);break;case"textarea":Yb(i,a);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var d=a.value;d!=null?Zi(i,!!a.multiple,d,!1):m!==!!a.multiple&&(a.defaultValue!=null?Zi(i,!!a.multiple,a.defaultValue,!0):Zi(i,!!a.multiple,a.multiple?[]:"",!1))}i[Do]=a}catch($){Ue(e,e.return,$)}}break;case 6:if(mn(t,e),wn(e),r&4){if(e.stateNode===null)throw Error(W(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch($){Ue(e,e.return,$)}}break;case 3:if(mn(t,e),wn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ko(t.containerInfo)}catch($){Ue(e,e.return,$)}break;case 4:mn(t,e),wn(e);break;case 13:mn(t,e),wn(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(_m=Ge())),r&4&&rp(e);break;case 22:if(h=n!==null&&n.memoizedState!==null,e.mode&1?(dt=(u=dt)||h,mn(t,e),dt=u):mn(t,e),wn(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!h&&e.mode&1)for(Q=e,h=e.child;h!==null;){for(c=Q=h;Q!==null;){switch(m=Q,d=m.child,m.tag){case 0:case 11:case 14:case 15:so(4,m,m.return);break;case 1:ji(m,m.return);var b=m.stateNode;if(typeof b.componentWillUnmount=="function"){r=m,n=m.return;try{t=r,b.props=t.memoizedProps,b.state=t.memoizedState,b.componentWillUnmount()}catch($){Ue(r,n,$)}}break;case 5:ji(m,m.return);break;case 22:if(m.memoizedState!==null){ap(c);continue}}d!==null?(d.return=m,Q=d):ap(c)}h=h.sibling}e:for(h=null,c=e;;){if(c.tag===5){if(h===null){h=c;try{i=c.stateNode,u?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(s=c.stateNode,l=c.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,s.style.display=ey("display",o))}catch($){Ue(e,e.return,$)}}}else if(c.tag===6){if(h===null)try{c.stateNode.nodeValue=u?"":c.memoizedProps}catch($){Ue(e,e.return,$)}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===e)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===e)break e;for(;c.sibling===null;){if(c.return===null||c.return===e)break e;h===c&&(h=null),c=c.return}h===c&&(h=null),c.sibling.return=c.return,c=c.sibling}}break;case 19:mn(t,e),wn(e),r&4&&rp(e);break;case 21:break;default:mn(t,e),wn(e)}}function wn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(E2(n)){var r=n;break e}n=n.return}throw Error(W(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(vo(i,""),r.flags&=-33);var a=np(e);Lc(e,a,i);break;case 3:case 4:var o=r.stateNode.containerInfo,s=np(e);Bc(e,s,o);break;default:throw Error(W(161))}}catch(l){Ue(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function o5(e,t,n){Q=e,D2(e)}function D2(e,t,n){for(var r=(e.mode&1)!==0;Q!==null;){var i=Q,a=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Es;if(!o){var s=i.alternate,l=s!==null&&s.memoizedState!==null||dt;s=Es;var u=dt;if(Es=o,(dt=l)&&!u)for(Q=i;Q!==null;)o=Q,l=o.child,o.tag===22&&o.memoizedState!==null?op(i):l!==null?(l.return=o,Q=l):op(i);for(;a!==null;)Q=a,D2(a),a=a.sibling;Q=i,Es=s,dt=u}ip(e)}else i.subtreeFlags&8772&&a!==null?(a.return=i,Q=a):ip(e)}}function ip(e){for(;Q!==null;){var t=Q;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:dt||lu(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!dt)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:fn(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&jf(t,a,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}jf(t,o,n)}break;case 5:var s=t.stateNode;if(n===null&&t.flags&4){n=s;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var c=h.dehydrated;c!==null&&ko(c)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(W(163))}dt||t.flags&512&&Ic(t)}catch(m){Ue(t,t.return,m)}}if(t===e){Q=null;break}if(n=t.sibling,n!==null){n.return=t.return,Q=n;break}Q=t.return}}function ap(e){for(;Q!==null;){var t=Q;if(t===e){Q=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Q=n;break}Q=t.return}}function op(e){for(;Q!==null;){var t=Q;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{lu(4,t)}catch(l){Ue(t,n,l)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(l){Ue(t,i,l)}}var a=t.return;try{Ic(t)}catch(l){Ue(t,a,l)}break;case 5:var o=t.return;try{Ic(t)}catch(l){Ue(t,o,l)}}}catch(l){Ue(t,t.return,l)}if(t===e){Q=null;break}var s=t.sibling;if(s!==null){s.return=t.return,Q=s;break}Q=t.return}}var s5=Math.ceil,Ml=ur.ReactCurrentDispatcher,$m=ur.ReactCurrentOwner,tn=ur.ReactCurrentBatchConfig,$e=0,it=null,Ye=null,lt=0,Nt=0,Vi=Vr(0),et=0,qo=null,gi=0,uu=0,vm=0,lo=null,Pt=null,_m=0,da=1/0,Wn=null,Fl=!1,Oc=null,Ar=null,Cs=!1,kr=null,ql=0,uo=0,jc=null,tl=-1,nl=0;function xt(){return $e&6?Ge():tl!==-1?tl:tl=Ge()}function zr(e){return e.mode&1?$e&2&&lt!==0?lt&-lt:Wx.transition!==null?(nl===0&&(nl=dy()),nl):(e=we,e!==0||(e=window.event,e=e===void 0?16:vy(e.type)),e):1}function $n(e,t,n,r){if(50<uo)throw uo=0,jc=null,Error(W(185));Ko(e,n,r),(!($e&2)||e!==it)&&(e===it&&(!($e&2)&&(uu|=n),et===4&&xr(e,lt)),zt(e,r),n===1&&$e===0&&!(t.mode&1)&&(da=Ge()+500,au&&Wr()))}function zt(e,t){var n=e.callbackNode;W3(e,t);var r=yl(e,e===it?lt:0);if(r===0)n!==null&&pf(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&pf(n),t===1)e.tag===0?Vx(sp.bind(null,e)):By(sp.bind(null,e)),Bx(function(){!($e&6)&&Wr()}),n=null;else{switch(fy(r)){case 1:n=H0;break;case 4:n=cy;break;case 16:n=bl;break;case 536870912:n=my;break;default:n=bl}n=N2(n,T2.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function T2(e,t){if(tl=-1,nl=0,$e&6)throw Error(W(327));var n=e.callbackNode;if(ta()&&e.callbackNode!==n)return null;var r=yl(e,e===it?lt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Rl(e,r);else{t=r;var i=$e;$e|=2;var a=z2();(it!==e||lt!==t)&&(Wn=null,da=Ge()+500,hi(e,t));do try{h5();break}catch(s){A2(e,s)}while(!0);om(),Ml.current=a,$e=i,Ye!==null?t=0:(it=null,lt=0,t=et)}if(t!==0){if(t===2&&(i=pc(e),i!==0&&(r=i,t=Vc(e,i))),t===1)throw n=qo,hi(e,0),xr(e,r),zt(e,Ge()),n;if(t===6)xr(e,r);else{if(i=e.current.alternate,!(r&30)&&!l5(i)&&(t=Rl(e,r),t===2&&(a=pc(e),a!==0&&(r=a,t=Vc(e,a))),t===1))throw n=qo,hi(e,0),xr(e,r),zt(e,Ge()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(W(345));case 2:ei(e,Pt,Wn);break;case 3:if(xr(e,r),(r&130023424)===r&&(t=_m+500-Ge(),10<t)){if(yl(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){xt(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=wc(ei.bind(null,e,Pt,Wn),t);break}ei(e,Pt,Wn);break;case 4:if(xr(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-yn(r);a=1<<o,o=t[o],o>i&&(i=o),r&=~a}if(r=i,r=Ge()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*s5(r/1960))-r,10<r){e.timeoutHandle=wc(ei.bind(null,e,Pt,Wn),r);break}ei(e,Pt,Wn);break;case 5:ei(e,Pt,Wn);break;default:throw Error(W(329))}}}return zt(e,Ge()),e.callbackNode===n?T2.bind(null,e):null}function Vc(e,t){var n=lo;return e.current.memoizedState.isDehydrated&&(hi(e,t).flags|=256),e=Rl(e,t),e!==2&&(t=Pt,Pt=n,t!==null&&Wc(t)),e}function Wc(e){Pt===null?Pt=e:Pt.push.apply(Pt,e)}function l5(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!_n(a(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function xr(e,t){for(t&=~vm,t&=~uu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-yn(t),r=1<<n;e[n]=-1,t&=~r}}function sp(e){if($e&6)throw Error(W(327));ta();var t=yl(e,0);if(!(t&1))return zt(e,Ge()),null;var n=Rl(e,t);if(e.tag!==0&&n===2){var r=pc(e);r!==0&&(t=r,n=Vc(e,r))}if(n===1)throw n=qo,hi(e,0),xr(e,t),zt(e,Ge()),n;if(n===6)throw Error(W(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ei(e,Pt,Wn),zt(e,Ge()),null}function xm(e,t){var n=$e;$e|=1;try{return e(t)}finally{$e=n,$e===0&&(da=Ge()+500,au&&Wr())}}function bi(e){kr!==null&&kr.tag===0&&!($e&6)&&ta();var t=$e;$e|=1;var n=tn.transition,r=we;try{if(tn.transition=null,we=1,e)return e()}finally{we=r,tn.transition=n,$e=t,!($e&6)&&Wr()}}function wm(){Nt=Vi.current,Me(Vi)}function hi(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Ix(n)),Ye!==null)for(n=Ye.return;n!==null;){var r=n;switch(rm(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&wl();break;case 3:ca(),Me(Tt),Me(pt),mm();break;case 5:cm(r);break;case 4:ca();break;case 13:Me(Ie);break;case 19:Me(Ie);break;case 10:sm(r.type._context);break;case 22:case 23:wm()}n=n.return}if(it=e,Ye=e=Mr(e.current,null),lt=Nt=t,et=0,qo=null,vm=uu=gi=0,Pt=lo=null,ai!==null){for(t=0;t<ai.length;t++)if(n=ai[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,a=n.pending;if(a!==null){var o=a.next;a.next=i,r.next=o}n.pending=r}ai=null}return e}function A2(e,t){do{var n=Ye;try{if(om(),Qs.current=zl,Al){for(var r=Oe.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Al=!1}if(pi=0,rt=Je=Oe=null,oo=!1,zo=0,$m.current=null,n===null||n.return===null){et=1,qo=t,Ye=null;break}e:{var a=e,o=n.return,s=n,l=t;if(t=lt,s.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,h=s,c=h.tag;if(!(h.mode&1)&&(c===0||c===11||c===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var d=Gf(o);if(d!==null){d.flags&=-257,Kf(d,o,s,a,t),d.mode&1&&Hf(a,u,t),t=d,l=u;var b=t.updateQueue;if(b===null){var $=new Set;$.add(l),t.updateQueue=$}else b.add(l);break e}else{if(!(t&1)){Hf(a,u,t),km();break e}l=Error(W(426))}}else if(Fe&&s.mode&1){var w=Gf(o);if(w!==null){!(w.flags&65536)&&(w.flags|=256),Kf(w,o,s,a,t),im(ma(l,s));break e}}a=l=ma(l,s),et!==4&&(et=2),lo===null?lo=[a]:lo.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var g=f2(a,l,t);Of(a,g);break e;case 1:s=l;var y=a.type,_=a.stateNode;if(!(a.flags&128)&&(typeof y.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(Ar===null||!Ar.has(_)))){a.flags|=65536,t&=-t,a.lanes|=t;var T=p2(a,s,t);Of(a,T);break e}}a=a.return}while(a!==null)}F2(n)}catch(D){t=D,Ye===n&&n!==null&&(Ye=n=n.return);continue}break}while(!0)}function z2(){var e=Ml.current;return Ml.current=zl,e===null?zl:e}function km(){(et===0||et===3||et===2)&&(et=4),it===null||!(gi&268435455)&&!(uu&268435455)||xr(it,lt)}function Rl(e,t){var n=$e;$e|=2;var r=z2();(it!==e||lt!==t)&&(Wn=null,hi(e,t));do try{u5();break}catch(i){A2(e,i)}while(!0);if(om(),$e=n,Ml.current=r,Ye!==null)throw Error(W(261));return it=null,lt=0,et}function u5(){for(;Ye!==null;)M2(Ye)}function h5(){for(;Ye!==null&&!q3();)M2(Ye)}function M2(e){var t=R2(e.alternate,e,Nt);e.memoizedProps=e.pendingProps,t===null?F2(e):Ye=t,$m.current=null}function F2(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=r5(n,t),n!==null){n.flags&=32767,Ye=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{et=6,Ye=null;return}}else if(n=n5(n,t,Nt),n!==null){Ye=n;return}if(t=t.sibling,t!==null){Ye=t;return}Ye=t=e}while(t!==null);et===0&&(et=5)}function ei(e,t,n){var r=we,i=tn.transition;try{tn.transition=null,we=1,c5(e,t,n,r)}finally{tn.transition=i,we=r}return null}function c5(e,t,n,r){do ta();while(kr!==null);if($e&6)throw Error(W(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(W(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(X3(e,a),e===it&&(Ye=it=null,lt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Cs||(Cs=!0,N2(bl,function(){return ta(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=tn.transition,tn.transition=null;var o=we;we=1;var s=$e;$e|=4,$m.current=null,a5(e,n),P2(n,e),Ax(_c),$l=!!vc,_c=vc=null,e.current=n,o5(n),R3(),$e=s,we=o,tn.transition=a}else e.current=n;if(Cs&&(Cs=!1,kr=e,ql=i),a=e.pendingLanes,a===0&&(Ar=null),B3(n.stateNode),zt(e,Ge()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Fl)throw Fl=!1,e=Oc,Oc=null,e;return ql&1&&e.tag!==0&&ta(),a=e.pendingLanes,a&1?e===jc?uo++:(uo=0,jc=e):uo=0,Wr(),null}function ta(){if(kr!==null){var e=fy(ql),t=tn.transition,n=we;try{if(tn.transition=null,we=16>e?16:e,kr===null)var r=!1;else{if(e=kr,kr=null,ql=0,$e&6)throw Error(W(331));var i=$e;for($e|=4,Q=e.current;Q!==null;){var a=Q,o=a.child;if(Q.flags&16){var s=a.deletions;if(s!==null){for(var l=0;l<s.length;l++){var u=s[l];for(Q=u;Q!==null;){var h=Q;switch(h.tag){case 0:case 11:case 15:so(8,h,a)}var c=h.child;if(c!==null)c.return=h,Q=c;else for(;Q!==null;){h=Q;var m=h.sibling,d=h.return;if(S2(h),h===u){Q=null;break}if(m!==null){m.return=d,Q=m;break}Q=d}}}var b=a.alternate;if(b!==null){var $=b.child;if($!==null){b.child=null;do{var w=$.sibling;$.sibling=null,$=w}while($!==null)}}Q=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,Q=o;else e:for(;Q!==null;){if(a=Q,a.flags&2048)switch(a.tag){case 0:case 11:case 15:so(9,a,a.return)}var g=a.sibling;if(g!==null){g.return=a.return,Q=g;break e}Q=a.return}}var y=e.current;for(Q=y;Q!==null;){o=Q;var _=o.child;if(o.subtreeFlags&2064&&_!==null)_.return=o,Q=_;else e:for(o=y;Q!==null;){if(s=Q,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:lu(9,s)}}catch(D){Ue(s,s.return,D)}if(s===o){Q=null;break e}var T=s.sibling;if(T!==null){T.return=s.return,Q=T;break e}Q=s.return}}if($e=i,Wr(),Tn&&typeof Tn.onPostCommitFiberRoot=="function")try{Tn.onPostCommitFiberRoot(eu,e)}catch{}r=!0}return r}finally{we=n,tn.transition=t}}return!1}function lp(e,t,n){t=ma(n,t),t=f2(e,t,1),e=Tr(e,t,1),t=xt(),e!==null&&(Ko(e,1,t),zt(e,t))}function Ue(e,t,n){if(e.tag===3)lp(e,e,n);else for(;t!==null;){if(t.tag===3){lp(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ar===null||!Ar.has(r))){e=ma(n,e),e=p2(t,e,1),t=Tr(t,e,1),e=xt(),t!==null&&(Ko(t,1,e),zt(t,e));break}}t=t.return}}function m5(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=xt(),e.pingedLanes|=e.suspendedLanes&n,it===e&&(lt&n)===n&&(et===4||et===3&&(lt&130023424)===lt&&500>Ge()-_m?hi(e,0):vm|=n),zt(e,t)}function q2(e,t){t===0&&(e.mode&1?(t=bs,bs<<=1,!(bs&130023424)&&(bs=4194304)):t=1);var n=xt();e=rr(e,t),e!==null&&(Ko(e,t,n),zt(e,n))}function d5(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),q2(e,n)}function f5(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(W(314))}r!==null&&r.delete(t),q2(e,n)}var R2;R2=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Tt.current)Dt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Dt=!1,t5(e,t,n);Dt=!!(e.flags&131072)}else Dt=!1,Fe&&t.flags&1048576&&Ly(t,El,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;el(e,t),e=t.pendingProps;var i=la(t,pt.current);ea(t,n),i=fm(null,t,r,e,i,n);var a=pm();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,At(r)?(a=!0,kl(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,um(t),i.updater=su,t.stateNode=i,i._reactInternals=t,Tc(t,r,e,n),t=Mc(null,t,r,!0,a,n)):(t.tag=0,Fe&&a&&nm(t),$t(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(el(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=g5(r),e=fn(r,e),i){case 0:t=zc(null,t,r,e,n);break e;case 1:t=Qf(null,t,r,e,n);break e;case 11:t=Zf(null,t,r,e,n);break e;case 14:t=Yf(null,t,r,fn(r.type,e),n);break e}throw Error(W(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:fn(r,i),zc(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:fn(r,i),Qf(e,t,r,i,n);case 3:e:{if($2(t),e===null)throw Error(W(387));r=t.pendingProps,a=t.memoizedState,i=a.element,Uy(e,t),Dl(t,r,null,n);var o=t.memoizedState;if(r=o.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=ma(Error(W(423)),t),t=Jf(e,t,r,n,i);break e}else if(r!==i){i=ma(Error(W(424)),t),t=Jf(e,t,r,n,i);break e}else for(Bt=Dr(t.stateNode.containerInfo.firstChild),Ot=t,Fe=!0,bn=null,n=Wy(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ua(),r===i){t=ir(e,t,n);break e}$t(e,t,r,n)}t=t.child}return t;case 5:return Hy(t),e===null&&Cc(t),r=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,o=i.children,xc(r,i)?o=null:a!==null&&xc(r,a)&&(t.flags|=32),y2(e,t),$t(e,t,o,n),t.child;case 6:return e===null&&Cc(t),null;case 13:return v2(e,t,n);case 4:return hm(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=ha(t,null,r,n):$t(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:fn(r,i),Zf(e,t,r,i,n);case 7:return $t(e,t,t.pendingProps,n),t.child;case 8:return $t(e,t,t.pendingProps.children,n),t.child;case 12:return $t(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value,Pe(Cl,r._currentValue),r._currentValue=o,a!==null)if(_n(a.value,o)){if(a.children===i.children&&!Tt.current){t=ir(e,t,n);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var s=a.dependencies;if(s!==null){o=a.child;for(var l=s.firstContext;l!==null;){if(l.context===r){if(a.tag===1){l=Kn(-1,n&-n),l.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?l.next=l:(l.next=h.next,h.next=l),u.pending=l}}a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),Pc(a.return,n,t),s.lanes|=n;break}l=l.next}}else if(a.tag===10)o=a.type===t.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(W(341));o.lanes|=n,s=o.alternate,s!==null&&(s.lanes|=n),Pc(o,n,t),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===t){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}$t(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,ea(t,n),i=rn(i),r=r(i),t.flags|=1,$t(e,t,r,n),t.child;case 14:return r=t.type,i=fn(r,t.pendingProps),i=fn(r.type,i),Yf(e,t,r,i,n);case 15:return g2(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:fn(r,i),el(e,t),t.tag=1,At(r)?(e=!0,kl(t)):e=!1,ea(t,n),d2(t,r,i),Tc(t,r,i,n),Mc(null,t,r,!0,e,n);case 19:return _2(e,t,n);case 22:return b2(e,t,n)}throw Error(W(156,t.tag))};function N2(e,t){return hy(e,t)}function p5(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Jt(e,t,n,r){return new p5(e,t,n,r)}function Sm(e){return e=e.prototype,!(!e||!e.isReactComponent)}function g5(e){if(typeof e=="function")return Sm(e)?1:0;if(e!=null){if(e=e.$$typeof,e===W0)return 11;if(e===X0)return 14}return 2}function Mr(e,t){var n=e.alternate;return n===null?(n=Jt(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function rl(e,t,n,r,i,a){var o=2;if(r=e,typeof e=="function")Sm(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Mi:return ci(n.children,i,a,t);case V0:o=8,i|=8;break;case ec:return e=Jt(12,n,t,i|2),e.elementType=ec,e.lanes=a,e;case tc:return e=Jt(13,n,t,i),e.elementType=tc,e.lanes=a,e;case nc:return e=Jt(19,n,t,i),e.elementType=nc,e.lanes=a,e;case Hb:return hu(n,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Xb:o=10;break e;case Ub:o=9;break e;case W0:o=11;break e;case X0:o=14;break e;case $r:o=16,r=null;break e}throw Error(W(130,e==null?e:typeof e,""))}return t=Jt(o,n,t,i),t.elementType=e,t.type=r,t.lanes=a,t}function ci(e,t,n,r){return e=Jt(7,e,r,t),e.lanes=n,e}function hu(e,t,n,r){return e=Jt(22,e,r,t),e.elementType=Hb,e.lanes=n,e.stateNode={isHidden:!1},e}function sh(e,t,n){return e=Jt(6,e,null,t),e.lanes=n,e}function lh(e,t,n){return t=Jt(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function b5(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ju(0),this.expirationTimes=ju(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ju(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Em(e,t,n,r,i,a,o,s,l){return e=new b5(e,t,n,s,l),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Jt(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},um(a),e}function y5(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zi,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function I2(e){if(!e)return qr;e=e._reactInternals;e:{if($i(e)!==e||e.tag!==1)throw Error(W(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(At(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(W(171))}if(e.tag===1){var n=e.type;if(At(n))return Iy(e,n,t)}return t}function B2(e,t,n,r,i,a,o,s,l){return e=Em(n,r,!0,e,i,a,o,s,l),e.context=I2(null),n=e.current,r=xt(),i=zr(n),a=Kn(r,i),a.callback=t??null,Tr(n,a,i),e.current.lanes=i,Ko(e,i,r),zt(e,r),e}function cu(e,t,n,r){var i=t.current,a=xt(),o=zr(i);return n=I2(n),t.context===null?t.context=n:t.pendingContext=n,t=Kn(a,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Tr(i,t,o),e!==null&&($n(e,i,o,a),Ys(e,i,o)),o}function Nl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function up(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Cm(e,t){up(e,t),(e=e.alternate)&&up(e,t)}function $5(){return null}var L2=typeof reportError=="function"?reportError:function(e){console.error(e)};function Pm(e){this._internalRoot=e}mu.prototype.render=Pm.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(W(409));cu(e,t,null,null)};mu.prototype.unmount=Pm.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;bi(function(){cu(null,e,null,null)}),t[nr]=null}};function mu(e){this._internalRoot=e}mu.prototype.unstable_scheduleHydration=function(e){if(e){var t=by();e={blockedOn:null,target:e,priority:t};for(var n=0;n<_r.length&&t!==0&&t<_r[n].priority;n++);_r.splice(n,0,e),n===0&&$y(e)}};function Dm(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function du(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function hp(){}function v5(e,t,n,r,i){if(i){if(typeof r=="function"){var a=r;r=function(){var u=Nl(o);a.call(u)}}var o=B2(t,r,e,0,null,!1,!1,"",hp);return e._reactRootContainer=o,e[nr]=o.current,Co(e.nodeType===8?e.parentNode:e),bi(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var s=r;r=function(){var u=Nl(l);s.call(u)}}var l=Em(e,0,!1,null,null,!1,!1,"",hp);return e._reactRootContainer=l,e[nr]=l.current,Co(e.nodeType===8?e.parentNode:e),bi(function(){cu(t,l,n,r)}),l}function fu(e,t,n,r,i){var a=n._reactRootContainer;if(a){var o=a;if(typeof i=="function"){var s=i;i=function(){var l=Nl(o);s.call(l)}}cu(t,o,e,i)}else o=v5(n,t,e,i,r);return Nl(o)}py=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Za(t.pendingLanes);n!==0&&(G0(t,n|1),zt(t,Ge()),!($e&6)&&(da=Ge()+500,Wr()))}break;case 13:bi(function(){var r=rr(e,1);if(r!==null){var i=xt();$n(r,e,1,i)}}),Cm(e,1)}};K0=function(e){if(e.tag===13){var t=rr(e,134217728);if(t!==null){var n=xt();$n(t,e,134217728,n)}Cm(e,134217728)}};gy=function(e){if(e.tag===13){var t=zr(e),n=rr(e,t);if(n!==null){var r=xt();$n(n,e,t,r)}Cm(e,t)}};by=function(){return we};yy=function(e,t){var n=we;try{return we=e,t()}finally{we=n}};mc=function(e,t,n){switch(t){case"input":if(ac(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=iu(r);if(!i)throw Error(W(90));Kb(r),ac(r,i)}}}break;case"textarea":Yb(e,n);break;case"select":t=n.value,t!=null&&Zi(e,!!n.multiple,t,!1)}};iy=xm;ay=bi;var _5={usingClientEntryPoint:!1,Events:[Yo,Ni,iu,ny,ry,xm]},Oa={findFiberByHostInstance:ii,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},x5={bundleType:Oa.bundleType,version:Oa.version,rendererPackageName:Oa.rendererPackageName,rendererConfig:Oa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ur.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=ly(e),e===null?null:e.stateNode},findFiberByHostInstance:Oa.findFiberByHostInstance||$5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ps=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ps.isDisabled&&Ps.supportsFiber)try{eu=Ps.inject(x5),Tn=Ps}catch{}}Wt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_5;Wt.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Dm(t))throw Error(W(200));return y5(e,t,null,n)};Wt.createRoot=function(e,t){if(!Dm(e))throw Error(W(299));var n=!1,r="",i=L2;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Em(e,1,!1,null,null,n,!1,r,i),e[nr]=t.current,Co(e.nodeType===8?e.parentNode:e),new Pm(t)};Wt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(W(188)):(e=Object.keys(e).join(","),Error(W(268,e)));return e=ly(t),e=e===null?null:e.stateNode,e};Wt.flushSync=function(e){return bi(e)};Wt.hydrate=function(e,t,n){if(!du(t))throw Error(W(200));return fu(null,e,t,!0,n)};Wt.hydrateRoot=function(e,t,n){if(!Dm(e))throw Error(W(405));var r=n!=null&&n.hydratedSources||null,i=!1,a="",o=L2;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=B2(t,null,e,1,n??null,i,!1,a,o),e[nr]=t.current,Co(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new mu(t)};Wt.render=function(e,t,n){if(!du(t))throw Error(W(200));return fu(null,e,t,!1,n)};Wt.unmountComponentAtNode=function(e){if(!du(e))throw Error(W(40));return e._reactRootContainer?(bi(function(){fu(null,null,e,!1,function(){e._reactRootContainer=null,e[nr]=null})}),!0):!1};Wt.unstable_batchedUpdates=xm;Wt.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!du(n))throw Error(W(200));if(e==null||e._reactInternals===void 0)throw Error(W(38));return fu(e,t,n,!1,r)};Wt.version="18.3.1-next-f1338f8080-20240426";function O2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(O2)}catch(e){console.error(e)}}O2(),Ob.exports=Wt;var w5=Ob.exports,cp=w5;Qh.createRoot=cp.createRoot,Qh.hydrateRoot=cp.hydrateRoot;var Tm={};Object.defineProperty(Tm,"__esModule",{value:!0});Tm.parse=T5;Tm.serialize=A5;const k5=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,S5=/^[\u0021-\u003A\u003C-\u007E]*$/,E5=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,C5=/^[\u0020-\u003A\u003D-\u007E]*$/,P5=Object.prototype.toString,D5=(()=>{const e=function(){};return e.prototype=Object.create(null),e})();function T5(e,t){const n=new D5,r=e.length;if(r<2)return n;const i=(t==null?void 0:t.decode)||z5;let a=0;do{const o=e.indexOf("=",a);if(o===-1)break;const s=e.indexOf(";",a),l=s===-1?r:s;if(o>l){a=e.lastIndexOf(";",o-1)+1;continue}const u=mp(e,a,o),h=dp(e,o,u),c=e.slice(u,h);if(n[c]===void 0){let m=mp(e,o+1,l),d=dp(e,l,m);const b=i(e.slice(m,d));n[c]=b}a=l+1}while(a<r);return n}function mp(e,t,n){do{const r=e.charCodeAt(t);if(r!==32&&r!==9)return t}while(++t<n);return n}function dp(e,t,n){for(;t>n;){const r=e.charCodeAt(--t);if(r!==32&&r!==9)return t+1}return n}function A5(e,t,n){const r=(n==null?void 0:n.encode)||encodeURIComponent;if(!k5.test(e))throw new TypeError(`argument name is invalid: ${e}`);const i=r(t);if(!S5.test(i))throw new TypeError(`argument val is invalid: ${t}`);let a=e+"="+i;if(!n)return a;if(n.maxAge!==void 0){if(!Number.isInteger(n.maxAge))throw new TypeError(`option maxAge is invalid: ${n.maxAge}`);a+="; Max-Age="+n.maxAge}if(n.domain){if(!E5.test(n.domain))throw new TypeError(`option domain is invalid: ${n.domain}`);a+="; Domain="+n.domain}if(n.path){if(!C5.test(n.path))throw new TypeError(`option path is invalid: ${n.path}`);a+="; Path="+n.path}if(n.expires){if(!M5(n.expires)||!Number.isFinite(n.expires.valueOf()))throw new TypeError(`option expires is invalid: ${n.expires}`);a+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(a+="; HttpOnly"),n.secure&&(a+="; Secure"),n.partitioned&&(a+="; Partitioned"),n.priority)switch(typeof n.priority=="string"?n.priority.toLowerCase():void 0){case"low":a+="; Priority=Low";break;case"medium":a+="; Priority=Medium";break;case"high":a+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${n.priority}`)}if(n.sameSite)switch(typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite){case!0:case"strict":a+="; SameSite=Strict";break;case"lax":a+="; SameSite=Lax";break;case"none":a+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${n.sameSite}`)}return a}function z5(e){if(e.indexOf("%")===-1)return e;try{return decodeURIComponent(e)}catch{return e}}function M5(e){return P5.call(e)==="[object Date]"}/**
 * react-router v7.0.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var fp="popstate";function F5(e={}){function t(i,a){let{pathname:o="/",search:s="",hash:l=""}=vi(i.location.hash.substring(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),Xc("",{pathname:o,search:s,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(i,a){let o=i.document.querySelector("base"),s="";if(o&&o.getAttribute("href")){let l=i.location.href,u=l.indexOf("#");s=u===-1?l:l.slice(0,u)}return s+"#"+(typeof a=="string"?a:Ro(a))}function r(i,a){hr(i.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(a)})`)}return R5(t,n,r,e)}function je(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function hr(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function q5(){return Math.random().toString(36).substring(2,10)}function pp(e,t){return{usr:e.state,key:e.key,idx:t}}function Xc(e,t,n=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?vi(t):t,state:n,key:t&&t.key||r||q5()}}function Ro({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function vi(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function R5(e,t,n,r={}){let{window:i=document.defaultView,v5Compat:a=!1}=r,o=i.history,s="POP",l=null,u=h();u==null&&(u=0,o.replaceState({...o.state,idx:u},""));function h(){return(o.state||{idx:null}).idx}function c(){s="POP";let w=h(),g=w==null?null:w-u;u=w,l&&l({action:s,location:$.location,delta:g})}function m(w,g){s="PUSH";let y=Xc($.location,w,g);n&&n(y,w),u=h()+1;let _=pp(y,u),T=$.createHref(y);try{o.pushState(_,"",T)}catch(D){if(D instanceof DOMException&&D.name==="DataCloneError")throw D;i.location.assign(T)}a&&l&&l({action:s,location:$.location,delta:1})}function d(w,g){s="REPLACE";let y=Xc($.location,w,g);n&&n(y,w),u=h();let _=pp(y,u),T=$.createHref(y);o.replaceState(_,"",T),a&&l&&l({action:s,location:$.location,delta:0})}function b(w){let g=i.location.origin!=="null"?i.location.origin:i.location.href,y=typeof w=="string"?w:Ro(w);return y=y.replace(/ $/,"%20"),je(g,`No window.location.(origin|href) available to create URL for href: ${y}`),new URL(y,g)}let $={get action(){return s},get location(){return e(i,o)},listen(w){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(fp,c),l=w,()=>{i.removeEventListener(fp,c),l=null}},createHref(w){return t(i,w)},createURL:b,encodeLocation(w){let g=b(w);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:m,replace:d,go(w){return o.go(w)}};return $}function j2(e,t,n="/"){return N5(e,t,n,!1)}function N5(e,t,n,r){let i=typeof t=="string"?vi(t):t,a=Rr(i.pathname||"/",n);if(a==null)return null;let o=V2(e);I5(o);let s=null;for(let l=0;s==null&&l<o.length;++l){let u=K5(a);s=H5(o[l],u,r)}return s}function V2(e,t=[],n=[],r=""){let i=(a,o,s)=>{let l={relativePath:s===void 0?a.path||"":s,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};l.relativePath.startsWith("/")&&(je(l.relativePath.startsWith(r),`Absolute route path "${l.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(r.length));let u=Zn([r,l.relativePath]),h=n.concat(l);a.children&&a.children.length>0&&(je(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),V2(a.children,t,h,u)),!(a.path==null&&!a.index)&&t.push({path:u,score:X5(u,a.index),routesMeta:h})};return e.forEach((a,o)=>{var s;if(a.path===""||!((s=a.path)!=null&&s.includes("?")))i(a,o);else for(let l of W2(a.path))i(a,o,l)}),t}function W2(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,i=n.endsWith("?"),a=n.replace(/\?$/,"");if(r.length===0)return i?[a,""]:[a];let o=W2(r.join("/")),s=[];return s.push(...o.map(l=>l===""?a:[a,l].join("/"))),i&&s.push(...o),s.map(l=>e.startsWith("/")&&l===""?"/":l)}function I5(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:U5(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var B5=/^:[\w-]+$/,L5=3,O5=2,j5=1,V5=10,W5=-2,gp=e=>e==="*";function X5(e,t){let n=e.split("/"),r=n.length;return n.some(gp)&&(r+=W5),t&&(r+=O5),n.filter(i=>!gp(i)).reduce((i,a)=>i+(B5.test(a)?L5:a===""?j5:V5),r)}function U5(e,t){return e.length===t.length&&e.slice(0,-1).every((r,i)=>r===t[i])?e[e.length-1]-t[t.length-1]:0}function H5(e,t,n=!1){let{routesMeta:r}=e,i={},a="/",o=[];for(let s=0;s<r.length;++s){let l=r[s],u=s===r.length-1,h=a==="/"?t:t.slice(a.length)||"/",c=Il({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},h),m=l.route;if(!c&&u&&n&&!r[r.length-1].route.index&&(c=Il({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},h)),!c)return null;Object.assign(i,c.params),o.push({params:i,pathname:Zn([a,c.pathname]),pathnameBase:J5(Zn([a,c.pathnameBase])),route:m}),c.pathnameBase!=="/"&&(a=Zn([a,c.pathnameBase]))}return o}function Il(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=G5(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),s=i.slice(1);return{params:r.reduce((u,{paramName:h,isOptional:c},m)=>{if(h==="*"){let b=s[m]||"";o=a.slice(0,a.length-b.length).replace(/(.)\/+$/,"$1")}const d=s[m];return c&&!d?u[h]=void 0:u[h]=(d||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:o,pattern:e}}function G5(e,t=!1,n=!0){hr(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,s,l)=>(r.push({paramName:s,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),r]}function K5(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return hr(!1,`The URL path "${e}" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Rr(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function Z5(e,t="/"){let{pathname:n,search:r="",hash:i=""}=typeof e=="string"?vi(e):e;return{pathname:n?n.startsWith("/")?n:Y5(n,t):t,search:e6(r),hash:t6(i)}}function Y5(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function uh(e,t,n,r){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Q5(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function X2(e){let t=Q5(e);return t.map((n,r)=>r===t.length-1?n.pathname:n.pathnameBase)}function U2(e,t,n,r=!1){let i;typeof e=="string"?i=vi(e):(i={...e},je(!i.pathname||!i.pathname.includes("?"),uh("?","pathname","search",i)),je(!i.pathname||!i.pathname.includes("#"),uh("#","pathname","hash",i)),je(!i.search||!i.search.includes("#"),uh("#","search","hash",i)));let a=e===""||i.pathname==="",o=a?"/":i.pathname,s;if(o==null)s=n;else{let c=t.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),c-=1;i.pathname=m.join("/")}s=c>=0?t[c]:"/"}let l=Z5(i,s),u=o&&o!=="/"&&o.endsWith("/"),h=(a||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||h)&&(l.pathname+="/"),l}var Zn=e=>e.join("/").replace(/\/\/+/g,"/"),J5=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),e6=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,t6=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function n6(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var H2=["POST","PUT","PATCH","DELETE"];new Set(H2);var r6=["GET",...H2];new Set(r6);var _a=S.createContext(null);_a.displayName="DataRouter";var pu=S.createContext(null);pu.displayName="DataRouterState";var G2=S.createContext({isTransitioning:!1});G2.displayName="ViewTransition";var i6=S.createContext(new Map);i6.displayName="Fetchers";var a6=S.createContext(null);a6.displayName="Await";var qn=S.createContext(null);qn.displayName="Navigation";var Jo=S.createContext(null);Jo.displayName="Location";var Rn=S.createContext({outlet:null,matches:[],isDataRoute:!1});Rn.displayName="Route";var Am=S.createContext(null);Am.displayName="RouteError";function o6(e,{relative:t}={}){je(es(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=S.useContext(qn),{hash:i,pathname:a,search:o}=ns(e,{relative:t}),s=a;return n!=="/"&&(s=a==="/"?n:Zn([n,a])),r.createHref({pathname:s,search:o,hash:i})}function es(){return S.useContext(Jo)!=null}function xn(){return je(es(),"useLocation() may be used only in the context of a <Router> component."),S.useContext(Jo).location}var K2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Z2(e){S.useContext(qn).static||S.useLayoutEffect(e)}function ts(){let{isDataRoute:e}=S.useContext(Rn);return e?v6():s6()}function s6(){je(es(),"useNavigate() may be used only in the context of a <Router> component.");let e=S.useContext(_a),{basename:t,navigator:n}=S.useContext(qn),{matches:r}=S.useContext(Rn),{pathname:i}=xn(),a=JSON.stringify(X2(r)),o=S.useRef(!1);return Z2(()=>{o.current=!0}),S.useCallback((l,u={})=>{if(hr(o.current,K2),!o.current)return;if(typeof l=="number"){n.go(l);return}let h=U2(l,JSON.parse(a),i,u.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:Zn([t,h.pathname])),(u.replace?n.replace:n.push)(h,u.state,u)},[t,n,a,i,e])}S.createContext(null);function l6(){let{matches:e}=S.useContext(Rn),t=e[e.length-1];return t?t.params:{}}function ns(e,{relative:t}={}){let{matches:n}=S.useContext(Rn),{pathname:r}=xn(),i=JSON.stringify(X2(n));return S.useMemo(()=>U2(e,JSON.parse(i),r,t==="path"),[e,i,r,t])}function u6(e,t){return Y2(e,t)}function Y2(e,t,n,r){var $;je(es(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=S.useContext(qn),{matches:a}=S.useContext(Rn),o=a[a.length-1],s=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let u=xn(),h;if(t){let w=typeof t=="string"?vi(t):t;je(l==="/"||(($=w.pathname)==null?void 0:$.startsWith(l)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${l}" but pathname "${w.pathname}" was given in the \`location\` prop.`),h=w}else h=u;let c=h.pathname||"/",m=c;if(l!=="/"){let w=l.replace(/^\//,"").split("/");m="/"+c.replace(/^\//,"").split("/").slice(w.length).join("/")}let d=j2(e,{pathname:m}),b=f6(d&&d.map(w=>Object.assign({},w,{params:Object.assign({},s,w.params),pathname:Zn([l,i.encodeLocation?i.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?l:Zn([l,i.encodeLocation?i.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),a,n,r);return t&&b?S.createElement(Jo.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...h},navigationType:"POP"}},b):b}function h6(){let e=$6(),t=n6(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},t),n?S.createElement("pre",{style:i},n):null,null)}var c6=S.createElement(h6,null),m6=class extends S.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?S.createElement(Rn.Provider,{value:this.props.routeContext},S.createElement(Am.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function d6({routeContext:e,match:t,children:n}){let r=S.useContext(_a);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),S.createElement(Rn.Provider,{value:e},n)}function f6(e,t=[],n=null,r=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let i=e,a=n==null?void 0:n.errors;if(a!=null){let l=i.findIndex(u=>u.route.id&&(a==null?void 0:a[u.route.id])!==void 0);je(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),i=i.slice(0,Math.min(i.length,l+1))}let o=!1,s=-1;if(n)for(let l=0;l<i.length;l++){let u=i[l];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(s=l),u.route.id){let{loaderData:h,errors:c}=n,m=u.route.loader&&!h.hasOwnProperty(u.route.id)&&(!c||c[u.route.id]===void 0);if(u.route.lazy||m){o=!0,s>=0?i=i.slice(0,s+1):i=[i[0]];break}}}return i.reduceRight((l,u,h)=>{let c,m=!1,d=null,b=null;n&&(c=a&&u.route.id?a[u.route.id]:void 0,d=u.route.errorElement||c6,o&&(s<0&&h===0?(_6("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),m=!0,b=null):s===h&&(m=!0,b=u.route.hydrateFallbackElement||null)));let $=t.concat(i.slice(0,h+1)),w=()=>{let g;return c?g=d:m?g=b:u.route.Component?g=S.createElement(u.route.Component,null):u.route.element?g=u.route.element:g=l,S.createElement(d6,{match:u,routeContext:{outlet:l,matches:$,isDataRoute:n!=null},children:g})};return n&&(u.route.ErrorBoundary||u.route.errorElement||h===0)?S.createElement(m6,{location:n.location,revalidation:n.revalidation,component:d,error:c,children:w(),routeContext:{outlet:null,matches:$,isDataRoute:!0}}):w()},null)}function zm(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function p6(e){let t=S.useContext(_a);return je(t,zm(e)),t}function g6(e){let t=S.useContext(pu);return je(t,zm(e)),t}function b6(e){let t=S.useContext(Rn);return je(t,zm(e)),t}function Mm(e){let t=b6(e),n=t.matches[t.matches.length-1];return je(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function y6(){return Mm("useRouteId")}function $6(){var r;let e=S.useContext(Am),t=g6("useRouteError"),n=Mm("useRouteError");return e!==void 0?e:(r=t.errors)==null?void 0:r[n]}function v6(){let{router:e}=p6("useNavigate"),t=Mm("useNavigate"),n=S.useRef(!1);return Z2(()=>{n.current=!0}),S.useCallback(async(i,a={})=>{hr(n.current,K2),n.current&&(typeof i=="number"?e.navigate(i):await e.navigate(i,{fromRouteId:t,...a}))},[e,t])}var bp={};function _6(e,t,n){bp[e]||(bp[e]=!0,hr(!1,n))}S.memo(x6);function x6({routes:e,future:t,state:n}){return Y2(e,void 0,n,t)}function ti(e){je(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function w6({basename:e="/",children:t=null,location:n,navigationType:r="POP",navigator:i,static:a=!1}){je(!es(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),s=S.useMemo(()=>({basename:o,navigator:i,static:a,future:{}}),[o,i,a]);typeof n=="string"&&(n=vi(n));let{pathname:l="/",search:u="",hash:h="",state:c=null,key:m="default"}=n,d=S.useMemo(()=>{let b=Rr(l,o);return b==null?null:{location:{pathname:b,search:u,hash:h,state:c,key:m},navigationType:r}},[o,l,u,h,c,m,r]);return hr(d!=null,`<Router basename="${o}"> is not able to match the URL "${l}${u}${h}" because it does not start with the basename, so the <Router> won't render anything.`),d==null?null:S.createElement(qn.Provider,{value:s},S.createElement(Jo.Provider,{children:t,value:d}))}function k6({children:e,location:t}){return u6(Uc(e),t)}function Uc(e,t=[]){let n=[];return S.Children.forEach(e,(r,i)=>{if(!S.isValidElement(r))return;let a=[...t,i];if(r.type===S.Fragment){n.push.apply(n,Uc(r.props.children,a));return}je(r.type===ti,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),je(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Uc(r.props.children,a)),n.push(o)}),n}var il="get",al="application/x-www-form-urlencoded";function gu(e){return e!=null&&typeof e.tagName=="string"}function S6(e){return gu(e)&&e.tagName.toLowerCase()==="button"}function E6(e){return gu(e)&&e.tagName.toLowerCase()==="form"}function C6(e){return gu(e)&&e.tagName.toLowerCase()==="input"}function P6(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function D6(e,t){return e.button===0&&(!t||t==="_self")&&!P6(e)}var Ds=null;function T6(){if(Ds===null)try{new FormData(document.createElement("form"),0),Ds=!1}catch{Ds=!0}return Ds}var A6=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function hh(e){return e!=null&&!A6.has(e)?(hr(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${al}"`),null):e}function z6(e,t){let n,r,i,a,o;if(E6(e)){let s=e.getAttribute("action");r=s?Rr(s,t):null,n=e.getAttribute("method")||il,i=hh(e.getAttribute("enctype"))||al,a=new FormData(e)}else if(S6(e)||C6(e)&&(e.type==="submit"||e.type==="image")){let s=e.form;if(s==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=e.getAttribute("formaction")||s.getAttribute("action");if(r=l?Rr(l,t):null,n=e.getAttribute("formmethod")||s.getAttribute("method")||il,i=hh(e.getAttribute("formenctype"))||hh(s.getAttribute("enctype"))||al,a=new FormData(s,e),!T6()){let{name:u,type:h,value:c}=e;if(h==="image"){let m=u?`${u}.`:"";a.append(`${m}x`,"0"),a.append(`${m}y`,"0")}else u&&a.append(u,c)}}else{if(gu(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=il,r=null,i=al,o=e}return a&&i==="text/plain"&&(o=a,a=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:a,body:o}}function Fm(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function M6(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function F6(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function q6(e,t,n){let r=await Promise.all(e.map(async i=>{let a=t.routes[i.route.id];if(a){let o=await M6(a,n);return o.links?o.links():[]}return[]}));return B6(r.flat(1).filter(F6).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function yp(e,t,n,r,i,a){let o=(l,u)=>n[u]?l.route.id!==n[u].route.id:!0,s=(l,u)=>{var h;return n[u].pathname!==l.pathname||((h=n[u].route.path)==null?void 0:h.endsWith("*"))&&n[u].params["*"]!==l.params["*"]};return a==="assets"?t.filter((l,u)=>o(l,u)||s(l,u)):a==="data"?t.filter((l,u)=>{var c;let h=r.routes[l.route.id];if(!h||!h.hasLoader)return!1;if(o(l,u)||s(l,u))return!0;if(l.route.shouldRevalidate){let m=l.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((c=n[0])==null?void 0:c.params)||{},nextUrl:new URL(e,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function R6(e,t){return N6(e.map(n=>{let r=t.routes[n.route.id];if(!r)return[];let i=[r.module];return r.imports&&(i=i.concat(r.imports)),i}).flat(1))}function N6(e){return[...new Set(e)]}function I6(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}function B6(e,t){let n=new Set;return new Set(t),e.reduce((r,i)=>{let a=JSON.stringify(I6(i));return n.has(a)||(n.add(a),r.push({key:a,link:i})),r},[])}function L6(e){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function O6(){let e=S.useContext(_a);return Fm(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function j6(){let e=S.useContext(pu);return Fm(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var qm=S.createContext(void 0);qm.displayName="FrameworkContext";function Q2(){let e=S.useContext(qm);return Fm(e,"You must render this element inside a <HydratedRouter> element"),e}function V6(e,t){let n=S.useContext(qm),[r,i]=S.useState(!1),[a,o]=S.useState(!1),{onFocus:s,onBlur:l,onMouseEnter:u,onMouseLeave:h,onTouchStart:c}=t,m=S.useRef(null);S.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let $=g=>{g.forEach(y=>{o(y.isIntersecting)})},w=new IntersectionObserver($,{threshold:.5});return m.current&&w.observe(m.current),()=>{w.disconnect()}}},[e]),S.useEffect(()=>{if(r){let $=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout($)}}},[r]);let d=()=>{i(!0)},b=()=>{i(!1),o(!1)};return n?e!=="intent"?[a,m,{}]:[a,m,{onFocus:ja(s,d),onBlur:ja(l,b),onMouseEnter:ja(u,d),onMouseLeave:ja(h,b),onTouchStart:ja(c,d)}]:[!1,m,{}]}function ja(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function W6({page:e,...t}){let{router:n}=O6(),r=S.useMemo(()=>j2(n.routes,e,n.basename),[n.routes,e,n.basename]);return r?S.createElement(U6,{page:e,matches:r,...t}):(console.warn(`Tried to prefetch ${e} but no routes matched.`),null)}function X6(e){let{manifest:t,routeModules:n}=Q2(),[r,i]=S.useState([]);return S.useEffect(()=>{let a=!1;return q6(e,t,n).then(o=>{a||i(o)}),()=>{a=!0}},[e,t,n]),r}function U6({page:e,matches:t,...n}){let r=xn(),{manifest:i,routeModules:a}=Q2(),{loaderData:o,matches:s}=j6(),l=S.useMemo(()=>yp(e,t,s,i,r,"data"),[e,t,s,i,r]),u=S.useMemo(()=>yp(e,t,s,i,r,"assets"),[e,t,s,i,r]),h=S.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let d=new Set,b=!1;if(t.forEach(w=>{var y;let g=i.routes[w.route.id];!g||!g.hasLoader||(!l.some(_=>_.route.id===w.route.id)&&w.route.id in o&&((y=a[w.route.id])!=null&&y.shouldRevalidate)||g.hasClientLoader?b=!0:d.add(w.route.id))}),d.size===0)return[];let $=L6(e);return b&&d.size>0&&$.searchParams.set("_routes",t.filter(w=>d.has(w.route.id)).map(w=>w.route.id).join(",")),[$.pathname+$.search]},[o,r,i,l,t,e,a]),c=S.useMemo(()=>R6(u,i),[u,i]),m=X6(u);return S.createElement(S.Fragment,null,h.map(d=>S.createElement("link",{key:d,rel:"prefetch",as:"fetch",href:d,...n})),c.map(d=>S.createElement("link",{key:d,rel:"modulepreload",href:d,...n})),m.map(({key:d,link:b})=>S.createElement("link",{key:d,...b})))}function H6(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var J2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{J2&&(window.__reactRouterVersion="7.0.1")}catch{}function G6({basename:e,children:t,window:n}){let r=S.useRef();r.current==null&&(r.current=F5({window:n,v5Compat:!0}));let i=r.current,[a,o]=S.useState({action:i.action,location:i.location}),s=S.useCallback(l=>{S.startTransition(()=>o(l))},[o]);return S.useLayoutEffect(()=>i.listen(s),[i,s]),S.createElement(w6,{basename:e,children:t,location:a.location,navigationType:a.action,navigator:i})}var e$=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,si=S.forwardRef(function({onClick:t,discover:n="render",prefetch:r="none",relative:i,reloadDocument:a,replace:o,state:s,target:l,to:u,preventScrollReset:h,viewTransition:c,...m},d){let{basename:b}=S.useContext(qn),$=typeof u=="string"&&e$.test(u),w,g=!1;if(typeof u=="string"&&$&&(w=u,J2))try{let N=new URL(window.location.href),O=u.startsWith("//")?new URL(N.protocol+u):new URL(u),U=Rr(O.pathname,b);O.origin===N.origin&&U!=null?u=U+O.search+O.hash:g=!0}catch{hr(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let y=o6(u,{relative:i}),[_,T,D]=V6(r,m),C=Q6(u,{replace:o,state:s,target:l,preventScrollReset:h,relative:i,viewTransition:c});function F(N){t&&t(N),N.defaultPrevented||C(N)}let R=S.createElement("a",{...m,...D,href:w||y,onClick:g||a?t:F,ref:H6(d,T),target:l,"data-discover":!$&&n==="render"?"true":void 0});return _&&!$?S.createElement(S.Fragment,null,R,S.createElement(W6,{page:y})):R});si.displayName="Link";var K6=S.forwardRef(function({"aria-current":t="page",caseSensitive:n=!1,className:r="",end:i=!1,style:a,to:o,viewTransition:s,children:l,...u},h){let c=ns(o,{relative:u.relative}),m=xn(),d=S.useContext(pu),{navigator:b,basename:$}=S.useContext(qn),w=d!=null&&rw(c)&&s===!0,g=b.encodeLocation?b.encodeLocation(c).pathname:c.pathname,y=m.pathname,_=d&&d.navigation&&d.navigation.location?d.navigation.location.pathname:null;n||(y=y.toLowerCase(),_=_?_.toLowerCase():null,g=g.toLowerCase()),_&&$&&(_=Rr(_,$)||_);const T=g!=="/"&&g.endsWith("/")?g.length-1:g.length;let D=y===g||!i&&y.startsWith(g)&&y.charAt(T)==="/",C=_!=null&&(_===g||!i&&_.startsWith(g)&&_.charAt(g.length)==="/"),F={isActive:D,isPending:C,isTransitioning:w},R=D?t:void 0,N;typeof r=="function"?N=r(F):N=[r,D?"active":null,C?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let O=typeof a=="function"?a(F):a;return S.createElement(si,{...u,"aria-current":R,className:N,ref:h,style:O,to:o,viewTransition:s},typeof l=="function"?l(F):l)});K6.displayName="NavLink";var Z6=S.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:r,replace:i,state:a,method:o=il,action:s,onSubmit:l,relative:u,preventScrollReset:h,viewTransition:c,...m},d)=>{let b=tw(),$=nw(s,{relative:u}),w=o.toLowerCase()==="get"?"get":"post",g=typeof s=="string"&&e$.test(s),y=_=>{if(l&&l(_),_.defaultPrevented)return;_.preventDefault();let T=_.nativeEvent.submitter,D=(T==null?void 0:T.getAttribute("formmethod"))||o;b(T||_.currentTarget,{fetcherKey:t,method:D,navigate:n,replace:i,state:a,relative:u,preventScrollReset:h,viewTransition:c})};return S.createElement("form",{ref:d,method:w,action:$,onSubmit:r?l:y,...m,"data-discover":!g&&e==="render"?"true":void 0})});Z6.displayName="Form";function Y6(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function t$(e){let t=S.useContext(_a);return je(t,Y6(e)),t}function Q6(e,{target:t,replace:n,state:r,preventScrollReset:i,relative:a,viewTransition:o}={}){let s=ts(),l=xn(),u=ns(e,{relative:a});return S.useCallback(h=>{if(D6(h,t)){h.preventDefault();let c=n!==void 0?n:Ro(l)===Ro(u);s(e,{replace:c,state:r,preventScrollReset:i,relative:a,viewTransition:o})}},[l,s,u,n,r,t,e,i,a,o])}var J6=0,ew=()=>`__${String(++J6)}__`;function tw(){let{router:e}=t$("useSubmit"),{basename:t}=S.useContext(qn),n=y6();return S.useCallback(async(r,i={})=>{let{action:a,method:o,encType:s,formData:l,body:u}=z6(r,t);if(i.navigate===!1){let h=i.fetcherKey||ew();await e.fetch(h,n,i.action||a,{preventScrollReset:i.preventScrollReset,formData:l,body:u,formMethod:i.method||o,formEncType:i.encType||s,flushSync:i.flushSync})}else await e.navigate(i.action||a,{preventScrollReset:i.preventScrollReset,formData:l,body:u,formMethod:i.method||o,formEncType:i.encType||s,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})},[e,t,n])}function nw(e,{relative:t}={}){let{basename:n}=S.useContext(qn),r=S.useContext(Rn);je(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),a={...ns(e||".",{relative:t})},o=xn();if(e==null){a.search=o.search;let s=new URLSearchParams(a.search),l=s.getAll("index");if(l.some(h=>h==="")){s.delete("index"),l.filter(c=>c).forEach(c=>s.append("index",c));let h=s.toString();a.search=h?`?${h}`:""}}return(!e||e===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(a.pathname=a.pathname==="/"?n:Zn([n,a.pathname])),Ro(a)}function rw(e,t={}){let n=S.useContext(G2);je(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=t$("useViewTransitionState"),i=ns(e,{relative:t.relative});if(!n.isTransitioning)return!1;let a=Rr(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=Rr(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Il(i.pathname,o)!=null||Il(i.pathname,a)!=null}new TextEncoder;function iw(e,t,{checkForDefaultPrevented:n=!0}={}){return function(i){if(e==null||e(i),n===!1||!i.defaultPrevented)return t==null?void 0:t(i)}}function aw(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function n$(...e){return t=>e.forEach(n=>aw(n,t))}function ow(...e){return S.useCallback(n$(...e),e)}function sw(e,t=[]){let n=[];function r(a,o){const s=S.createContext(o),l=n.length;n=[...n,o];const u=c=>{var g;const{scope:m,children:d,...b}=c,$=((g=m==null?void 0:m[e])==null?void 0:g[l])||s,w=S.useMemo(()=>b,Object.values(b));return M.jsx($.Provider,{value:w,children:d})};u.displayName=a+"Provider";function h(c,m){var $;const d=(($=m==null?void 0:m[e])==null?void 0:$[l])||s,b=S.useContext(d);if(b)return b;if(o!==void 0)return o;throw new Error(`\`${c}\` must be used within \`${a}\``)}return[u,h]}const i=()=>{const a=n.map(o=>S.createContext(o));return function(s){const l=(s==null?void 0:s[e])||a;return S.useMemo(()=>({[`__scope${e}`]:{...s,[e]:l}}),[s,l])}};return i.scopeName=e,[r,lw(i,...t)]}function lw(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(a){const o=r.reduce((s,{useScope:l,scopeName:u})=>{const c=l(a)[`__scope${u}`];return{...s,...c}},{});return S.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}function r$(e){const t=S.useRef(e);return S.useEffect(()=>{t.current=e}),S.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}function uw({prop:e,defaultProp:t,onChange:n=()=>{}}){const[r,i]=hw({defaultProp:t,onChange:n}),a=e!==void 0,o=a?e:r,s=r$(n),l=S.useCallback(u=>{if(a){const c=typeof u=="function"?u(e):u;c!==e&&s(c)}else i(u)},[a,e,i,s]);return[o,l]}function hw({defaultProp:e,onChange:t}){const n=S.useState(e),[r]=n,i=S.useRef(r),a=r$(t);return S.useEffect(()=>{i.current!==r&&(a(r),i.current=r)},[r,i,a]),n}function cw(e){const t=S.useRef({value:e,previous:e});return S.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var mw=globalThis!=null&&globalThis.document?S.useLayoutEffect:()=>{};function dw(e){const[t,n]=S.useState(void 0);return mw(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const a=i[0];let o,s;if("borderBoxSize"in a){const l=a.borderBoxSize,u=Array.isArray(l)?l[0]:l;o=u.inlineSize,s=u.blockSize}else o=e.offsetWidth,s=e.offsetHeight;n({width:o,height:s})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var i$=S.forwardRef((e,t)=>{const{children:n,...r}=e,i=S.Children.toArray(n),a=i.find(pw);if(a){const o=a.props.children,s=i.map(l=>l===a?S.Children.count(o)>1?S.Children.only(null):S.isValidElement(o)?o.props.children:null:l);return M.jsx(Hc,{...r,ref:t,children:S.isValidElement(o)?S.cloneElement(o,void 0,s):null})}return M.jsx(Hc,{...r,ref:t,children:n})});i$.displayName="Slot";var Hc=S.forwardRef((e,t)=>{const{children:n,...r}=e;if(S.isValidElement(n)){const i=bw(n);return S.cloneElement(n,{...gw(r,n.props),ref:t?n$(t,i):i})}return S.Children.count(n)>1?S.Children.only(null):null});Hc.displayName="SlotClone";var fw=({children:e})=>M.jsx(M.Fragment,{children:e});function pw(e){return S.isValidElement(e)&&e.type===fw}function gw(e,t){const n={...t};for(const r in t){const i=e[r],a=t[r];/^on[A-Z]/.test(r)?i&&a?n[r]=(...s)=>{a(...s),i(...s)}:i&&(n[r]=i):r==="style"?n[r]={...i,...a}:r==="className"&&(n[r]=[i,a].filter(Boolean).join(" "))}return{...e,...n}}function bw(e){var r,i;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(i=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:i.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var yw=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],a$=yw.reduce((e,t)=>{const n=S.forwardRef((r,i)=>{const{asChild:a,...o}=r,s=a?i$:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),M.jsx(s,{...o,ref:i})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{}),Rm="Switch",[$w,FF]=sw(Rm),[vw,_w]=$w(Rm),o$=S.forwardRef((e,t)=>{const{__scopeSwitch:n,name:r,checked:i,defaultChecked:a,required:o,disabled:s,value:l="on",onCheckedChange:u,form:h,...c}=e,[m,d]=S.useState(null),b=ow(t,_=>d(_)),$=S.useRef(!1),w=m?h||!!m.closest("form"):!0,[g=!1,y]=uw({prop:i,defaultProp:a,onChange:u});return M.jsxs(vw,{scope:n,checked:g,disabled:s,children:[M.jsx(a$.button,{type:"button",role:"switch","aria-checked":g,"aria-required":o,"data-state":l$(g),"data-disabled":s?"":void 0,disabled:s,value:l,...c,ref:b,onClick:iw(e.onClick,_=>{y(T=>!T),w&&($.current=_.isPropagationStopped(),$.current||_.stopPropagation())})}),w&&M.jsx(ww,{control:m,bubbles:!$.current,name:r,value:l,checked:g,required:o,disabled:s,form:h,style:{transform:"translateX(-100%)"}})]})});o$.displayName=Rm;var s$="SwitchThumb",xw=S.forwardRef((e,t)=>{const{__scopeSwitch:n,...r}=e,i=_w(s$,n);return M.jsx(a$.span,{"data-state":l$(i.checked),"data-disabled":i.disabled?"":void 0,...r,ref:t})});xw.displayName=s$;var ww=e=>{const{control:t,checked:n,bubbles:r=!0,...i}=e,a=S.useRef(null),o=cw(n),s=dw(t);return S.useEffect(()=>{const l=a.current,u=window.HTMLInputElement.prototype,c=Object.getOwnPropertyDescriptor(u,"checked").set;if(o!==n&&c){const m=new Event("click",{bubbles:r});c.call(l,n),l.dispatchEvent(m)}},[o,n,r]),M.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...i,tabIndex:-1,ref:a,style:{...e.style,...s,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function l$(e){return e?"checked":"unchecked"}var u$=o$;function h$(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=h$(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function c$(){for(var e,t,n=0,r="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=h$(e))&&(r&&(r+=" "),r+=t);return r}const Nm="-",kw=e=>{const t=Ew(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:o=>{const s=o.split(Nm);return s[0]===""&&s.length!==1&&s.shift(),m$(s,t)||Sw(o)},getConflictingClassGroupIds:(o,s)=>{const l=n[o]||[];return s&&r[o]?[...l,...r[o]]:l}}},m$=(e,t)=>{var o;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),i=r?m$(e.slice(1),r):void 0;if(i)return i;if(t.validators.length===0)return;const a=e.join(Nm);return(o=t.validators.find(({validator:s})=>s(a)))==null?void 0:o.classGroupId},$p=/^\[(.+)\]$/,Sw=e=>{if($p.test(e)){const t=$p.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},Ew=e=>{const{theme:t,prefix:n}=e,r={nextPart:new Map,validators:[]};return Pw(Object.entries(e.classGroups),n).forEach(([a,o])=>{Gc(o,r,a,t)}),r},Gc=(e,t,n,r)=>{e.forEach(i=>{if(typeof i=="string"){const a=i===""?t:vp(t,i);a.classGroupId=n;return}if(typeof i=="function"){if(Cw(i)){Gc(i(r),t,n,r);return}t.validators.push({validator:i,classGroupId:n});return}Object.entries(i).forEach(([a,o])=>{Gc(o,vp(t,a),n,r)})})},vp=(e,t)=>{let n=e;return t.split(Nm).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},Cw=e=>e.isThemeGetter,Pw=(e,t)=>t?e.map(([n,r])=>{const i=r.map(a=>typeof a=="string"?t+a:typeof a=="object"?Object.fromEntries(Object.entries(a).map(([o,s])=>[t+o,s])):a);return[n,i]}):e,Dw=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const i=(a,o)=>{n.set(a,o),t++,t>e&&(t=0,r=n,n=new Map)};return{get(a){let o=n.get(a);if(o!==void 0)return o;if((o=r.get(a))!==void 0)return i(a,o),o},set(a,o){n.has(a)?n.set(a,o):i(a,o)}}},d$="!",Tw=e=>{const{separator:t,experimentalParseClassName:n}=e,r=t.length===1,i=t[0],a=t.length,o=s=>{const l=[];let u=0,h=0,c;for(let w=0;w<s.length;w++){let g=s[w];if(u===0){if(g===i&&(r||s.slice(w,w+a)===t)){l.push(s.slice(h,w)),h=w+a;continue}if(g==="/"){c=w;continue}}g==="["?u++:g==="]"&&u--}const m=l.length===0?s:s.substring(h),d=m.startsWith(d$),b=d?m.substring(1):m,$=c&&c>h?c-h:void 0;return{modifiers:l,hasImportantModifier:d,baseClassName:b,maybePostfixModifierPosition:$}};return n?s=>n({className:s,parseClassName:o}):o},Aw=e=>{if(e.length<=1)return e;const t=[];let n=[];return e.forEach(r=>{r[0]==="["?(t.push(...n.sort(),r),n=[]):n.push(r)}),t.push(...n.sort()),t},zw=e=>({cache:Dw(e.cacheSize),parseClassName:Tw(e),...kw(e)}),Mw=/\s+/,Fw=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:i}=t,a=[],o=e.trim().split(Mw);let s="";for(let l=o.length-1;l>=0;l-=1){const u=o[l],{modifiers:h,hasImportantModifier:c,baseClassName:m,maybePostfixModifierPosition:d}=n(u);let b=!!d,$=r(b?m.substring(0,d):m);if(!$){if(!b){s=u+(s.length>0?" "+s:s);continue}if($=r(m),!$){s=u+(s.length>0?" "+s:s);continue}b=!1}const w=Aw(h).join(":"),g=c?w+d$:w,y=g+$;if(a.includes(y))continue;a.push(y);const _=i($,b);for(let T=0;T<_.length;++T){const D=_[T];a.push(g+D)}s=u+(s.length>0?" "+s:s)}return s};function qw(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=f$(t))&&(r&&(r+=" "),r+=n);return r}const f$=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=f$(e[r]))&&(n&&(n+=" "),n+=t);return n};function Rw(e,...t){let n,r,i,a=o;function o(l){const u=t.reduce((h,c)=>c(h),e());return n=zw(u),r=n.cache.get,i=n.cache.set,a=s,s(l)}function s(l){const u=r(l);if(u)return u;const h=Fw(l,n);return i(l,h),h}return function(){return a(qw.apply(null,arguments))}}const Ae=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},p$=/^\[(?:([a-z-]+):)?(.+)\]$/i,Nw=/^\d+\/\d+$/,Iw=new Set(["px","full","screen"]),Bw=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Lw=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Ow=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,jw=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Vw=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,jn=e=>na(e)||Iw.has(e)||Nw.test(e),dr=e=>xa(e,"length",Yw),na=e=>!!e&&!Number.isNaN(Number(e)),ch=e=>xa(e,"number",na),Va=e=>!!e&&Number.isInteger(Number(e)),Ww=e=>e.endsWith("%")&&na(e.slice(0,-1)),fe=e=>p$.test(e),fr=e=>Bw.test(e),Xw=new Set(["length","size","percentage"]),Uw=e=>xa(e,Xw,g$),Hw=e=>xa(e,"position",g$),Gw=new Set(["image","url"]),Kw=e=>xa(e,Gw,Jw),Zw=e=>xa(e,"",Qw),Wa=()=>!0,xa=(e,t,n)=>{const r=p$.exec(e);return r?r[1]?typeof t=="string"?r[1]===t:t.has(r[1]):n(r[2]):!1},Yw=e=>Lw.test(e)&&!Ow.test(e),g$=()=>!1,Qw=e=>jw.test(e),Jw=e=>Vw.test(e),e7=()=>{const e=Ae("colors"),t=Ae("spacing"),n=Ae("blur"),r=Ae("brightness"),i=Ae("borderColor"),a=Ae("borderRadius"),o=Ae("borderSpacing"),s=Ae("borderWidth"),l=Ae("contrast"),u=Ae("grayscale"),h=Ae("hueRotate"),c=Ae("invert"),m=Ae("gap"),d=Ae("gradientColorStops"),b=Ae("gradientColorStopPositions"),$=Ae("inset"),w=Ae("margin"),g=Ae("opacity"),y=Ae("padding"),_=Ae("saturate"),T=Ae("scale"),D=Ae("sepia"),C=Ae("skew"),F=Ae("space"),R=Ae("translate"),N=()=>["auto","contain","none"],O=()=>["auto","hidden","clip","visible","scroll"],U=()=>["auto",fe,t],B=()=>[fe,t],he=()=>["",jn,dr],ue=()=>["auto",na,fe],ae=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],be=()=>["solid","dashed","dotted","double","none"],le=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],j=()=>["start","end","center","between","around","evenly","stretch"],J=()=>["","0",fe],k=()=>["auto","avoid","all","avoid-page","page","left","right","column"],ne=()=>[na,fe];return{cacheSize:500,separator:":",theme:{colors:[Wa],spacing:[jn,dr],blur:["none","",fr,fe],brightness:ne(),borderColor:[e],borderRadius:["none","","full",fr,fe],borderSpacing:B(),borderWidth:he(),contrast:ne(),grayscale:J(),hueRotate:ne(),invert:J(),gap:B(),gradientColorStops:[e],gradientColorStopPositions:[Ww,dr],inset:U(),margin:U(),opacity:ne(),padding:B(),saturate:ne(),scale:ne(),sepia:J(),skew:ne(),space:B(),translate:B()},classGroups:{aspect:[{aspect:["auto","square","video",fe]}],container:["container"],columns:[{columns:[fr]}],"break-after":[{"break-after":k()}],"break-before":[{"break-before":k()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ae(),fe]}],overflow:[{overflow:O()}],"overflow-x":[{"overflow-x":O()}],"overflow-y":[{"overflow-y":O()}],overscroll:[{overscroll:N()}],"overscroll-x":[{"overscroll-x":N()}],"overscroll-y":[{"overscroll-y":N()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[$]}],"inset-x":[{"inset-x":[$]}],"inset-y":[{"inset-y":[$]}],start:[{start:[$]}],end:[{end:[$]}],top:[{top:[$]}],right:[{right:[$]}],bottom:[{bottom:[$]}],left:[{left:[$]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Va,fe]}],basis:[{basis:U()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",fe]}],grow:[{grow:J()}],shrink:[{shrink:J()}],order:[{order:["first","last","none",Va,fe]}],"grid-cols":[{"grid-cols":[Wa]}],"col-start-end":[{col:["auto",{span:["full",Va,fe]},fe]}],"col-start":[{"col-start":ue()}],"col-end":[{"col-end":ue()}],"grid-rows":[{"grid-rows":[Wa]}],"row-start-end":[{row:["auto",{span:[Va,fe]},fe]}],"row-start":[{"row-start":ue()}],"row-end":[{"row-end":ue()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",fe]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",fe]}],gap:[{gap:[m]}],"gap-x":[{"gap-x":[m]}],"gap-y":[{"gap-y":[m]}],"justify-content":[{justify:["normal",...j()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...j(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...j(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[w]}],mx:[{mx:[w]}],my:[{my:[w]}],ms:[{ms:[w]}],me:[{me:[w]}],mt:[{mt:[w]}],mr:[{mr:[w]}],mb:[{mb:[w]}],ml:[{ml:[w]}],"space-x":[{"space-x":[F]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[F]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",fe,t]}],"min-w":[{"min-w":[fe,t,"min","max","fit"]}],"max-w":[{"max-w":[fe,t,"none","full","min","max","fit","prose",{screen:[fr]},fr]}],h:[{h:[fe,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[fe,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[fe,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[fe,t,"auto","min","max","fit"]}],"font-size":[{text:["base",fr,dr]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",ch]}],"font-family":[{font:[Wa]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",fe]}],"line-clamp":[{"line-clamp":["none",na,ch]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",jn,fe]}],"list-image":[{"list-image":["none",fe]}],"list-style-type":[{list:["none","disc","decimal",fe]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[g]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[g]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...be(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",jn,dr]}],"underline-offset":[{"underline-offset":["auto",jn,fe]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:B()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",fe]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",fe]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[g]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ae(),Hw]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Uw]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Kw]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[b]}],"gradient-via-pos":[{via:[b]}],"gradient-to-pos":[{to:[b]}],"gradient-from":[{from:[d]}],"gradient-via":[{via:[d]}],"gradient-to":[{to:[d]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[s]}],"border-w-x":[{"border-x":[s]}],"border-w-y":[{"border-y":[s]}],"border-w-s":[{"border-s":[s]}],"border-w-e":[{"border-e":[s]}],"border-w-t":[{"border-t":[s]}],"border-w-r":[{"border-r":[s]}],"border-w-b":[{"border-b":[s]}],"border-w-l":[{"border-l":[s]}],"border-opacity":[{"border-opacity":[g]}],"border-style":[{border:[...be(),"hidden"]}],"divide-x":[{"divide-x":[s]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[s]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[g]}],"divide-style":[{divide:be()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...be()]}],"outline-offset":[{"outline-offset":[jn,fe]}],"outline-w":[{outline:[jn,dr]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:he()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[g]}],"ring-offset-w":[{"ring-offset":[jn,dr]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",fr,Zw]}],"shadow-color":[{shadow:[Wa]}],opacity:[{opacity:[g]}],"mix-blend":[{"mix-blend":[...le(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":le()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",fr,fe]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[h]}],invert:[{invert:[c]}],saturate:[{saturate:[_]}],sepia:[{sepia:[D]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[h]}],"backdrop-invert":[{"backdrop-invert":[c]}],"backdrop-opacity":[{"backdrop-opacity":[g]}],"backdrop-saturate":[{"backdrop-saturate":[_]}],"backdrop-sepia":[{"backdrop-sepia":[D]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",fe]}],duration:[{duration:ne()}],ease:[{ease:["linear","in","out","in-out",fe]}],delay:[{delay:ne()}],animate:[{animate:["none","spin","ping","pulse","bounce",fe]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[T]}],"scale-x":[{"scale-x":[T]}],"scale-y":[{"scale-y":[T]}],rotate:[{rotate:[Va,fe]}],"translate-x":[{"translate-x":[R]}],"translate-y":[{"translate-y":[R]}],"skew-x":[{"skew-x":[C]}],"skew-y":[{"skew-y":[C]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",fe]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",fe]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":B()}],"scroll-mx":[{"scroll-mx":B()}],"scroll-my":[{"scroll-my":B()}],"scroll-ms":[{"scroll-ms":B()}],"scroll-me":[{"scroll-me":B()}],"scroll-mt":[{"scroll-mt":B()}],"scroll-mr":[{"scroll-mr":B()}],"scroll-mb":[{"scroll-mb":B()}],"scroll-ml":[{"scroll-ml":B()}],"scroll-p":[{"scroll-p":B()}],"scroll-px":[{"scroll-px":B()}],"scroll-py":[{"scroll-py":B()}],"scroll-ps":[{"scroll-ps":B()}],"scroll-pe":[{"scroll-pe":B()}],"scroll-pt":[{"scroll-pt":B()}],"scroll-pr":[{"scroll-pr":B()}],"scroll-pb":[{"scroll-pb":B()}],"scroll-pl":[{"scroll-pl":B()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",fe]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[jn,dr,ch]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},t7=Rw(e7);function vn(...e){return t7(c$(e))}const b$=S.forwardRef(({className:e,...t},n)=>M.jsx(u$,{ref:n,className:vn("relative inline-flex h-[24px] w-[44px] cursor-pointer rounded-full transition-colors duration-200 ease-in-out","focus:outline-none focus-visible:ring focus-visible:ring-sky-500 focus-visible:ring-opacity-75","bg-sky-900","data-[state=checked]:bg-sky-600",e),...t}));b$.displayName=u$.displayName;const y$=S.createContext(void 0),n7=({children:e})=>{const[t,n]=S.useState(!1);return M.jsx(y$.Provider,{value:{fontToggle:t,setFontToggle:n},children:e})},$$=()=>{const e=S.useContext(y$);if(!e)throw new Error("useFontToggle must be used within a FontToggleProvider");return e},r7=()=>{const{fontToggle:e,setFontToggle:t}=$$();return Bb.useEffect(()=>{const n=window.document.documentElement;e?n.classList.add("alt-font"):n.classList.remove("alt-font")},[e]),M.jsx("nav",{className:"bg-sky-100 shadow",children:M.jsxs("div",{className:"container mx-auto px-4 h-16 flex items-center justify-between",children:[M.jsx(si,{to:"/",className:"text-xl font-bold text-sky-900 hover:text-sky-600",children:"Luna"}),M.jsxs("div",{className:"my-auto flex items-center justify-between",children:[M.jsx(b$,{className:"mr-4",checked:e,onCheckedChange:t}),M.jsx(si,{to:"/warp",className:"font-semibold text-sky-900 hover:text-sky-600 mx-4",children:"Warp"}),M.jsx(si,{to:"/show",className:"font-semibold text-sky-900 hover:text-sky-600 mx-4",children:"World"}),M.jsx(si,{to:"/about",className:"font-semibold text-sky-900 hover:text-sky-600 mx-4",children:"About"})]})]})})},i7=()=>M.jsx("footer",{className:"bg-sky-100 shadow mt-10",children:M.jsx("div",{className:"container mx-auto px-4 h-16 flex items-center justify-center",children:M.jsx("p",{className:"text-sky-800",children:"All original information in this website follow CC BY-SA 3.0 Unported creative commons license."})})});function _p(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function a7(...e){return t=>{let n=!1;const r=e.map(i=>{const a=_p(i,t);return!n&&typeof a=="function"&&(n=!0),a});if(n)return()=>{for(let i=0;i<r.length;i++){const a=r[i];typeof a=="function"?a():_p(e[i],null)}}}}var v$=S.forwardRef((e,t)=>{const{children:n,...r}=e,i=S.Children.toArray(n),a=i.find(s7);if(a){const o=a.props.children,s=i.map(l=>l===a?S.Children.count(o)>1?S.Children.only(null):S.isValidElement(o)?o.props.children:null:l);return M.jsx(Kc,{...r,ref:t,children:S.isValidElement(o)?S.cloneElement(o,void 0,s):null})}return M.jsx(Kc,{...r,ref:t,children:n})});v$.displayName="Slot";var Kc=S.forwardRef((e,t)=>{const{children:n,...r}=e;if(S.isValidElement(n)){const i=u7(n),a=l7(r,n.props);return n.type!==S.Fragment&&(a.ref=t?a7(t,i):i),S.cloneElement(n,a)}return S.Children.count(n)>1?S.Children.only(null):null});Kc.displayName="SlotClone";var o7=({children:e})=>M.jsx(M.Fragment,{children:e});function s7(e){return S.isValidElement(e)&&e.type===o7}function l7(e,t){const n={...t};for(const r in t){const i=e[r],a=t[r];/^on[A-Z]/.test(r)?i&&a?n[r]=(...s)=>{a(...s),i(...s)}:i&&(n[r]=i):r==="style"?n[r]={...i,...a}:r==="className"&&(n[r]=[i,a].filter(Boolean).join(" "))}return{...e,...n}}function u7(e){var r,i;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(i=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:i.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}const xp=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,wp=c$,h7=(e,t)=>n=>{var r;if((t==null?void 0:t.variants)==null)return wp(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:i,defaultVariants:a}=t,o=Object.keys(i).map(u=>{const h=n==null?void 0:n[u],c=a==null?void 0:a[u];if(h===null)return null;const m=xp(h)||xp(c);return i[u][m]}),s=n&&Object.entries(n).reduce((u,h)=>{let[c,m]=h;return m===void 0||(u[c]=m),u},{}),l=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((u,h)=>{let{class:c,className:m,...d}=h;return Object.entries(d).every(b=>{let[$,w]=b;return Array.isArray(w)?w.includes({...a,...s}[$]):{...a,...s}[$]===w})?[...u,c,m]:u},[]);return wp(e,o,l,n==null?void 0:n.class,n==null?void 0:n.className)},_$=h7("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),ra=S.forwardRef(({className:e,variant:t,size:n,asChild:r=!1,...i},a)=>{const o=r?v$:"button";return M.jsx(o,{className:vn(_$({variant:t,size:n,className:e})),ref:a,...i})});ra.displayName="Button";const c7=({post:e})=>M.jsxs("div",{className:"bg-sky-100 rounded-lg shadow p-6 mb-6 mx-16",children:[M.jsx("h2",{className:`font-semibold text-sky-900
      text-xl
      sm:text-xl
      lg:text-2xl
      `,children:e.title}),M.jsxs("div",{className:`text-sky-900 mb-4
      text-xs
      sm:text-xs
      lg:text-sm
      `,children:[e.date," • ",e.author]}),M.jsx("p",{className:`text-sky-900 mb-4
      text-sm
      sm:text-sm
      lg:text-base
      `,children:e.excerpt}),M.jsx(si,{to:`/posts/${e.id}`,children:M.jsx(ra,{variant:"default",className:`font-semibold bg-sky-900 text-sky-100 hover:bg-sky-600 focus:outline-none
        text-sm
        sm:text-sm
        lg:text-base
        `,children:"Detail"})})]});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m7=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),x$=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var d7={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f7=S.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:a,iconNode:o,...s},l)=>S.createElement("svg",{ref:l,...d7,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:x$("lucide",i),...s},[...o.map(([u,h])=>S.createElement(u,h)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bu=(e,t)=>{const n=S.forwardRef(({className:r,...i},a)=>S.createElement(f7,{ref:a,iconNode:t,className:x$(`lucide-${m7(e)}`,r),...i}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p7=bu("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g7=bu("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w$=bu("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b7=bu("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),k$=({className:e,...t})=>M.jsx("nav",{role:"navigation","aria-label":"pagination",className:vn("mx-auto flex w-full justify-center",e),...t});k$.displayName="Pagination";const S$=S.forwardRef(({className:e,...t},n)=>M.jsx("ul",{ref:n,className:vn("flex flex-row items-center gap-1",e),...t}));S$.displayName="PaginationContent";const ol=S.forwardRef(({className:e,...t},n)=>M.jsx("li",{ref:n,className:vn("",e),...t}));ol.displayName="PaginationItem";const yu=({className:e,isActive:t,size:n="icon",...r})=>M.jsx("a",{"aria-current":t?"page":void 0,className:vn(_$({variant:t?"outline":"ghost",size:n}),e),...r});yu.displayName="PaginationLink";const E$=({className:e,...t})=>M.jsxs(yu,{"aria-label":"Go to previous page",size:"default",className:vn("gap-1 pl-2.5",e),...t,children:[M.jsx(p7,{className:"h-4 w-4"}),M.jsx("span",{children:"Previous"})]});E$.displayName="PaginationPrevious";const C$=({className:e,...t})=>M.jsxs(yu,{"aria-label":"Go to next page",size:"default",className:vn("gap-1 pr-2.5",e),...t,children:[M.jsx("span",{children:"Next"}),M.jsx(g7,{className:"h-4 w-4"})]});C$.displayName="PaginationNext";const y7=({posts:e,currentPage:t,totalPages:n,onPageChange:r})=>M.jsxs("div",{className:"space-y-6",children:[M.jsx("div",{children:e.map(i=>M.jsx(c7,{post:i},i.id))}),M.jsx("div",{className:"flex justify-center mt-8",children:M.jsx(k$,{children:M.jsxs(S$,{className:"gap-2",children:[" ",M.jsx(ol,{children:M.jsx(E$,{onClick:()=>t>1&&r(t-1),className:vn("select-none","min-w-9 h-9","bg-sky-100 hover:bg-sky-200","text-sky-900","rounded-md","flex items-center justify-center")})}),[...Array(n)].map((i,a)=>M.jsx(ol,{className:"list-none",children:M.jsx(yu,{onClick:()=>r(a+1),className:vn("select-none","min-w-9 h-9","bg-sky-100 hover:bg-sky-200","text-sky-900","rounded-md","flex items-center justify-center",t===a+1&&"bg-sky-900 text-sky-100 hover:bg-sky-800"),children:a+1})},a+1)),M.jsx(ol,{children:M.jsx(C$,{onClick:()=>t<n&&r(t+1),className:vn("select-none","min-w-9 h-9","bg-sky-100 hover:bg-sky-200","text-sky-900","rounded-md","flex items-center justify-center")})})]})})})]}),Wi=[{id:1,title:"Test LATEX",date:"2023-10-01",excerpt:"Test LATEX",contentKey:"post1",author:"Tester",category:"Test"},{id:4,title:"[QC] Day 1 - Projective measure",date:"2024-12-10",excerpt:"QC Day 1 - Projective measure: Exercise 2.58 - 2.61",contentKey:"QC_1",author:"Me",category:"Quantum Computation"},{id:5,title:"[QC] Day 2 - Phase, Composite systems",date:"2024-12-10",excerpt:"QC Day 2 - Phase Composite systems",contentKey:"QC_2",author:"Me",category:"Quantum Computation"},{id:6,title:"[CD] Day 1 - Japanese sentence structure",date:"2024-12-11",excerpt:"CD Day 1 - Japanese sentence structure, yoroshiku, wo/ni/no, verb conjugation, teiru/tearu",contentKey:"CD_1",author:"私",category:"Cure Dolly"},{id:7,title:"[CD] Day 2 - Adjective",date:"2024-12-11",excerpt:"CD Day 2 - i/na adjectives, da/desu, noni, ender",contentKey:"CD_2",author:"私",category:"Cure Dolly"},{id:8,title:"[CD] Day 3 - mo",date:"2024-12-12",excerpt:"CD Day 3 - mo, negative, adjective conjugation, transitive/intransitive",contentKey:"CD_3",author:"私",category:"Cure Dolly"},{id:9,title:"[QC] Day 3 - POVM, superdense coding, density operator",date:"2024-12-13",excerpt:"QC Day 3 - POVM, some thoughts about it, superdense coding, density operator",contentKey:"QC_3",author:"Me",category:"Quantum Computation"},{id:10,title:"[CD] Day 4 - te-miru",date:"2024-12-12",excerpt:"CD Day 4 - te-miru, masu, causative/receptive, place",contentKey:"CD_4",author:"私",category:"Cure Dolly"},{id:11,title:"[QC] Day 4 - more density operator",date:"2024-12-16",excerpt:"QC Day 4 - more density operator",contentKey:"QC_3",author:"Me",category:"Quantum Computation"},{id:12,title:"[A0] Day 1 - Chapter 1",date:"2024-12-19",excerpt:"QC Day 1 - Chapter 1 exercise",contentKey:"A0_1",author:"Me",category:"Algebra Chapter 0"},{id:13,title:"[A0] Day 2 - Chapter 1, function between sets",date:"2024-12-21",excerpt:"QC Day 2 - function between sets",contentKey:"A0_2",author:"Me",category:"Algebra Chapter 0"},{id:14,title:"[EC] Day 1 -  THE SELECTION EFFECT AND THE SPEED OF LEARNING",date:"2024-12-23",excerpt:"EC Day 1 - the seletion effect and the speed of learning",contentKey:"EC_1",author:"Me",category:"Business paper"},{id:15,title:"[EC] Day 2 -  The Good, The Bad and The Picky: Reference Dependence and the Reversal of Product Ratings",date:"2024-12-29",excerpt:"EC Day 2 - The Good, The Bad and The Picky: Reference Dependence and the Reversal of Product Ratings",contentKey:"EC_2",author:"Me",category:"Business paper"},{id:16,title:"[EC] Day 3 - Stability Evaluation through Distributional Perturbation Analysis",date:"2025-1-15",excerpt:"[EC] Day 3 - Stability Evaluation through Distributional Perturbation Analysis",contentKey:"EC_3",author:"Me",category:"Business paper"},{id:17,title:"[CD] Day 5 - te-oku",date:"2025-1-15",excerpt:"CD Day 5 - te-oku",contentKey:"CD_5",author:"私",category:"Cure Dolly"},{id:18,title:"[EC] Day 4 - Conformal Inverse Optimization",date:"2025-1-18",excerpt:"[EC] Day 4 - Conformal Inverse Optimization",contentKey:"EC_4",author:"Me",category:"Business paper"},{id:19,title:"[EC] Day 5 - A Survey of Contextual Optimization Methods for Decision-Making under Uncertainty",date:"2025-1-21",excerpt:"[EC] Day 5 - A Survey of Contextual Optimization Methods for Decision-Making under Uncertainty",contentKey:"EC_5",author:"Me",category:"Business paper"},{id:20,title:"[EC] Day 7 - A Practical Use of SLO",date:"2025-2-24",excerpt:"[EC] Day 7 - A Practical Use of SLO",contentKey:"EC_7",author:"Me",category:"Business paper"},{id:21,title:"[GT] Week 1 - Introduction",date:"2025-2-24",excerpt:"[GT] Week 1 - Introduction",contentKey:"GT_1",author:"Me",category:"Notes"},{id:22,title:"[GT_P] Week 1 - supplier encroachment",date:"2025-2-24",excerpt:"[GT_P] Week 1 - supplier encroachment",contentKey:"GT_P1",author:"Me",category:"Notes"},{id:23,title:"[SP] Week 1 - RV",date:"2025-2-24",excerpt:"[SP] Week 1 - RV",contentKey:"SP_1",author:"Me",category:"Notes"},{id:24,title:"[GT] Week 1 - Assignment",date:"2025-2-24",excerpt:"[GT] Week 1 - Assignment",contentKey:"GT_A1",author:"Me",category:"Assignments"},{id:25,title:"[SP] Week 1 - Assignment",date:"2025-2-24",excerpt:"[SP] Week 1 - Assignment",contentKey:"SP_A1",author:"Me",category:"Assignments"},{id:26,title:"[EC] Day 6 - Crowdsourcing Exploration ",date:"2025-2-25",excerpt:"[EC] Day 6 - Crowdsourcing Exploration ",contentKey:"EC_6",author:"Me",category:"Business paper"},{id:27,title:"[EC] Day 8 -  Service Oriented Considerate Routing",date:"2025-2-25",excerpt:"[EC] Day 8 - Service Oriented Considerate Routing",contentKey:"EC_8",author:"Me",category:"Business paper"},{id:28,title:"[GT_P] Week 2 -  Supplier Encroachment with Multiple Retailers",date:"2025-3-2",excerpt:"[GT_P] Week 2 -  Supplier Encroachment with Multiple Retailers",contentKey:"GT_P2",author:"Me",category:"Notes"},{id:29,title:"[GT_A] Week 2",date:"2025-3-2",excerpt:"[GT_A] Week 2",contentKey:"GT_A02",author:"Me",category:"Assignments"},{id:30,title:"[GT] Week 2",date:"2025-3-2",excerpt:"[GT] Week 2",contentKey:"GT_02",author:"Me",category:"Notes"},{id:31,title:"[FE] Week 2",date:"2025-3-2",excerpt:"[FE] Week 2",contentKey:"FE_02",author:"Me",category:"Notes"},{id:32,title:"[SCM] Week 2",date:"2025-3-2",excerpt:"[SCM] Week 2",contentKey:"SCM_02",author:"Me",category:"Notes"},{id:33,title:"[SGD] Week 2",date:"2025-3-2",excerpt:"[SGD] Week 2",contentKey:"SGD_02",author:"Me",category:"Notes"},{id:34,title:"[SP] Week 2",date:"2025-3-2",excerpt:"[SP] Week 2",contentKey:"SP_02",author:"Me",category:"Notes"},{id:35,title:"[GT] Week 3",date:"2025-3-13",excerpt:"[GT] Week 3",contentKey:"GT_03",author:"Me",category:"Notes"},{id:36,title:"[GT_A] Week 3",date:"2025-3-13",excerpt:"[GT_A] Week 3",contentKey:"GT_03A",author:"Me",category:"Notes"},{id:37,title:"[GT_P] Week 3",date:"2025-3-13",excerpt:"[GT_P] Week 3",contentKey:"GT_03P",author:"Me",category:"Notes"},{id:38,title:"[SCM] Week 3",date:"2025-3-13",excerpt:"[SCM] Week 3",contentKey:"SCM_03",author:"Me",category:"Notes"},{id:39,title:"[SCS] Week 3",date:"2025-3-13",excerpt:"[SCS] Week 3",contentKey:"SCS_03",author:"Me",category:"Notes"},{id:40,title:"[SP] Week 3",date:"2025-3-13",excerpt:"[SP] Week 3",contentKey:"SP_03",author:"Me",category:"Notes"},{id:41,title:"[SP_A] Week 2",date:"2025-3-13",excerpt:"[SP_A] Week 2",contentKey:"SP_02A",author:"Me",category:"Notes"},{id:42,title:"[EC] Week 9: Advance Admission Scheduling via Resource Satisficing",date:"2025-3-13",excerpt:"[EC] Week 9: Advance Admission Scheduling via Resource Satisficing",contentKey:"EC_09",author:"Me",category:"Notes"},{id:43,title:"[FE] Week 4",date:"2025-3-18",excerpt:"[FE] Week 4",contentKey:"FE_04",author:"Me",category:"Notes"},{id:44,title:"[GT] Week 4",date:"2025-3-18",excerpt:"[GT] Week 4",contentKey:"GT_04",author:"Me",category:"Notes"},{id:45,title:"[GT_P] Week 4",date:"2025-3-18",excerpt:"[GT_P] Week 4",contentKey:"GT_04P",author:"Me",category:"Notes"},{id:46,title:"[SCM] Week 4",date:"2025-3-18",excerpt:"[SCM] Week 4",contentKey:"SCM_04",author:"Me",category:"Notes"},{id:47,title:"[SP] Week 4",date:"2025-3-18",excerpt:"[SP] Week 4",contentKey:"SP_04",author:"Me",category:"Notes"}],$7=({categories:e,isExpanded:t,onExpandedChange:n})=>{const r=ts(),i=xn();S.useEffect(()=>{localStorage.setItem("sidebarExpanded",JSON.stringify(t))},[t]);const o=new URLSearchParams(i.search).get("category"),s=l=>{r(l==="All"?"/":`/?category=${l}`)};return M.jsxs("div",{className:`
        fixed
        transition-all duration-300 ease-in-out transform
        bg-sky-100 shadow
        overflow-hidden
        ${t?"w-[250px] h-auto p-4 rounded-lg":"w-10 h-10 p-0 rounded-lg"}
      `,children:[M.jsx(ra,{variant:"ghost",size:"icon",onClick:()=>n(!t),className:`
          transition-all duration-300 ease-in-out transform
          font-semibold 
          hover:bg-sky-600 
          focus:outline-none
          text-xs
          sm:text-xs
          lg:text-sm
          bg-sky-100 
          text-sky-900
          ${t?"absolute right-2 top-2 w-8 h-8":"w-full h-full rounded-lg"}
        `,children:t?M.jsx(b7,{className:"h-4 w-4 text-sky-900"}):M.jsx(w$,{className:"h-4 w-4 text-sky-900"})}),M.jsxs("div",{className:`
        transition-all duration-300 ease-in-out transform
        ${t?"opacity-100 mt-8":"opacity-0 invisible h-0"}
      `,children:[M.jsx("h2",{className:`font-semibold text-sky-900 mb-4
        lg:text-xl
        sm:text-base
        `,children:"Categories"}),M.jsxs("ul",{className:"w-full pr-2",children:[M.jsx("li",{className:"mb-2",children:M.jsx(ra,{className:`w-full justify-start font-semibold hover:bg-sky-600 focus:outline-none
              text-xs
              sm:text-xs
              lg:text-sm
              ${o===null?"bg-sky-900 text-sky-100":"bg-sky-100 text-sky-900"}`,onClick:()=>s("All"),children:"All"})}),e.map(l=>M.jsx("li",{className:"mb-2",children:M.jsx(ra,{className:`w-full justify-start font-semibold hover:bg-sky-600 focus:outline-none text-left
                text-xs break-words whitespace-normal
                sm:text-xs sm:break-words sm:whitespace-normal 
                lg:text-sm lg:break-normal lg:whitespace-nowrap 
                ${o===l?"bg-sky-900 text-sky-100":"bg-sky-100 text-sky-900"}`,onClick:()=>s(l),children:l})},l))]})]})]})},P$=({searchTerm:e,onSearchTermChange:t,onClose:n,posts:r})=>{const i=ts(),a=S.useRef(null),o=S.useRef([]),[s,l]=S.useState(-1),u=r.filter(m=>m.title.toLowerCase().includes(e.toLowerCase()));S.useEffect(()=>{var m;(m=a.current)==null||m.focus(),o.current=[]},[]),S.useEffect(()=>{l(-1)},[e]);const h=m=>{var d,b,$,w,g;if(m.key==="Tab"&&u.length>0){m.preventDefault();const y=u.length-1;if(m.shiftKey)if(s<=0)(d=a.current)==null||d.focus(),l(-1);else{const _=Math.max(0,s-1);l(_),(b=o.current[_])==null||b.focus()}else if(s===-1)l(0),($=o.current[0])==null||$.focus();else if(s<y){const _=s+1;l(_),(w=o.current[_])==null||w.focus()}else(g=a.current)==null||g.focus(),l(-1)}},c=m=>{i(`/posts/${m}`),n()};return M.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center pt-20 z-50",onClick:n,children:M.jsxs("div",{className:"bg-slate-800 p-4 rounded-lg w-full max-w-xl",onClick:m=>m.stopPropagation(),children:[M.jsx("input",{ref:a,type:"text",placeholder:"Search posts...",className:"w-full p-2 rounded bg-slate-700 text-sky-100",value:e,onChange:m=>t(m.target.value),onKeyDown:h}),M.jsx("div",{className:"mt-2 max-h-60 overflow-auto",children:u.map((m,d)=>M.jsx("div",{ref:b=>o.current[d]=b,tabIndex:0,className:`p-2 hover:bg-slate-700 rounded cursor-pointer text-sky-100
                ${s===d?"bg-slate-700 ring-2 ring-sky-400":""}`,onClick:()=>c(m.id),onKeyDown:b=>{b.key==="Enter"&&c(m.id)},children:m.title},m.id))})]})})},mh=5,v7=()=>{const e=xn(),n=new URLSearchParams(e.search).get("category"),r=Array.from(new Set(Wi.map(w=>w.category))),[i,a]=S.useState(!1),[o,s]=S.useState("");S.useEffect(()=>{const w=g=>{g.key==="/"&&!i&&(g.preventDefault(),a(!0)),g.key==="Escape"&&i&&a(!1)};return document.addEventListener("keydown",w),()=>document.removeEventListener("keydown",w)},[i]),S.useEffect(()=>{u(1)},[n]);const[l,u]=S.useState(1),[h,c]=S.useState(()=>{const w=localStorage.getItem("sidebarExpanded");return w?JSON.parse(w):!1}),m=n&&n!=="All"?Wi.filter(w=>w.category===n):Wi,d=Math.ceil(m.length/mh),b=m.slice((l-1)*mh,l*mh),$=m.length>0;return M.jsxs("div",{className:"container mx-auto mt-10",children:[M.jsx("h1",{className:`font-bold mb-8 text-center text-sky-100
      text-5xl
      sm:text-5xl
      lg:text-6xl
      `,children:"This is Luna's world"}),M.jsxs("div",{className:"flex row-auto",children:[M.jsx("div",{className:`
          transition-all duration-300 ease-in-out
          ${h?"w-[250px]":"w-10"}
          mr-6
        `,children:M.jsx($7,{categories:r,isExpanded:h,onExpandedChange:c},n)}),M.jsx("div",{className:`
          transition-all duration-300 ease-in-out
          flex-1
          ${h?"ml-0":"ml-4"}
        `,children:$?M.jsx(y7,{posts:b,currentPage:l,totalPages:d,onPageChange:u}):M.jsx("p",{className:"text-sky-100",children:"No posts found in this category."})})]}),i&&M.jsx(P$,{searchTerm:o,onSearchTermChange:s,onClose:()=>{a(!1),s("")},posts:Wi})]})},_7=()=>M.jsxs("div",{className:"mx-auto w-1/2 mt-10 p-6 bg-sky-100 rounded-lg shadow",children:[M.jsx("h1",{className:"text-3xl font-bold mb-4 text-sky-900",children:"About"}),M.jsx("p",{className:"text-sky-900 leading-7",children:"Love is murderous utopia."})]}),x7=`# Exercise 1.1

Locate a discussion of Russell's paradox, and understand it.

---

## Answer

Let $R$ be the set of all sets that do not contain themselves.

Paradox.

# Exercise 1.2

Prove that if  $\\sim$  is a relation on a set  $S $,

then the corresponding family  $\\mathscr{P}_{\\sim} $ defined in  $\\S 1.5$

is indeed a partition of  $S$  :

that is, its elements are nonempty, disjoint, and their union is  $S$ . [§1.5]

---

## Proof

Nonempty: for each class, $x\\in\\left[x\\right]$

Disjoint: Suppose $z\\in \\left[x\\right]\\cap\\left[y\\right]$, then we have:

$z\\sim x, z\\sim y\\Rightarrow x\\sim y\\Rightarrow \\left[x\\right] = \\left[y\\right]$

Union: we can know every element is in some equivalence class.

---

# Exercise 1.3

Given a partition  $\\mathscr{P}$  on a set  $S$ ,

show how to define a relation  $\\sim$  on  $S $ such that  

$\\mathscr{P}$  is the corresponding partition. [§1.5]

---

## Answer

$x\\sim y \\Leftrightarrow \\exists P \\in \\mathscr{P} s.t. x\\in P , y\\in P$

---

# Exercise 1.4

How many different equivalence relations may be defined on the set $\\{1,2,3\\}$?

---

## Answer

5, $\\{\\{1,2,3\\}\\},\\{\\{1\\},\\{2,3\\}\\},\\{\\{2\\},\\{1,3\\}\\},\\{\\{3\\},\\{1,2\\}\\},\\{\\{1\\},\\{2\\},\\{3\\}\\}$

---

# Exercise 1.5

Give an example of a relation that is reflexive and symmetric but not transitive.

What happens if you attempt to use this relation to define a partition on the set?

(Hint: Thinking about the second question will help you answer the first one.)

---

## Answer

Let $R=\\{(a,a), (b,b), (c,c), (a,b), (b,a), (b,c), (c,b)\\}$

When we try to form equivalence classes:

$a$ and $c$ are indirectly connected through $b$,

but they are not directly related.

---

# Exercise 1.6

$\\triangleright $ Define a relation $ \\sim $ on the set $ \\mathbb{R} $ of real numbers 

by setting  $a \\sim b \\Longleftrightarrow b-a \\in   \\mathbb{Z} $.

Prove that this is an equivalence relation, 

and find a 'compelling' description for  $\\mathbb{R} / \\sim $. 

Do the same for the relation  $\\approx  $on the plane  $\\mathbb{R} \\times \\mathbb{R}$  defined by declaring  $\\left(a_{1}, a_{2}\\right) \\approx\\left(b_{1}, b_{2}\\right) \\Longleftrightarrow b_{1}-a_{1} \\in \\mathbb{Z}  $and  $b_{2}-a_{2} \\in \\mathbb{Z}$ . [§II.8.1, II.8.10]

---

## Proof

Reflectivity: $a - a = 0 \\in \\mathbb{Z}$

Symmetric: $b - a = c \\in \\mathbb{Z}, -c \\in \\mathbb{Z}, a-b\\in\\mathbb{Z}$

Transitivity: $b-a = x\\in\\mathbb{Z}, c-b = y\\in\\mathbb{Z}, y + x\\in\\mathbb{Z}$

$R/\\sim \\cong [0,1)$
`,w7=`# Function between sets

function: from $A$ to $B$

graph: $\\Gamma_f := \\{(a,b)\\in A\\times B \\mid b = f(a)\\}\\subseteq A \\times B$

Requirement: $(\\forall a \\in A)(\\exists!b\\in B)\\quad(a,b)\\in\\Gamma_f$

- or: $(\\forall a \\in A)(\\exists!b\\in B)\\quad f(a) = b$

$f$ is a function from a set $A$ to a set $B$: $A \\xrightarrow{f} B $

$f$ on element $a\\in A$: $a\\mapsto f(a)$ 

collection of all functions from a set $A$ to a set $B$: $B^A$

identity function: $\\mathrm{id}_A : A\\rightarrow A$, $(\\forall a\\in A) \\mathrm{id}_A(a) = a$

subset function: $f(S) := \\{ b\\in B \\mid (\\exists a \\in A)b = f(a)\\}$

image: $f(A)$, image of $f$, $\\mathrm{im} f$, largest subset.

restriction: $f|_S := (\\forall s \\in S) : \\quad f|_S(s) = f(s)$

composition of functions: if $f: A\\rightarrow B, g: B\\rightarrow C$, $g\\circ f$:

- $(\\forall a\\in A) (g\\circ f) (a) := g(f(a))$

commute: two ways are same

associative: $h\\circ (g\\circ f) = (h\\circ g)\\circ f$

---

injective: $a' \\ne a''\\Rightarrow f(a')\\ne f(a'')$

- $f$ sends different elements to different elements

surjective: $(\\forall b\\in B)(\\exists a\\in A) b = f(a)$

- $f$ 'covers the whole of B', $\\mathrm{im} f = B$

bijective: both injective and surjective: $f: A \\xrightarrow \\sim B$ or $A\\cong B$

- $A$ and $B$ are ‘isomorphic’ sets
- sets $A$ and $B$ may be 'identified' through $f$

fiber of $f$ over $q$ : $f^{-1}(T)$ if $T = \\{q\\}$

---

monomorphism / monic : $f\\circ \\alpha' = f\\circ \\alpha' \\Rightarrow \\alpha ' = \\alpha''$ for all sets $Z$ and all functions $\\alpha', \\alpha'': Z\\rightarrow A$
`,k7=`# Reading Aim

- get useful information 

`,S7=`# Introduction 

## Academic

- academic skills
- academic tasks

## English
- proficiency of using the English language

## Business 
- a specific discipline as the focus 

## Target

> Enhance English proficiency for doing academic tasks in business 

# For who

- Studying Business in English-medium academic settings

# What will you do

Based on the features of studying business 

- Problem-solving
- Decision-making
- Persuasion

Through **ENGLISH**

# Academic skills required 

- the case method
  - actual business situations 
  - apply knowledge to analysis & decision-making 

For example 

  - simulate real-world problems 
  - Give a feel 

- case study 


# Tasks

- case study
- critical thinking
- researching
- presentations
- writing
- `,E7=`# Quick review

が is the heart of the Japanese, every sentence has a が.

Sometimes が is invisible, it's called *zero particle*.


が marks the **subject** of the sentence. e.g.: I, She, He.

---

# よろしくお願いします

Directly translation: I beg your favor.

Actually: lower yourself and raise the person whom you are talking.

---

# を に と

## mutuality

を has the most non-mutuality, と has the most mutuality.

---

# Verb conjugation

一段動詞 always delete る

## i-stem

五段動詞 u -> i

＋ます formal version

＋たい want

＋そう 

＋noun -> new noun

## a-stem

五段動詞 u -> a (exception: かう -> かわ)

＋ない not

＋れる( られる for ichidan ) receptive (受身形) e.g. get bought, get heard

＋せる( させる for ichidan ) causative (使役形) allow/make someone to do something

## e-stem

五段動詞 u -> e

＋る( られる for ichidan ) potential (可能形) e.g. can hear, can speak

くる -> こられる

する -> できる

## o-stem

五段動詞 u -> o

＋う( よう for ichidan ) volitional (意向形) e.g. let's eat, let's hear

---

# ている vs てある

ている : cont present form / **did X and still be in state of X** (Being in state X of itself)

- ていた : cont past form
- ていない : cont negative present form
- ていなかった : cont negative past form

てある : (Being in state X because someone put it that way and left it so)

## ていく・てくる

ていく : go / take
てくる : come(back) / bring


`,C7=`# い and な adjectives

## Fact 1: na adjectives are nouns

## Fact 2: i adjectives are close cousins to verbs

## Fact 3: i adjectives contains the da/desu ( = ) function

花があかい　・　花があかいです

花がきれいだ　・　花がきれいです

## Fact 4: な＝だ, な is connective form of the だ

---

小さくてかわいい

きれいで有名だ

---

# だ　です

COUPLER: A,Bだ / A,Bです => A = B

A, B: two nouns.

---

# のです

母が来るのです

-> 0 が　母が来る　の　です

母が来るの　= mother's coming

0 = it

-> mother's coming is it. / it is that mother is coming.

## usage

to answer question that not be asked

to ask question that imply the context

to reveal something unexpected

to command (it's time to XXX)---

# のに　なのに

のに : contrastive conjunction, imply an **unsatisfactory** reason

なのに : turn だ into な, then のに

---

## ender:　ね　よ　な　かな

ね : shared information, already known

よ : sharing information, not known, friendly

よね : sharing and then treating as shared

な : "sharing" feeling with self

かな : I wonder (か for question and な for self)

の : casual sentence ender

なの : だ can't be connected with の, な is connective form of だ

`,P7=`# も

も : adjective particle, including particle / as much as / even

誰も / 何も : not even anyone / anything -> nobody / nothing

誰でも / 何でも : で is だ・です, couple the 誰 and **zero noun** -> even it's anyone / anything

かもしれません : か question marker + も even　+ しれ potential form + ません negative

---

# ない, adjective conjugation

verb negative : u -> a + ない

i adjective negative: i -> ku + ない　( Remember i adjectives has だ form inside, so it has the て form)

i adjective past ( remember だ form inside, so it contains past form ) i ->かった

adjective to adverb : i -> ku

noun to adverb : + に

---

# に

i-stem of verb on its own is **noun**, can be the target of the に

i-stem of verb on its own can also connect with another verb

---

# compound noun

rendaku happens when two noun connected to make a compound-noun

---

# transitivity

自動詞 : self-move, e.g. 出る 負ける ある be

a-stem + る is 自動詞

他動詞 : other-move, e.g. 出す 負かす する do

す・せる ending is 他動詞

める・べる・てる ending is 他動詞

- e-stem + る flips the meaning 従う(shitagau): follow / 従える:  be accompanied by
`,D7=`# あいだ

verb woking as adjective for あいだ : 落ちる間に

# てみる

do it and **see**

there's no doubt we can do it

we don't know the result

# ます

ます is a verb in itself, a helper verb

i-stem + ます

past : ました

negative ません

past negative ませんでした

# volitional 

だろう probably

でしょう probably

# と

しようとする we don't know whether we can do it, try to do it.

として : と + して

という : と + 言う

# causative / receptive

れる : helper verb, has different subject

水が犬に飲まれた

せる : helper verb, has different subject

犬を食べさせた

# place

これ : れ related to ある, a thing

この : の is class-marking の, something

こんな : な descriptive of a thing's quality, like this

こう : manner of being / doing, the way like this




`,T7=`### te iru/te aru

`,A7=`# Advance Admission Scheduling via Resource Satisficing

#### Table 1 Summary of notations

$
\\begin{array}{|l|l|}
\\hline
\\text{Symbol} & \\text{Description} \\\\
\\hline
\\mathcal{A} & \\text{Set of requesting patients} \\\\
T & \\text{Length of the horizon} \\\\
I & \\text{Number of potential patients} \\\\
R & \\text{Number of patient types} \\\\
K & \\text{Number of resources} \\\\
\\tilde{\\nu}_{tk} & \\text{Random usage of the } k\\text{-th resource on day } t \\\\
\\Gamma_{tk} & \\text{Capacity of the } k\\text{-th resource on day } t \\\\
\\tilde{w}_{tk} & \\text{Random usage of the } k\\text{-th resource on day } t \\text{ by admitted and emergency patients} \\\\
\\tilde{s}_{\\ell k}^d & \\text{Random usage of the } k\\text{-th resource by the } \\ell\\text{-th patient, } d \\text{ days after admission} \\\\
\\tilde{u}_{ikr}^d & 
  \\begin{array}{}
  \\text{Random usage of the } k\\text{-th resource by the } i\\text{-th potential patient,} \\\\
  d \\text{ days after admission, if type is } r \\\\
  \\end{array} \\\\
x_{\\ell t} & \\text{Admission decision of the } \\ell\\text{-th requesting patient on day } t \\\\
y_{itr} & 
  \\begin{array}{}
  \\text{Admission decision of the } i\\text{-th potential patient on day } t \\\\
  \\text{if type is } r \\\\
  \\end{array} \\\\
\\phi_k & \\text{Capacity-related parameter for the } k\\text{-th resource} \\\\
\\hline
\\end{array}
$






# Advance Admission Scheduling 

$\\mathcal A$: requesting patients

$T$: days 

$K$ type of resources 

$\\tilde s^d_{lk}$: usage of $k$-th resource, $d$ days after $l$-th patient 

$\\tilde{w_{tk}}$: random usage of $k$-th resource at day $t$ by scheduled and emergency patients 

#### (1)

$ \\tilde{w}_{t k}=\\sum_{\\tau=t-\\bar{d}}^{t} \\sum_{\\ell \\in \\mathcal{D}_{\\tau}} \\tilde{s}_{\\ell k}^{t-\\tau}+\\sum_{\\tau=1}^{t} \\sum_{j=1}^{\\tilde{n}_{\\tau}} \\tilde{v}_{j k}^{t-\\tau} $
- $\\forall t \\in [T], k\\in[k]$
- $\\tilde n_r $: random number of emergency arrivals on day $\\tau $
- $\\tilde v_{jk}^{t-r} $: usage of $k $-th resource by $j $-th patient after admitted $t-\\tau  $ days 


$R$: total numbers of possible patientis' types 

$\\tilde{r_i}$: discrete random variable on support $[R]$: random type of the $i$-th potential patient for $i\\in[I]$ and $r\\in[R]$

$\\tilde u_{ikr}^d$: random usage of $k$-th resource by $i $-th potential patient, $d $days agter scheduled admission if type is $r $

$\\mathcal G $: possible probability distributions 

### Assumption 1

> For any distribution in $ \\mathcal{G} $ associated with the system's random parameters, we assume that the random variables $ \\tilde{r}_{1}, \\ldots, \\tilde{r}_{I} $ are independent and identically distributed. In addition, the random variables associated with the usage of resource $ k $ at time period $ t $ are independently distributed for different patients and that their moment generation functions exist.

## Partially adaptive scheduling policy 

Two sets of decision variables:

$ \\boldsymbol{x} \\in\\{0,1\\}^{|\\mathcal{A}| \\times T} $: here-and-now decision 
- for $\\mathcal A $
- $x_{\\ell t} = 1$ if $i$-th patient to day $t\\in[T]$

$ \\bar{y}_{i t}:[R]^{i} \\rightarrow\\{0,1\\}, \\forall  i \\in[I], t \\in[T] $: wait-and-see policy 

To avoid curse of dimensionality:

$ \\hat{y}_{i t}:[R] \\rightarrow\\{0,1\\} \\forall i \\in[I], t \\in[T] $
- $=1 $ if $i $-th patient to day $t $ when type is $r$

$ \\boldsymbol{y} \\in\\{0,1\\}^{I \\times T \\times R} $

$ \\hat{y}_{i t}\\left(\\tilde{r}_{i}\\right)=\\sum_{r \\in[R]} y_{i t r} \\mathbb{1}\\left(\\tilde{r}_{i}=r\\right) $

- $y_{itr} = 1 $ if $i $-th patient to day $t\\in[T]$ if type is $r$

#### (2)

$ \\tilde{\\nu}_{t k}=\\tilde{w}_{t k}+\\sum_{\\tau \\in[t]} \\sum_{\\ell \\in \\mathcal{A}} \\tilde{s}_{\\ell k}^{t-\\tau} x_{\\ell \\tau}+\\sum_{\\tau \\in[t]} \\sum_{i \\in[I]} \\sum_{r \\in[R]} \\tilde{u}_{i k r}^{t-\\tau} y_{i \\tau r} \\mathbb{1}\\left(\\tilde{r}_{i}=r\\right) \\quad \\forall k \\in[K], \\forall t \\in[T] $.

- total random usage $\\tilde \\nu_{tk}$ of resource $k $ on day $t$
- $\\Gamma_{tk}$: capacity of resource $k\\in [K]$ for day $t\\in[T]$
- overutilization: $\\tilde \\nu_{tk}$ exceeds $\\Gamma_{tk}$ in day $t $for resource $k$

# Resource Satisficing Index

$\\mathcal Z$: all random usages 
- defined on $\\Omega$

$ \\rho: \\mathcal{Z} \\times \\mathbb{R}_{+} \\rightarrow \\mathbb{R} $

$ \\rho(\\tilde{\\nu}, \\Gamma) $: overutilization risk associated with random usages ($\\tilde \\mu$) in exceeding capacity ($\\Gamma$)

### Definition 1 (Riskiness index)

> The Aumann and Serrano riskiness index $ \\varphi[\\tilde{\\xi}] $ of a random variable $ \\tilde{\\xi} $ representing an uncertain monetary loss of a gamble is the reciprocal of the absolute risk aversion (ARA) of an individual with constant ARA who is indifferent to taking that gamble. By extending their definition to incorporate ambiguity aversion, we define the riskiness index as:
> 
> $\\varphi[\\tilde{\\xi}]=\\inf \\left\\{\\alpha \\geq 0: C_{\\alpha}[\\tilde{\\xi}] \\leq 0\\right\\}$
> 
> where
> 
> $C_{\\alpha}[\\tilde{\\xi}] \\triangleq\\left\\{\\begin{array}{ll}\\inf \\{u \\mid \\tilde{\\xi} \\leq u\\} & \\text { if } \\alpha=0 \\\\\\alpha \\log \\left(\\sup _{\\mathbb{P} \\in \\mathcal{G}} \\mathbb{E}_{\\mathbb{P}}[\\exp (\\tilde{\\xi} / \\alpha)]\\right) & \\text { if } \\alpha \\in(0, \\infty) \\\\\\sup _{\\mathbb{P} \\in \\mathcal{G}} \\mathbb{E}_{\\mathbb{P}}[\\tilde{\\xi}] & \\text { if } \\alpha=\\infty\\end{array}\\right.$
> 
> denotes the worst-case certainty equivalent under an exponential utility function with risk tolerance parameter $ \\alpha \\in \\mathbb{R} \\cup\\{\\infty\\} $.

---

### Definition 2 (Resource Satisficing Index) 

> Given a random usage, $ \\tilde{\\nu} \\in \\mathcal{Z} $ and capacity $ \\Gamma>0 $. For a given calibration function $ \\Phi_{\\Gamma}:[0, \\infty] \\mapsto[0,1] $, parameterized by $ \\Gamma $ and satisfies 
> 
> 1. $ \\Phi_{\\Gamma}(0)=0 $, 
> 
> 2. $ \\Phi_{\\Gamma}(\\infty)=1 $, and 
> 
> 3. $ \\Phi_{\\Gamma}(\\alpha) $ is continuous and increasing in $ \\alpha \\in[0, \\infty] $, 
> 
> the resource satisficing index $ (\\mathrm{RSI}) \\rho: \\mathcal{Z} \\times \\mathbb{R}_{+} \\rightarrow \\mathbb{R} $, is defined as 
> 
> $ \\rho(\\tilde{\\nu}, \\Gamma) \\triangleq\\left\\{\\begin{array}{ll} \\Phi_{\\Gamma}(\\varphi[\\tilde{\\nu}-\\Gamma]) & \\text { if } \\sup _{\\mathbb{P} \\in \\mathcal{G}} \\mathbb{E}_{\\mathbb{P}}[\\tilde{\\nu}] \\leq \\Gamma \\\\ \\sup _{\\mathbb{P} \\in \\mathcal{G}} \\mathbb{E}_{\\mathbb{P}}[\\tilde{\\nu} / \\Gamma] & \\text { otherwise } \\end{array}\\right. $

### Theorem 1

> For a given type of resource with capacity $ \\Gamma $, let $ \\tilde{\\nu}_{\\mu} $ represent a non-negative random resource usage, whose distribution belongs to a family of probability distributions parameterized by $ \\mu $ such that 
> 
> 1. $ C_{\\infty}\\left[\\tilde{\\nu}_{\\mu}\\right]=\\mu $,
>
> 2. $ C_{0}\\left[\\tilde{\\nu}_{\\mu}\\right]>\\Gamma $ for all $ \\mu>0 $, and
> 
> 3. $ C_{\\alpha}\\left[\\tilde{\\nu}_{\\mu}\\right] $ is increasing in $ \\mu $ for given $ \\alpha \\in(0, \\infty) $.
> Define
> 
> $g_{\\alpha}(\\mu) \\triangleq C_{\\alpha}\\left[\\tilde{\\nu}_{\\mu}\\right]$
> 
> Then, the calibration function $ \\Phi_{\\Gamma}:[0, \\infty] \\mapsto[0,1] $,
> $\\Phi_{\\Gamma}(\\alpha) \\triangleq\\left\\{\\begin{array}{ll}0 & \\text { if } \\alpha=0 \\\\g_{\\alpha}^{-1}(\\Gamma) / \\Gamma & \\text { if } \\alpha \\in(0, \\infty) \\\\1 & \\text { if } \\alpha=\\infty\\end{array}\\right.$
> 
> is continuous and increasing in $ \\alpha \\in[0, \\infty] $. Moreover,
> 
> $\\rho\\left(\\tilde{\\nu}_{\\mu}, \\Gamma\\right)=\\sup _{\\mathbb{P} \\in \\mathcal{G}} \\mathbb{E}_{\\mathbb{P}}\\left[\\tilde{\\nu}_{\\mu} / \\Gamma\\right] .$

### Theorem 2

> Theorem 2. The RSI is a lower semi-continuous measure that has the following properties. For any $ \\Gamma>0 $, and random usages, $ \\tilde{\\nu}, \\tilde{\\nu}_{1}, \\tilde{\\nu}_{2} $, we have
> 
> 1. Monotonicity: $ \\rho\\left(\\tilde{\\nu}_{1}, \\Gamma\\right) \\geq \\rho\\left(\\tilde{\\nu}_{2}, \\Gamma\\right) $ if $ \\tilde{\\nu}_{1} \\geq \\tilde{\\nu}_{2} $.
> 
> 2. Quasi-convexity: $ \\rho\\left(\\lambda \\tilde{\\nu}_{1}+(1-\\lambda) \\tilde{\\nu}_{2}, \\Gamma\\right) \\leq \\max \\left\\{\\rho\\left(\\tilde{\\nu}_{1}, \\Gamma\\right), \\rho\\left(\\tilde{\\nu}_{2}, \\Gamma\\right)\\right\\} $.
> 
> 3. Excess utilization: if $ \\sup _{\\mathbb{P} \\in \\mathcal{G}} \\mathbb{E}_{\\mathbb{P}}[\\tilde{\\nu}]>\\Gamma $, then $ \\rho(\\tilde{\\nu}, \\Gamma)=\\sup _{\\mathbb{P} \\in \\mathcal{G}} \\mathbb{E}_{\\mathbb{P}}[\\tilde{\\nu} / \\Gamma]>1 $.
> 
> 4. Risk-free: if $ \\tilde{\\nu} \\leq \\Gamma $, then $ \\rho(\\tilde{\\nu}, \\Gamma)=0 $.

# Resource Satisficing Optimizing Problem 

### MIP formulation, bisection search and Benders’ decomposition

Resource satisficing advance admission scheduling problem:

#### (4)

$ \\begin{aligned} \\beta^{*}=\\min & \\beta \\\\ \\text { s.t. } & \\rho_{k}\\left(\\tilde{\\nu}_{t k}, \\Gamma_{t k}\\right) \\leq \\beta \\phi_{k} \\quad \\forall t \\in[T], \\forall k \\in[K], \\\\ & (\\boldsymbol{x}, \\boldsymbol{y}) \\in \\mathcal{X},\\end{aligned} $

where:

$ \\mathcal{X}=\\left\\{\\begin{array}{l|l}(\\boldsymbol{x}, \\boldsymbol{y}) & \\begin{array}{l}\\sum_{t \\in[T]} x_{\\ell t}=1 \\forall \\ell \\in \\mathcal{A}, \\\\ x_{\\ell t} \\in\\{0,1\\} \\forall \\ell \\in \\mathcal{A}, \\forall t \\in[T], \\\\ \\sum_{t \\in[T]} y_{i t r}=1 \\forall i \\in[I], \\forall r \\in[R], \\\\ y_{i t r} \\in\\{0,1\\} \\forall i \\in[I], \\forall t \\in[T], \\forall r \\in[R], \\\\ \\text { other mixed-integer constraints on } \\boldsymbol{x}, \\boldsymbol{y}\\end{array}\\end{array}\\right\\} $

### Theorem 3

> There exists some feasible solution $ (\\boldsymbol{x}, \\boldsymbol{y}) \\in \\mathcal{X} $ to Problem (4) for a fixed $ \\beta $ if and only if the optimal solution $ \\gamma^{*} $ to Problem (5) satisfies $ \\gamma^{*} \\leq 0 $. 
> 
> #### (5)
> 
> $ \\begin{array}{ll} \\min & \\gamma \\\\ \\text { s.t. } & w_{t k}(\\infty)+\\sum_{\\ell \\in \\mathcal{A}} \\sum_{\\tau \\in[t]} x_{\\ell \\tau} s_{\\ell k}^{t-\\tau}(\\infty)+\\sum_{i \\in[I]} \\sum_{\\tau \\in[t]} \\sum_{r \\in[R]} y_{i \\tau r} u_{i t r k}^{t-\\tau}(\\infty)-\\Gamma_{t k} \\beta \\phi_{k} \\leq \\gamma \\quad \\forall k \\in \\mathcal{K}_{1}, t \\in[T], \\\\ & w_{t k}\\left(\\alpha_{t k}\\right)+\\sum_{\\ell \\in \\mathcal{A}} \\sum_{\\tau \\in[t]} x_{\\ell \\tau} s_{\\ell k}^{t-\\tau}\\left(\\alpha_{t k}\\right)+\\sum_{i \\in[I]} f_{i t k}\\left(\\alpha_{t k}, \\boldsymbol{y}_{i}\\right)-\\Gamma_{t k} \\leq \\gamma \\quad \\forall k \\in \\mathcal{K}_{2}, t \\in[T] \\\\ & (\\boldsymbol{x}, \\boldsymbol{y}) \\in \\mathcal{X} \\end{array} $ 
> 
> where 
> 
> $ \\mathcal{K}_{1}=\\left\\{k: \\beta \\phi_{k} \\geq 1\\right\\}, \\mathcal{K}_{2}=\\left\\{k: \\beta \\phi_{k}<1\\right\\}, \\boldsymbol{y}_{i}=\\left(y_{i 11}, \\ldots, y_{i T R}\\right)^{\\prime} ; $ 
> 
> in addition, 
> 
> $ \\alpha_{t k} \\triangleq \\Phi_{\\Gamma_{t k}}^{-1}\\left(\\beta \\phi_{k}\\right), w_{t k}(\\alpha) \\triangleq C_{\\alpha}\\left[\\tilde{w}_{t k}\\right], s_{\\ell k}^{d}(\\alpha) \\triangleq C_{\\alpha}\\left[\\tilde{s}_{\\ell t k}^{d}\\right], u_{i t r k}^{d}(\\alpha) \\triangleq C_{\\alpha}\\left[\\tilde{u}_{i k r}^{d}\\right] $ 
> 
> and 
> 
> $ f_{i t k}\\left(\\alpha, \\boldsymbol{y}_{i}\\right) \\triangleq \\alpha \\log \\left(\\sum_{r \\in[R]} p_{r} \\exp \\left(\\sum_{\\tau \\in[t]} y_{i \\tau r} \\frac{u_{i t r}^{t-\\tau}(\\alpha)}{\\alpha}\\right)\\right) $

### Proposition 1

> For any $ \\boldsymbol{y} \\in \\mathbb{R}^{T \\times R} $,
>
> #### (6)
> 
> $f_{i t k}(\\alpha, \\boldsymbol{y})=\\max _{\\boldsymbol{v} \\in \\mathbb{R} T \\times R}\\left\\{f_{i t k}(\\alpha, \\boldsymbol{v})+\\sum_{r \\in[R]} \\sum_{\\tau \\in[t]} g_{i t r k}^{\\tau}(\\alpha, \\boldsymbol{v})\\left(y_{\\tau r}-v_{\\tau r}\\right)\\right\\}$
>
> where
> 
> $g_{i t r k}^{\\tau}(\\alpha, \\boldsymbol{v})=\\frac{p_{r} u_{i t r k}^{t-\\tau}(\\alpha) \\exp \\left(\\sum_{\\tau_{1} \\in[t]} v_{\\tau_{1} r} u_{i t r k}^{t-\\tau_{1}}(\\alpha) / \\alpha\\right)}{\\sum_{m \\in[R]} p_{m} \\exp \\left(\\sum_{\\tau_{2} \\in[t]} v_{\\tau_{2} m} u_{i t m k}^{t-\\tau_{2}}(\\alpha) / \\alpha\\right)}$
> 
> is the first order derivative of $ f_{i t k}(\\alpha, \\boldsymbol{v}) $ with respect to $ v_{\\tau r} $. The worst-case of Problem (6) occurs when $ \\boldsymbol{v}=\\boldsymbol{y} $.

### BD Algorithm

1. Initialize $ \\mathcal{Y}=\\emptyset $ and input fixed $ \\beta $.

2. Solve the following subproblem:
$
\\begin{array}{l}
\\text { min } \\gamma \\\\
\\text { s.t. } w_{t k}(\\infty)+\\sum_{\\ell \\in \\mathcal{A}} \\sum_{\\tau \\in[t]} x_{\\ell \\tau} s_{\\ell k}^{t-\\tau}(\\infty)+\\sum_{i \\in[I]} \\sum_{\\tau \\in[t]} \\sum_{r \\in[R]} y_{i \\tau r} u_{i t r k}^{t-\\tau}(\\infty)-\\Gamma_{t k} \\beta \\phi_{k} \\leq \\gamma \\quad \\forall k \\in \\mathcal{K}_{1}, t \\in[T], \\\\
w_{t k}\\left(\\alpha_{t k}\\right)+ \\\\
\\sum_{\\ell \\in \\mathcal{A}} \\sum_{\\tau \\in[t]} x_{\\ell \\tau} s_{\\ell k}^{t-\\tau}\\left(\\alpha_{t k}\\right)+\\sum_{i \\in[I]} f_{i t k}\\left(\\alpha_{t k}, \\boldsymbol{v}_{i}\\right) \\\\
\\\\
+\\sum_{i \\in[I]} \\sum_{\\tau \\in[t]} \\sum_{r \\in[R]} g_{i t r k}^{\\tau}\\left(\\alpha_{k}, \\boldsymbol{v}_{i}\\right)\\left(y_{i \\tau r}-v_{i \\tau r}\\right)-\\Gamma_{t k} \\leq \\gamma \\quad \\forall k \\in \\mathcal{K}_{2}, t \\in[T], \\boldsymbol{v} \\in \\mathcal{Y}, \\\\
(\\boldsymbol{x}, \\boldsymbol{y}) \\in \\mathcal{X} .
\\end{array}
$

If $ \\gamma^{*} \\leq 0 $, then record the optimal decisions $ \\left(\\boldsymbol{x}^{*}, \\boldsymbol{y}^{*}\\right) $ and go to the next step. Otherwise, we can conclude that $ \\beta<\\beta^{*} $, and we terminate this Benders decomposition procedure.

3. Check if
$
w_{t k}\\left(\\alpha_{k}\\right)+\\sum_{\\ell \\in \\mathcal{A}} \\sum_{\\tau \\in[t]} x_{\\ell \\tau}^{*} s_{\\ell k}^{t-\\tau}\\left(\\alpha_{k}\\right)+\\sum_{i \\in[I]} f_{i t k}\\left(\\alpha_{k}, \\boldsymbol{y}_{i}^{*}\\right)-\\Gamma_{t k} \\leq 0 \\quad \\forall k \\in \\mathcal{K}_{2}, t \\in[T] .
$

If it is true, go to the next step. Otherwise, include $ \\boldsymbol{y}^{*} $ in $ \\mathcal{Y} $ and return to step 2.

4. We conclude that $ \\beta \\geq \\beta^{*} $ and terminate this procedure.



当然，我可以根据您提供的查询和(4)式子，举一个完全符合的例子来说明资源满足优化问题在提前入院调度中的应用。以下是一个简化的医院资源调度场景，逐步展示如何构建并求解这个问题。

---

### 场景描述

假设一家医院需要为患者安排入院时间，考虑两种资源：**床位**（资源1）和**手术室**（资源2）。医院需要调度已知的需求患者（$\\mathcal{A}$）和潜在的未来患者（$[I]$），同时考虑患者类型（$[R]$）和资源容量限制。以下是具体参数：

- **时间范围**：$T = 3$ 天（即调度3天的入院计划）。
- **资源类型**：$K = 2$（床位和手术室）。
- **需求患者**：$\\mathcal{A} = \\{1, 2\\}$（两个已知患者）。
- **潜在患者**：$I = 2$（两个潜在未来患者）。
- **患者类型**：$R = 2$（例如，类型1为非手术患者，类型2为手术患者）。

#### 资源容量
- 床位容量：$\\Gamma_{t1} = 10$（每天10张床位），对于所有 $t \\in [3]$。
- 手术室容量：$\\Gamma_{t2} = 5$（每天5个手术室），对于所有 $t \\in [3]$。
- 容量相关参数：$\\phi_1 = 1$（床位），$\\phi_2 = 1$（手术室）。

---

### 决策变量

我们需要决定每个患者的入院时间：

1. **需求患者调度**：
   - $x_{\\ell t}$：对于每个需求患者 $\\ell \\in \\mathcal{A}$ 和每一天 $t \\in [T]$，$x_{\\ell t} = 1$ 表示患者 $\\ell$ 在第 $t$ 天入院，否则为 0。

2. **潜在患者调度**：
   - $y_{itr}$：对于每个潜在患者 $i \\in [I]$，每一天 $t \\in [T]$，和每种类型 $r \\in [R]$，$y_{itr} = 1$ 表示如果潜在患者 $i$ 是类型 $r$，则在第 $t$ 天入院，否则为 0。

---

### 假设的资源使用量

为了简化示例，假设所有随机变量（如资源使用量）是确定的（即没有不确定性），这样 $\\tilde{\\nu}_{tk}$ 变为确定的 $\\nu_{tk}$。以下是患者对资源的使用：

#### 需求患者（$\\mathcal{A}$）
- **患者1**：
  - 入院当天（$d=0$）：使用2张床位，0个手术室。
  - 入院次日（$d=1$）：使用1张床位，0个手术室。
- **患者2**：
  - 入院当天（$d=0$）：使用1张床位，1个手术室。
  - 入院次日（$d=1$）：使用1张床位，0个手术室。

#### 潜在患者（$[I]$）
- **潜在患者1和2**（取决于类型 $r$）：
  - 类型1（非手术患者，$r=1$）：
    - 入院当天（$d=0$）：使用1张床位，0个手术室。
  - 类型2（手术患者，$r=2$）：
    - 入院当天（$d=0$）：使用1张床位，1个手术室。

#### 紧急患者
- 假设紧急患者的资源使用为0（简化假设），即 $\\tilde{w}_{tk} = 0$。

---

### 约束条件

根据(4)式子和 $\\mathcal{X}$ 的定义，约束如下：

1. **需求患者入院约束**：
   $$
   \\sum_{t \\in [T]} x_{\\ell t} = 1 \\quad \\forall \\ell \\in \\mathcal{A}
   $$
   每个需求患者必须且仅在某一天入院。例如：
   - $x_{11} + x_{12} + x_{13} = 1$（患者1）。
   - $x_{21} + x_{22} + x_{23} = 1$（患者2）。

2. **潜在患者入院约束**：
   $$
   \\sum_{t \\in [T]} y_{itr} = 1 \\quad \\forall i \\in [I], \\forall r \\in [R]
   $$
   对于每种类型，每个潜在患者必须在某一天入院。例如：
   - $y_{111} + y_{121} + y_{131} = 1$（潜在患者1，类型1）。
   - $y_{112} + y_{122} + y_{132} = 1$（潜在患者1，类型2）。

3. **资源使用量**：
   根据公式(2)：
   $$
   \\tilde{\\nu}_{tk} = \\tilde{w}_{tk} + \\sum_{\\tau \\in [t]} \\sum_{\\ell \\in \\mathcal{A}} \\tilde{s}_{\\ell k}^{t-\\tau} x_{\\ell \\tau} + \\sum_{\\tau \\in [t]} \\sum_{i \\in [I]} \\sum_{r \\in [R]} \\tilde{u}_{ikr}^{t-\\tau} y_{i\\tau r} \\mathbb{1}(\\tilde{r}_i = r)
   $$
   因为假设 $\\tilde{w}_{tk} = 0$ 且无随机性，$\\tilde{\\nu}_{tk}$ 简化为确定的 $\\nu_{tk}$。例如：
   - **第1天床位使用**（$t=1, k=1$）：
     $$
     \\nu_{11} = 2 x_{11} + 1 x_{21} + 1 y_{111} \\mathbb{1}(\\tilde{r}_1 = 1) + 1 y_{112} \\mathbb{1}(\\tilde{r}_1 = 2) + 1 y_{211} \\mathbb{1}(\\tilde{r}_2 = 1) + 1 y_{212} \\mathbb{1}(\\tilde{r}_2 = 2)
     $$
   - **第1天手术室使用**（$t=1, k=2$）：
     $$
     \\nu_{12} = 1 x_{21} + 1 y_{112} \\mathbb{1}(\\tilde{r}_1 = 2) + 1 y_{212} \\mathbb{1}(\\tilde{r}_2 = 2)
     $$

4. **资源满足约束**：
   $$
   \\rho_k(\\tilde{\\nu}_{tk}, \\Gamma_{tk}) \\leq \\beta \\phi_k \\quad \\forall t \\in [T], \\forall k \\in [K]
   $$
   由于资源使用是确定的，$\\rho_k(\\nu_{tk}, \\Gamma_{tk})$ 定义如下：
   - 若 $\\nu_{tk} \\leq \\Gamma_{tk}$，则 $\\rho_k(\\nu_{tk}, \\Gamma_{tk}) = 0$。
   - 若 $\\nu_{tk} > \\Gamma_{tk}$，则 $\\rho_k(\\nu_{tk}, \\Gamma_{tk}) = \\nu_{tk} / \\Gamma_{tk}$。

   因此，约束变为：
   - $\\nu_{t1} \\leq 10 \\beta$（床位）。
   - $\\nu_{t2} \\leq 5 \\beta$（手术室）。

---

### 目标

根据(4)式子，目标是最小化 $\\beta$：
$$
\\beta^* = \\min \\beta
$$
使得所有资源在所有天数的资源满足指数不超过 $\\beta \\phi_k$。

---

### 具体调度示例

让我们尝试一个可行调度，并计算 $\\beta$：

#### 调度方案
- **需求患者**：
  - 患者1在第1天入院：$x_{11} = 1$，$x_{12} = x_{13} = 0$。
  - 患者2在第2天入院：$x_{22} = 1$，$x_{21} = x_{23} = 0$。
- **潜在患者**（假设最坏情况，即资源使用最大化）：
  - 潜在患者1：
    - 类型1：第1天入院（$y_{111} = 1$）。
    - 类型2：第1天入院（$y_{112} = 1$）。
  - 潜在患者2：
    - 类型1：第2天入院（$y_{221} = 1$）。
    - 类型2：第2天入院（$y_{222} = 1$）。

#### 计算资源使用
- **第1天**：
  - 床位：$\\nu_{11} = 2 x_{11} + 1 y_{111} + 1 y_{112} = 2 + 1 + 1 = 4$。
  - 手术室：$\\nu_{12} = 1 y_{112} = 1$。
- **第2天**：
  - 床位：$\\nu_{21} = 1 x_{11} + 1 x_{22} + 1 y_{221} + 1 y_{222} = 1 + 1 + 1 + 1 = 4$。
  - 手术室：$\\nu_{22} = 1 x_{22} + 1 y_{222} = 1 + 1 = 2$。
- **第3天**：
  - 床位：$\\nu_{31} = 1 x_{22} = 1$。
  - 手术室：$\\nu_{32} = 0$。

#### 检查约束
- 床位：$\\nu_{11} = 4 \\leq 10\\beta$，$\\nu_{21} = 4 \\leq 10\\beta$，$\\nu_{31} = 1 \\leq 10\\beta$。
- 手术室：$\\nu_{12} = 1 \\leq 5\\beta$，$\\nu_{22} = 2 \\leq 5\\beta$，$\\nu_{32} = 0 \\leq 5\\beta$。

所有使用量均小于容量，$\\rho_k = 0$，但我们需要 $\\beta$ 尽量小。最大使用率为：
- 床位：$4 / 10 = 0.4$。
- 手术室：$2 / 5 = 0.4$。

因此，$\\beta \\geq 0.4$ 是可行的最小值。

---

### 求解结果

通过优化(4)式子，最优 $\\beta^* = 0.4$，表示资源满足指数的最大值为0.4，确保所有资源在所有天数上都不会超载。这个例子展示了如何将资源满足优化问题应用于医院调度，平衡已知和潜在患者的需求。`,z7=`# LEARNING FROM REVIEWS: THE SELECTION EFFECT AND THE SPEED OF LEARNING

# 2 Environment

Product: unknown to both side

Rating system:

- Collect from previous customers
- provide a rating
- new customers observe it
- purchase with ex ante type
- ex post preference

## 2.1 Customers' Problem, Rating System

$Q\\in\\{0, 1\\}$: True quality of the product

$t\\in\\mathbb{N}$: new customerm arrive time

$u_t = \\theta_t + \\zeta_t + Q - p\\quad (1)$: **material utility** of customer $t$

- $\\theta_t$: ex ante type of the customer
  - independently continuous $F_\\theta$
- $\\zeta_t$: ex post idiosyncratic preference term
  - independently continuous $F_\\zeta$
  - sometimes combined $F_{\\theta, \\zeta}$
- $p$: price of the product
- $\\theta_t, \\zeta_t$: customer private info

Procedure:

- $t$ observe rating and $\\theta_t$
- whether to by
- if buy: experience **material utility**
- $r_t$: review
  - $-\\underline{K},\\dots,\\overline{K}$: reviews
  - $\\mathcal{R} = \\{-\\underline{K},\\dots,\\overline K \\}$
  - $\\overline K$: like, $-\\underline K $ : dislike
- $b_t$: purchase decision
- $r_t$: review decision
- $a_t\\in \\mathcal{R}\\cup \\{ N \\}$: action
  - $a_t = N$: no purchase ($b_t$ = 0)
- $\\mathcal A = \\mathcal R \\cup \\{ N \\}$: set of actions
- $h_t = \\{ a_1,\\dots,a_{t-1}\\}$: history ($h_1 = \\oslash$)
- $\\mathbf\\Omega$: rating system
  - $\\Omega_t$: rating avaliable to $t$

---

### Purchase decision

- $t$ observe $\\Omega_t$
- $B_t :\\Omega_t\\times\\mathbb R^3\\rightarrow\\{0, 1\\}$: purchase decision
  - rating system & ex ante type $\\theta_t$ & ex post idiosyncratic preference $\\zeta_t$ & price $p$
- $\\mathbf B = \\{ B_t\\} ^ \\infty_{t = 1}$: collection of purchase decision strategies
  - $B_t(\\Omega_t, \\theta_t) = 1\\quad$if and only if$\\quad \\theta_t + \\mathbb E \\left[\\zeta_t\\right] + q_t - p \\ge 0$: Bayes-Nash equilibrium
  - $q_t = \\mathbb P _{\\{(\\theta_S, \\zeta_S\\}_{S=1}^{t-1}}\\left[Q=1\\mid\\Omega_t\\right] \\quad$ <p id = "2">(2)</p>: the belief of $t$

## 2.2 Review decision

$\\lambda_{-\\underline K }\\le \\dots\\le \\lambda_{-1}\\le \\lambda_1\\le\\dots\\le\\lambda_{\\overline K} \\in \\mathbb R$: threshold

$$
r_{t}=\\left\\{\\begin{array}{ll}
-\\underline{K} & \\text { if } u_{t}<\\lambda_{-\\underline{K}}, \\\\
i & \\text { if } \\lambda_{i-1} \\leq u_{t}<\\lambda_{i}, -\\underline{K} < i < 0, \\\\
0 & \\text { if } \\lambda_{-1} \\leq u_{t}<\\lambda_{1}, \\\\
i & \\text { if } \\lambda_{i} \\leq u_{t}<\\lambda_{i+1}, 0 < i < \\overline{K}, \\\\
\\bar{K} & \\text { if } u_{t} \\geq \\lambda_{\\bar{K}} .
\\end{array}\\right.\\quad (3)
$$

---

#### Assumption 1 - Richness

$\\theta, \\zeta$, random variable, drawn from $\\left[\\underline \\theta, \\overline\\theta\\right], \\left[\\underline \\zeta, \\overline\\zeta\\right]$, so that

- $\\overline\\zeta + \\overline\\theta - p > \\lambda\\_{\\overline K}, $
- $\\underline\\zeta+\\overline\\theta - p + 1 < \\lambda_{-\\underline K}$

why $\\overline\\theta$ ?

- lower may not purchase
- $Q = 0$ for most favorable review, $Q = 1$ for least favorable review , these are not fully revealing ablout the quality

#### Remark 1

---

# 3 Full history

- $\\Omega_t = h_t$

## 3.1 Learning Dynamics

[(2)](#2) becomes:

$q_t = \\mathbb P _{\\{(\\theta_S, \\zeta_S\\}_{S=1}^{t-1}}\\left[Q=1\\mid h_t\\right]$

$l_t = \\dfrac{q_t}{1-q_t} = \\dfrac{\\mathbb P_{\\{(\\theta_S,\\zeta_S)\\}_{S=1}^{t-1}}[Q=1\\mid h_t]}{\\mathbb P_{\\{(\\theta_S,\\zeta_S)\\}^{t-1}_{S=1}}[Q=0\\mid h_t]}$ <p id = "4">(4)</p> : associated likelihood ratio

$\\pi(a;F_{\\theta,\\zeta},Q,q)$: probability of action $a\\in \\mathcal A$,

- given joint distribution of $\\theta, \\zeta$
- price $p$
- thesholds when true quality is $Q$, belief is $q$

$$
\\begin{array}{l}
\\pi\\left(a ; F_{\\theta, \\zeta}, Q, q\\right) \\\\
\\quad=\\left\\{\\begin{array}{ll}
\\mathbb{P}_{\\theta, \\zeta}[q+\\theta+\\mathbb{E}[\\zeta]-p<0], & \\text { for } a=N, \\\\
\\mathbb{P}_{\\theta, \\zeta}\\left[q+\\theta+\\mathbb{E}[\\zeta]-p \\geq 0, \\theta+\\zeta+Q-p<\\lambda_{-\\underline{K}}\\right], & \\text { for } a=-\\underline{K}, \\\\
\\mathbb{P}_{\\theta, \\zeta}\\left[q+\\theta+\\mathbb{E}[\\zeta]-p \\geq 0, \\lambda_{a-1} \\leq \\theta+\\zeta+Q-p<\\lambda_{a}\\right], & \\text { for }-\\underline{K} < a < 0, \\\\
\\mathbb{P}_{\\theta, \\zeta}\\left[q+\\theta+\\mathbb{E}[\\zeta]-p \\geq 0, \\lambda_{-1} \\leq \\theta+\\zeta+Q-p<\\lambda_{1}\\right], & \\text { for } a=0, \\\\
\\mathbb{P}_{\\theta, \\zeta}\\left[q+\\theta+\\mathbb{E}[\\zeta]-p \\geq 0, \\lambda_{a} \\leq \\theta+\\zeta+Q-p<\\lambda_{a+1}\\right], & \\text { for } 0 < a < \\bar{K}, \\\\
\\mathbb{P}_{\\theta, \\zeta}\\left[q+\\theta+\\mathbb{E}[\\zeta]-p \\geq 0, \\theta+\\zeta+Q-p \\geq \\lambda_{\\bar{K}}\\right], & \\text { for } a=\\bar{K} .
\\end{array}\\right.
\\end{array}
$$

$\\mathbf \\pi (F_{\\theta,\\zeta},Q,q) = (\\pi(a;F_{\\theta,\\zeta},Q,q): a\\in\\mathcal A)$: vector of probabilities

$$
\\begin{aligned}
l_{t} & =\\frac{q_{t}}{1-q_{t}}=\\frac{\\mathbb{P}_{\\left\\{\\left(\\theta_{s}, \\zeta_{s}\\right)\\right\\}_{s=1}^{t-1}}\\left[Q=1 \\mid h_{t}\\right]}{\\mathbb{P}_{\\left\\{\\left(\\theta_{s}, \\zeta_{s}\\right)\\right\\}_{s=1}^{t-1}}^{t-1}\\left[Q=0 \\mid h_{t}\\right]}=\\frac{\\mathbb{P}_{\\left\\{\\left(\\theta_{s}, \\zeta_{s}\\right) \\zeta_{s=1}^{t-1}\\right.}\\left[h_{t} \\mid Q=1\\right]}{\\mathbb{P}_{\\left\\{\\left(\\theta_{s}, \\zeta_{s}\\right)\\right\\}_{s=1}^{t-1}}^{t h}\\left[h_{t} \\mid Q=0\\right]} \\\\
& =\\prod_{s=1}^{t-1} \\frac{\\pi\\left(a_{s} ; F_{\\theta, \\zeta}, Q=1, q_{s}\\right)}{\\pi\\left(a_{s} ; F_{\\theta, \\zeta}, Q=0, q_{s}\\right)}
\\end{aligned}
$$

<p id = "5">(5)</p>

#### More detailed on (5)

$\\dfrac{\\mathbb P [Q=1\\mid h_t]}{\\mathbb P [Q=0 \\mid h_t]} = \\dfrac{\\mathbb P [h_t \\mid Q = 1]\\mathbb P [Q=1]}{\\mathbb P [h_t \\mid Q = 0]\\mathbb P [Q = 0]}$

using that $\\mathbb P [Q=  1] = \\mathbb P [Q = 0]$ we get the third equation

$\\mathbb P[h_t \\mid Q ] = \\prod_{s = 1}^{t -1} \\mathbb P [a_s \\mid Q ] $, notice that $h_t$ is composed from $a_s$,

$\\mathbb P [a_s \\mid Q ] = \\pi (a_s; F_{\\theta,\\zeta}, Q, q_s)$ with this we get the fourth equation.

---

$l_{t+1} = l_t \\times \\dfrac{\\pi(a_t; F_{\\theta, \\zeta}, Q = 1, q_t)}{\\pi (a_t; F_{\\theta, \\zeta}, Q = 0, q_t )}$

$l_{t+1} = l_t \\times \\dfrac{\\pi(a_t; F_{\\theta, \\zeta}, Q = 1, q_t)}{\\pi (a_t; F_{\\theta, \\zeta}, Q = 0, q_t )}, \\quad \\text{w.p. } \\pi(a_t; F_{\\theta,\\zeta}, Q, q_t), a\\in \\mathcal A \\text { for } t \\ge 1$

## 3.2 Complete learning

### Theorem 1:

If $\\overline\\theta + \\mathbb E [\\zeta] - p \\ge 0, q_1 \\in(0, 1)$, then $q_t\\rightarrow Q$ almost surely

Proof

$Z(a_t | l_t ) = \\dfrac{\\pi (a_t ; F_{\\theta, \\zeta}, Q = 1, q = q_t ) }{ \\pi ( a*t ; F*{\\theta, \\zeta}, Q = 0, q = q_t)}, \\forall a_t \\in \\mathcal A, $<p id = "A-1">(A-1)</p>

: likelihood ratio

#### Part 1 : when $\\overline \\theta + \\mathbb E [\\zeta] - p > 0$

$$
\\begin{aligned}
& \\mathbb{E}_{a \\sim \\pi\\left(F_{\\theta, \\zeta}, Q=0, q=q_{t}\\right)}\\left[Z\\left(a \\mid l_{t}\\right) \\mid h_{t}\\right] \\\\
& =\\mathbb{E}_{a \\sim \\pi\\left(F_{\\theta, \\zeta}, Q=0, q=q_{t}\\right)}\\left[\\frac{\\pi\\left(a ; F_{\\theta, \\zeta}, Q=1, q=q_{t}\\right)}{\\pi\\left(a ; F_{\\theta, \\zeta}, Q=0, q=q_{t}\\right)}\\right] \\\\
& =\\sum_{a \\in \\mathcal A }\\pi(F_{\\theta,\\zeta}, Q = 0, q = q_t)\\left[\\frac{\\pi\\left(a ; F_{\\theta, \\zeta}, Q=1, q=q_{t}\\right)}{\\pi\\left(a ; F_{\\theta, \\zeta}, Q=0, q=q_{t}\\right)}\\right] \\\\
& =\\sum_{a \\in \\mathcal{A}} \\pi\\left(a ; F_{\\theta, \\zeta}, Q=1, q=q_{t}\\right)\\\\
& =1 .
\\end{aligned}
$$

$$
\\begin{aligned}
&\\mathbb E [l_{t + 1} \\mid\\mathcal F_t]\\\\
&= \\mathbb E [l_t \\times Z(a_t\\mid l_t)\\mid \\mathcal F_t]\\\\
&=\\mathbb E[l_t \\mid \\mathcal F_t ] = l_t\\\\
&\\Rightarrow l_t\\text{ forms a martingale}
\\end{aligned}
$$

$l_t = \\dfrac{q_t}{1-q_t} < \\infty, l_t \\ge 0$

---

#### Martingale convergence theorem

**Statement:**

$\\{X_n\\}_{n=1}^\\infty$ is a submartingale (or martingale, or supermartingale) with respect to a filtration $\\{\\mathcal{F}_n\\}$.

Suppose one of the following conditions holds:

1. $\\{X_n\\}$ is bounded in $L^1$, i.e., $\\sup_n \\mathbb{E}[|X_n|] < \\infty$.

2. $\\{X_n\\}$ is bounded almost surely, i.e., there exists a constant $K$ such that $|X_n| \\leq K$ almost surely for all $n$.

3. $\\{X_n\\}$ is a non-negative supermartingale, i.e., $X_n \\geq 0$ almost surely for all $n$.

Then, $\\{X_n\\}$ converges almost surely (a.s.) to a limit $X_\\infty$ as $n \\to \\infty$.

If, in addition, $\\{X_n\\}$ is uniformly integrable, then $X_\\infty$ is integrable, and
$
\\lim_{n \\to \\infty} \\mathbb{E}[|X_n - X_\\infty|] = 0.
$

---

$l_t \\rightarrow l_\\infty$ almost surely

$$
\\begin{aligned}
& Z\\left(a=\\bar{K} \\mid l_{t}\\right) \\\\
& =\\frac{\\pi\\left(a=\\bar{K} ; F_{\\theta, \\zeta}, Q=1, q=q_{t}\\right)}{\\pi\\left(a=\\bar{K} ; F_{\\theta, \\zeta}, Q=0, q=q_{t}\\right)} \\\\
& =\\frac{\\mathbb{P}_{\\theta, \\zeta}\\left[q_{t}+\\theta+\\mathbb{E}[\\zeta]-p \\geq 0, \\theta+\\zeta+1-p \\geq \\lambda_{\\bar{K}}\\right]}{\\mathbb{P}_{\\theta, \\zeta}\\left[q_{t}+\\theta+\\mathbb{E}[\\zeta]-p \\geq 0, \\theta+\\zeta-p \\geq \\lambda_{\\bar{K}}\\right]} \\\\
& \\text{notice the over part is >= -1 and the below part is >= 0} \\\\
& =1+\\frac{\\mathbb{P}_{\\theta, \\zeta}\\left[q_{t}+\\theta+\\mathbb{E}[\\zeta]-p \\geq 0, \\theta+\\zeta-p-\\lambda_{\\bar{K}} \\in[-1,0)\\right]}{\\mathbb{P}_{\\theta, \\zeta}\\left[q_{t}+\\theta+\\mathbb{E}[\\zeta]-p \\geq 0, \\theta+\\zeta-p-\\lambda_{\\bar{K}} \\geq 0\\right]} \\\\
& \\text{let over part q is 0, below part q is 1}\\\\
& \\geq 1+\\frac{\\mathbb{P}_{\\theta, \\zeta}\\left[\\theta+\\mathbb{E}[\\zeta]-p \\geq 0, \\theta+\\zeta-p-\\lambda_{\\bar{K}} \\in[-1,0)\\right]}{\\mathbb{P}_{\\theta, \\zeta}\\left[1+\\theta+\\mathbb{E}[\\zeta]-p \\geq 0, \\theta+\\zeta-p-\\lambda_{\\bar{K}} \\geq 0\\right]},
\\end{aligned}
$$

Prove the upper part > 0 :

Let $\\Delta_1 = \\min \\{ 1, \\overline \\theta + \\mathbb E [\\zeta] - p\\} > 0$

$$
\\begin{array}{l}
\\mathbb{P}_{\\theta, \\zeta}\\left[\\theta+\\mathbb{E}[\\zeta]-p \\geq 0, \\theta+\\zeta-p-\\lambda_{\\bar{K}} \\in[-1,0)\\right] \\\\
\\quad \\stackrel{(a)}{\\geq} \\mathbb{P}_{\\theta, \\zeta}\\left[\\theta \\geq \\bar{\\theta}-\\Delta_{1}, p+\\lambda_{\\bar{K}}-\\theta-1 \\leq \\zeta \\leq p+\\lambda_{\\bar{K}}-\\theta\\right] \\\\
\\quad \\stackrel{(\\text { b) }}{>} 0,
\\end{array}
$$

<p id = "(A-2)">(A-2)</p>

for detailed (b), we have:

$$
\\begin{aligned}
&p+\\lambda_{\\overline K} - \\theta - 1 \\\\
&\\le p + \\lambda_{\\overline K} - \\overline \\theta + \\Delta_1 - 1\\\\
&\\le p + \\lambda_{\\overline K} - \\overline \\theta < \\overline \\zeta\\\\
\\\\
&p+\\lambda_{\\overline K} - \\theta - 1 \\\\
&\\ge p + \\lambda _{-\\underline K} - \\overline \\theta - 1 \\\\
&> \\underline \\zeta
\\end{aligned}
$$

(refer to [Assumption 1](#assumption-1---richness))

$\\min_l Z(a = \\overline K \\mid l) - 1 \\ge \\epsilon > 0$

$$
\\begin{aligned}
&\\mathbb P _{a\\sim \\mathbf \\pi (F_{\\theta,\\zeta}, Q = 0, q = q_t)}[|Z(a\\mid l_t )- 1 | \\ge \\epsilon \\mid l_t]\\\\
&\\ge \\pi ( a = \\overline K; F_{\\theta, \\zeta}, Q = 0, q = q_t)\\\\
&\\ge \\mathbb P_{\\theta, \\zeta}[q_t + \\theta + \\mathbb E[\\zeta] - p \\ge 0, \\theta + \\zeta - p \\ge \\lambda_{\\underline K }]\\\\
&\\ge \\mathbb P_{\\theta, \\zeta } [\\theta + \\mathbb [\\zeta] - p \\ge 0 , \\theta + \\zeta - p \\ge \\lambda_{\\overline K }]\\\\
&\\ge \\mathbb P_{\\theta, \\zeta } \\left[\\theta\\ge\\overline\\theta - \\dfrac{\\Delta _2}{2}, \\zeta\\ge \\overline\\zeta - \\dfrac{\\Delta_2}{2}\\right]\\\\
&> 0
\\end{aligned}
$$

where $\\Delta_2 = \\min\\{\\overline\\theta + \\mathbb E [\\zeta] - p,\\overline\\theta + \\overline\\zeta - p - \\lambda_{\\overline K }\\} > 0$

<p id = "(A-3)">(A-3)</p>

with [(A-2)](#(A-2)), [(A-3)](#(A-3)):
$$
\\begin{aligned}
&\\mathbb P_{\\{(\\theta_s,\\zeta_s)\\}^t_{s = 1}}[|l_{t+1} - l_t|\\ge\\delta\\epsilon]\\\\
&\\text{with } l_{t+1} = l_t\\cdot Z(\\cdot \\mid l_t)\\\\
& = \\mathbb E_{\\{(\\theta_s,\\zeta_s)\\}^t_{s = 1}}[\\mathbf 1\\{|l_t(Z(\\cdot\\mid l_t ) - 1)|\\ge \\delta\\epsilon\\}] \\\\
&\\ge  \\mathbb E_{\\{(\\theta_s,\\zeta_s)\\}^t_{s = 1}}[\\mathbf 1\\{l_t\\ge\\delta\\}\\mathbf 1 \\{|(Z(\\cdot\\mid l_t ) - 1)|\\ge \\epsilon\\}] \\\\
&=  \\mathbb E_{\\{(\\theta_s,\\zeta_s)\\}^t_{s = 1}}[\\mathbf 1\\{l_t\\ge\\delta\\}\\mathbb P_{\\theta, \\zeta } [\\mathbf |(Z(\\cdot\\mid l_t ) - 1)|\\ge \\epsilon \\mid l_t ]] \\\\
&\\ge\\eta\\mathbb E_{\\{(\\theta_s,\\zeta_s)\\}^t_{s = 1}} [ \\mathbf 1 \\{ l_t\\ge\\delta\\}] \\\\
&= \\eta\\mathbb E_{\\{(\\theta_s,\\zeta_s)\\}^t_{s = 1}} [l_t> \\delta]\\\\
\\end{aligned}
$$

$l_t\\rightarrow l_\\infty$ almost surely ( martingale convergence theorem ) $\\Rightarrow P_{\\{(\\theta_s,\\zeta_s)\\}^t_{s = 1}}[|l_{t+1} - l_t|\\ge\\delta\\epsilon]\\rightarrow 0 $

$\\Rightarrow P_{\\{(\\theta_s,\\zeta_s)\\}^t_{s = 1}}[|l_{t} > \\delta ]\\rightarrow 0$

$\\Rightarrow  l_t\\rightarrow 0 $ in probability

with $l_t\\rightarrow l_\\infty$ almost surely

$\\Rightarrow \\mathbb P[l_\\infty = 0] = 1$

notice $l_t = \\dfrac{q_t}{1 - q_t} \\Rightarrow q_t \\rightarrow 0$ almost surely $\\square$

this ends the part 1 proof

[return to part 1](#part-1--when-overline-theta--mathbb-e-zeta---p--0)

#### Part 2: when $\\overline\\theta + \\mathbb E[\\zeta] - p < 0$

Let $\\Delta = -(\\overline\\theta + \\mathbb E [\\zeta] - p) > 0$

notice $\\Delta > 1 \\Leftrightarrow \\overline + \\mathbb E[\\zeta] - p + q \\le -\\Delta + 1 < 0$, no purchase happen

$\\forall q \\ge \\Delta$, with [Assumption 1](#assumption-1---richness) and similar to [(A-2)](#(A-2))

$\\theta\\ge\\overline\\theta - ( 1 - \\Delta)$

$\\Rightarrow \\underline\\zeta < \\lambda_{-\\underline K} + p - \\overline\\theta - 1 \\le \\lambda_{-\\underline K } + p - \\theta - 1 \\le \\lambda_{\\overline K } + p - (\\overline\\theta - (1 - \\Delta)) - 1 < \\overline \\zeta$

$\\Rightarrow \\max _{q \\in[\\Delta, 1]} \\frac{\\mathbb{P}_{\\theta, \\zeta}\\left[\\theta+\\mathbb{E}[\\zeta]+q-p \\geq 0, \\theta+\\zeta+1-p \\leq \\lambda_{-\\underline{K}}\\right]}{\\mathbb{P}_{\\theta, \\zeta}\\left[\\theta+\\mathbb{E}[\\zeta]+q-p \\geq 0, \\theta+\\zeta-p \\leq \\lambda_{-\\underline{K}}\\right]}<1$

the over part and below part difference is bounded by:

$ \\mathbb{P}_{\\theta, \\zeta}\\left[\\theta \\geq \\bar{\\theta}-(1-\\Delta), \\lambda_{-\\underline{K}}+p-\\theta-1 \\leq \\zeta \\leq \\lambda_{-\\underline{K}}+p-\\theta\\right]>0 $

--- 

Theorem shows: 

- $ \\bar{\\theta}+\\mathbb{E}[\\zeta]-p \\geq 0 $ is sufficient for complete learning 
  - starting from any initial belief 
- when not hold:
  - for sufficiently pessimistic beliefs about $Q$(quality of product)
    - all customers stop buying it 

Notice:
- most positive assessment of expected utility: 
  - hightest ex ante valuation $\\bar \\theta $
  - $ \\bar{\\theta}+\\mathbb{E}[\\zeta]+q-p $
    - $ q $ is the public belief at the time of purchase

when: $ \\bar{\\theta}+\\mathbb{E}[\\zeta]-p<0 $

- notice whole will $<0$
  - once belief reach pessimistic level:
    - the most positive valuation stop purchasing
    - consequently beliefs remain stuck at $q$

#### Assumption 2: $ \\bar{\\theta}+\\mathbb{E}[\\zeta]-p>0 $ 

## 3.3 Speed of learning 

Characterize the speed of learning under full history 

Introduce KL(Kullback-Leibler) divergence 

#### Definition 1 : KL Divergence 

> $ D(\\boldsymbol{\\mu} \\| \\boldsymbol{\\nu})=\\sum_{i=1}^{m} \\mu_{i} \\log \\left(\\frac{\\mu_{i}}{\\nu_{i}}\\right) $

> - two strictly positive distributions :
>   - $ \\boldsymbol{\\mu}=\\left(\\mu_{1}, \\ldots\\right. $, $ \\left.\\mu_{m}\\right) $ 
>   - $ \\nu=\\left(\\nu_{1}, \\ldots, \\nu_{m}\\right) $
> - defined on a finite set $ \\{1, \\ldots, m\\}, \\mathrm{KL} $

#### Definition 2 : Speed of learning 

> For a rating system with exponentially fast (complete) learning:
> - $ \\lim _{t \\rightarrow \\infty} \\frac{1}{t} \\log q_{t} $ : the speed of learning 
>   - when $ Q=0 $
> - $ \\lim _{t \\rightarrow \\infty} \\frac{1}{t} \\log (1- q_{t} )$
>   - when $ Q=1 $
> -  a rating system has faster learning than another one :
>   - speed of learning is greater for both $Q = 0$ and $Q = 1$

#### Theorem 2: 

> Suppose:
> -  Assumptions 1 and 2 hold 
> - Then : learning is exponentially fast
>   - that is: $ q_{t} $ almost surely converges exponentially to $ Q $
> 
> For $Q = 0$: almost sure have:
> - $ \\lim _{t \\rightarrow \\infty} \\frac{1}{t} \\log q_{t}=-D\\left(\\pi\\left(F_{\\theta, \\zeta}, Q=0, q=0\\right) \\| \\boldsymbol{\\pi}\\left(F_{\\theta, \\zeta}, Q=1, q=0\\right)\\right) $
> For $Q = 1$: almost sure have:
> $ \\lim _{t \\rightarrow \\infty} \\frac{1}{t} \\log \\left(1-q_{t}\\right)=-D\\left(\\pi\\left(F_{\\theta, \\zeta}, Q=1, q=1\\right) \\| \\pi\\left(F_{\\theta, \\zeta}, Q=0, q=1\\right)\\right) $

Tell us:

Learning under full history:

- exponentially fast 
- is governed by the **KL** divergence between:
  - probability distribution of possible actions (i.e., $ a \\in \\mathcal{A} $ )
    - when the underlying quality is $ Q $
    - public belief is $q = Q $
  - and the probability distribution
    - when underlying quality is $1-Q $
    - still $q=Q$

Three components to intuition:

-  the ability of users to overcome the selection effect and combine (the independent components of) past reviews
   -  can achieve because: they know the distribution of
past reviews and can draw the correct inferences from them
- the speed of learning is given by KL divergence is intuitive as well
  - think of distinguishing $ Q=0 $ from $ Q=1 $ as a binary hypothesis testing problem 
  -  The best error exponent for a binary hypothesis testing problem from independently-drawn samples is given: 
     -  by the KL divergence between the probability distributions of these samples conditional on the two hypotheses
- both probability distributions in the KL divergence condition on $q=Q$
   -  because: under full history, each customer correctly reasons about previous users’ beliefs, which are converging to $Q$
   -  enables the effective filtering out of selection effect


## 3.4 The Selection Effect 

Because : 

the composition of customers purchasing the product :
-  influenced by information at time $t$ (summarized by $q_t$)

Then :

the distribution of reviews depends on this information. 

For example:

with full history, when the public belief $q_t $ is very low:
- only customers with very high $\\theta $ purchase
- these customers are much more likely to enjoy a high material utility 
-  leave a positive review than the
average customer

### Example 1 : 

> A rating system : 
>
> $ p=0, \\zeta=0, \\theta \\sim \\mathcal{U}[-1,1] , Q=0 $
> 
> When $ Q+\\theta \\geq 0 $
> - leave a positive review ("like")
> 
> Suppose:
> - $ q \\approx 1 $
>
> then all customers purchase 
> - because: $ \\theta+q \\approx \\theta+1 $ greater than zero 
>
> Then :
>
>  ex ante valuation of customers who have purchased the product : 
> - uniformaly distributed over $[-1, 1]$
> - half is positive 
>
> In contrast : 
>
> $ q \\approx 0 $
>
> - only customers with positive $\\theta $ purchase the product
> - conditional distribution of ex ante valuations is uniform over $[0, 1]$ 
> - all reviews will be positive

Selection effect impact the speed of learning:

Suppose:

that customer $ t $ (in addition to $ h_{t} $ ) observes the ex ante valuation of previous customers :

- $ \\theta_{s} $ for $ s=1, \\ldots, t-1 $

In this setting:

- extra information remove selection effect 
  - because: current customers can condition on past customers' valuation 
  - learning is faster 
  - extra information regarding distribution of previous customers' preferences increases the speed of learning 

# 4 Summary statistics 

Characterize the conditions for:
- complete learning
- speed for more realistic rating system 
  - where platform provides summary statistics of reviews
  - by past customers

## 4.1 Learning Dynamics 

Summary statistics will not see full history 

- only observe a vector of statistics $\\mathbb S $ 
  - include the fraction of review in a subset of all review 

Formally:

$T$ : a nonempty subset

- of all possible actions $\\mathcal A $

a partition of $T $: A rating system $ \\left\\{T_{1}, \\ldots, T_{m}\\right\\} $

- i.e. $ T=\\bigcup_{i=1}^{m} T_{i} $ and $ T_{i} \\cap T_{j}=\\emptyset, i \\neq j \\in[m] $

- such that:
  - for any $i>j $:
  - reviews in $ T_{i} $ are more positive than the reviews in the set $ T_{j} $

$\\tau $: the times $ t $ at which an action in $ T $ occurs

- $\\tau $ will be the number of reviews left so far 

So:

-  customers observe the number of actions in the
set $T $
- know their own $\\tau $
- for user $\\tau $:
  - rating system takes the form: $ \\Omega_{\\tau}=\\mathbf{S}_{\\tau-1} $
  - report information from the first $\\tau - 1 $ reviews

A summary statistic: $ \\mathbf{S}_{\\tau} \\in \\mathbb{R}^{m} $ with its $ i $ th entry representing fraction of past reviews in $ T_{i} $

that is :

$ \\mathbf{S}_{\\tau}(i)=\\frac{1}{\\tau} \\sum_{s=1}^{\\tau} \\mathbf{1}\\left\\{a_{s} \\in T_{i}\\right\\}, \\quad i \\in[m] $

Examples: 

- The fractions of each one of $ \\underline{K}+\\bar{K} $ reviews are reported.
  -  $ \\mathbf{S}_{\\tau} \\in \\mathbb{R}^{m} $ where $ m=\\underline{K}+\\bar{K} $
  -  $ T=\\mathcal{R} \\backslash\\{{0\\}}$,
  -  $ T_{1}=\\{-\\underline{K}\\}, \\ldots, T_{\\underline{K}}=\\{-1\\}$,
  -  $ T_{\\underline{K}+1}=\\{1\\}, \\ldots, T_{\\underline{K}+K}= $ $ \\{\\bar{K}\\} $.
-  Averages of the scores of past reviews
-  rating system reports only the fraction of reviews that give the highest score: 
   -  $ a=\\bar{K} $
   -   out of the available $ \\underline{K}+\\bar{K} $ options. 
   -   In this case, $ T=\\mathcal{R} \\backslash\\{0\\}$
   -   $ T_{2}=\\{\\bar{K}\\}$,
   -   $ T_{1}=T \\backslash T_{2} $ 
   -   the rating system is represented by: $ \\mathbf{S}_{\\tau} \\in \\mathbb{R}^{2} $ 
       -   $ \\mathbf{S}_{\\tau}(2)=\\frac{1}{\\tau} \\sum_{s=1}^{\\tau} \\mathbf{1}\\left\\{a_{s}=\\bar{K}\\right\\}, \\quad $
       -   $ \\quad \\mathbf{S}_{\\tau}(1)=1-\\mathbf{S}_{\\tau}(2)$


Key object: expectation of qality $Q$

- conditional on the information avaliable from the rating system at time $t$ : $q_t$

the relevant information is summarized by : vector $ \\mathbf{S}_{\\tau} $ after $ \\tau $ purchases
- written as: $ q_{\\tau}=\\mathbb{P}_{\\left\\{\\left(\\theta_{s}, \\zeta_{s}\\right)\\right\\}_{s=1}^{\\tau -1}}\\left[Q=1 \\mid \\mathbf{S}_{\\tau}\\right] $

In contrast to full history case:

$q_\\tau $ is not public belief because :

- $ \\mathbf{S}_{\\tau} $ is only observed by the customer making the $ \\tau $ th purchase

The likelihood ratio implied by belief $q_\\tau$ takes an analogous form to [(4)](#4) :

#### (7)

$ l_{\\tau}=\\frac{q_{\\tau}}{1-q_{\\tau}}=\\frac{\\mathbb{P}_{\\left\\{\\left(\\theta_{s}, \\zeta_{s}\\right)\\right\\}_{s=1}^{\\tau-1}}\\left[Q=1 \\mid \\mathbf{S}_{\\tau}\\right]}{\\mathbb{P}_{\\left\\{\\left(\\theta_{s}, \\zeta_{s}\\right)\\right\\}_{s=1}^{\\tau-1}}\\left[Q=0 \\mid \\mathbf{S}_{\\tau}\\right]}=\\frac{\\mathbb{P}_{\\left\\{\\left(\\theta_{s}, \\zeta_{s}\\right)\\right)_{s=1}^{\\tau_{-1}-1}}\\left[\\mathbf{S}_{\\tau} \\mid Q=1\\right]}{\\mathbb{P}_{\\left\\{\\left(\\theta_{s}, \\zeta_{s}\\right)\\right\\}_{s=1}^{\\tau-1}}\\left[\\mathbf{S}_{\\tau} \\mid Q=0\\right]} $.

Because :

- future customers do not observe $ \\mathbf{S}_{\\tau} $ 
- cannot compute $ q_{\\tau} $ 

So:

the likelihood ratio $ l_{\\tau} $ is no longer a martingale

Then: 

we develop a different approach to study its asymptotic properties.


$ \\pi\\left(i ; F_{\\theta, \\zeta}, Q, q, T\\right)=\\mathbb{P}_{\\theta, \\zeta}\\left[a \\in T_{i} \\mid a \\in T, q, Q\\right], \\quad \\forall i \\in[m] $.

- the probability 
  - of observing an action profile $ a $ 
  - in the set $ T_{i} $ 
  - conditional on the action profile being in $ T $ 


#### (8)

$ \\mathbf{S}_{\\tau+1}=\\frac{\\tau}{\\tau+1} \\mathbf{S}_{\\tau}+\\frac{1}{\\tau+1} \\mathbf{Y}_{\\tau+1}, \\quad \\forall \\tau \\geq 0 $

- The governing stochastic process 
  - for $ \\mathbf{S}_{\\tau} $ 
  - given the true quality $ Q $
- $ \\mathbf{Y}_{\\tau+1} \\in \\mathbb{R}^{m} $
  - $ \\mathbf{Y}_{\\tau+1}=\\mathbf{e}_{i}, \\quad $ w.p. $ \\pi\\left(i ; F_{\\theta, \\zeta}, Q, q_{\\tau+1}, T\\right) $
    - $ \\mathbf{e}_{i} \\in \\mathbb{R}^{m} $ 
    - is the $ i $ th canonical basis vector, $ \\mathbf{e}_{i}=(0, \\ldots, 0,1,0, \\ldots, 0) $

In computing [(7)](#7) :

- agents know  there may be unobserved actions
- but : because 
  - the information observed by agent who did not leave a review
  - is the same as the information available to the next agent
- Bayesian customers can consistently compute posterior probabilities

## 4.2 Negative and Positive Selection

Intuitively:

- negative selection corresponds to the case
  - belief $ q_{t} $ becomes more favorable to $ Q=1 $
  - reviews become less likely to be positive
  - "negative selected"
- Positive selection
  - as belief $ q_{t} $ becomes more favorable to $ Q=1 $
  - reviews are more likely to be
positive

### Definition 3:

> Consider a rating system with $ m $ review options:
> 
>  $ T_{1}, \\ldots, T_{m} $ such that
> 
> - for any $ i^{\\prime}<i$
> - $\\mathbb{P}\\left[a \\in \\bigcup_{j=i}^{m} T_{j} \\mid a \\in \\bigcup_{j=i^{\\prime}}^{m} T_{j}, q, Q=1\\right]> $ $ \\mathbb{P}\\left[a \\in \\bigcup_{j=i}^{m} T_{j} \\mid a \\in \\bigcup_{j=i^{\\prime}}^{m} T_{j}, q, Q=0\\right] .{ }^{12} $
> 
> The rating system has negative selection if
> - for any $ i^{\\prime}<i$, 
> - $ \\mathbb{P}\\left[a \\in \\bigcup_{j=i}^{m} T_{j} \\mid a \\in\\right. $ $ \\left.\\bigcup_{j=i^{\\prime}}^{m} T_{j}, q, Q\\right] $ is decreasing in $ q $
>   - that is, if the probability of more favorable reviews is decreasing in belief $ q $.
> The rating system has positive selection if
> - for any $ i^{\\prime}<i$,
> - $ \\mathbb{P}\\left[a \\in \\bigcup_{j=i}^{m} T_{j} \\mid a \\in\\right. $ $ \\left.\\bigcup_{j=i^{\\prime}}^{m} T_{j}, q, Q\\right] $ is increasing in $ q $
>   - that is, if the probability of more favorable reviews is increasing in belief $ q $.

In both:

as $q_t $ becomes more favorable:

-  customers with
lower ex ante valuations (lower $\\theta $) 
- more likely to purchase the product.

With negative selection:

-  these additional purchases decrease the likelihood of favorable reviews
  
With potsitive selection: 

- they increase the likelihood of favorable reviews

Negative or positive?

- depends on:
  - review options available to customers
  - the distribution of the random variables $\\theta  \\zeta$

Next proposition:

- present simple sufficient conditions for selection 
  -  in terms of the primitives of the model
  -  given a rating system with $ m=\\stackrel{\\rightharpoonup}{K}-\\ell+1 \\geq 2 $ review options 
     -  that reporting the fraction of all reviews
        -  reviews that are more favorable than $\\ell $
        -  for some $ \\ell \\in\\{-\\underline{K}+1, \\ldots, \\bar{K}-1\\} $
        -  i.e., the set $ T $ is $ \\{\\ell, \\ldots, \\bar{K}\\} $ and we have $ T_{1}=\\{\\ell\\}, \\ldots, T_{m}= $ $ \\{\\bar{K}\\}) 

### Proposition 1 : 


> For any $ \\ell \\in\\{-\\underline{K}+1, \\ldots, \\bar{K}-1\\} $
> 
>  consider a rating system that : 
> - reports the fraction of all reviews 
>   - are more favorable than $ \\ell $
> 
> If :
> 
> - $ \\theta $ has a uniform distribution 
> - and $ \\bar{\\theta} \\geq \\max \\left\\{p-\\mathbb{E}[\\zeta], \\lambda_{\\bar{K}}-\\underline{\\zeta}+p\\right\\} $, 
> 
> then :
> 
> for any $ i^{\\prime}<i,$
> 
> $ \\mathbb{P}\\left[a \\in \\bigcup_{j=i}^{m} T_{j} \\mid a \\in \\bigcup_{j=i^{\\prime}}^{m} T_{j}, q, Q=1\\right]> $ $ \\mathbb{P}\\left[a \\in \\bigcup_{j=i}^{m} T_{j} \\mid a \\in \\bigcup_{j=i^{\\prime}}^{m} \\bar{T}_{j}, q, Q=0\\right] $, 
> 
> and we have:

> 1. If the hazard rate $ \\frac{f_{\\zeta}(x)}{1-F_{\\zeta}(x)} $ is decreasing in $ x $,
> 
>  then :
> 
>  this rating system features negative selection.

> 2. If the hazard rate $ \\frac{f_{\\xi}(x)}{1-F_{\\xi}(x)} $ is increasing in $ x $
> 
>  then :
> 
>  this rating system features positive selection.

Example: 

### Example 2

> Negative Selection: 
> 
> Consider a rating system with : 
> 
> two review options 
> - reporting the fraction of the most favorable review: 
>   - $ \\bar{K} $ (i.e., $ T=\\{\\bar{K}-1, \\bar{K}\\}, T_{1}=\\{\\bar{K}-1\\} $, $ T_{2}=\\{\\bar{K}\\} $ with $ \\bar{K} \\geq 2 $ ).
> 
>  This rating system features negative selection when :
> 
> -  $ \\zeta $ has decreasing hazard rate (e.g., when the distribution of $ \\zeta $ is Pareto) 
> - $ \\theta $ is uniform with $ \\bar{\\theta} \\geq \\max \\left\\{p-\\mathbb{E}[\\zeta], \\lambda_{K}-\\underline{\\zeta}+p\\right\\} $.
> 
> Positive Selection: Consider the same rating system, but now suppose that :
> 
> - $ \\zeta $ has increasing hazard rate (e.g., when the distribution of $ \\zeta $ is uniform) 
> -  $ \\theta $ is again uniform with $ \\bar{\\theta} \\geq \\max \\left\\{p-\\mathbb{E}[\\zeta], \\lambda_{\\bar{K}}-\\zeta+p\\right\\} $.
> 
> A simpler, even if less realistic, example of positive selection :
> 
>  rating system with  two review options 
> - reports the fraction of "likes" among all customers 
> - that is
>   - $ T= $ $ \\{-1,0,1\\} \\cup\\{N\\} $ 
>   - $ T_{1}=\\{-1,0\\} \\cup\\{N\\}
>   -  T_{2}=\\{1\\} $ with any distribution of $ \\theta $ and $ \\zeta $

The selection effect is more pronounced when :

-  customers have access to sum-
mary statistics (rather than the full history as in the previous section)
  - because:  customers do not know the exact belief with which the previous actions were taken
- when there is negative selection
  - suppose the rating system exhibits negative selection and $Q=0$
  - as $q_t $ approaches 0:
    -  only customers with very high $\\theta $ purchase the product
    -  tend to leave more positive reviews
 -  makes it more difficult for $q_t $ to converge to 0 
 -  also explains:
    -  with positive selection: 
       -  the selection effect will be less burdensome for learning
       -  less harmful to the speed of learning
    -  because as $q_t $ approaches 0:
       -   more favorable reviews become less likely
       -   helps faster convergence to 0

## 4.3 Complete Learning

Define **separation**:

- it enables customers to filter out the selection effect for rating systems
  - with summary statistics

Intuitively: 

- requires : 
  - the distribution of at least one review option under $Q = 1$ :
    - to be nonoverlapping with its distribution under $Q=0 $

Formally:

### Definition 4-Saparation 

> A rating  system $ \\left(T_{1}, \\ldots, T_{m}\\right) $ satisfies the weak separation condition if :
> 
> - there exists a subset of reviews $ \\mathcal{S} \\subseteq[m] $ such that : 
>   - the range of functions $ \\sum_{i \\in \\mathcal{S}} \\pi\\left(i ; F_{\\theta, \\zeta}, Q=0, q, T\\right) $ and $ \\sum_{i \\in \\mathcal{S}} \\pi\\left(i ; F_{\\theta, \\zeta}, Q=1, q, T\\right) $ (as functions of $ q $ ) are weakly separate 
>
> formally either or:
> 
> - $ \\min _{q \\in[0,1]} \\sum_{i \\in \\mathcal{S}} \\pi\\left(i ; F_{\\theta, \\zeta}, Q=0, q, T\\right) \\geq \\max _{q \\in[0,1]} \\sum_{i \\in \\mathcal{S}} \\pi\\left(i ; F_{\\theta, \\zeta}, Q=1, q, T\\right) $
> - $ \\min _{q \\in[0,1]} \\sum_{i \\in \\mathcal{S}} \\pi\\left(i ; F_{\\theta, \\zeta}, Q=1, q, T\\right) \\geq \\max _{q \\in[0,1]} \\sum_{i \\in \\mathcal{S}} \\pi\\left(i ; F_{\\theta, \\zeta}, Q=0, q, T\\right) $

Strict separation condition if above inequalities strict 

### Theorem 3 : 

> Suppose Assumptions 1 and 2 hold,
>  consider a rating system with summary statistics.

> - The strict separation condition is sufficient for complete learning
> - For $m = 2$ reviews and negative selection:
>   - the weak separation condition is necessary and sufficient for complete learning

First part of theorem: 

- with summary statistics, the strict separation is sufficient for complete learning

Second part :

- establishes a partial converse to this result: 
  -  for rating systems with $m = 2$ reviews and negative selection
     -  the weak separation condition is necessary 
     -  being sufficient for complete learning

if [Assumption 2](#assumption-2--barthetamathbbezeta-p0-) did not hold

- purchases would stop with positive probability
- there would be no complete learning

We have a example:

- absence of weak separation 
  - will lead to failure of complete learning 
    - with negative Selection
  - but not necessarily with positive selection 

### Example 3

> Consider a rating system with two review options 
> 
> "like" and "dislike" denoted by $ \\bar{K} $ and $ -\\underline{K} $.
> 
>  Suppose : 
> - $ p=0 $ 
> -  a customer leaves review $ \\bar{K} $ when her material utility is positive. 
> 
> let the distribution of $ \\theta $ be close to : 
> -  a distribution with two equally likely point masses at $ -7 / 8 $ and $ 1 / 2 $
> 
>  the distribution of $ \\zeta $ 
> - close to four equally likely point masses at $ -7 / 4,-1 / 4,1 / 4 $, and $ 7 / 4 $ 

![Figure 1](EC_1/image.png)

for (a):

- presence of negative selection:
  - curves are downward sloping
- no weak separation :
  - the ranges of $ \\pi\\left(\\bar{K} ; F_{\\theta, \\zeta}, Q=0, q\\right) $ and $ \\pi\\left(\\bar{K} ; F_{\\theta, \\zeta}, Q=1, q\\right) $ being overlapping

for (b) :

- distribution of the number of “likes” among 1000 reviews for both $ Q=1 $ and $ Q=0 $
- complete learning fails
  - beliefs in the overlapping range customers cannot identify the underlying quality

If (in contrast) :

- rating system reports fraction of “likes” among all (potential) customers

Then : 

![Figure 2](EC_1/image_2.png)

- upward sloping
  -  positive selection
-  Even though weak separation again fails
   -  (the ranges of $ \\pi\\left(\\bar{K} ; F_{\\theta, \\zeta}, Q=0, q\\right) $ and $ \\pi\\left(\\bar{K} ; F_{\\theta, \\zeta}, Q=1, q\\right) $ are overlapping )
   -   the distributions of the number of “likes” among 1000 customers for$ Q = 1$ and $Q = 0$ are distinct 
       -   ensure complete learning 

The separation condition is stated :

- about $ \\pi\\left(i ; F_{\\theta, \\zeta}, Q=0, q, T\\right) $
  - probabilities of realization of different review combinations 

Next lemma:

- simple property of distribution of ex ante valuation 
  - sufficient for this condition to be satisfied 

### Lemma 1 : 

> Consider a rating system :
> 
>  reports the fraction of each review among all reviews
> 
>  that is : 
> 
> $ T=\\mathcal{R} $ 
> 
>  $ T_{1}=\\{-\\underline{K}\\}, \\ldots, T_{m}=\\{\\bar{K}\\} $ 
> 
> - $ m=\\bar{K}+\\underline{K}+1 $
> 
> For any distribution on $ \\zeta $ :
> 
>  if the hazard rate $ \\frac{f_{\\theta}(x)}{1-F_{\\theta}(x)} $ is monotonically increasing in $ x $ :
> 
> - then the strict separation condition holds.

A consequence :

for a rating system :
- reports the fraction of each review among all reviews 

strict separation is satisfied 

- for a wide range of distributions of $\\theta $
- including uniform and normal

## 4.4 Speed of Learning 

conditional on complete learning:

the speed of learning 

- under summary statistics

is governed by a KL divergence measure 

- closely related to the full history case

### Theorem 4:

> For a given rating system $ \\left(T_{1}, \\ldots, T_{m}\\right) $ : 
> 
> suppose Assumptions 1 and 2 and the strict separation condition hold.
> 
> Then learning is exponentially fast 
> 
> in particular :
> 
> for $ Q=0 $, we almost surely have :
>
> - $ \\lim _{\\tau \\rightarrow \\infty} \\frac{1}{\\tau} \\log q_{\\tau}=-D\\left(\\pi\\left(F_{\\theta, \\zeta}, Q=0, q=0, T\\right) \\| \\pi\\left(F_{\\theta, \\zeta}, Q=1, q=1, T\\right)\\right) $
>
> for $ Q=1 $, we almost surely have :
>
> - $ \\lim _{\\tau \\rightarrow \\infty} \\frac{1}{\\tau} \\log \\left(1-q_{\\tau}\\right)=-D\\left(\\pi\\left(F_{\\theta, \\zeta}, Q=1, q=1, T\\right) \\| \\pi\\left(F_{\\theta, \\zeta}, Q=0, q=0, T\\right)\\right) $

Intuition on KL divergence determines the speed of learning :

- similar to the full history case 

Difference :

- consider $Q=0$
- with full history :
  - the probability distribution under the alternative hypothesis was still conditioned on $q = 0$
  - now conditioned on $q=1$
- Difference is a consequence of the selection effect
- Under full history :
  -  when drawing inferences from past reviews
     -  customers know the public belief at each point
     -  correct for the selection effect
        -  by conditioning on the public belief
        -   at the time the review was left
 -   not possible with summary statistics :
   - forces a user into the following inference :
     - if $Q = 1$ : 
       -  the belief of all other customers (which she does not observe) is very likely to have also converged to $q=1$.


Specifically:

- consider customer $t$’s learning problem for some large $t$ :
- both full history and summary statistics settings :
- customer $t$ is facing a binary hypothesis testing problem 
- About the belief of customer $t$ regarding previous customers’ beliefs:
  - With full history:
    - observes their public beliefs and conditions on them
  - With summary statistics :
    -  does not observe their beliefs
    -  draws inferences about their belief
       -  conditioning on her expectation
       -  $q$ is converging to $Q$
    -  that is :
       -  $ q \\approx 0 $ under the null hypothesis 
       -  $ q \\approx 1 $ under the alternative hypothesis 
 
 This explains :

 - in [Theorem 4](#theorem-4) : 
   - the distributions being compared have $q = 0$ and $q = 1$
 - in [Theorem 2](#theorem-2) :
   - under full history, these distributions both condition on the same $q$ 

We will investigate :

- the implication of this difference 
- on the speed of learning 
- under full history and summary statistics 

in Section 5

### Remark 5

> Notice: 
> 
> the results in [Theorems 3](#theorem-3-) and [4](#theorem-4) apply 
> - even we consider more general summary statistics. 
> 
> In particular:
> 
>  a general summary statistics can be represented 
> 
> - by a mapping :
>   - from the fraction of each of the $ k=\\underline{K}+\\bar{K}+ 1$  reviews 
>   - among previous customers
> - that is:
> 
> - $ f: \\Delta^{k} \\rightarrow \\mathbb{R}^{m} $, 
>   - $ \\Delta^{k}=\\left\\{\\left(x_{1}, \\ldots, x_{k}\\right) \\in\\right. $ $ \\left.[0,1]^{k}: \\sum_{i=1}^{k} x_{i}=1\\right\\} $

# 5 Comparison of rating systems 

- start with a comparison of full history and summary statistics
- move to a characterization of :
  - different review options affect the speed of learning
- provide examples of fast and slow learning 
  - as the rating system is modified

## 5.1 Full history v.s. Summary Statistics 


Natural conjecture:

- full history  lead to faster learning

We show:

- when negative selection :
  - learning is indeed faster under full history
- when positive selection
  - in fact slower

### Proposition 2

> Consider a rating system with summary statistics : 
> 
> - reports the fraction of reviews in sets $ T_{1}, \\ldots, T_{m} $ 
>   - $ T=\\bigcup_{i=1}^{m} T_{i} $ 
> - that is, $ \\mathbf{S}_{\\tau}(i)=\\frac{1}{\\tau} \\sum_{s=1}^{\\tau} \\mathbf{1}\\left\\{a_{s} \\in T_{i}\\right\\} $ 
>   - $ \\tau $ is the number of reviews in $ T $ (i.e., $ \\tau=\\#\\{a \\in T\\}) $, 
> 
>  a rating system with full history : 
> 
>  reports the sequence of reviews in the sets $ T_{1}, \\ldots, T_{m} $. 
> 
> Suppose that [Assumptions 1](#assumption-1---richness) and [2](#assumption-2--barthetamathbbezeta-p0-) and the strict separation condition hold (so that there is complete learning under both full history and summary statistics).
> 
>  Then: 
> 
> 1. If the rating system has negative selection: 
> 
> - the speed of learning under full history is greater than under summary statistics.

> 2. If the rating system has positive selection
> 
> - the speed of learning under summary statistics is greater than under full history.

Intuition:

- the speed of learning is determined
  - by the problem of distinguishing :
  - the distribution of reviews under the true state
    - $Q = 1$
  - and their distribution under the alternative state
    - $Q = 0$
- As discussion in [Theorem 2](#theorem-2) and [4](#theorem-4)
  - under full history:
    - users observe the public belief
    - $q=1$
  - with summary statistics:
    - users infer that when $ Q=1 $, we must have $ q=1 $
    -  when $ Q=0 $, then we must have $q=0 $
-  Then :
   -  under full history:
      -  distinguish $ (Q=1, q=1) $ from $ (Q=0, q=1) $
   -  under summary statistics:
      -  distinguish $ (Q=1, q=1) $ from $ (Q=0, q=0) $
   -   exacerbates the selection effect, leading to slower learning
- Because :
-  under negative selection
   -  false favorable reviews are quite likely when $ q=0 $
      -  even if $ Q=0 $
      -   making the task of distinguishing the two distributions more difficult
-  under positive selection:
   -  the combination $ (Q=0, q=1) $ generates more false favorable reviews than $ (Q=0, q=  0 )$, 
      -  because: by the definition of positive selection
      -  favorable reviews are less likely
          -  when $q=0$
   -  consequently :
   -  distinguishing $ (Q=1, q=1) $ and $ (Q= $ $ 0, q=0) $ is easier than distinguishing $ (Q=1, q=1) $ from $ (Q=0, q=1) $
   -  leading to faster learning under summary statistics than full history.

This example illustrate the results of Proposition 2:

> EXAMPLE 4: Consider a rating system with two review options 
> 
> - $ T=\\{\\bar{K}-1, \\bar{K}\\} $
> - $ T_{1}=\\{\\bar{K}-1\\}, T_{2}=\\{\\bar{K}\\} $ 
>   - they reports the fraction of the most favorable review among the most favorable two review options
> - that is : $ S_{\\tau}(2)=\\frac{1}{\\tau} \\sum_{s=1}^{\\tau} \\mathbf{1}\\left\\{a_{s}=\\bar{K}\\right\\} $ 
>   - $ \\tau $ is the number of reviews in the set $ \\{\\bar{K}-1, \\bar{K}\\} $. 
> 
> Suppose :
> 
> - the distribution of $ \\theta $ is uniform 
> - $ \\bar{\\theta} \\geq \\max \\left\\{p-\\mathbb{E}[\\zeta], \\lambda_{\\bar{K}}-\\underline{\\zeta}+p\\right\\} $ 
> - the distribution of $ \\zeta $ is Pareto
> 
> so that : 
> 
> this rating system features negative selection (as in [Example 2](#example-2)). 
> 
> Suppose that:
> 
>  the conditions in Theorem 3 are satisfied 
> 
> so that :
> 
> there is complete learning under both full history and summary statistics. 
> 
> Then :
> 
>  the speed of learning under full history is greater than under summary statistics.
> 
>  However , with the same rating system but now $ \\zeta $ having a uniform distribution :
> 
>  there is positive selection
> 
>  the speed of learning under summary statistics is greater than full history.

## 5.2 Learning from refined rating systems 

Show **more refined** rating systems:

- faster learning 
  - both full history and under summary statistics

Consider :

- a rating system $ \\boldsymbol{\\Omega} $ 
- review options $ \\mathcal{R}=\\{-\\underline{K}, \\ldots, \\bar{K}\\} $ 
- thresholds $ \\Lambda=\\left\\{\\lambda_{-\\underline{K}}, \\ldots, \\lambda_{\\bar{K}}\\right\\} $

We say : $ \\boldsymbol{\\Omega}^{\\prime} $ is "coarser" than $ \\boldsymbol{\\Omega} $

If:

- the review options in $ \\boldsymbol{\\Omega}^{\\prime} $ are fewer 
- have thresholds $ \\Lambda^{\\prime}=\\left\\{\\lambda_{i_{1}}, \\ldots, \\lambda_{i_{m}}\\right\\} $ 
  -  $ i_{1}<\\cdots<i_{m} $ 
  -  $ i_{j} \\in \\mathcal{R} $ for $ j=1, \\ldots, m $.

### Proposition 3:

> Consider a rating system with either full history or summary statistics
>
> suppose Assumptions 1 and 2 and the strict separation condition hold (so that there is complete learning).
> 
>  Then : 
> 
> the speed of learning is always faster under a more refined rating
system.

Intuition:

- the more refined rating system $ \\boldsymbol{\\Omega} $:
  - provides strictly more information 
    - about the utility of previous users (and, therefore, their preferences) 
  - than the less refined $ \\boldsymbol{\\Omega}^{\\prime} $, 
  - thus makes it easier for customers to distinguish between : 
    - the probability distributions of reviews induced under the true state of nature 
    - and the alternative.


### Remark 3: 

> we extend [Proposition 3](#proposition-3) to rating systems :
> 
> - with general summary statistics (as mentioned in [Remark 2](#remark-2)). 
> 
> In particular:
> 
> for a general summary statistic $ f: \\Delta^{k} \\rightarrow \\mathbb{R}^{m} $ 
> 
> and a noninjective function $ g: \\mathbb{R}^{m} \\rightarrow \\mathbb{R}^{m^{\\prime}}$,
> 
> $ h=g \\circ f $ will represent a coarser summary statistic
> 
> Proposition B-5 shows that this general form of coarsening always reduces the speed of learning.

Application of [Proposition 3](#proposition-3) :


rating systems :

- report an average score of past
reviews 
- rather than reporting detailed fractions of reviews
  -  that fall in different categories.

When review thresholds remain unchanged:

- a rating system reporting average scores is less refined 
  -  than a rating system reporting detailed fractions

- and from [Proposition 3](#proposition-3):
  - leads to slower learning 

Another application  :

to rating systems that have "targeted information." 

In particular:

platforms such as Amazon offer information about:

- the reviews of groups of customers with certain characteristics. 

For instance:

for a book at the intersection of climate science and economics:

- Amazon separately depicts:
  -  reviews among customers who are interested in economics 
  - as well as reviews among customers who are interested in climate science.

Providing information on reviews by groups of customers is a form of refinement

we make this intuition precise in Appendix B.3.7

- establishes that this type of targeting always leads to faster learning.

Notice:

when the platform alters the review options:

- users’ thresholds might also change
-  reducing the informativeness of their reviews. 

For example:

- when the review options are noncomparable between two rating systems 

- or when additional options change the users’ review thresholds. 

The next example shows that:

- a greater number of review options may lead to slower learning.

### EXAMPLE 5: 

> Assume : 
> 
> - $ \\zeta $ is uniform over $ [-2,2]$, 
> - $ \\theta $ is uniform over $ [-1,1] $
> - $ p=0 $. 
> 
> Consider the following two rating systems: 
> 
> - (i) there are two review options $ \\{-1,1\\} $, with threshold 0
>   - that is: the review is 1 if and only if the utility is nonnegative
> - (ii) there are three review options $ \\{-2,-1,1\\} $, with thresholds $ -1 / 2 $ and $ 1 / 2 $
>   - that is: 
>      - the customer chooses -2 if her utility is below $ -1 / 2 $;
>      - $-1 $ if her utility is between $ -1 / 2 $ and $ 1 / 2 $; 
>      - 1 if her utility is above $ 1 / 2 $. 
> 
> It can be verified that :
> 
> - even though the second rating system has more review options
> 
> - it leads to slower learning.

## 5.3 Fast and Slow Learning from reviews 

we provide several examples illustrating :

how 

- different aspects of the rating system 
-  the extent of heterogeneity among customers 

affect the speed of
learning. 

Example B-1 illustrates:

how a small refinement of a rating system can lead to a very large change in the speed of learning 

- because the refinement provides a review option 
  -  has a much higher likelihood ratio when $Q = 1$ than when $Q = 0$

Examples B-2 and B-3 show that: 

an increase in ex post heterogeneity (a wider support or greater variance of $ \\zeta $ ):

- reduces the speed of learning 

because: reviews become less informative about the underlying quality of the product.

In particular: 

in Example B-3 we consider a setting 

-  both $ \\theta $ and $ \\zeta $ are normally distributed (with $ \\mathbb{E}[\\zeta]=0 $ and $ \\operatorname{var}(\\theta)=1 $ )
-  and then study :
   -  how the speed of learning changes 
   -  as a function of $ \\operatorname{var}(\\zeta) $ and $ \\mathbb{E}[\\theta] $. 
- The speed of learning: 
  -  is decreasing in $ \\operatorname{var}(\\zeta) $ 
  -  and increasing in $ \\mathbb{E}[\\theta] $. 

The intuition for the former result is that: 

- more disperse ex post preferences make reviews less informative. 

The intuition for the latter result is that:  

- higher $ \\mathbb{E}[\\theta] $ implies that:
  -  customers who purchase the product 
     -  are more likely to have a positive experience
  -  exacerbating the selection effect 
  -  slowing down learning.

# 6 Conclusion 

For interesting directions: 

- it is important to study how platform decisions, 
  - including:
    - design of rating systems and pricing
    - interact with user learning. 
  - We take a first step in this direction in Appendix B. 
  - In Appendix B.3.8, we show that:
    - if the platform would like to maximize participation by users, 
    - then it will always choose a rating system that:
      -  maximizes the speed of learning.
  -  In Appendix B.3.9, we show that:
     - our learning and speed of learning results generalize to some environments 
       - where the platform also chooses an endogenous sequence of prices 
       - to maximize revenue. 
- another interesting direction is to introduce more strategic interactions between users 
  - (our analysis of review decisions intended to influence future purchasing behavior in Appendix A.2.2 is one step in this direction). 
- it is important to:
  -  move beyond Bayesian learning 
  -  investigate what types of rating systems robustly aggregate information 
     -  when agents use simple learning rules. 
- a fruitful area for future research would be: 
  - to close the gap between :
    - theoretical models of learning 
    - and the burgeoning empirical literature 
      - on behavior in online markets
    - which highlights :
      - both the role of selection effects 
      - and user incentives.

`,M7=`# Model

$1$: consumers totalling mass

$E, NE$: Experts, Non-Experts

$\\psi\\in(0,1)$: the share of Experts

$1 - \\psi$: thetshare of Non-Experts

$q\\in [0, 1]$ product quality

$0$ prices normalized to 0

$F_E(q)$: Experts choose, a continuous, smooth cumulative distribution

$f_E(q)$ density

$F_{NE}(q), f_{NE}(q)$: Non-Experts

### Assumption 1 (Expertise and Choice)

> $F_E(q)\\le F_{NE}(q), \\forall q\\in [0, 1]$: On average, Experts identify and purchase better products.
> $\\dfrac{\\partial \\left(\\frac{f_E(q)}{f_{NE}(q)}\\right)}{\\partial q} > 0$: MLRP property
> MLRP: Monotone Likelihood Ratio Property, the better will be better.

**Assumption 1** gives us:
- Experts experience higher quality on average
- the higher the product’s quality, the higher the share of its buyers that are Experts.

$r_E := \\int_{0}^{1}q\\mathrm d F_E(q), \\quad r_{NE}:= \\int_{0}^{1}q\\mathrm d F_{NE}(q)$: Choice Procedure (Also means Expectation)

$r_E > r_{NE}$

- We denote this gap by $ \\Delta(r):=r_{E}-r_{N E}>0 $.
-  In our empirical analysis, we find a substantial $ \\Delta(r) $ on both IMDb and MovieLens.

### Assumption 2 (Reference-Dependence)

>  For every $ q \\in[0,1] $ and consumer type $ i=E, N E $, we have:
>
> #### (1)
>
> $ U_{i}(q)=u(q)+\\mu\\left(u(q)-u\\left(r_{i}\\right)\\right) $
> - $ u(\\cdot) $ satisfying the standard assumptions $ u^{\\prime}(\\cdot)>0 $ and $ u^{\\prime \\prime}(\\cdot)<0 $
> - $ \\mu>0 $.

From [Equation 1](#1):
- standards enter utility negatively
- $\\mu$ quantify their impace 

This leads Experts to be less satisfied than Non-Experts

For any level of $q$:

$ \\begin{aligned} r_{E}>r_{N E} & \\Rightarrow U_{E}(q)-U_{N E}(q) \\\\ & =\\left(u(q)+\\mu\\left(u(q)-u\\left(r_{E}\\right)\\right)\\right)-\\left(u(q)+\\mu\\left(u(q)-u\\left(r_{N E}\\right)\\right)\\right) \\\\ & =\\mu \\cdot\\left(u\\left(r_{N E}\\right)-u\\left(r_{E}\\right)\\right) \\\\ & <0 \\quad \\forall q \\geq 0\\end{aligned} $

- the inequality follows from $ \\mu>0, u^{\\prime}(\\cdot)>0 $ and $ r_{E}>r_{N E} $

### Assumption 3 ((Subjectively) Honest Ratings)

> For every $ q \\in[0,1] $, and $ i=E, N E $, ratings reflect subjective satisfaction:
> $ \\mathcal{R}_{i}(q)=U_{i}(q) $

Without loss of generality, given Experts' higher stringency:

we can normalize utilities so that 
- $ \\mathcal{R}_{E}(0)=0 $ 
- $ \\mathcal{R}_{N E}(1)=1 $. 

This ensures all ratings lie within this interval

---

We first consider the case:

the average ratings displayed by the platform are the average of individual opinions. 

That is, given a share $ \\psi $ of Experts, choice densities $ f_{E}(\\cdot) $ and $ f_{N E}(\\cdot) $, and ratings $ R_{E}(\\cdot) $ and $ R_{N E}(\\cdot) $, 

we have:

$ \\begin{aligned} \\mathcal{R}(q) & =\\frac{\\psi f_{E}(q) \\mathcal{R}_{E}(q)+(1-\\psi) f_{N E}(q) \\mathcal{R}_{N E}(q)}{\\psi f_{E}(q)+(1-\\psi) f_{N E}(q)} \\\\ & =\\frac{\\psi f_{E}(q) U_{E}(q)+(1-\\psi) f_{N E}(q) U_{N E}(q)}{\\psi f_{E}(q)+(1-\\psi) f_{N E}(q)} \\\\ & =: \\omega_{E}(q, \\psi) U_{E}(q)+\\left(1-\\omega_{E}(q, \\psi)\\right) U_{N E}(q) \\\\ & =(1+\\mu) u(q)-\\mu\\left(\\omega_{E}(q, \\psi) r_{E}+\\left(1-\\omega_{E}(q, \\psi)\\right) r_{N E}\\right)\\end{aligned} $

- $ \\omega_{E}(q, \\psi):=\\frac{\\psi f_{E}(q)}{\\psi f_{E}(q)+(1-\\psi) f_{N E}(q)} $
  - represents the share of buyers who are Experts, 
  - as a function of product quality $ q $, their baseline share $ \\psi $, and choice densities $ f_{E}(\\cdot) $ and $ f_{N E}(\\cdot) $.

We will relax assumption and consider slightly more general aggregation rules, such as:

- prioritize more expert consumers
- prioritize products with a larger number of ratings

### Proposition 1

> Quality-based self-selection causes ratings to underestimate quality differences. 
> 
> Moreover, ratings can be non-monotonic in quality. 
> 
> In particular, $ \\mathcal{R}^{\\prime}(q)>0 $ if and only if the following condition is satisfied:

> #### (2)
>
> $ u^{\\prime}(q) \\geq \\frac{\\partial \\omega_{E}(q, \\psi)}{\\partial q} \\cdot \\Delta(r) \\cdot \\frac{\\mu}{1+\\mu} $

First result follows:
- higher quality products are purchased by a higher share of Experts

Thus:

they face a higher “burden of proof”, 
- which implies their relative ratings are penalized compared to those of their lower quality alternatives.

Second result admits a intuition, we list the terms of [Equation 2](#2):

$ \\underbrace{u^{\\prime}(q)}_{\\text {Gains in individual satisfaction }} \\geq \\underbrace{\\frac{\\partial \\omega_{E}(q, \\psi)}{\\partial q}}_{\\text {Increase in } \\% \\text { of } \\mathrm{E} \\text { buyers }} \\cdot \\underbrace{\\Delta(r)}_{\\text {Difference in standards }} \\cdot \\underbrace{\\frac{\\mu}{1+\\mu}}_{\\text {Importance of reference-dependence }} $

- the LHS quantifies the gains in ratings from improved quality:
  - each individual consumer is more satisfied, as measured by $ u^{\\prime}(q) $. 
- The RHS quantifies its costs, driven by self-selection: 
  - the first term represents choice heterogeneity, 
  - and the second and third rating heterogeneity. 
    - In particular, $ \\frac{\\partial \\omega_{E}(q, \\psi)}{\\partial q} $ represents negative self-selection, 
      - or the increase in the share of Experts buyers as $ q $ increases; 
    - $ \\Delta(r) $ represents the difference in standards between Experts and Non-Experts; 
    - $ \\frac{\\mu}{1+\\mu} $ measures the relative weight of referencedependence in shaping total individual utility.

Note that:
 
when either $ \\frac{\\partial \\omega_{E}(q, \\psi)}{\\partial q}, \\Delta(r) $ or $ \\mu $ go to zero,
- ratings are guaranteed to be increasing,
- since $ u^{\\prime}(\\cdot)>0 $. 

It is straightforward to see why: 
- the first case corresponds to a lack of self-selection, 
- the second to equal standards (and thus ratings) for the two types of consumers,
- and the third to reference-independent 

and, thus, homogenous across consumers - utility.

In Section 4.4,:

we propose a fixed-point algorithm to back out individual stringency for each user, 
- which allows us to correct for it
- and thus obtain new ratings reflecting $ \\Delta(r)=0 $, thus eliminating the bias.

## 3.1 Platform Design 

Consider two commonly observed real world practices. 
- First, a vast majority of platforms overweight the opinions of their most expert reviewers. 
- While there are obvious rationales for doing so 
  - for instance, more expert consumers might be less likely to post fake ratings,
  - or more thorough in their quality evaluations 

the following Corollary shows that this can have perverse effect in our context

### Corollary 1 

> When the percentage of Experts, $ \\psi $, is low, >
> 
> overweighting their opinions by a factor $ \\gamma>1 $ worsens the bias, 
> 
> further contracting ratings and thus making it more likely for the monotonicity between ratings and quality to be broken.

Observation:

the bias gets worse when the crowd of buyers is more heterogeneous: 

- If $ 90 \\% $ of buyers were Experts, 
  - then overweighting their opinions bring aggregate ratings closer to essentially only reflecting the (homogeneous) opinions of Experts, 
  - yielding monotonicity: $ \\mathcal{R}^{\\prime}(q) \\approx(1+ $ $ \\mu) u^{\\prime}(q)>0 $. 
- Conversely, if - say - only $ 10 \\% $ were Experts (which we believe to be the far more likely scenario empirically), increasing their share worsens the bias


the number of buyers for a given product is proportional to the share of Experts buyers: 
- while everybody responds to quality, Experts do so more than Non-Experts. 

Therefore, more popular products are effectively facing a higher burden of proof. 

We thus provide an additional rationale for the platform rewarding products receiving more ratings, even in a setting in which a greater number of reviews does not bring more accuracy or credibility per se.

### Corollary 2

> Denote by $ \\mathcal{N}(q):=\\psi f_{E}(q)+(1-\\psi) f_{N E}(q) $ the number of ratings for product $ q $,
> 
> and by $ \\beta(\\cdot) $ a reward function, with $ \\beta(\\cdot), \\beta^{\\prime}(\\cdot)>0 $. 
> 
> Then, substituting average ratings $ \\mathcal{R}(q) $ with mass inflated ratings $ \\beta(\\mathcal{N}(q)) \\cdot \\mathcal{R}(q) $ reduces ratings' contraction and improves monotonicity.


A very stylized relationship between quality and number of ratings:
- higher quality products are on average more popular than their lower quality alternatives.
-  While fairly natural, this relationship need not always hold empirically. 
-  In particular, one can think of products of mediocre quality but huge mass appeal, and viceversa, high quality and niche appeal. 
-  In those situations, the impact of inflating the ratings of popular products would be reversed.

In Section 4.4 : 

we propose a complementary design remedy that:
- is both new (to the best of our knowledge)
- and conceptually orthogonal to those highlighted in Corollaries 1 and 2. 

Unlike in Corollary 1, our algorithm counts all ratings equally, 

and thus does not require us to take a stance on which opinions are credible or not; 

it also requires less knowledge of the proportion of Experts (even more: it does not require us to take a stance on who is an expert in the first place). 

Moreover, unlike in Corollary 2, our algorithm is agnostic as to the predictive power of the number of ratings on ratings' stringency, and correct for the bias in either of the two cases highlighted here.

# 4 Data and Empirical Strategy

We now provide empirical support for the role of consumer expertise on:

both choice and rating behavior as described in Section 3, and study its consequences for movie ratings.

We start by presenting the dataset in Section 4.1. 

Our dataset is obtained by combining data from two online platforms: MovieLens and IMDb. 

In particular,
- we carefully explain how we proxy movies' quality with festival and industry awards,
-  and users' stringency with the number of ratings posted on the platforms. 

Then, in Subsections 4.2 and 4.3, we provide empirical evidence for our two main assumptions. 

In particular, we will center our analysis on the following two empirical counterparts of Assumptions 1 and 2 in Section 3:

### Choice heterogeneity

> Experts watch and rate higher-quality movies than Non-Experts 

### Rating heterogeneity

> For a given movie, Experts post lower rating than Non-Experts 

After providing support for these two facts, 

in Subsection 4.4 we provide a fixed-point algorithm to remove the self-selection of stringent, expert reviewers into high quality movies 

Allow us to compute new, normalized ratings, and provide convincing evidence for the main proposition of the model: 

average ratings understate differences in quality, thus unfaitly penalizing high quality movies compared to their inferior alternatives 

## 4.1 The Database

$$
\\begin{array}{|c|c|c|c|c|c|}
\\hline
 & \\text{Mean} & \\text{SD} & \\text{N} & \\text{Min} & \\text{Max} \\\\
\\hline
\\text{Year of Production} & 2007 & 6.81 & 9426 & 1995 & 2019 \\\\
\\hline
\\text{Movie Runtime} & 104.1 & 28.9 & 9426 & 2 & 629 \\\\
\\hline
\\text{Genre: Action (\\%)} & 17 & - & 9426 & - & - \\\\
\\hline
\\text{Genre: Comedy (\\%)} & 26 & - & 9426 & - & - \\\\
\\hline
\\text{Genre: Drama (\\%)} & 26 & - & 9426 & - & - \\\\
\\hline
\\text{Nominated or Awarded (\\%)} & 58 & - & 9426 & - & - \\\\
\\hline
\\text{Nominated or Awarded (Excluding Academy) (\\%)} & 48 & - & 9426 & - & - \\\\
\\hline
\\text{IMDb Ratings: } \\bar{r}_{i}^{I M D b} & 6.5 & 0.979 & 9426 & 1.4 & 9.5 \\\\
\\hline
\\text{IMDb Number of Users: } n_{i}^{I M D b}(\\times 1000) & 69 & 148 & 9426 & 0.05 & 2588 \\\\
\\hline
\\text{IMDb Top1000 Ratings: } \\bar{r}_{i}^{\\text{Top } 1000} & 6 & 0.864 & 9426 & 1 & 9 \\\\
\\hline
\\text{IMDb Number of Top1000 Users: } n_{i}^{\\text{Top1000 }} & 260.3 & 191 & 9426 & 2 & 928 \\\\
\\hline
\\text{MovieLens Ratings: } \\bar{r}_{i}^{\\text{Movielens }} & 3.2 & 0.459 & 9426 & 0.8548 & 4.483 \\\\
\\hline
\\text{MovieLens Number of Users: } n_{i}^{\\text{Movielens }}(\\times 1000) & 1.6 & 4.36 & 9426 & 0.031 & 72.67 \\\\
\\hline
\\text{Have Critics Reviews: } \\operatorname{Meta}_{i}(\\%) & 72 & - & 9426 & - & - \\\\
\\hline
\\text{Have Positive Critics Reviews: } M e t a_{i}^{>60} (\\%) & 32 & - & 9426 & - & - \\\\
\\hline
\\text{Share 18-29 Users: } p_{i}^{18-29} (\\%) & 13 & - & 9426 & - & - \\\\
\\hline
\\text{Share 30-44 Users: } p_{i}^{30-44} (\\%) & 60 & - & 9426 & - & - \\\\
\\hline
\\text{Share Over 45 Users: } p_{i}^{45} (\\%) & 26 & - & 9426 & - & - \\\\
\\hline
\\text{Share Female Users: } p_{i}^{\\text{female }} (\\%) & 21 & - & 9426 & - & - \\\\
\\hline
\\text{Share US Users: } p_{i}^{U S}(\\%) & 30 & - & 9426 & - & - \\\\
\\hline
\\end{array}
$$

![Figure 1](image.png)

Figure 1: Distribution of the number of ratings posted by Top 1000 users.

## 4.2 Choice Heterogeneity 

Experts differ from Non-Experts since:
- they are more capable of choosing high quality products. 

Thus, we expect Top1000 users to watch and rate more high quality movies. 

The main estimating equation to study this assumption is the following:

### (3)

$ n_{i}^{\\text {Top } 1000}=\\alpha+\\beta_{1} q_{i}+\\beta_{2} X_{i}+\\epsilon_{i} $,

- $ n_{i}^{\\text {Top } 1000} $ is the total number of ratings by Top 1000 users for movie $ i $; 

Figure 1 shows the distribution of $ n_{i}^{\\text {Top } 1000} $ for all movies in our sample. 

No movies are rated by all 1000 Top1000 users. 

Accordingly, issues related to censoring bias are not relevant in our analysis. 

- $ q_{i} $ is the unobserved quality of movie $ i ; 
- X_{i} $ is a set of controls related to movie characteristics and its audience; 
- and $ \\epsilon_{i} $ is an error term. 

Movie quality is not perfectly observable. 

In our preferred specifications, we proxy quality using three measures that do not depend on platforms' feedback. 

- In particular, we use one dummy variable that equals 1 if a movie has received at least one nomination or award to one of the major festival or industry awards around the world. 

- A second dummy variable that equals 1 if a movie has received at least one nomination or award excluding the Academy awards. 

We exclude the Academy awards since previous research has shown that:
- the relevance of the Oscars is such that it may move users' reference point, and affect selection of users who watch the nominated and awarded movies (Rossi, 2021). 

Finally, we use a third dummy variable that equals 1 if a movie has received a Metacritic Metascore greater than 60 .

Quality and popularity are correlated positively.

## Rating Heterogeneity 

Experts have higher standards than Non-Experts.

## 4.4 Debiasing the Ratings 

Of course, individual stringency and ratings are intertwined: updating one implies updating the other. 

Thus, we iterate this process until it converges. 

More formally, for each MovieLens user $ j $, defined as $ \\mathcal{I}_{j} $ the set of movies she has watched. 

Moreover, define by $ n_{j} $ the cardinality of $ \\mathcal{I}_{j} $, or user expertise. 

Then, for each movie $ i \\in \\mathcal{I}_{j} $, compute the movie-user specific stringency as the average movie rating, $ \\bar{r}_{i} $, minus the rating posted by the user, $ r_{i j} $. 

Then, we define the user's stringency as the average of movie-user specific stringency over the set $ \\mathcal{I}_{j} $ :

### (4)

$ s_{j}:=\\frac{\\sum_{i \\in \\mathcal{I}_{j}}\\left(\\bar{r}_{i}-r_{i j}\\right)}{n_{j}} $

Then, we compute new movie ratings 
- which take into account - and correct for - how stringent their watchers are. 

Define by $ \\mathcal{J}_{i} $ the set of all users who have watched movie $ i $, 

and by $ n_{i} $ its cardinality. 

Then, we update, or normalize, movie $ i $ 's rating $ \\bar{r}_{i} $ to:

### (5)

$ \\bar{r}_{i}^{\\text {norm }}:=\\frac{\\sum_{j \\in \\mathcal{J}_{i}}\\left(r_{i j}+s_{j}\\right)}{n_{i}}=\\bar{r}_{i}+\\frac{\\sum_{j \\in \\mathcal{J}_{i}} s_{j}}{n_{i}} $.

Notice:

-  it weights all opinions equally
-   it does not require us to make assumptions about the rating and choice processes for each category of consumers.







placeholder


placeholder


placeholder


placeholder


placeholder


`,F7=`# Model Evaluation Framework

## OT-based stability evaluation criterion

### Definition 1 (OT discrepancy with moment constraints)

If:

$\\mathcal Z \\subseteq \\mathbb R^d, \\mathcal  W\\subseteq  \\mathbb R_+$: convex, closed sets, 

$c: (\\mathcal Z \\times \\mathcal  W )^2 \\rightarrow  \\mathbb R_+$: lower semicontinuous function,

$\\mathbb Q, \\mathbb  P \\in \\mathcal  P (\\mathcal Z\\times \\mathcal W) $


Then:

$\\mathrm M_c: \\mathcal P(\\mathcal  Z \\times \\mathcal  W )^2 \\rightarrow  \\mathbb R_+$ is a function, defined through

$$
\\mathrm{M}_{c}(\\mathbb{Q}, \\mathbb{P})=\\left\\{\\begin{array}{ll}
\\inf & \\mathbb{E}_{\\pi}[c((Z, W),(\\hat{Z}, \\hat{W}))] \\\\
\\text { s.t. } & \\pi \\in \\mathcal{P}\\left((\\mathcal{Z} \\times \\mathcal{W})^{2}\\right) \\\\
& \\pi_{(Z, W)}=\\mathbb{Q}, \\pi_{(\\hat{Z}, \\hat{W})}=\\mathbb{P} \\\\
& \\mathbb{E}_{\\pi}[W]=1 \\quad \\pi \\text {-a.s }
\\end{array}\\right.
$$

is called OT discrepancy wth moment constraints induced by $c, \\mathbb  Q, \\mathbb P$

$f_\\beta$ : given learning model, trained on the distribution:

$\\mathbb P_0 \\in \\mathcal P (\\mathcal  Z)$, we have:

#### Problem P
$$
\\mathfrak{R}(\\beta, r)=\\left\\{\\begin{array}{cl}
\\inf _{\\mathbb{Q} \\in \\mathcal{P}(\\mathcal{Z} \\times \\mathcal{W})} & \\mathrm{M}_{c}(\\mathbb{Q}, \\hat{\\mathbb{P}}) \\\\
\\text { s.t. } & \\mathbb{E}_{\\mathbb{Q}}[W \\cdot \\ell(\\beta, Z)] \\geq r
\\end{array}\\right.
$$

- $\\hat {\\mathbb  P}$ is selected as $\\mathbb  P_ 0 \\otimes \\delta _1$
  - $\\delta _1 $ : Dirac delta function
  - $\\mathrm M_c (\\mathbb Q, \\hat {\\mathbb P} )$: OT discrepancy with moment constraints between the projected distribution $\\mathbb Q$ and the reference distribution $\\hat{\\mathbb P}$
  - $l(\\beta ,z)$ : prediction risk of model $f_\\beta $ on sample $z$
  - $r > 0$ : pre-defined risk threshold

example c:

##### formula 1

$c((z,w), (\\hat z, \\hat w )) = \\theta _1 \\cdot w \\cdot d(z, \\hat z) +\\theta _2 \\cdot (\\phi  (w) - \\phi (\\hat{w}))_+$

- $d(z,\\hat z) = \\| x - \\hat x \\|^2_2 + \\infty \\cdot | y - \\hat y|$: cost with different $z, \\hat z$

- $(\\phi(w) - \\phi (\\hat w))_+$ : cost related to differences in probability mass.

  - $\\phi : \\mathbb  R_+ \\rightarrow  \\mathbb  R_+$ : convex function, where:
  - $\\phi(1) = 0$
- $\\theta _1, \\theta _2 \\ge 0$ : hyperparameters, where:
  - $\\dfrac{1}{\\theta _1} + \\dfrac{1}{\\theta _2}=C $ for some constant $C$

--- 

## Dual reformulation and its interpretation

### Theorem 1 (Strong duality for problem for problem [(P)](#problem-p))

Suppose:

- $\\mathcal Z \\times \\mathcal  W$ is compact.

- $l(\\beta ,\\cdot )$ is upper semicontinuous for all $\\beta $ 

- $c:(\\mathcal Z\\times\\mathcal W)^2\\rightarrow \\mathbb R_+$ is continuous
- $r<\\bar r := \\max_{z\\in\\mathcal Z}l(\\beta ,z)$

Then:


#### Function D
$\\mathfrak{R}(\\beta, r)=\\sup _{h \\in \\mathbb{R}_{+}, \\alpha \\in \\mathbb{R}} h r+\\alpha+\\mathbb{E}_{\\hat{\\mathbb{P}}}\\left[\\tilde{\\ell}_{c}^{\\alpha, h}(\\beta,(\\hat{Z}, \\hat{W}))\\right]$

- $\\tilde{\\ell}_{c}^{\\alpha, h}(\\beta,(\\hat{Z}, \\hat{W}))$ : surrogate function
  - it equals to : $\\min_{(z,w)\\in\\mathcal Z\\times\\mathcal W}c((z,w),(\\hat z,\\hat w)) + \\alpha w - h\\cdot w \\cdot l(\\beta ,z)$, for all $\\hat z \\in \\mathcal Z, \\hat w \\in \\mathcal W$.

( is it $+aw$ ? in the proof it's $-aw$)

[Skip the proof](#end-proof-for-function-d)

##### Proof for Function D

Reformulate Problem [(P)](#problem-p) into a infinite-dimension linear program:

###### Formula Primal
$$
\\begin{array}{cl}
\\inf _{\\pi} & \\mathbb{E}_{\\pi}[c((Z, W),(\\hat{Z}, \\hat{W}))] \\\\
\\text { s.t. } & \\pi \\in \\mathcal{P}\\left((\\mathcal{Z} \\times \\mathcal{W})^{2}\\right) \\\\
& r-\\mathbb{E}_{\\pi}[W \\cdot \\ell(\\beta, Z)] \\leq 0 \\\\
& \\mathbb{E}_{\\pi}[W]=1 \\\\
& \\pi_{(\\hat{Z}, \\hat{W})}=\\hat{\\mathbb{P}} .
\\end{array}
$$

We get the Lagrangian function

$L(\\pi ; h, \\alpha)=h r+\\alpha+\\mathbb{E}_{\\pi}[c((Z, W),(\\hat{Z}, \\hat{W}))-h \\cdot W \\cdot \\ell(\\beta, Z)-\\alpha \\cdot W]$,

where $h\\in\\mathbb R_+,\\alpha \\in\\mathbb R,\\pi$ belongs to :
- $\\Pi_{\\hat {\\mathbb P}} = \\left\\{  \\pi\\in\\mathcal P((\\mathcal Z\\times\\mathcal W)^2) : \\pi_{(\\hat{Z},\\hat W)} = \\hat{\\mathbb P}\\right\\}$

$\\mathcal Z\\times W$ is compact 

$\\Rightarrow \\mathcal P(\\mathcal  Z\\times\\mathcal W) $ is tight.

$\\Rightarrow \\Pi_{\\hat{\\mathbb P }}$ is tight

$\\Rightarrow  \\Pi_{\\hat{\\mathbb P }}$ has a compact closure (Prokhorov's theorem)

$\\Pi_{\\hat{\\mathbb P }}$ is weakly closed

$\\Rightarrow \\Pi_{\\hat{\\mathbb P }} is compact$ (tight + close)

$\\Pi_{\\hat{\\mathbb P }}$ is convex

###### Prove $L(\\pi; h ,\\alpha)$ is lower semicontinuous in $\\pi $ under the weak topology

Suppose:

$\\pi_n$ converges weakly to $\\pi $

$\\Rightarrow \\liminf_{n\\rightarrow +\\infty}\\int g\\mathrm d \\pi_n \\ge \\int g\\mathrm d  \\pi$, for any lower semicontinuous function $g$ that is bounded below (Portmanteau theorem)

$l(\\beta,\\cdot)$ is upper semicontinuous for all $\\beta $, 

and $w,h\\ge 0 $,

$\\Rightarrow  h\\cdot w \\cdot l(\\beta ,z)$ is upper semicontinuous, w.r.t $(z,w)$

$c((z,w),(\\hat z, \\hat w))$ is lower semicontinuous

$\\Rightarrow c((z,w),(\\hat z, \\hat w)) - h\\cdot w \\cdot l (\\beta,z) - \\alpha\\cdot w $ is lower semicontinuous w.r.t $(z,w)$ for any $(\\hat z,\\hat w) \\in \\mathcal  Z\\times \\mathcal W$

$\\mathcal  Z\\times\\mathcal W$ is compact

$\\Rightarrow $ the function is bounded below

$\\Rightarrow \\liminf_{n\\rightarrow +\\infty}L(\\pi_n;h,\\alpha )\\ge L(\\pi;h,\\alpha )$

$\\Rightarrow L(\\pi;h,\\alpha )$ is lower semicontinuous in $\\pi$ under the weak topology

###### Prove continuous in $(h,\\alpha)$ under the uniform topology in $\\mathbb{R}_+ \\times \\mathbb R$

Suppose:

$\\lim_{n\\to+\\infty}h_n = h$ in Euclidean topology, $\\lim_{n\\to\\infty}|\\alpha _n|<\\bar\\alpha $ in Euclidean topology

Exists:

$\\bar h\\in\\mathbb R_+, \\bar\\alpha \\in\\mathbb R $, with $\\sum_{n\\to\\infty}|h_n|\\le\\bar h, \\sup_{n\\to\\infty }|\\alpha _n|<\\bar\\alpha $, for all $n\\ge 1$

$\\Rightarrow  \\lim_{n\\to+\\infty}L(\\pi;h_n,\\alpha _n) = L(\\pi;h,\\alpha )$ ( dominated convergence theorem)

$\\Rightarrow  L(\\pi;h,\\alpha )$ is continuous in  $(h,\\alpha )$ under the Ecludiean topology in  $\\mathbb R_+ \\times \\mathbb  R$

###### Formula 5

$\\Rightarrow \\inf_{\\pi\\in\\Pi_{\\hat{\\mathbb P }}}\\sup_{h\\in\\mathbb R_+,\\alpha \\in\\mathbb R }L(\\pi;h,\\alpha ) = \\sup_{h\\in\\mathbb R_+,\\alpha \\in\\mathbb R }\\inf_{\\pi\\in\\Pi_{\\hat{\\mathbb P }}}L(\\pi;h,\\alpha )$ (Sion's minmax theorem)

Rewrite:

$L(\\pi ; h, \\alpha)=\\mathbb{E}_{\\pi}\\left[c((Z, W),(\\hat{Z}, \\hat{W}))\\right]+h\\left(r-\\mathbb{E}_{\\pi}[W \\cdot \\ell(\\beta, Z)]\\right)+\\alpha\\left(1-\\mathbb{E}_{\\pi}[W]\\right)$ (The original paper lost a close bracket)

$\\Rightarrow \\inf_{\\pi\\in\\Pi_{\\hat{\\mathbb P }}}\\sup_{h\\in\\mathbb R_+,\\alpha \\in\\mathbb R }L(\\pi;h,\\alpha ) $ is bounded above

We construct:

$\\mathbb Q_0 = \\delta _{(z^*,1)}$

- $z^* = \\argmax_{z\\in\\mathcal Z }l(\\beta ,z)$

Then:

$$
\\begin{aligned}
&\\inf _{\\pi \\in \\Pi_{\\mathbb{P}}} \\sup _{h \\in \\mathbb{R}_{+}, \\alpha \\in \\mathbb{R}} L(\\pi ; h, \\alpha) \\\\
& \\leq \\sup _{h \\in \\mathbb{R}_{+}, \\alpha \\in \\mathbb{R}} L\\left(\\mathbb{Q}_{0} \\otimes \\hat{\\mathbb{P}} ; h, \\alpha\\right) \\\\
& =\\mathbb{E}_{\\mathbb{Q}_{0} \\otimes \\hat{\\mathbb{P}}}[c((Z, W),(\\hat{Z}, \\hat{W}))]+\\sup _{h \\in \\mathbb{R}_{+}} h(r-\\bar{r}) \\quad (E_\\pi[W] = 1)\\\\
& <+\\infty
\\end{aligned}
$$

- $\\bar r = \\mathbb E_{\\mathbb  Q_0 }[l(\\beta ,Z)]$ (Notice $W$ is independent with it) $ = \\max_{z\\in Z }l(\\beta ,Z)$
- combined $c$ is continuous, it's bounded on a compact domain $Z\\times W$ (The suppose)
$$
\\begin{aligned}
\\Rightarrow & r - \\mathbb E_\\pi [W\\cdot l(\\beta ,Z)] \\le 0 \\\\ 
& \\mathbb E_\\pi [W] = 1
\\end{aligned}
$$

Then: for [(5)](#formula-5) right hand side:

$$
\\begin{aligned}
& \\sup _{h \\in \\mathbb{R}_{+}, \\alpha \\in \\mathbb{R}} \\inf _{\\pi \\in \\Pi_{\\mathrm{P}}} L(\\pi ; h, \\alpha) . \\\\
= & \\sup _{h \\in \\mathbb{R}_{+}, \\alpha \\in \\mathbb{R}} h r+\\alpha+\\inf _{\\pi \\in \\Pi_{\\mathbb{®}}} \\mathbb{E}_{\\pi}[c((Z, W),(\\hat{Z}, \\hat{W}))-h \\cdot W \\cdot \\ell(\\beta, Z)-\\alpha \\cdot W] .
\\end{aligned}
$$

Notice:

$$
\\begin{aligned}
& \\inf _{\\pi \\in \\Pi_{\\mathfrak{R}}} \\mathbb{E}_{\\pi}[c((Z, W),(\\hat{Z}, \\hat{W}))-h \\cdot W \\cdot \\ell(\\beta, Z)-\\alpha \\cdot W] \\\\
= & \\mathbb{E}_{\\hat{\\mathbb{P}}}\\left[\\min _{(z, w) \\in \\mathcal{Z} \\times \\mathcal{W}} c((z, w),(\\hat{Z}, \\hat{W}))-h \\cdot w \\cdot \\ell(\\beta, z)-\\alpha \\cdot w\\right],
\\end{aligned}
$$

##### End Proof for Function D

We explore [(1)](#formula-1) with:

- $\\phi (t) = t\\log t - t + 1$, Kullback-Leibler divergence

- $\\phi (t) = (t-1)^2$ , $\\chi^2$-divergence

---

### Proposition 1 (Dual reformulations)

Suppose:

$\\mathcal  W = \\mathbb  R_+$

(i) If:

$\\phi (t) = t\\log t - t + 1$, [(D)](#function-d) admits:

#### function 2

$\\sup_{h\\ge0 }hr - \\theta _2\\log \\mathbb E_{\\mathbb P_0 }\\left[\\exp\\left(\\dfrac{l_{h,\\theta _1 }(\\hat Z)}{\\theta _2 }\\right)\\right]$

(ii) If:

$\\phi(t) = (t-1)^2 $, [(D)](#function-d) admits:

#### function 3

$\\sup _{h \\geq 0, \\alpha \\in \\mathbb{R}} h r+\\alpha+\\theta_{2}-\\theta_{2} \\mathbb{E}_{\\mathbb{P}_{0}}\\left[\\left(\\frac{\\ell_{h, \\theta_{1}}(\\hat{Z})+\\alpha}{2 \\theta_{2}}+1\\right)_{+}^{2}\\right]$


- $l_{h,\\theta _1 }(\\hat z ):=\\max_{z\\in\\mathcal Z }h\\cdot l(\\beta ,z)-\\theta _1 \\cdot d(z,\\hat z)$ : the d-trasform of $h\\cdot l(\\beta, \\cdot)$ with the step size $\\theta_1$

[Skip the Proof](#end-proof-for-proposition-1)

#### Proof for proposition 1

$$
\\begin{aligned}
&\\tilde{\\ell}_{c}^{\\alpha, h}(\\beta,(\\hat{z}, \\hat{w})) \\\\ 
& =\\min _{(z, w) \\in \\mathcal{Z} \\times \\mathcal{W}} \\theta_{1} \\cdot w \\cdot d(z, \\hat{z})+\\theta_{2}(\\phi(w)-\\phi(\\hat{w}))_{+}-\\alpha w-h \\cdot w \\cdot \\ell(\\beta, z) \\\\
& =\\min _{z \\in \\mathcal{Z}} \\theta_{2} \\cdot \\min _{w \\in \\mathbb{R}}-w \\frac{h \\cdot \\ell(\\beta, z)-\\theta_{1} \\cdot d(z, \\hat{z})+\\alpha}{\\theta_{2}}+\\phi(w)+\\mathbb{I}_{\\mathcal{W}}(w) \\text{ // Notice } \\hat W = 1 \\text{ almost surely, and } \\phi(1) = 0\\\\
& =\\min _{z \\in \\mathcal{Z}}-\\theta_{2} \\cdot\\left(\\phi+\\mathbb{I}_{\\mathcal{W}}\\right)^{*}\\left(\\frac{h \\cdot \\ell(\\beta, z)-\\theta_{1} \\cdot d(z, \\hat{z})+\\alpha}{\\theta_{2}}\\right) . \\text{ Convex conjugate}
\\end{aligned}
$$

- $\\mathbb I_{\\mathcal W }(w) = \\begin{cases}
0& \\text{if } w\\in \\mathcal W\\\\
+\\infty &\\text{if }w\\notin \\mathcal W
\\end{cases}
$

- Convex conjugate: $\\min_x\\{-(x,y) + f(x)\\} = -f^* (y)$

(i) When $\\mathcal W = \\mathbb R_+, \\phi (t) = t\\log t -t + 1$:

$(\\phi + \\mathbb I_{\\mathbb R_+})^*(\\cdot) = \\exp(\\cdot) - 1$

- 
$$
\\begin{cases}
&(\\phi + \\mathbb I_{\\mathbb R_+})^*(y) \\\\
&= \\sup_{x\\ge0}\\{xy - (x\\log x-x+1)\\}\\\\
&(Derive) = y - \\log x - 1 + 1 = 0\\\\
&\\Rightarrow x = e^y\\\\
&\\Rightarrow (\\phi + \\mathbb I_{\\mathbb R_+})^*(y)  = ye^y - ye^y + e^y - 1 = e^y - 1
\\end{cases}
$$

Continue:

$$
\\begin{aligned} 
&\\tilde{\\ell}_{c}^{\\alpha, h}(\\beta,(\\hat{z}, \\hat{w})) \\\\ 
& =\\min _{z \\in \\mathcal{Z}}-\\theta_{2} \\cdot \\exp \\left(\\frac{h \\cdot \\ell(\\beta, z)-\\theta_{1} \\cdot d(z, \\hat{z})+\\alpha}{\\theta_{2}}\\right)+\\theta_{2} \\\\ & =-\\theta_{2} \\cdot \\exp \\left(\\frac{\\max _{z \\in \\mathcal{Z}} h \\cdot \\ell(\\beta, z)-\\theta_{1} \\cdot d(z, \\hat{z})+\\alpha}{\\theta_{2}}\\right)+\\theta_{2} \\\\ & =-\\theta_{2} \\cdot \\exp \\left(\\frac{\\ell_{h, \\theta_{1}}(\\hat{z})+\\alpha}{\\theta_{2}}\\right)+\\theta_{2} \\end{aligned} 
$$

Then we reformulate the [(D)](#function-d) :

$\\mathfrak{R}(\\beta, r)=\\sup _{h \\in \\mathbb{R}_{+}, \\alpha \\in \\mathbb{R}} h r+\\alpha-\\theta_{2} \\mathbb{E}_{\\mathbb{P}_{0}}\\left[\\exp \\left(\\frac{\\ell_{h, \\theta_{1}}(\\hat{Z})+\\alpha}{\\theta_{2}}\\right)\\right]+\\theta_{2} $

Derive the $\\alpha  $:

$1-\\exp \\left(\\frac{\\alpha}{\\theta_{2}}\\right) \\mathbb{E}_{\\mathbb{P}_{0}}\\left[\\exp \\left(\\frac{\\ell_{h, \\theta_{1}}(\\hat{Z})}{\\theta_{2}}\\right)\\right]=0$

Solve this and get the $\\alpha  $:

$\\alpha^{\\star}=-\\theta_{2} \\log \\left(\\mathbb{E}_{\\mathbb{P}_{0}}\\left[\\frac{\\ell_{h, \\theta_{1}}(\\hat{z})}{\\theta_{2}}\\right]\\right) $

Put it back:

$\\mathfrak R(\\beta, r)=\\sup _{h \\in \\mathbb{R}_{+}} h r-\\theta_{2} \\log \\left(\\mathbb{E}_{\\mathbb{P}_{0}}\\left[\\exp \\left(\\frac{\\ell_{h, \\theta_{1}}(\\hat{Z})}{\\theta_{2}}\\right)\\right]\\right)$

(ii)

When $ \\mathcal{W}=\\mathbb{R}+ $ and $ \\phi(t)=(t-1)^{2} $

$\\left(\\phi+\\mathbb{I}_{\\mathbb{R}_{+}}\\right)^{*}(\\cdot)=\\left(\\frac{\\cdot}{2}+1\\right)_{+}^{2}-1 $

- 
$$
\\begin{cases}
\\left(\\phi+\\mathbb{I}_{\\mathbb{R}_{+}}\\right)^{*}(y) \\\\
=\\sup_{x\\ge0}xy - (x-1)^2\\\\ 
(Derive) y - 2x + 2 = 0 \\\\ 
x = \\dfrac{y}{2} + 1\\\\
\\left(\\phi+\\mathbb{I}_{\\mathbb{R}_{+}}\\right)^{*}(y) =\\dfrac{y^2}{2} + y - \\dfrac{y^2}{4} \\\\
= (\\dfrac{y}{2} + 1)^2 - 1 
\\end{cases}
$$

Then:

$$
\\begin{aligned} 
&\\tilde{\\ell}_{c}^{\\alpha, h}(\\beta,(\\hat{z}, \\hat{w}))\\\\ 
& =\\min _{z \\in \\mathbb{Z}}-\\theta_{2} \\cdot\\left(\\phi+\\mathbb{I}_{\\mathcal{W}}\\right)^{*}\\left(\\frac{h \\cdot \\ell(\\beta, z)-\\theta_{1} \\cdot d(z, \\hat{z})+\\alpha}{\\theta_{2}}\\right) \\\\ 
& =\\min _{z \\in \\mathcal{Z}}-\\theta_{2} \\cdot\\left(\\frac{h \\cdot \\ell(\\beta, z)-\\theta_{1} \\cdot d(z, \\hat{z})+\\alpha}{2 \\theta_{2}}+1\\right)_{+}^{2}+\\theta_{2} \\\\
& =-\\theta_{2} \\cdot\\left(\\frac{\\ell_{h, \\theta_{1}}(\\hat{z})+\\alpha}{2 \\theta_{2}}+1\\right)_{+}^{2}+\\theta_{2}
\\end{aligned}
$$

Then we reformulate the [(D)](#function-d) :

$\\sup _{h \\geq 0, \\alpha \\in \\mathbb{R}} h r+\\alpha+\\theta_{2}-\\theta_{2} \\mathbb{E}_{\\mathbb{P}_{0}}\\left[\\left(\\frac{\\ell_{h, \\theta_{1}}(\\hat{Z})+\\alpha}{2 \\theta_{2}}+1\\right)_{+}^{2}\\right]$

We can't continue, because it's a piecewise linear equation.

#### End proof for proposition 1

---

### Remark 4 (Structure of the most sensitive distribution)

$\\mathbb  Q^* = \\dfrac{1}{n}\\sum_{n}^{i=1 }\\delta _{(z^*_i,w^*_i)}, (z^*_i, w^*_8)\\in \\mathcal Z \\times \\mathbb R_+$

- $z_{i}^{\\star}=\\underset{z \\in \\mathcal{Z}}{\\arg \\max } h^{\\star} \\ell(\\beta ; z)-\\theta_{1} \\cdot d\\left(z, \\hat{z}_{i}\\right), \\quad \\forall i \\in[n]$

---

## Computation

Address [(2)](#function-2), [(3)](#function-3) with different loss functions.

### Convex piecewise linear loss functions

[(2)](#function-2) admits a tractable finite convex program

### Theorem 2 (KL divergence)

Suppose:

$\\mathcal Z = \\mathbb R^d \\times \\{+1, -1\\},$

$ l(\\{(a_k,b_k)\\}_{k\\in[K]},z)=\\max_{k\\in[K]}y\\cdot a_k^T + b_k$

The negative optimal value of problem [(2)](#function-2) is equivalent to :

$$
\\begin{array}{ll}
\\min & -h r+t \\\\ 
\\text { s.t. } & \\lambda \\in \\mathbb{R}_{+}, t \\in \\mathbb{R}, \\eta \\in \\mathbb{R}_{+}^{n}, p \\in \\mathbb{R}^{n} \\\\ 
& \\left(\\eta_{i}, \\theta_{2}, p_{i}-t\\right) \\in \\mathcal{K}_{\\exp } \\\\ 
& \\frac{\\left\\|a_{k}\\right\\|_{2}^{2}}{4\\theta _1} h^{2}+\\hat{y}_{i} \\cdot a_{k}^{T} \\hat{x}_{i} \\cdot h+b_{k} \\leq p_{i} \\\\ 
& \\frac{1}{n} \\sum_{i=1}^{n} \\eta_{i} \\leq \\theta_{2},\\end{array}
$$

- $\\mathcal K_{\\exp}$ is exponential cone 

- $\\mathcal K_{\\exp }=\\left\\{(z, y, x) \\in \\mathbb{R}^{3}: y>0, y e^{x / y} \\leq z\\right\\} \\cup\\{(z, 0, x): x \\leq 0, z \\geq 0\\}$

[Skip the proof](#end-proof-for-theorem-2)

#### Proof for Theorem 2

Start from [(2)](#function-2):

$$
\\begin{array}{l}
\\sup_{h\\ge0 }hr - \\theta _2\\log \\mathbb E_{\\mathbb P_0 }\\left[\\exp\\left(\\dfrac{l_{h,\\theta _1 }(\\hat Z)}{\\theta _2 }\\right)\\right]\\\\ 
=\\min _{h \\geq 0}-h r+\\theta_{2} \\log \\mathbb{E}_{\\mathbb{P}_{0}}\\left[\\exp \\left(\\dfrac{\\ell_{h, \\theta_{1}}(\\hat{Z})}{\\theta_{2}}\\right)\\right] \\\\
=\\left\\{\\begin{array}{ll}
\\min & -h r+t \\\\
\\text { s.t. } & h \\in \\mathbb{R}_{+}, t \\in \\mathbb{R} \\\\
& \\theta_{2} \\log \\mathbb{E}_{\\mathbb{P}_{0}}\\left[\\exp \\left(\\frac{\\ell_{h, \\theta_{1}}(\\hat{Z})}{\\theta_{2}}\\right)\\right] \\leq t
\\end{array}\\right. \\\\
=\\left\\{\\begin{array}{ll}
\\min & -h r+t \\\\
\\text { s.t. } & \\lambda \\in \\mathbb{R}_{+}, t \\in \\mathbb{R}, \\eta \\in \\mathbb{R}_{+}^{n} \\\\
& \\left(\\eta_{i}, \\theta_{2}, \\ell_{h, \\theta_{1}}\\left(\\hat{z}_{i}\\right)-t\\right) \\in \\mathcal{K}_{\\exp } \\quad \\forall i \\in[n] \\\\
& \\frac{1}{n} \\sum_{i=1}^{n} \\eta_{i} \\leq \\theta_{2}
\\end{array}\\right. \\\\
=\\left\\{\\begin{array}{lll}
\\min & -h r+t & \\\\
\\text { s.t. } & \\lambda \\in \\mathbb{R}_{+}, t \\in \\mathbb{R}, \\eta \\in \\mathbb{R}_{+}^{n}, p \\in \\mathbb{R}_{n} & \\\\
& \\left(\\eta_{i}, \\theta_{2}, p_{i}-t\\right) \\in \\mathcal{K}_{\\exp } & \\forall i \\in[n] \\\\
& \\ell_{h, \\theta_{1}}\\left(\\hat{z}_{i}\\right) \\leq p_{i} & \\forall i \\in[n] \\\\
& \\frac{1}{n} \\sum_{i=1}^{n} \\eta_{i} \\leq \\theta_{2} . &
\\end{array}\\right.
\\end{array}
$$

- To get second euqality, notice :
$$
\\begin{aligned}
& \\theta_{2} \\log \\mathbb{E}_{\\mathbb{P}_{0}}\\left[\\exp \\left(\\frac{\\ell_{h, \\theta_{1}}(\\hat{Z})}{\\theta_{2}}\\right)\\right] \\leq t \\\\ 
& \\Leftrightarrow \\mathbb{E}_{\\mathbb{P}_{0}}\\left[\\exp \\left(\\frac{\\ell_{h, \\theta_{1}}(\\hat{Z})-t}{\\theta_{2}}\\right)\\right] \\leq 1 \\\\ 
&\\lrArr  \\frac{1}{n} \\sum_{i=1}^{n} \\exp \\left(\\frac{\\ell_{h, \\theta_{1}}\\left(\\hat{z}_{i}\\right)-t}{\\theta_{2}}\\right) \\leq 1
\\end{aligned}
$$

- We introduce $\\eta \\in \\mathbb R_+^n$, then decomposed to :

$$
\\left\\{\\begin{array}{l}
\\frac{1}{n} \\sum_{i=1}^{n} \\eta_{i} \\leq \\theta_{2} \\\\ 
\\theta_{2} \\exp \\left(\\frac{\\ell_{h, \\theta_{1}}\\left(\\hat{z}_{i}\\right)-t}{\\theta_{2}}\\right) \\leq \\eta_{i}, \\quad \\forall i \\in[n]\\end{array}\\right.
$$

- The second ineuqality is decomposed by definition of exponential cone
- We introduce $p_i$ to get the last equality

Then: 

##### Formlua 10

$$
\\begin{aligned} 
& \\ell_{h, \\theta_{1}}\\left(\\hat{z}_{i}\\right) \\leq p_{i} \\\\ \\Longleftrightarrow & \\sup _{z \\in \\mathcal{Z}}\\left\\{h \\cdot \\max _{k \\in[K]} y \\cdot a_{k}^{\\top} x+b_{k}-\\theta_{1} d\\left(z, \\hat{z}_{i}\\right)\\right\\} \\leq p_{i} \\\\ \\Longleftrightarrow & \\sup _{z \\in \\mathcal{Z}}\\left\\{h \\cdot y \\cdot a_{k}^{\\top} x+b_{k}-\\theta_{1} d\\left(z, \\hat{z}_{i}\\right)\\right\\} \\leq p_{i} \\forall k \\in[K] \\\\ \\Longleftrightarrow & \\sup _{x \\in \\mathbb{R}^{d}}\\left\\{h \\cdot \\hat{y}_{i} \\cdot a_{k}^{\\top} x+b_{k}-\\theta_{1}\\left\\|x-\\hat{x}_{i}\\right\\|_{2}^{2}\\right\\} \\leq p_{i} \\forall k \\in[K] \\\\ \\Longleftrightarrow & \\frac{\\left\\|a_{k}\\right\\|_{2}^{2}}{4 \\theta_{1}} \\cdot h^{2}+\\hat{y}_{i} \\cdot a_{k}^{T} \\hat{x}_{i} \\cdot h+b_{k} \\leq p_{i}, \\forall k \\in[K]
\\end{aligned}
$$

- Refer to [(2)](#function-2) for first equivalent
- Refer to [(1)](#formula-1) for $d(z,\\hat z_i)$ for third equivalent
- Simple derivation for fourth equivalent

Put everything together:

$$
\\begin{array}{lll}\\min & -h r+t & \\\\ \\text { s.t. } & \\lambda \\in \\mathbb{R}_{+}, t \\in \\mathbb{R}, \\eta \\in \\mathbb{R}_{+}^{n}, p \\in \\mathbb{R}^{n} & \\\\ & \\left(\\eta_{i}, \\theta_{2}, p_{i}-t\\right) \\in \\mathcal{K}_{\\exp } & \\forall i \\in[n] \\\\ & \\frac{\\left\\|a_{k}\\right\\|_{2}^{2}}{4 \\theta_{1}} \\cdot h^{2}+\\hat{y}_{i} \\cdot a_{k}^{T} \\hat{x}_{i} \\cdot h+b_{k} \\leq p_{i}, & \\forall k \\in[K], \\forall i \\in[n] \\\\ & \\frac{1}{n} \\sum_{i=1}^{n} \\eta_{i} \\leq \\theta_{2} . & \\end{array}
$$

#### End proof for Theorem 2

--- 

### Theorem 3 ($\\chi^2$ Divergence)

Suppose:

$\\mathcal Z = \\mathbb R^d\\times {+1,-1}$


$ l(\\{(a_k,b_k)\\}_{k\\in[K]},z)=\\max_{k\\in[K]}y\\cdot a_k^T + b_k$


The negative optimal value of problem [(2)](#function-2) is equivalent to :

$$
\\begin{array}{ll}
\\min & -h r+t \\\\ 
\\text { s.t. } & h \\in \\mathbb{R}_{+}, \\alpha \\in \\mathbb{R}, t \\in \\mathbb{R}, \\eta \\in \\mathbb{R}_{+}^{n} \\\\ 
& \\frac{\\left\\|a_{k}\\right\\|_{2}^{2}}{4 \\theta_{1} \\cdot} \\cdot h^{2}+\\hat{y}_{i} \\cdot a_{k}^{T} \\hat{x}_{i} \\cdot h+b_{k}+ \\alpha+2 \\theta_{2} \\leq 2 \\theta_{2} \\eta_{i} \\\\ 
& \\frac{\\theta_{2}}{n} \\sum_{i=1}^{n} \\eta_{i}^{2} \\leq t
\\end{array}
$$

#### Note for theorem 3

It should be $\\alpha$ instead of $2\\theta_1 \\alpha$, the paper made a mistake here.

[Skip the proof](#end-proof-for-theorem-3)

#### Proof for Theorem 3

Start from [(3)](#function-3) :

$$
\\begin{array}{l}
\\sup _{h \\geq 0, \\alpha \\in \\mathbb{R}} h r+\\alpha+\\theta_{2}-\\theta_{2} \\mathbb{E}_{\\mathbb{P}_{0}}\\left[\\left(\\frac{\\ell_{h, \\theta_{1}}(\\hat{Z})+\\alpha}{2 \\theta_{2}}+1\\right)_{+}^{2}\\right]\\\\ 
=\\min _{h \\geq 0, \\alpha \\in \\mathbb{R}}-h r-\\alpha+\\theta_{2}+\\theta_{2} \\mathbb{E}_{\\mathbb{P}_{0}}\\left[\\left(\\frac{\\ell_{h, \\theta_{1}}(\\hat{Z})+\\alpha}{2 \\theta_{2}}+1\\right)_{+}^{2}\\right] \\\\
=\\left\\{\\begin{array}{ll}
\\min & -h r-\\alpha+t \\\\
\\text { s.t. } & h \\in \\mathbb{R}_{+}, \\alpha \\in \\mathbb{R}, t \\in \\mathbb{R} \\\\
& \\theta_{2} \\mathbb{E}_{\\mathbb{P}_{0}}\\left[\\left(\\frac{\\ell_{h, \\theta_{1}}(\\hat{Z})+\\alpha}{2 \\theta_{2}}+1\\right)_{+}^{2}\\right] \\leq t
\\end{array}\\right. \\\\
=\\left\\{\\begin{array}{ll}
\\min & -h r+t \\\\
\\text { s.t. } & h \\in \\mathbb{R}_{+}, \\alpha \\in \\mathbb{R}, t \\in \\mathbb{R}, \\eta \\in \\mathbb{R}_{+}^{n} \\\\
& \\ell_{h, \\theta_{1}}(\\hat{z})+\\alpha+2 \\theta_{2} \\leq 2 \\theta_{2} \\eta_{i} \\quad \\forall i \\in[n] \\\\
& \\frac{\\theta_{2}}{n} \\sum_{i=1}^{n} \\eta_{i}^{2} \\leq t
\\end{array}\\right. \\\\
=\\left\\{\\begin{array}{ll}
\\min & -h r+t \\\\
\\text { s.t. } & h \\in \\mathbb{R}_{+}, \\alpha \\in \\mathbb{R}, t \\in \\mathbb{R}, \\eta \\in \\mathbb{R}_{+}^{n} \\\\
& \\frac{\\left\\|a_{k}\\right\\|_{2}^{2}}{4 \\theta_{1}} \\cdot h^{2}+\\hat{y}_{i} \\cdot a_{k}^{T} \\hat{x}_{i} \\cdot h+b_{k}+\\alpha+2 \\theta_{2} \\leq 2 \\theta_{2} \\eta_{i} \\quad \\forall k \\in[K], \\forall i \\in[n] \\\\
& \\frac{\\theta_{2}}{n} \\sum_{i=1}^{n} \\eta_{i}^{2} \\leq t
\\end{array}\\right.
\\end{array}
$$

- Reformulate the first equivalent into:
$$
\\left\\{\\begin{array}{l}\\frac{\\theta_{2}}{n} \\sum_{i=1}^{n} \\eta_{i}^{2} \\leq t \\\\ \\ell_{h, \\theta_{1}}(\\hat{z})+2 \\theta_{2} \\alpha+2 \\theta_{2} \\leq 2 \\theta_{2} \\eta_{i}, \\eta_{i} \\in \\mathbb{R}_{+}\\end{array}\\right.
$$
to get the second equivalent 
- Refer to [(10)](#formlua-10) for the last equivalent

#### End proof for Theorem 3

--- 

### 0/1 loss function

$r$: risk level, error rate

$\\ell(\\beta,(x, y))=\\mathbb{I}_{y \\neq f_{\\beta}(x)}$ : loss function 

- $\\beta $ : trained model
- $(x,y) $ : sample
- $\\mathbb{I}_{y \\neq f_{\\beta}(x)} = 1 $ if $y \\ne f_\\beta  (x)$, $0$ otherwise

### Nonlinear loss function

Gradient ascent

---

## Feature stability analysis

For machine learning: 

Modify function $d $:

$d(z, \\hat{z})=\\left\\|z_{(i)}-\\hat{z}_{(i)}\\right\\|_{2}^{2}+\\infty \\cdot\\left\\|z_{(,-i)}-\\hat{z}_{(,-i)}\\right\\|_{2}^{2}$

- $z_{(i)}$ : $i$-th feature of $z$
- $z_{(,-i)} = z\\backslash z_{(i)}$ : all variables in $z $ except for $i$-th

Then the $\\mathfrak R_i(\\beta ,r)$ indicates the stability

---

# Visualizations on stylized / toy examples

Visualize the most sensitive distribution $\\mathbb  Q^*$ based on
[Remark 4](#remark-4-structure-of-the-most-sensitive-distribution)

2d binary classifaction:

$$
\\begin{cases}
100 \\text{ samples} \\\\ 
Y = 0\\\\ 
\\mathcal  N([2,2]^T, I_2)
\\end{cases}
$$


$$
\\begin{cases}
100 \\text{ samples} \\\\ 
Y = 1\\\\ 
\\mathcal  N([-1,-1]^T, I_2)
\\end{cases}
$$

$f_\\beta (\\cdot)$ : Logistic regression

$\\dfrac{1}{\\theta_1} + \\dfrac{1}{\\theta_2} = 5$

risk : $0.5$

then solve $(2)$


placeholder

placeholder

placeholder

placeholder

placeholder

placeholder`,q7=`# Preliminaries

## Problem setup

### Data generation

#### (1)

$\\mathbf{F O}(\\boldsymbol{\\theta}, \\mathbf{u}): \\min_{\\mathbf x\\in\\mathcal X(\\mathbb u)} f(\\boldsymbol{\\theta}, \\mathbf{x})$

- $\\mathbb x\\in\\mathbb R^n$
- $\\mathcal X(\\mathbf u)$ : feasible region
- $\\mathbf u\\in\\mathbb R^m $ : exogenous parameters
- $f : \\mathbb R^{n\\times d }\\to\\mathbb R $ : objective function
- $\\mathbf u $ distributed according to $\\mathbb P_{\\mathbf  u }$ supported on $\\mathcal  U $

**There exists:**

$\\boldsymbol \\theta ^*$ unknown to the DM(Decision maker)

**DM obtains:**

$\\hat{\\mathbb  x}$ : decision
- by solving: $\\mathbf{F O}(\\hat {\\boldsymbol{\\theta}}, \\mathbf{u})$
- $\\hat{\\boldsymbol \\theta }$: noisy perception of $\\boldsymbol \\theta ^*$
  - $\\mathbb P_{\\boldsymbol \\theta }$ : the distribution of of $\\hat{\\boldsymbol \\theta }$ : unknown
  - $\\boldsymbol \\Theta \\subset \\mathbb R^d$: support set of $\\mathbb P_{\\boldsymbol \\theta }$, bounded
    - $\\boldsymbol \\theta ^*\\in\\boldsymbol \\Theta $
  - $\\mathbb P_{(\\boldsymbol \\theta ,\\mathbf u)}$: joint distribution of $\\hat{\\boldsymbol \\theta} ,\\mathbf u $ 
- $\\tilde {\\mathbf x} : \\boldsymbol \\Theta \\times\\mathcal U \\to\\mathbb R^n $
: oracle, returns an optimal solution to $\\mathbf  {FO}$
  - $\\mathcal X^{\\text{OPT}}(\\boldsymbol \\theta ,\\mathbf u):=\\argmin \\{f(\\boldsymbol \\theta ,\\mathbf x)\\mid \\mathbf x\\in\\mathcal X(\\mathbb u)\\}$ : solutions drawn uniformly from

### Objective function

$f$ is linear in $\\boldsymbol \\theta  $ and convec in $\\mathbf x $

$f(\\boldsymbol \\theta ,\\mathbf x) = \\sum_{i\\in[d]}\\theta _i f_i (\\mathbb x)$
- $f_i : \\mathbb R^n \\to\\mathbb R$ for all $i\\in[d]$ : convex basis functions
  - i.e.: $f(\\boldsymbol{\\theta}, \\mathbf{x})=\\boldsymbol{\\theta}^{\\top} \\mathbf{x}$
- $\\mathbf {FO}$ with it -> multi-objective optimization model

### Learning task

$\\mathcal  D = \\{\\hat{\\mathbf x_k},\\mathbf u_k\\}^N_{k=1}$ : decision-exogenous parameter pairs
- $N$: number

Aim: find

$\\bar{\\mathbf x}: \\mathcal U\\to\\mathbb R^n$: decision policy, to suggest future $\\mathbf u$
- $\\bar{\\mathbf x}(\\mathbb u) \\in\\mathcal X(\\mathbf u)$ for any $\\mathbf u\\in\\mathcal U$: require

### Assumptions

#### Assumption 1 (I.I.D. Samples)

> The dataset $\\mathcal  D$ is generated using : 
> $\\hat{\\mathbf x_k} := \\tilde {\\mathbf x}(\\hat{\\boldsymbol \\theta _k},\\mathbf u_k)$ 
> - $(\\hat{\\boldsymbol \\theta _k}, \\mathbf u_k)$ : i.i.d. samples from $\\mathbb P _{(\\boldsymbol \\theta , \\mathbf u)}$ for all $k\\in[N]$ 




#### Assumption 2 (Bounded Inverse Feasible Set)

#### (2)
> There exists a constant $ \\eta \\in \\mathbb{R}_{+} $ such that, for any $ \\boldsymbol{\\theta}, \\boldsymbol{\\theta}^{\\prime} \\in \\boldsymbol{\\Theta}^{\\mathrm{OPT}}(\\hat{\\mathbf{x}}, \\mathbf{u}) $, for some $ \\hat{\\mathbf{x}} \\in \\mathcal{X}(\\mathbf{u}) $ and $ \\mathbf{u} \\in \\mathcal{U} $: 
>  $ \\left\\|\\boldsymbol{\\theta}-\\boldsymbol{\\theta}^{\\prime}\\right\\|_{2} \\leq \\eta $,
> -  $\\Theta^{\\mathrm{OPT}}(\\mathbf{x}, \\mathbf{u}):=\\left\\{\\boldsymbol{\\theta} \\in \\mathbb{R}^{d} \\mid \\mathbf{x} \\in \\mathcal{X}^{\\mathrm{OPT}}(\\boldsymbol{\\theta}, \\mathbf{u}),\\|\\boldsymbol{\\theta}\\|_{2}=1\\right\\}$

#### Assumption 3 (Bounded Divergence)

> There exists a constant $ \\sigma \\in \\mathbb{R}_{+} $such that :
> $ \\left\\|\\mathbb{E}(\\hat{\\boldsymbol{\\theta}})-\\boldsymbol{\\theta}^{*}\\right\\|_{2} \\leq \\sigma $.

### Evaluation Metrics

#### Definition 1

#### (3)

>  $$ \\operatorname{AOG}(\\overline{\\mathbf{x}}):=\\mathbb{E}\\left[f\\left(\\boldsymbol{\\theta}^{*}, \\overline{\\mathbf{x}}(\\mathbf{u})\\right)-f\\left(\\boldsymbol{\\theta}^{*}, \\tilde{\\mathbf{x}}\\left(\\boldsymbol{\\theta}^{*}, \\mathbf{u}\\right)\\right)\\right] $$ : The actual optimality gap $ (A O G) $ of a decision policy $ \\overline{\\mathbf{x}} $
> - $\\mathbf u, \\bar{\\mathbf x}$ is random
>
> 

#### Definition 2

#### (4)

> $$\\operatorname{POG}(\\overline{\\mathbf{x}}):=\\mathbb{E}[f(\\hat{\\boldsymbol{\\theta}}, \\overline{\\mathbf{x}}(\\mathbf{u}))-f(\\hat{\\boldsymbol{\\theta}}, \\tilde{\\mathbf{x}}(\\hat{\\boldsymbol{\\theta}}, \\mathbf{u}))]$$ : The perceived optimality gap $ (P O G) $ of a decision policy $ \\overline{\\mathbf{x}} $
> - $\\hat{\\boldsymbol \\theta }, \\mathbf u, \\bar{\\mathbf x}$ is random

## Note 1

**An Example for Model, Assumption, Defninition:**

> A investment is needed, allocate money between $n$ assets.

- $\\mathbf x\\in\\mathbb R^n$ : weight for $n$ portfolio
- $\\mathbf u \\in\\mathbb R^m$: market condition (inflation, interest, etc.)
- $\\boldsymbol{\\theta}^*$: true assets return 
- $\\hat{\\boldsymbol{\\theta}}$: estimated assets return 
- $f(\\boldsymbol{\\theta}, \\mathbf{x})$ the return with the given weight and return (e.g.$\\boldsymbol \\theta ^T \\mathbb x$)
- $\\mathcal{X}(\\mathbf{u})$ the feasible weight under the given market condition

> To get the data, every month:

- $\\mathbf{u}_k$: observe the market
- $\\hat{\\boldsymbol{\\theta}}_k$: estimate the return 
- $\\hat{\\mathbf{x}}_k$: make the decision

> Assumptions

- 1: Every month is i.i.d.
- 2: If $\\mathbf x$(weight) is observed, the difference between the $\\boldsymbol \\theta $(return) is not big 
- 3: the average $\\hat{\\boldsymbol \\theta }$ (estimated return) is not far from $\\boldsymbol \\theta ^*$(real return)

> Definitions

- 1: AOG: Real return under current decision - real return under best decision
- 2: POG: Estimated return under current decision - estimated return under best decision

## An Inverse Optimization Pipeline

Finding $\\bar{\\mathbf x}$ is challenging because:

- $\\bar{\\mathbf x}(\\mathbf u)$ to be feasible to $\\mathbf {FO}$, involve more constraints, we can't use supervised learning that predict $\\hat{\\mathbf x}$ on $\\mathbf u $
- We do not observe $\\boldsymbol \\theta ^*$ or $\\hat {\\boldsymbol \\theta }$, we cant use classic ML technique.
- AOG and POG may not connected.

Classic IO pipeline:

Obtain:

$\\bar{\\boldsymbol \\theta }$: point decision 

Employ:

$\\bar{\\mathbf x_{IO}} (\\mathbf u):= \\tilde {\\mathbf x}(\\bar{\\boldsymbol \\theta },\\mathbb u)$ 

We can solve:

#### (5)

$ \\mathbf{I O}(\\mathcal{D}): \\underset{\\boldsymbol{\\theta} \\in \\boldsymbol{\\Theta}}{\\operatorname{min}} \\dfrac{1}{N} \\sum_{k \\in[N]} \\ell\\left(\\hat{\\mathbf{x}}_{k}, \\mathcal{X}^{\\mathrm{OPT}}\\left(\\boldsymbol{\\theta}, \\mathbf{u}_{k}\\right)\\right) $
- $\\ell $: non-negative loss function
  - return $0$ when $\\hat{\\mathbf x_k} \\in\\mathcal X^{OPT }(\\boldsymbol \\theta ,\\mathbf u_k ) $

### Definition 3

#### (6)

> The sub-optimality loss of $ \\boldsymbol{\\theta} $ is given by
$$
\\ell_{S}\\left(\\hat{\\mathbf{x}}, \\mathcal{X}^{O P T}(\\boldsymbol{\\theta}, \\mathbf{u})\\right):=\\max _{\\mathbf{x} \\in \\mathcal{X}^{OPT}(\\boldsymbol \\theta, \\mathbf{u})} f(\\boldsymbol{\\theta}, \\hat{\\mathbf{x}})-f(\\boldsymbol{\\theta}, \\mathbf{x})
$$

**However, it can't be used here, because it will cause arbitrarily large AOG and POG**

### Example 1

Let : 

$\\mathbf {FO}(\\theta, u)$ be: 

#### (7)

$$
\\begin{aligned} 
\\text{min } & \\theta_{1} x_{1}+\\theta_{2} x_{2} \\\\ 
\\text { s.t. } & x_{1}+u x_{2} \\geq u \\\\ 
& 0 \\leq x_{1} \\leq u \\\\ 
& 0 \\leq x_{2} \\leq 2
\\end{aligned}
$$

- $\\boldsymbol \\theta ^* = (\\cos\\dfrac{\\pi}{4},\\sin\\dfrac{\\pi}{4})$
- $\\mathcal U = \\{u\\}$
  - $u > 1$, real constant
- $\\mathcal D = \\{\\hat{\\mathbf x_k}, u\\}^N_{k=1} $
  - $\\hat{\\mathbf x_k} = \\tilde {\\mathbf x}(\\hat{\\boldsymbol \\theta _k},u)$
    - $\\hat{\\boldsymbol \\theta _k}$ uniformly, independently drawn from $\\boldsymbol \\Theta = \\{(\\cos\\delta ,\\sin\\delta )\\mid \\delta \\in(0,\\dfrac{\\pi}{2})\\}$ for all $k\\in[N]$

### Lemma 1
> $ \\overline{\\boldsymbol{\\theta}}_{N} $ : an optimal solution to $ \\mathbf{I O}(\\mathcal{D}) $ with the sub-optimality loss [(6)](#6), we have:
>  $ \\mathbb{P}\\left(\\overline{\\boldsymbol{\\theta}}_{N}=\\boldsymbol{\\theta}_{u}\\right) \\rightarrow $ $ as $ N \\rightarrow \\infty $
> - $ \\boldsymbol{\\theta}_{u}:=\\left(1 / \\sqrt{1+u^{2}}, u / \\sqrt{1+u^{2}}\\right) $.

[Skip the proof](#end-proof-of-lemma-1)

#### Proof of Lemma 1

Let : $\\delta_u := \\arccos(\\dfrac{1}{\\sqrt{1+u^2}})$
- $\\cos\\delta_u = \\dfrac{1}{\\sqrt{1+u^2}}, \\sin\\delta_u = \\dfrac{u}{\\sqrt{1+u^2}}$ 
  - when $ \\hat{\\boldsymbol{\\theta}}_{k} \\in \\boldsymbol{\\Theta}_{1}:= $ $ \\left\\{(\\cos \\delta, \\sin \\delta) \\mid \\delta \\in\\left(0, \\delta_{u}\\right]\\right\\} $, $ \\hat{\\mathbf{x}}_{k}=\\tilde{\\mathbf{x}}\\left(\\hat{\\boldsymbol{\\theta}}_{k}, u\\right)=(0,1) $ almost surely. (Notice the slope)
  - When $ \\hat{\\boldsymbol{\\theta}}_{k} \\in \\boldsymbol{\\Theta}_{2}:= $ $ \\left\\{(\\cos \\delta, \\sin \\delta) \\mid \\delta \\in\\left(\\delta_{u}, \\pi / 2\\right)\\right\\} $, $ \\hat{\\mathbf{x}}_{k}=\\tilde{\\mathbf{x}}\\left(\\hat{\\boldsymbol{\\theta}}_{k}, u\\right)=(u, 0) $ almost surely. (Notice the slope)

Notice:

$\\hat{\\boldsymbol{\\theta}} \\in \\boldsymbol{\\Theta}=\\boldsymbol{\\Theta}_{1} \\cup \\boldsymbol{\\Theta}_{2}$

Then:

##### ($5)

$ \\hat{\\mathbf{x}}_{k}=\\left\\{\\begin{array}{l}(0,1), \\text { w.p. } 2 \\delta_{u} / \\pi \\\\ (u, 0), \\text { w.p. }\\left(\\pi-2 \\delta_{u}\\right) / \\pi\\end{array}\\right. $

$N_1$ : the numbers of $(0,1)$ in $\\mathcal D$

$N_1$ : the numbers of $(u,0)$ in $\\mathcal D$
- $\\mathcal D = \\{\\mathbf u_k,\\hat{\\mathbb x_k}\\}_{k\\in[N]}$

For $\\mathbf {IO}(\\mathcal D)$ :

##### (16)

$ \\overline{\\boldsymbol{\\theta}}_{N}:=\\underset{\\boldsymbol{\\theta} \\in \\boldsymbol{\\Theta}}{\\operatorname{argmin}} \\frac{N_{1}}{N} l_{1}(\\boldsymbol{\\theta})+\\frac{N_{2}}{N} l_{2}(\\boldsymbol{\\theta}) $


##### (17)
- $ l_{1}(\\boldsymbol{\\theta})=\\left\\{\\begin{array}{ll}0, & \\text { if } \\boldsymbol{\\theta} \\in \\boldsymbol{\\Theta}_{1} \\\\ \\theta_{2}-u \\theta_{1}, & \\text { if } \\boldsymbol{\\theta} \\in \\boldsymbol{\\Theta}_{2}\\end{array}\\right. $

##### (18)
- $ l_{2}(\\boldsymbol{\\theta})=\\left\\{\\begin{array}{ll}u \\theta_{1}-\\theta_{2}, & \\text { if } \\boldsymbol{\\theta} \\in \\boldsymbol{\\Theta}_{1}, \\\\ 0, & \\text { if } \\boldsymbol{\\theta} \\in \\boldsymbol{\\Theta}_{2} .\\end{array}\\right. $

Now discuss:

- When $N_1 > 0, N_2 > 0$ The minimum is $0$, occurs at $\\boldsymbol \\theta = (\\cos\\theta_u,\\sin\\delta_u)$
- $N_2 = 0$ : The minimum is $0$, occurs at $\\boldsymbol \\theta\\in\\boldsymbol \\Theta _1$
- $N_1 = 0$ : The minimum is $0$, occurs at $\\boldsymbol \\theta \\in\\boldsymbol \\Theta _2$

Then :


##### ($9)

$ \\mathbb{P}\\left(N_{1} N_{2}>0\\right) \\leq \\mathbb{P}\\left(\\overline{\\boldsymbol{\\theta}}_{N}=\\left(\\cos \\delta_{u}, \\sin \\delta_{u}\\right)\\right) \\leq 1 $

With the probability distribution in [(15)](#15), and $\\mathcal D$ is generated i.i.d. from $\\mathbb P_\\theta $:

##### (20)

$ \\mathbb{P}\\left(N_{1} N_{2}>0\\right)=1-\\left(\\dfrac{2 \\delta_{u}}{\\pi}\\right)^{N}-\\left(1-\\dfrac{2 \\delta_{u}}{\\pi}\\right)^{N} $

it converges to $1$ as $N$ goes to infinity

So $ \\mathbb{P}\\left(\\overline{\\boldsymbol{\\theta}}_{N}=\\left(\\cos \\delta_{u}, \\sin \\delta_{u}\\right)\\right) $ converges to 1 as $N $ goes to infinity (Squeeze Theorem)

#### End Proof of Lemma 1

Notice $\\boldsymbol \\theta ^* \\ne \\boldsymbol \\theta _u$, then AOG and PGO can be arbitrarily large

### Proposition 1

> In Example 1, Let: 
> $ \\overline{\\mathbf{x}}_{\\mathrm{IO}}(u)=\\tilde{\\mathbf{x}}\\left(\\boldsymbol{\\theta}_{u}, u\\right) $. 
> Then:
> For any $ v \\in \\mathbb{R}_{+} $there exists some $ \\bar{u}>1 $ such that: 
> $ \\mathrm{AOG}\\left(\\overline{\\mathrm{x}}_{\\mathrm{IO}}\\right)>v $ and $ \\mathrm{POG}\\left(\\overline{\\mathrm{x}}_{\\mathrm{IO}}\\right)>v $ for any $ u>\\bar{u} $

[Skip the proof](#end-proof-for-proposition-1)



#### Proof for Proposition 1

##### Lemma 4

> In Example 1, Let: 
> $ \\overline{\\mathbf{x}}_{\\mathrm{IO}}(u)=\\tilde{\\mathbf{x}}\\left(\\boldsymbol{\\theta}_{u}, u\\right) $. 
> For any $ v \\in \\mathbb{R}_{+} $there exists some $ \\bar{u}>1 $, such that: 
> $ \\operatorname{AOG}\\left(\\overline{\\mathrm{x}}_{\\mathrm{IO}}\\right)>v $ for any $ u>\\bar{u}_{A O G} $.

###### Proof for lemma 4

According to the definition of $\\bar{\\mathbf  x}$, we know that:

$\\bar{\\mathbf x_{IO}}(u)$ is uniformly drawn from:

###### (21)

$ \\mathcal{X}^{\\mathrm{OPT}}\\left(\\boldsymbol{\\theta}_{u}, u\\right)=\\left\\{\\left.\\left(\\frac{u t}{\\sqrt{u^{2}+1}}, 1-\\frac{t}{\\sqrt{u^{2}+1}}\\right) \\right\\rvert\\, t \\in\\left[0, \\sqrt{u^{2}+1}\\right]\\right\\} $

Since:

$\\boldsymbol \\theta ^* = (\\cos\\dfrac{\\pi}{4},\\sin\\dfrac{\\pi}{4})$ : ground-truth
$\\mathbf x^* = (0,1)$: true optimal solution

$\\tilde f(\\boldsymbol \\theta ^*,u) = \\dfrac{\\sqrt 2}{2}$

Then :

###### (22)

$$
\\begin{aligned}
&\\operatorname{AOG}\\left(\\overline{\\mathrm{x}}_{\\mathrm{IO}}\\right)\\\\ 
&=  \\mathbb{E}\\left[f\\left(\\boldsymbol{\\theta}^{*}, \\overline{\\mathbf{x}}_{\\mathrm{IO}}(\\mathbf{u})\\right)-f\\left(\\boldsymbol{\\theta}^{*}, \\tilde{\\mathbf{x}}\\left(\\boldsymbol{\\theta}^{*}, \\mathbf{u}\\right)\\right)\\right]  \\\\
&=\\int_{0}^{\\sqrt{u^{2}+1}} \\frac{\\sqrt{2}}{2 \\sqrt{u^{2}+1}}\\left(\\frac{u t}{\\sqrt{u^{2}+1}} + 1-\\frac{t}{\\sqrt{u^{2}+1}}\\right) d t-\\frac{\\sqrt{2}}{2}\\\\ 
&=\\frac{\\sqrt{2}(u-1)}{4}
\\end{aligned}
$$

Therefore:

For any $v\\in\\mathbb R_+$, exists:

$\\bar{u}_{\\mathrm{AOG}} = 2\\sqrt 2v + 1$, s.t.:

$\\mathrm{AOG} (\\bar{\\mathbf x}_{\\mathrm{IO}}) > v1, for any 1u > \\bar{u}_{\\mathrm{AOG}}$


###### End proof for lemma 4

##### Lemma 5

> In Example 1, let:  
> $ \\overline{\\mathbf{x}}_{\\mathrm{IO}}(u)=\\tilde{\\mathbf{x}}\\left(\\boldsymbol{\\theta}_{u}, u\\right) $. 
> for any $ v \\in \\mathbb{R}_{+} $there exists some $ \\bar{u}_{P O G}>1 $ such that :
> $ \\mathrm{POG}\\left(\\overline{\\mathrm{x}}_{\\mathrm{IO}}\\right)>v $ for any $ u>\\bar{u}_{\\text {POG }} $.

[Skip the proof](#end-proof-for-lemma-5)

###### Proof for lemma 5

According to the definition of $\\tilde {\\mathbf x}$, $\\bar{\\mathbf x}_{\\mathrm{IO}(u)}$ is uniformly drawn from:

###### (23)

$\\mathcal{X}^{\\mathrm{OPT}}\\left(\\boldsymbol{\\theta}_{u}, u\\right)=\\left\\{\\left.\\left(\\frac{u t}{\\sqrt{u^{2}+1}}, 1-\\frac{t}{\\sqrt{u^{2}+1}}\\right) \\right \\rvert\\, t \\in\\left[0, \\sqrt{u^{2}+1}\\right]\\right\\} $

Similarly, we have:

When $\\hat{\\boldsymbol{\\theta}} \\in \\boldsymbol{\\Theta}_{1}:=\\left\\{(\\cos \\delta, \\sin \\delta) \\mid \\delta \\in\\left(0, \\delta_{u}\\right]\\right\\}$, we have: 

$\\hat{\\mathbf{x}}_{k}=\\tilde{\\mathbf{x}}(\\hat{\\boldsymbol{\\theta}}, u)=(0,1)$,  with $\\tilde{f}(\\hat{\\boldsymbol{\\theta}}, u)=\\hat{\\theta}_{2}$ almost surely; 

When $\\hat{\\boldsymbol{\\theta}} \\in \\Theta_{2}:=\\left\\{(\\cos \\delta, \\sin \\delta) \\mid \\delta \\in\\left(\\delta_{u}, \\pi / 2\\right\\}\\right.$, we have : 

$\\hat{\\mathbf{x}}_{k}=\\tilde{\\mathbf{x}}(\\hat{\\boldsymbol{\\theta}}, u)=(u, 0)$ with $\\tilde{f}(\\hat{\\boldsymbol{\\theta}}, u)=u \\hat{\\theta}_{1}$ almost surely. 

Since the optimal solution drawn from $\\mathcal{X}^{\\mathrm{OPT}}\\left(\\boldsymbol{\\theta}_{u}, u\\right)$ is independent of the DM's perception $\\hat{\\boldsymbol{\\theta}}$, we have:

$$
\\begin{aligned}
&\\operatorname{POG}(\\overline{\\mathbf{x}}_{\\mathrm{IO}})\\\\ 
&=\\mathbb{E}[f(\\hat{\\boldsymbol{\\theta}}, \\overline{\\mathbf{x}}_{\\mathrm{IO}}(\\mathbf{u}))-f(\\hat{\\boldsymbol{\\theta}}, \\tilde{\\mathbf{x}}(\\hat{\\boldsymbol{\\theta}}, \\mathbf{u}))]\\\\ 
&= \\int_{0}^{\\delta_{u}} \\int_{0}^{\\sqrt{u^{2}+1}} \\frac{1}{\\sqrt{u^{2}+1}}\\left[\\frac{u t}{\\sqrt{u^{2}+1}} \\cos \\delta+\\left(1-\\frac{t}{\\sqrt{u^{2}+1}}\\right) \\sin \\delta-\\sin \\delta\\right] d t d \\delta \\\\ 
& +\\int_{\\delta_{u}}^{\\pi / 2} \\int_{0}^{\\sqrt{u^{2}+1}} \\frac{1}{\\sqrt{u^{2}+1}}\\left[\\frac{u t}{\\sqrt{u^{2}+1}} \\cos \\delta+\\left(1-\\frac{t}{\\sqrt{u^{2}+1}}\\right) \\sin \\delta-u \\cos \\delta\\right] d t d \\delta \\\\ 
&= \\frac{1}{2} \\int_{0}^{\\delta_{u}}(u \\cos \\delta-\\sin \\delta) d \\delta+\\frac{1}{2} \\int_{\\delta_{u}}^{\\pi / 2}(-u \\cos \\delta+\\sin \\delta) d \\delta \\\\ 
&= \\sqrt{1+u^{2}}-\\frac{u+1}{2} . \\\\ 
&> \\frac{u-1}{2} \\text{ (notice: } \\sqrt{1+u^2}>u\\text{)}
\\end{aligned}
$$

Therefore, for any $\\in\\mathbb R_+$, exists:

$\\bar{u}_{\\mathrm{POG}}=2 v+1$, such that : 

$\\operatorname{POG}\\left(\\overline{\\mathbf{x}}_{\\mathrm{IO}}\\right)>v$ , for any $u>\\bar{u}_{\\mathrm{POG}}$.

###### End proof for lemma 5

#### End proof for proposition 1

## Robustify the Inverse Optimization Pipeline 

- not solve $\\mathbf{FO}$ with some estimated parameters $\\bar{\\boldsymbol \\theta}$ 

- solve **robust forward optimization problem** with an uncertainty set around $\\bar{\\boldsymbol \\theta }$ :

#### (8)

$\\boldsymbol{\\mathbf  { R F O }}(\\mathcal{C}(\\overline{\\boldsymbol{\\theta}}, \\boldsymbol{\\alpha}), \\mathbf{u}): \\underset{\\mathbf{x} \\in \\mathcal{X}(\\mathbf{u})}{\\operatorname{min}} \\underset{\\boldsymbol{\\theta} \\in \\mathcal{C}(\\overline{\\boldsymbol{\\theta}}, \\boldsymbol{\\alpha})}{\\operatorname{max}} f(\\boldsymbol{\\theta}, \\mathbf{x})$
- $\\mathcal C $: uncertainty set
  - $\\bar{\\boldsymbol \\theta }$: center
  - $\\boldsymbol \\alpha $ : parameters that control the shape / size
- Since $f$ is linear in $\\boldsymbol \\theta $, then:

#### (9)
- $\\mathcal{C}(\\overline{\\boldsymbol{\\theta}}, \\alpha):=\\left\\{\\boldsymbol{\\theta} \\in \\mathbb{R}^{d} \\mid\\|\\boldsymbol{\\theta}\\|_{2}=1, \\boldsymbol{\\theta}^{\\top} \\overline{\\boldsymbol{\\theta}} \\geq \\cos \\alpha\\right\\}$
  - $\\alpha\\in(0,\\pi)$

### Remark 1

TODO

### Lemma 2

> In Example 1, let:  
> $\\overline{\\mathbf{x}}_{\\mathrm{CIO}}(u)$ be an optimal solution to $\\mathbf{R F O}\\left(\\mathcal{C}\\left(\\overline{\\boldsymbol{\\theta}}_{N}, \\alpha\\right)\\right. , u)$
> - $\\overline{\\boldsymbol{\\theta}}_{N}$ is an optimal solution to $\\mathbf{I O}(\\mathcal{D})$ with the sub-optimality loss [(6)](#6).
> 
> When $\\alpha \\in(0, \\pi / 2)$, we have :
> $\\mathbb{P}\\left[\\mathrm{AOG}\\left(\\mathbf{x}_{\\mathrm{CIO}}\\right)=0\\right] \\rightarrow 1$ and $\\mathbb{P}\\left[\\mathrm{POG}\\left(\\overline{\\mathbf{x}}_{\\mathrm{CIO}}\\right)<\\pi / 2 \\sqrt{2}\\right] \\rightarrow 1$ as $N \\rightarrow \\infty$.

#### Proof of lemma 2

TODO

# Conformal Inverse Optimization

## Learning an Uncertainty Set

### Data split

Split $\\mathcal D$ into:

$\\mathcal D_{\\text{train}}, \\mathcal D _{\\text{val}}$, 

Let :

$\\mathcal{K}_{\\text {train }}$ and $\\mathcal{K}_{\\text {val }}$ index $\\mathcal{D}_{\\text {train }}$ and $\\mathcal{D}_{\\text {val }}$,

 $N_{\\text {train }}=\\left|\\mathcal{D}_{\\text {train }}\\right|$ and $N_{\\text {val }}=\\left|\\mathcal{D}_{\\text {val }}\\right|$.

### Point estimation 

Given training set $\\mathcal D_{\\text{train}}$, we obtain a **point estimation** $\\bar{\\boldsymbol \\theta } $ of the unknown parameters

### Uncertainty set calibration

Given a point estimation $\\bar{\\boldsymbol \\theta } $, we solve the following **calibration problem **

#### (10)

$\\begin{aligned} \\mathbf{C P}\\left(\\overline{\\boldsymbol{\\theta}}, \\mathcal{D}_{\\text {val }}, \\gamma\\right): \\underset{\\alpha,\\left\\{\\boldsymbol{\\theta}_{k}\\right\\}_{k \\in \\mathcal{K}_{\\text {val }}}}{\\operatorname{min}} & \\alpha \\\\ \\text { s.t. } & \\hat{\\mathbf{x}}_{k} \\in \\mathcal{X}^{\\mathrm{OPT}}\\left(\\boldsymbol{\\theta}_{k}, \\mathbf{u}_{k}\\right), \\forall k \\in \\mathcal{K}_{\\text {val }} \\\\ & \\sum_{k \\in \\mathcal{K}_{\\text {val }}} \\mathbb{1}\\left[\\boldsymbol{\\theta}_{k} \\in \\mathcal{C}(\\overline{\\boldsymbol{\\theta}}, \\alpha)\\right] \\geq \\gamma\\left(N_{\\text {val }}+1\\right) \\\\ & \\left\\|\\boldsymbol{\\theta}_{k}\\right\\|_{2}=1, \\forall k \\in \\mathcal{K}_{\\text {val }} \\\\ & 0 \\leq \\alpha \\leq \\pi,\\end{aligned}$

- $\\alpha$ controls the size of the uncertainty set 
- $\\boldsymbol \\theta _k $ represent a possible parameter vecto
r associated with $k\\in\\mathcal K_\\text{val}$
- $\\gamma \\in[0,1]$ is a DM-specefied confidence level

How to decompose:

### Theorem 1

>Let: 
> $\\mathcal{D}_{\\mathrm{val}}$ be a dataset, $\\gamma \\in[0,1], \\overline{\\boldsymbol{\\theta}} \\in \\mathbb{R}^{d}, \\tau=\\left\\lceil\\gamma\\left(N_{\\mathrm{val}}+1\\right)\\right\\rceil$ , $\\Gamma_{\\tau}$ be an operator that returns the $\\tau^{\\text {th }}$ largest value in a set. 
> The optimal solution to $\\mathbf{C P}\\left(\\overline{\\boldsymbol{\\theta}}, \\mathcal{D}_{\\text {val }}, \\gamma\\right)$ is: 
> $\\alpha_{\\gamma}:=\\arccos \\left(\\Gamma_{\\tau}\\left(\\left\\{c_{k}\\right\\}_{k \\in \\mathcal{K}_{\\text {vel }}}\\right)\\right)$ 
> - $c_{k}:=\\max _{\\boldsymbol{\\theta}_{k}}\\left\\{\\boldsymbol{\\theta}_{k}^{\\top} \\overline{\\boldsymbol{\\theta}} \\mid \\hat{\\mathbf{x}}_{k} \\in \\mathcal{X}^{\\mathrm{OPT}}\\left(\\boldsymbol{\\theta}_{k}, \\mathbf{u}_{k}\\right),\\left\\|\\boldsymbol{\\theta}_{k}\\right\\|_{2} \\leq 1\\right\\}$.

[Skip the proof](#end-proof-of-theorem-1)

#### Proof of Theorem 1

Define:

$\\hat{\\boldsymbol{\\Theta}}_{k}:=\\boldsymbol{\\Theta}^{\\mathrm{OPT}}\\left(\\mathbf{u}_{k}, \\hat{\\mathbf{x}}_{k}\\right)$ for any $k \\in[N]$

we can optimize:

$c:=\\cos \\alpha $, with $-1\\le c \\le 1$

Introduce:

$y_k\\in\\{0,1\\}$ that :
- $\\hat{\\boldsymbol{\\Theta}}_{k}$intersect learned uncertainty set ( $=1$)
- not intersect : ($=0$)
  - for any $k\\in\\mathcal K_{\\text{val}}$

We rewrite [(10)](#10):

##### (39)

$\\begin{aligned} \\max_{c,\\{\\boldsymbol \\theta _k\\}_{k\\in\\mathcal K_{\\text{val}}},\\{y_k\\}_{k\\in\\mathcal K_{\\text{val}}}}& c \\\\ \\text { s.t. } & \\hat{\\mathbf{x}}_{k} \\in \\mathcal{X}^{\\mathrm{OPT}}\\left(\\boldsymbol{\\theta}_{k}, \\mathbf{u}_{k}\\right), \\quad \\forall k \\in \\mathcal{K}_{\\text {val }} \\\\ & \\boldsymbol{\\theta}_{k}^{\\top} \\overline{\\boldsymbol{\\theta}} \\geq c+2\\left(y_{k}-1\\right), \\quad \\forall k \\in \\mathcal{K}_{\\text {val }} \\\\ & \\sum_{k \\in \\mathcal{K}_{\\text {val }}} y_{k} \\geq\\left\\lceil\\gamma\\left(N_{\\text {val }}+1\\right)\\right\\rceil \\\\ & \\left\\|\\boldsymbol{\\theta}_{k}\\right\\|_{2}=1, \\quad \\forall k \\in \\mathcal{K}_{\\text {val }} \\\\ & -1 \\leq c \\leq 1 \\\\ & y_{k} \\in\\{0,1\\}, \\quad \\forall k \\in \\mathcal{K}_{\\text {val }} .\\end{aligned}$

Notice decision variables $\\boldsymbol \\theta _k$ only interact in secont constraint, we can rewrite:

##### (40)

$\\begin{array}{ll}\\operatorname{max} & c \\\\ \\text { s.t. } & c \\leq c_{k}-2\\left(y_{k}-1\\right), \\quad \\forall k \\in \\mathcal{K}_{\\text {val }} \\\\ & \\sum_{k \\in \\mathcal{K}_{\\text {val }}} y_{k} \\geq\\left\\lceil\\gamma\\left(N_{\\text {val }}+1\\right)\\right\\rceil \\\\ & -1 \\leq c \\leq 1 \\\\ & y_{k} \\in\\{0,1\\}, \\quad \\forall k \\in \\mathcal{K}_{\\text {val }},\\end{array}$

where:


##### (41)

$\\begin{aligned} c_{k}:=\\underset{\\boldsymbol{\\theta}_{k}}{\\max } & \\boldsymbol{\\theta}_{k}^{\\top} \\overline{\\boldsymbol{\\theta}} \\\\ \\text { s.t. } & \\hat{\\mathbf{x}}_{k} \\in \\mathcal{X}^{\\mathrm{OPT}}\\left(\\boldsymbol{\\theta}_{k}, \\mathbf{u}_{k}\\right) \\\\ & \\left\\|\\boldsymbol{\\theta}_{k}\\right\\|_{2} \\leq 1\\end{aligned}$

Notice: optimal solution for [(40)](#40) is:

- $y_k = 1$, for all $k$ s.t. $c_{k} \\geq \\Gamma_{\\tau}\\left(\\left\\{c_{k}\\right\\}_{k \\in \\mathcal{K}_{\\text {val }}}\\right)$
- $y_k = 0$, otherwise
  - $\\tau = \\dfrac{\\gamma (N_{\\text{val}}+1)}{N_{\\text{val}}}$
  - $\\gamma _{\\tau}(\\{c_k\\})$: quantile function

Therefore : 

Optimal objective value of [(40)](#40) is :

$c=\\Gamma_{\\tau}\\left(\\left\\{c_{k}\\right\\}_{k \\in \\mathcal{K}_{\\mathrm{val}}}\\right)$

That is :

$\\alpha_{\\gamma}=\\arccos \\Gamma_{\\tau}\\left(\\left\\{c_{k}\\right\\}_{k \\in \\mathcal{K}_{\\mathrm{val}}}\\right)$

#### End proof of theorem 1

## Properties of Conformal IO

### Theorem 2 (Uncertainty Set Validity)

> Let: 
> $\\mathcal{D}_{\\text {val }}$ : a dataset that satisfies Assumption 1, 
> $(\\hat{\\boldsymbol{\\theta}}, \\mathbf{u})$ : a new i.i.d. sample from $\\mathbb{P}_{(\\boldsymbol{\\theta}, \\mathbf{u})}$,
> $\\hat{\\mathbf{x}}=\\tilde{\\mathbf{x}}(\\hat{\\boldsymbol{\\theta}}, \\mathbf{u})$, 
> $\\hat{\\boldsymbol{\\Theta}}:=\\boldsymbol{\\Theta}^{\\mathrm{OPT}}(\\hat{\\mathbf{x}}, \\mathbf{u})$, 
>  $\\alpha_{\\gamma}$ be an optimal solution to : 
> $\\mathbf{C P}\\left(\\overline{\\boldsymbol{\\theta}}, \\mathcal{D}_{\\text {val }}, \\gamma\\right)$ 
> - $\\overline{\\boldsymbol{\\theta}} \\in \\mathbb{R}^{d}$
> We have:
> #### (11)
> $\\mathbb{P}\\left(\\hat{\\boldsymbol{\\Theta}} \\cap \\mathcal{C}\\left(\\overline{\\boldsymbol{\\theta}}, \\alpha_{\\gamma}\\right) \\neq \\varnothing\\right) \\geq \\gamma$
> - for any $\\gamma \\in\\left[0, N_{\\text {val }} /\\left(N_{\\text {val }}+1\\right)\\right]$
> #### (12)
> $\\left|\\mathbb{P}\\left(\\hat{\\boldsymbol{\\Theta}} \\cap \\mathcal{C}\\left(\\overline{\\boldsymbol{\\theta}}, \\alpha_{\\gamma}\\right) \\neq \\varnothing\\right)-\\gamma\\right| \\leq \\sqrt{\\frac{8 \\log \\left(N_{v a l}+1\\right)+2 \\log N_{v a l}}{N_{v a l}}}+\\frac{2}{N_{v a l}}$
> - with probability at least $1-\\dfrac 1 N_{\\text {val }}$
> for any $\\gamma \\in[0,1 ]$

[Skip the proof](#proof-of-theorem-2)

#### Proof of Theorem 2

We define:

##### (42)
 
$ \\begin{aligned} A_{\\overline{\\boldsymbol{\\theta}}}(\\hat{\\mathbf{x}}, \\mathbf{u}):=\\underset{\\boldsymbol{\\theta}}{\\operatorname{max }} & \\boldsymbol{\\theta}^{\\mathrm{\\top}} \\overline{\\boldsymbol{\\theta}} \\\\ \\text { s.t.  } & \\boldsymbol{\\theta} \\in \\boldsymbol{\\Theta}^{\\mathrm{OPT}}(\\hat{\\mathbf{x}}, \\mathbf{u}) \\\\ & \\|\\boldsymbol{\\theta}\\|_{2} \\leq 1 .\\end{aligned} $

Notice:

$ c_{k}=A_{\\overline{\\boldsymbol{\\theta}}}\\left(\\hat{\\mathbf{x}}_{k}, \\mathbf{u}_{k}\\right) $ for any $ k \\in \\mathcal{K}_{\\text {val }} $
- $c_k$ is defined in [Theorem 1](#theorem-1)

Let:


$\\tau = [\\gamma (N_{\\text{val }}+1)]$

$ \\mathcal{A}:=\\left\\{A_{\\overline{\\boldsymbol{\\theta}}}\\left(\\hat{\\mathbf{x}}_{k}, \\mathbf{u}_{k}\\right)\\right\\}_{k \\in \\mathcal{K}_{\\mathrm{val}}} $

Then: 

##### (43)

$ \\mathbb{P}\\left(\\boldsymbol{\\Theta}^{\\mathrm{OPT}}(\\hat{\\mathbf{x}}, \\mathbf{u}) \\cap \\mathcal{C}(\\overline{\\boldsymbol{\\theta}}, \\alpha) \\neq \\varnothing\\right)=\\mathbb{P}\\left(A_{\\overline{\\boldsymbol{\\theta}}}(\\hat{\\mathbf{x}}, \\mathbf{u}) \\geq \\Gamma^{\\tau}(\\mathcal{A})\\right) $

Let : 

$ \\mathcal{D}^{\\prime}=\\mathcal{D}_{\\text {val }} \\cup\\{(\\hat{\\mathbf{x}}, \\mathbf{u})\\} $

$ \\mathcal{A}^{\\prime}=\\mathcal{A} \\cup\\left\\{A_{\\overline{\\boldsymbol{\\theta}}}(\\hat{\\mathbf{x}}, \\mathbf{u})\\right\\} $

Then : 

$ \\begin{aligned} \\gamma & \\leq \\mathbb{P}\\left\\{A_{\\overline{\\boldsymbol{\\theta}}}(\\hat{\\mathbf{x}}, \\mathbf{u}) \\geq \\Gamma^{\\tau}\\left(\\mathcal{A}^{\\prime}\\right)\\right\\} \\\\ & =1-\\mathbb{P}\\left\\{A_{\\overline{\\boldsymbol{\\theta}}}(\\hat{\\mathbf{x}}, \\mathbf{u})<\\Gamma^{\\tau}\\left(\\mathcal{A}^{\\prime}\\right)\\right\\} \\\\ & =1-\\mathbb{P}\\left\\{A_{\\overline{\\boldsymbol{\\theta}}}(\\hat{\\mathbf{x}}, \\mathbf{u})<\\Gamma^{\\tau}(\\mathcal{A})\\right\\} \\\\ & =\\mathbb{P}\\left\\{A_{\\overline{\\boldsymbol{\\theta}}}(\\hat{\\mathbf{x}}, \\mathbf{u}) \\geq \\Gamma^{\\tau}(\\mathcal{A})\\right\\} \\\\ & =\\mathbb{P}\\left\\{\\boldsymbol{\\Theta}^{\\mathrm{OPT}}(\\hat{\\mathbf{x}}, \\mathbf{u}) \\cap \\mathcal{C}(\\overline{\\boldsymbol{\\theta}}, \\alpha) \\neq \\varnothing\\right\\}\\end{aligned} $


Next, Let:

$ z_{k}:=\\left(\\mathbf{u}_{k}, \\hat{\\mathbf{x}}_{k}\\right), \\mathcal{Z}:= $ $ \\left\\{z_{k}\\right\\}_{k \\in \\mathcal{K}_{\\text {val }}} $

Define:

##### (44)

$ \\mathcal{H}=\\left\\{h(z, \\alpha)=\\mathbb{1}\\left[\\boldsymbol{\\Theta}^{\\mathrm{OPT}}(\\hat{\\mathbf{x}}, \\mathbf{u}) \\cap \\mathcal{C}(\\overline{\\boldsymbol{\\theta}}, \\alpha)\\right] \\mid \\alpha \\in(0, \\pi)\\right\\} $

##### (36)

$ \\Pi_{\\mathcal{H}}(N):=\\max _{\\left(Z_{1}, Z_{2}, \\ldots, Z_{N}\\right) \\in \\mathcal{Z}^{N}}\\left|\\left\\{\\left(h\\left(Z_{1}\\right), h\\left(Z_{2}\\right), \\ldots, h\\left(Z_{N}\\right)\\right) \\mid h \\in \\mathcal{H}\\right\\}\\right| $

We can see:

##### (45)

$ \\Pi_{\\mathcal{H}}\\left(N_{\\mathrm{val}}\\right)=N_{\\mathrm{val}}+1 $

##### Lemma 9

> Let $ \\mathcal{H} $ be a class of functions taking values in $ \\{1,-1\\} $, 
> Then, for any integer $ N \\geq 1 $, the following holds
> $
\\Re_{N}(\\mathcal{H}) \\leq \\sqrt{\\frac{2 \\log \\Pi_{\\mathcal{H}}(N)}{N}} .
$
##### (35)

> - $
\\mathfrak{R}_{N}(\\mathcal{F}):=\\mathbb{E}_{\\mathcal{D} \\sim \\mathbb{P}^{N}}\\left[\\hat{\\mathfrak{R}}_{\\mathcal{D}}(\\mathcal{F})\\right]
$

Then : 

$ \\gamma \\leq \\frac{1}{N_{\\text {val }}} \\sum_{k \\in \\mathcal{K}_{\\text {val }}} h\\left(z_{k}, \\alpha\\right) \\leq \\gamma+\\frac{2}{N_{\\text {val }}} $.

##### (46)

$ \\Re_{N_{\\mathrm{val}}}(\\mathcal{H}) \\leq \\sqrt{\\dfrac{2 \\log \\left(N_{\\mathrm{val}}+1\\right)}{N_{\\mathrm{val}}}} $

Notice, $\\alpha$ is the smallest value that:

##### (47)

$ \\dfrac{1}{N_{\\text {val }}} \\sum_{k \\in \\mathcal{K}_{\\text {val }}} h\\left(z_{k}, \\alpha\\right)=\\dfrac{1}{N_{\\text {val }}} \\sum_{k \\in \\mathcal{K}_{\\text {val }}} \\mathbb{1}\\left[\\boldsymbol{\\Theta}^{\\mathrm{OPT}}\\left(\\hat{\\mathbf{x}}_{k}, \\mathbf{u}_{k}\\right) \\cap \\mathcal{C}(\\overline{\\boldsymbol{\\theta}}, \\alpha)\\right]=\\dfrac{\\left\\lceil\\gamma\\left(N_{\\text {val }}+1\\right)\\right\\rceil}{N_{\\text {val }}} $

So:

$ \\gamma \\leq \\dfrac{1}{N_{\\text {val }}} \\sum_{k \\in \\mathcal{K}_{\\text {val }}} h\\left(z_{k}, \\alpha\\right) \\leq \\gamma+\\dfrac{2}{N_{\\text {val }}} $.

##### Lemma 10

> For any b-uniformly bounded class of functions $ \\mathcal{F} $, any positive integer $ N \\geq 1 $, and any scalar $ \\delta \\geq 0 $, 
> with probability at least:  
> $ 1-\\exp \\left(-N \\delta^{2} /\\left(2 b^{2}\\right)\\right) $, 
> we have : 
> $\\sup _{f \\in \\mathcal{F}}\\left|\\frac{1}{N} \\sum_{i \\in[N]} f\\left(X_{i}\\right)-\\mathbb{E}\\left[f\\left(X_{i}\\right)\\right]\\right| \\leq 2 \\mathfrak{R}_{N}(\\mathcal{F})+\\delta$  
> - $ \\mathfrak{R}(\\mathcal{F}) $ denotes the Rademacher complexity of the function class $ \\mathcal{F} $.

Then with probability at least $\\delta = 1 - \\dfrac{1}{N_\\text{val}}$ :

##### (50)

$ \\left|\\dfrac{1}{N_{\\text {val }}} \\sum_{k \\in \\mathcal{K}_{\\text {val }}} h\\left(z_{k}, \\alpha\\right)-\\mathbb{E}[h(z, \\alpha)]\\right| \\leq 2 \\mathfrak{R}_{N_{\\text {val }}}(\\mathcal{H})+\\sqrt{\\dfrac{2 \\log N_{\\text {val }}}{N_{\\text {val }}}} $

Combine [(46)](#46) - [(50)](#50) is all

#### End proof of Theorem 2

### Lemma 3

> For any : 
> $ \\hat{\\mathbf{x}} \\in \\tilde{\\mathbf{x}}(\\hat{\\boldsymbol{\\theta}}, \\mathbf{u}) $ and $ (\\hat{\\boldsymbol{\\theta}}, \\mathbf{u}) \\in \\boldsymbol{\\Theta} \\times \\mathcal{U} $, 
> there exists a constant : 
> $ \\nu(\\hat{\\mathbf{x}}) \\in \\mathbb{R}_{+} $ 
> such that, for any : 
> $ \\boldsymbol{\\theta}, \\boldsymbol{\\theta}^{\\prime} \\in \\boldsymbol{\\Theta} $, 
> we have : 
> $ f(\\boldsymbol{\\theta}, \\hat{\\mathbf{x}})-f\\left(\\boldsymbol{\\theta}^{\\prime}, \\hat{\\mathbf{x}}\\right) \\leq \\nu(\\hat{\\mathbf{x}})\\left\\|\\boldsymbol{\\theta}-\\boldsymbol{\\theta}^{\\prime}\\right\\|_{2} $

[Skip the proof](#end-proof-for-lemma-3)

#### Proof of Lemma 3

For any fixed $\\mathbb x$, we have:

$ \\begin{aligned} f(\\boldsymbol{\\theta}, \\hat{\\mathbf{x}})-f\\left(\\boldsymbol{\\theta}^{\\prime}, \\hat{\\mathbf{x}}\\right) & =\\sum_{i \\in[d]}\\left(\\theta_{i}-\\theta_{i}^{\\prime}\\right) f_{i}(\\hat{\\mathbf{x}}) \\\\ & \\leq \\sqrt{\\sum_{i \\in[d]} f_{i}^{2}(\\hat{\\mathbf{x}})} \\sqrt{\\sum_{i \\in[d]}\\left(\\theta_{i}-\\theta_{i}^{\\prime}\\right)^{2}} \\\\ & =\\nu(\\hat{\\mathbf{x}})\\left\\|\\boldsymbol{\\theta}-\\boldsymbol{\\theta}^{\\prime}\\right\\|_{2}\\end{aligned} $
- $ \\nu(\\hat{\\mathbf{x}}):=\\sqrt{\\sum_{i \\in[d]} f_{i}^{2}(\\hat{\\mathbf{x}})} $

#### End proof of lemma 3

### Theorem 3 (POG Bound)

> Let $ \\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u}) $ be an optimal solution to $ \\mathbf{R F O}\\left(\\mathcal{C}\\left(\\overline{\\boldsymbol{\\theta}}, \\alpha_{1}\\right), \\mathbf{u}\\right) $ for any $ \\mathbf{u} \\in \\mathcal{U} $ 
> - $ \\overline{\\boldsymbol{\\theta}} \\in \\mathbb{R}^{d} $ and $ \\alpha_{1} $ are chosen such that : 
>   - for a new sample : $ \\left(\\boldsymbol{\\theta}^{\\prime}, \\mathbf{u}^{\\prime}\\right) $ from $ \\mathbb{P}_{(\\boldsymbol{\\theta}, \\mathbf{u})} $ and $ \\mathbf{x}^{\\prime}=\\tilde{\\mathbf{x}}\\left(\\boldsymbol{\\theta}^{\\prime}, \\mathbf{u}^{\\prime}\\right) $, $ \\mathbb{P}\\left(\\mathcal{C}\\left(\\overline{\\boldsymbol{\\theta}}, \\alpha_{1}\\right) \\cap \\Theta^{\\mathrm{OPT}}\\left(\\mathbf{u}^{\\prime}, \\mathbf{x}^{\\prime}\\right) \\neq \\varnothing\\right)=1 $. 
> 
> If Assumptions [2](#assumption-2-bounded-inverse-feasible-set)-[3](#assumption-3-bounded-divergence) hold, then :
> $\\operatorname{POG}\\left(\\overline{\\mathbf{x}}_{\\mathrm{CIO}}\\right) \\leq\\left(\\eta-2 \\cos 2 \\alpha_{1}+2\\right) \\mu+\\eta \\mu_{\\mathrm{CIO}}$ 
> and 
> $\\mathrm{AOG}\\left(\\overline{\\mathbf{x}}_{\\mathrm{CIO}}\\right) \\leq\\left(2-2 \\cos 2 \\alpha_{1}+\\eta+\\sigma\\right) \\mu^{*}+(\\eta+\\sigma) \\mu_{\\mathrm{CIO}}$
> - $ \\mu:=\\mathbb{E}[\\nu(\\tilde{\\mathbf{x}}(\\hat{\\boldsymbol{\\theta}}, \\mathbf{u}))]$
> - $ \\mu_{\\mathrm{CIO}}:=\\mathbb{E}\\left(\\nu\\left[\\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right]\\right) $ 
> - $ \\mu^{*}:=\\mathbb{E}\\left(\\nu\\left[\\tilde{\\mathbf{x}}\\left(\\boldsymbol{\\theta}^{*}, \\mathbf{u}\\right)\\right]\\right) $.


#### Proof of Theorem 3

#### Proposition 2 (Conformal IO Achieves Bounded POG). 

> Let : 
> $ \\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u}) $ be an optimal solution to $ \\operatorname{RFO}\\left(\\mathcal{C}\\left(\\overline{\\boldsymbol{\\theta}}, \\alpha_{1}\\right), \\mathbf{u}\\right) $ for any $ \\mathbf{u} \\in \\mathcal{U} $ 
> - $ \\overline{\\boldsymbol{\\theta}} \\in \\mathbb{R}^{d} $ and $ \\alpha_{1} $ are chosen such that : 
>   - for a new sample $ \\left(\\boldsymbol{\\theta}^{\\prime}, \\mathbf{u}^{\\prime}\\right) $ from $ \\mathbb{P}_{(\\boldsymbol{\\theta}, \\mathbf{u})} $ and $ \\mathbf{x}^{\\prime}=\\tilde{\\mathbf{x}}\\left(\\boldsymbol{\\theta}^{\\prime}, \\mathbf{u}^{\\prime}\\right), \\mathbb{P}\\left(\\mathcal{C}\\left(\\overline{\\boldsymbol{\\theta}}, \\alpha_{1}\\right) \\cap \\boldsymbol{\\Theta}^{\\mathrm{OPT}}\\left(\\mathbf{u}^{\\prime}, \\mathbf{x}^{\\prime}\\right) \\neq \\varnothing\\right)=1 $. 
> 
> If Assumptions [2](#assumption-2-bounded-inverse-feasible-set)-[3](#assumption-3-bounded-divergence) hold, then: 
> $\\operatorname{POG}\\left(\\overline{\\mathbf{x}}_{\\mathrm{CIO}}\\right) \\leq\\left(\\eta-2 \\cos 2 \\alpha_{1}+2\\right) \\mu+\\eta \\mu_{\\mathrm{CIO}}$
> - $ \\mu:=\\mathbb{E}[\\nu(\\tilde{\\mathbf{x}}(\\hat{\\boldsymbol{\\theta}}, \\mathbf{u}))] $ 
> - $ \\mu_{\\mathrm{CIO}}:=\\mathbb{E}\\left(\\nu\\left[\\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right]\\right) $.

[Skip the proof](#end-proof-of-proposition-2)

##### Proof of Proposition 2

Let :  

$ (\\hat{\\boldsymbol{\\theta}}, \\mathbf{u}) $ be a sample from : 

$ \\mathbb{P}_{(\\boldsymbol{\\theta}, \\mathbf{u})}, \\hat{\\mathbf{x}}=\\tilde{\\mathbf{x}}(\\hat{\\boldsymbol{\\theta}}, \\mathbf{u}), $ 

$\\hat{\\boldsymbol{\\theta}}_{\\mathrm{CIO}}(\\mathbf{u}) $ be the optimal solution to the inner maximization problem in $ \\mathbf{R F O}\\left(\\mathcal{C}\\left(\\overline{\\boldsymbol{\\theta}}, \\alpha_{1}\\right), \\mathbf{u}\\right) $ 
- the outer decision variable is set to $ \\hat{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbb u)$

If : 

$ \\Theta^{\\mathrm{OPT}}(\\hat{\\mathbf{x}}, \\mathbf{u}) \\cap \\mathcal{C}\\left(\\overline{\\boldsymbol{\\theta}}, \\alpha_{1}\\right) \\neq \\varnothing $, 

let : 

$ \\tilde{\\boldsymbol{\\theta}} $ be an element of $ \\boldsymbol{\\Theta}^{\\mathrm{OPT}}(\\hat{\\mathbf{x}}, \\mathbf{u}) \\cap \\mathcal{C}\\left(\\overline{\\boldsymbol{\\theta}}, \\alpha_{1}\\right) $

We have:

$ \\begin{aligned} & f\\left(\\hat{\\boldsymbol{\\theta}}, \\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right)-f(\\hat{\\boldsymbol{\\theta}}, \\hat{\\mathbf{x}}) \\\\ \\leq & f\\left(\\tilde{\\boldsymbol{\\theta}}, \\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right)-f(\\tilde{\\boldsymbol{\\theta}}, \\hat{\\mathbf{x}})+\\left[\\nu(\\hat{\\mathbf{x}})+\\nu\\left(\\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right)\\right]\\|\\hat{\\boldsymbol{\\theta}}-\\tilde{\\boldsymbol{\\theta}}\\|_{2} \\\\ \\leq & f\\left(\\tilde{\\boldsymbol{\\theta}}, \\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right)-f(\\tilde{\\boldsymbol{\\theta}}, \\hat{\\mathbf{x}})+\\eta\\left[\\nu(\\hat{\\mathbf{x}})+\\nu\\left(\\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right)\\right] \\\\ \\leq & f\\left(\\overline{\\boldsymbol{\\theta}}_{\\mathrm{CIO}}(\\mathbf{u}), \\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right)-f(\\tilde{\\boldsymbol{\\theta}}, \\hat{\\mathbf{x}})+\\eta\\left[\\nu(\\hat{\\mathbf{x}})+\\nu\\left(\\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right)\\right] \\\\ \\leq & f\\left(\\hat{\\boldsymbol{\\theta}}_{\\mathrm{CIO}}(\\mathbf{u}), \\hat{\\mathbf{x}}\\right)-f(\\tilde{\\boldsymbol{\\theta}}, \\hat{\\mathbf{x}})+\\eta\\left[\\nu(\\hat{\\mathbf{x}})+\\nu\\left(\\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right)\\right] \\\\ \\leq & \\nu(\\hat{\\mathbf{x}})\\left\\|\\hat{\\boldsymbol{\\theta}}_{\\mathrm{CIO}}(\\mathbf{u})-\\tilde{\\boldsymbol{\\theta}}\\right\\|_{2}+\\eta\\left[\\nu(\\hat{\\mathbf{x}})+\\nu\\left(\\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right)\\right] \\\\ \\leq & 2 \\nu(\\hat{\\mathbf{x}})\\left(1-\\cos 2 \\alpha_{1}\\right)+\\eta\\left(\\nu(\\hat{\\mathbf{x}})+\\nu\\left[\\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right]\\right) \\\\ = & \\nu(\\hat{\\mathbf{x}})\\left(\\eta-2 \\cos 2 \\alpha_{1}+2\\right)+\\eta \\nu\\left[\\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right] .\\end{aligned} $

First line : [Lemma 3](#lemma-3)

Second line : [Assumption 2](#assumption-2-bounded-inverse-feasible-set)

Third line : Definition

Fourth line : $ \\left(\\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u}), \\overline{\\boldsymbol{\\theta}}_{\\mathrm{CIO}}(\\mathbf{u})\\right) $ is an optimal solution to $ \\boldsymbol{\\operatorname { R F O }}\\left(\\mathcal{C}\\left(\\overline{\\boldsymbol{\\theta}}, \\alpha_{1}\\right), \\mathbf{u}\\right) $

Fifth line : [Lemma 3](#lemma-3)

Sixth line : both $ \\hat{\\boldsymbol{\\theta}}_{\\mathrm{CIO}}(\\mathbf{u}) $ and $ \\tilde{\\boldsymbol{\\theta}} $ are in $ \\mathcal{C}\\left(\\overline{\\boldsymbol{\\theta}}, \\alpha_{1}\\right) $ so the angle between them is no larger than $ 2 \\alpha_{1} $. the $ L_{2} $ distance between them are bounded by $ 2\\left(1-\\cos 2 \\alpha_{1}\\right) $

Since $ \\alpha_{1} $ is chosen such that $ \\mathbb{P}\\left(\\boldsymbol{\\Theta}^{\\mathrm{OPT}}(\\hat{\\mathbf{x}}, \\mathbf{u}) \\cap \\mathcal{C}\\left(\\overline{\\boldsymbol{\\theta}}, \\alpha_{1}\\right)\\right)=1 $, we have ： 

$ \\begin{aligned} \\operatorname{POG}\\left(\\overline{\\mathbf{x}}_{\\mathrm{CIO}}\\right) & =\\mathbb{E}\\left[f\\left(\\hat{\\boldsymbol{\\theta}}, \\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right)-f(\\hat{\\boldsymbol{\\theta}}, \\hat{\\mathbf{x}})\\right] \\\\ & \\leq \\mathbb{E}\\left\\{\\nu(\\hat{\\mathbf{x}})\\left(\\eta-2 \\cos 2 \\alpha_{1}+2\\right)+\\eta \\nu\\left[\\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right]\\right\\} \\\\ & =\\mu\\left(\\eta-2 \\cos 2 \\alpha_{1}+2\\right)+\\eta \\mu_{\\mathrm{CIO}}\\end{aligned} $

- $ \\mu:=\\mathbb{E}[\\nu(\\hat{\\mathbf{x}})] $ 
- $ \\mu_{\\mathrm{CIO}}:=\\mathbb{E}\\left(\\nu\\left[\\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right]\\right) $

##### End Proof of Proposition 2

#### Proposition 3 (Conformal IO Achieves Bounded AOG). 

Let :

$ \\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u}) $ 

be an optimal solution to : 

$ \\operatorname{RFO}\\left(\\mathcal{C}\\left(\\overline{\\boldsymbol{\\theta}}, \\alpha_{1}\\right), \\mathbf{u}\\right) $ for any $ \\mathbf{u} \\in \\mathcal{U} $ 

- $ \\overline{\\boldsymbol{\\theta}} \\in \\mathbb{R}^{d} $ and $ \\alpha_{1} $ are chosen such that : 
  - for a new sample $ \\left(\\boldsymbol{\\theta}^{\\prime}, \\mathbf{u}^{\\prime}\\right) $ from $ \\mathbb{P}_{(\\boldsymbol{\\theta}, \\mathbf{u})} $ and $ \\mathbf{x}^{\\prime}=\\tilde{\\mathbf{x}}\\left(\\boldsymbol{\\theta}^{\\prime}, \\mathbf{u}^{\\prime}\\right), \\mathbb{P}\\left(\\mathcal{C}\\left(\\overline{\\boldsymbol{\\theta}}, \\alpha_{1}\\right) \\cap \\boldsymbol{\\Theta}^{\\mathrm{OPT}}\\left(\\mathbf{u}^{\\prime}, \\mathbf{x}^{\\prime}\\right) \\neq \\varnothing\\right)=1 $. 
  
If Assumptions [2](#assumption-2-bounded-inverse-feasible-set)-[3](#assumption-3-bounded-divergence) hold, then

$
\\operatorname{AOG}\\left(\\overline{\\mathbf{x}}_{\\mathrm{CIO}}\\right) \\leq\\left(2-2 \\cos 2 \\alpha_{1}+\\eta+\\sigma\\right) \\mu^{*}+(\\eta+\\sigma) \\mu_{\\mathrm{CIO}}
$
-  $ \\mu^{*}:=\\mathbb{E}\\left(\\nu\\left[\\tilde{\\mathbf{x}}\\left(\\boldsymbol{\\theta}^{*}, \\mathbf{u}\\right)\\right]\\right) $.

[Skip the proof](#end-proof-of-proposition-3)

##### Proof of Proposition 3


Let : 

$ (\\hat{\\boldsymbol{\\theta}}, \\mathbf{u}) $ be a sample from $ \\mathbb{P}_{(\\boldsymbol{\\theta}, \\mathbf{u})}, \\hat{\\mathbf{x}}=\\tilde{\\mathbf{x}}(\\hat{\\boldsymbol{\\theta}}, \\mathbf{u}) $, 

$ \\tilde{\\boldsymbol{\\theta}} $ be an element of $ \\boldsymbol{\\Theta}^{\\mathrm{OPT}}(\\hat{\\mathbf{x}}, \\mathbf{u}) \\cap \\mathcal{C}\\left(\\overline{\\boldsymbol{\\theta}}, \\alpha_{1}\\right) $ 

-  is non-empty almost surely because $ \\alpha_{1} $ is chosen such that : 
  -  $ \\mathbb{P}\\left(\\boldsymbol{\\Theta}^{\\mathrm{OPT}}(\\hat{\\mathbf{x}}, \\mathbf{u}) \\cap \\mathcal{C}\\left(\\overline{\\boldsymbol{\\theta}}, \\alpha_{1}\\right)\\right)=1 $. 
  
Let : 

$ \\overline{\\boldsymbol{\\theta}}_{\\mathrm{CIO}}(\\mathbf{u}) $ denote the optimal solution to the inner maximization problem in : 

$ \\operatorname{RFO}\\left(\\mathcal{C}\\left(\\overline{\\boldsymbol{\\theta}}, \\alpha_{1}\\right), \\mathbf{u}\\right) $ 

- when the outer decision variable is set to $ \\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u}) $. 

For any $ \\mathbf{u} \\in \\mathcal{U} $, let : 

$ \\mathbf{x}^{*}(\\mathbf{u}):=\\tilde{\\mathbf{x}}\\left(\\boldsymbol{\\theta}^{*}, \\mathbf{u}\\right) $ 

$ \\boldsymbol{\\theta}_{\\mathrm{CIO}}^{*}(\\mathbf{u}) $ denote the optimal solution to the inner maximization problem in : 

$ \\operatorname{RFO}\\left(\\mathcal{C}\\left(\\overline{\\boldsymbol{\\theta}}, \\alpha_{1}\\right), \\mathbf{u}\\right) $ 

- when the outer decision variable is set to $ \\mathbf{x}^{*}(\\mathbf{u}) $


Now, we have : 

$ \\begin{aligned} & f\\left(\\boldsymbol{\\theta}^{*}, \\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right)-f\\left(\\boldsymbol{\\theta}^{*}, \\mathbf{x}^{*}(\\mathbf{u})\\right) \\\\ \\leq & f\\left(\\mathbb{E}(\\hat{\\boldsymbol{\\theta}}), \\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right)-f\\left(\\mathbb{E}(\\hat{\\boldsymbol{\\theta}}), \\mathbf{x}^{*}(\\mathbf{u})\\right)+\\left(\\nu\\left[\\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right]+\\nu\\left[\\mathbf{x}^{*}(\\mathbf{u})\\right]\\right)\\left\\|\\boldsymbol{\\theta}^{*}-\\mathbb{E}(\\hat{\\boldsymbol{\\theta}})\\right\\|_{2} \\\\ \\leq & f\\left(\\mathbb{E}(\\hat{\\boldsymbol{\\theta}}), \\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right)-f\\left(\\mathbb{E}(\\hat{\\boldsymbol{\\theta}}), \\mathbf{x}^{*}(\\mathbf{u})\\right)+\\sigma\\left(\\nu\\left[\\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right]+\\nu\\left[\\mathbf{x}^{*}(\\mathbf{u})\\right]\\right) \\\\ = & \\mathbb{E}\\left[f\\left(\\hat{\\boldsymbol{\\theta}}, \\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right)-f\\left(\\hat{\\boldsymbol{\\theta}}, \\mathbf{x}^{*}(\\mathbf{u})\\right)\\right]+\\sigma\\left(\\nu\\left[\\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right]+\\nu\\left(\\mathbf{x}^{*}(\\mathbf{u})\\right)\\right) \\\\ \\leq & \\mathbb{E}\\left[f\\left(\\tilde{\\boldsymbol{\\theta}}, \\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right)-f\\left(\\tilde{\\boldsymbol{\\theta}}, \\mathbf{x}^{*}(\\mathbf{u})\\right)+\\left(\\nu\\left[\\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right]+\\nu[\\hat{\\mathbf{x}}]\\right)\\|\\hat{\\boldsymbol{\\theta}}-\\tilde{\\boldsymbol{\\theta}}\\|_{2}\\right] \\\\ & +\\sigma\\left(\\nu\\left[\\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right]+\\nu\\left(\\mathbf{x}^{*}(\\mathbf{u})\\right)\\right) \\\\ \\leq & \\mathbb{E}\\left[f\\left(\\tilde{\\boldsymbol{\\theta}}, \\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right)-f\\left(\\tilde{\\boldsymbol{\\theta}}, \\mathbf{x}^{*}(\\mathbf{u})\\right)+\\left(\\nu\\left[\\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right]+\\nu[\\hat{\\mathbf{x}}]\\right) \\eta\\right] \\\\ & +\\sigma\\left(\\nu\\left[\\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right]+\\nu\\left(\\mathbf{x}^{*}(\\mathbf{u})\\right)\\right) \\\\ \\leq & \\mathbb{E}\\left[f\\left(\\overline{\\boldsymbol{\\theta}}_{\\mathrm{CIO}}(\\mathbf{u}), \\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right)-f\\left(\\tilde{\\boldsymbol{\\theta}}, \\mathbf{x}^{*}(\\mathbf{u})\\right)\\right]+(\\eta+\\sigma)\\left(\\nu\\left[\\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right]+\\nu\\left(\\mathbf{x}^{*}(\\mathbf{u})\\right)\\right) \\\\ \\leq & \\mathbb{E}\\left[f\\left(\\boldsymbol{\\theta}_{\\mathrm{CIO}}^{*}(\\mathbf{u}), \\mathbf{x}^{*}(\\mathbf{u})\\right)-f\\left(\\tilde{\\boldsymbol{\\theta}}, \\mathbf{x}^{*}(\\mathbf{u})\\right)\\right]+(\\eta+\\sigma)\\left(\\nu\\left[\\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right]+\\nu\\left(\\mathbf{x}^{*}(\\mathbf{u})\\right)\\right) \\\\ \\leq & \\mathbb{E}\\left[\\nu\\left(\\mathbf{x}^{*}(\\mathbf{u})\\right)\\left\\|\\boldsymbol{\\theta}_{\\mathrm{CIO}}^{*}(\\mathbf{u})-\\tilde{\\boldsymbol{\\theta}}\\right\\|_{2}\\right]+(\\eta+\\sigma)\\left(\\nu\\left[\\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right]+\\nu\\left(\\mathbf{x}^{*}(\\mathbf{u})\\right)\\right) \\\\ \\leq & 2 \\nu\\left(\\mathbf{x}^{*}(\\mathbf{u})\\right)\\left(1-\\cos 2 \\alpha_{1}\\right)+(\\eta+\\sigma)\\left(\\nu\\left[\\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right]+\\nu\\left(\\mathbf{x}^{*}(\\mathbf{u})\\right)\\right) \\\\ \\leq & \\left(2-2 \\cos 2 \\alpha_{1}+\\eta+\\sigma\\right) \\nu\\left(\\mathbf{x}^{*}(\\mathbf{u})\\right)+(\\eta+\\sigma) \\nu\\left[\\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right]\\end{aligned} $

Line 1: [Lemma 3](#lemma-3)

Line 2: [Assumption 3](#assumption-3-bounded-divergence)

Line 3: $f $ is linear in $\\boldsymbol \\theta $

Line 4: [Lemma 3](#lemma-3)

Line 5: [Assumption 2](#assumption-2-bounded-inverse-feasible-set)

Line 6: the definition of $ \\overline{\\boldsymbol{\\theta}}_{\\mathrm{CIO}}(\\mathbf{u}) $

Line 7: $ \\left(\\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u}), \\overline{\\boldsymbol{\\theta}}_{\\mathrm{CIO}}(\\mathbf{u})\\right) $ is an optimal solution to $ \\mathbf{R F O}\\left(\\mathcal{C}\\left(\\overline{\\boldsymbol{\\theta}}, \\alpha_{1}\\right), \\mathbf{u}\\right) $.

Line 8: [Lemma 3](#lemma-3)

Line 9: both $ \\boldsymbol{\\theta}_{\\mathrm{CIO}}^{*}(\\mathbf{u}) $ and $ \\tilde{\\boldsymbol{\\theta}} $ are on the unit sphere and the angle between them is no greater than $ 2 \\alpha_{1} $, then the $ L_{2} $ distance between them is upper bounded by $ 2\\left(1-\\cos 2 \\alpha_{1}\\right) $.

Then : 

$ \\begin{aligned} \\operatorname{AOG}\\left(\\overline{\\mathbf{x}}_{\\mathrm{CIO}}\\right) & =\\mathbb{E}\\left[f\\left(\\boldsymbol{\\theta}^{*}, \\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right)-f\\left(\\boldsymbol{\\theta}^{*}, \\mathbf{x}^{*}(\\mathbf{u})\\right)\\right] \\\\ & \\leq \\mathbb{E}\\left[\\left(2-2 \\cos 2 \\alpha_{1}+\\eta+\\sigma\\right) \\nu\\left(\\mathbf{x}^{*}(\\mathbf{u})\\right)+(\\eta+\\sigma) \\nu\\left[\\overline{\\mathbf{x}}_{\\mathrm{CIO}}(\\mathbf{u})\\right]\\right] \\\\ & =\\left(2-2 \\cos 2 \\alpha_{1}+\\eta+\\sigma\\right) \\mu^{*}+(\\eta+\\sigma) \\mu_{\\mathrm{CIO}}\\end{aligned} $

- $ \\mu^{*}:=\\mathbb{E}\\left(\\nu\\left[\\mathbf{x}^{*}(\\mathbf{u})\\right]\\right) $.

##### End Proof of Proposition 3

#### End Proof of Theorem 3

`,R7=`# 1. Examples & Glossary

$$
\\begin{array}{|c|c|l|}
\\hline
\\text{Domain} & \\text{Description} \\\\
\\hline
\\mathbb{P} & \\mathcal{M}(\\mathcal{X} \\times \\mathcal{Y}) & \\text{True (unknown) joint distribution of } (\\boldsymbol{x}, \\boldsymbol{y}) \\\\
\\hat{\\mathbb{P}}_{N} & \\mathcal{M}(\\mathcal{X} \\times \\mathcal{Y}) & \\text{Joint empirical distribution of } (\\boldsymbol{x}, \\boldsymbol{y}) \\\\
\\delta_{y} & \\mathcal{M}(\\mathcal{Y}) & \\text{Dirac distribution that puts all of its weight on } \\boldsymbol{y} \\\\
\\boldsymbol{x} & \\mathcal{X} \\subseteq \\mathbb{R}^{d_{\\boldsymbol{x}}} & \\text{Contextual information} \\\\
\\boldsymbol{y} & Y \\subseteq \\mathbb{R}^{d_{\\boldsymbol{y}}} & \\text{Uncertain parameters} \\\\
\\boldsymbol{z} & \\mathcal{Z} \\subseteq \\mathbb{R}^{d_{\\boldsymbol{z}}} & \\text{A feasible action} \\\\
\\boldsymbol{\\theta} & \\Theta & \\text{Parameters of a prediction model} \\\\
\\hat{\\boldsymbol{\\theta}} & \\Theta & \\text{Optimal parameter value that minimizes the estimation error} \\\\
c(\\boldsymbol{z}, \\boldsymbol{y}) & \\mathbb{R} & \\text{Cost of an action } \\boldsymbol{z} \\text{ under } \\boldsymbol{y} \\\\
h\\left(\\boldsymbol{z}, \\mathbb{Q}_{\\xi}\\right) & \\mathbb{R} & \\text{Expected cost of an action } \\boldsymbol{z} \\text{ under } \\mathbb{Q}_{\\xi} \\text{ (a distribution over } \\boldsymbol{y}) \\\\
H(\\pi, \\mathbb{Q}) & \\mathbb{R} & \\text{Expected cost of a policy } \\pi \\text{ under } \\mathbb{Q} \\text{ (a distribution over } (\\boldsymbol{x}, \\boldsymbol{y})) \\\\
f_{\\boldsymbol{\\theta}}(\\boldsymbol{x}) & \\mathcal{M}(\\mathcal{Y}) & \\text{Estimate of the conditional distribution of } \\boldsymbol{y} \\text{ given } \\boldsymbol{x} \\\\
g_{\\boldsymbol{\\theta}}(\\boldsymbol{x}) & \\mathbb{R} \\boldsymbol{R}_{\\boldsymbol{y}} & \\text{Estimate of the conditional expectation of } \\boldsymbol{y} \\text{ given } \\boldsymbol{x} \\\\
\\pi^{*}(\\boldsymbol{x}) & \\mathcal{Z} & \\text{Optimal solution of CSO under true conditional distribution } \\mathbb{P}(\\boldsymbol{y} \\mid \\boldsymbol{x}) \\\\
\\pi_{\\boldsymbol{\\theta}}(\\boldsymbol{x}) & \\mathcal{Z} & \\text{Action prescribed by a policy parameterized by } \\boldsymbol{\\theta} \\text{ for context } \\boldsymbol{x} \\\\
z^{*}(\\boldsymbol{x}) & \\mathcal{Z} & \\text{Optimal solution to the CSO problem under the true conditional distribution } \\mathbb{P}(\\boldsymbol{y} \\mid \\boldsymbol{x}) \\\\
z^{*}\\left(\\boldsymbol{x}, f_{\\boldsymbol{\\theta}}\\right) & \\mathcal{Z} & \\text{Optimal solution to the CSO problem under the conditional distribution } f_{\\boldsymbol{\\theta}}(\\boldsymbol{x}) \\\\
z^{*}\\left(\\boldsymbol{x}, g_{\\boldsymbol{\\theta}}\\right) & \\mathcal{Z} & \\text{Optimal solution to the CSO problem under the Dirac distribution } \\delta_{g \\boldsymbol{\\theta}}(\\boldsymbol{x}) \\\\
\\rho\\left(\\boldsymbol{f}_{\\boldsymbol{\\theta}}, \\hat{\\mathbb{P}}_{N}\\right) & \\mathbb{R} & \\text{Expected prediction error for distribution model } f_{\\boldsymbol{\\theta}} \\text{ based on empirical distribution } \\hat{\\mathbb{P}}_{N} \\\\
\\rho\\left(g_{\\boldsymbol{\\theta}}, \\hat{\\mathbb{P}}_{N}\\right) & \\mathbb{R} & \\text{Expected prediction error for point prediction model } g_{\\boldsymbol{\\theta}} \\text{ based on empirical distribution } \\hat{\\mathbb{P}}_{N} \\\\
\\hline
\\end{array}
$$

$$
\\begin{array}{|c|c|c|c|c|c|c|c|c|c|c|c|}
\\hline
\\text{Reference} & \\text{rcso} & \\text{wSAA} & \\text{EVB} & \\text{Reg. CSO} & \\text{DRO} & \\text{General} & \\text{Linear} & \\text{Kernel} & \\text{kNN} & \\text{DT} & \\text{RF} \\\\
\\hline
\\text{Hannah et al. (2010)} & \\times & \\checkmark & \\times & \\times & \\times & \\times & \\times & \\checkmark & \\times & \\times & \\times \\\\
\\hline
\\text{Ferreira et al. (2016)} & \\times & \\times & \\checkmark & \\times & \\times & \\times & \\times & \\times & \\times & \\checkmark & \\times \\\\
\\hline
\\text{Ban et al. (2019)} & \\checkmark & \\times & \\times & \\times & \\times & \\times & \\checkmark & \\times & \\times & \\times & \\times \\\\
\\hline
\\text{Chen and Paschalidis (2019)} & \\times & \\checkmark & \\times & \\times & \\checkmark & \\times & \\times & \\times & \\checkmark & \\times & \\times \\\\
\\hline
\\text{Bertsimas and Kallus (2020)} & \\times & \\checkmark & \\times & \\times & \\times & \\times & \\checkmark & \\times & \\checkmark & \\checkmark & \\checkmark \\\\
\\hline
\\text{Kannan et al. (2020)} & \\checkmark & \\times & \\times & \\times & \\times & \\checkmark & \\checkmark & \\checkmark & \\checkmark & \\checkmark & \\checkmark \\\\
\\hline
\\text{Kannan et al. (2021)} & \\checkmark & \\times & \\times & \\times & \\checkmark & \\checkmark & \\checkmark & \\checkmark & \\checkmark & \\checkmark & \\checkmark \\\\
\\hline
\\text{Liu et al. (2021)} & \\times & \\times & \\checkmark & \\times & \\times & \\times & \\checkmark & \\times & \\times & \\checkmark & \\times \\\\
\\hline
\\text{Srivastava et al. (2021)} & \\times & \\checkmark & \\times & \\checkmark & \\times & \\times & \\times & \\checkmark & \\times & \\times & \\times \\\\
\\hline
\\text{Wang et al. (2021)} & \\times & \\checkmark & \\times & \\times & \\checkmark & \\times & \\times & \\checkmark & \\times & \\times & \\times \\\\
\\hline
\\text{Bertsimas and Van Parys (2022)} & \\times & \\checkmark & \\times & \\times & \\checkmark & \\times & \\times & \\checkmark & \\checkmark & \\times & \\times \\\\
\\hline
\\text{Deng and Sen (2022)} & \\checkmark & \\times & \\times & \\times & \\times & \\checkmark & \\checkmark & \\checkmark & \\checkmark & \\checkmark & \\checkmark \\\\
\\hline
\\text{Esteban-Pérez and Morales (2022)} & \\times & \\checkmark & \\times & \\times & \\checkmark & \\times & \\times & \\checkmark & \\checkmark & \\times & \\times \\\\
\\hline
\\text{Kannan et al. (2022)} & \\checkmark & \\times & \\times & \\times & \\checkmark & \\checkmark & \\checkmark & \\checkmark & \\checkmark & \\checkmark & \\checkmark \\\\
\\hline
\\text{Lin et al. (2022)} & \\times & \\checkmark & \\times & \\checkmark & \\times & \\times & \\times & \\times & \\checkmark & \\checkmark & \\checkmark \\\\
\\hline
\\text{Nguyen et al. (2021)} & \\times & \\checkmark & \\times & \\times & \\checkmark & \\times & \\times & \\times & \\checkmark & \\times & \\times \\\\
\\hline
\\text{Notz and Pibernik (2022)} & \\times & \\checkmark & \\times & \\times & \\times & \\times & \\times & \\checkmark & \\times & \\checkmark & \\times \\\\
\\hline
\\text{Zhu et al. (2022)} & \\times & \\times & \\checkmark & \\times & \\checkmark & \\checkmark & \\checkmark & \\checkmark & \\checkmark & \\checkmark & \\checkmark \\\\
\\hline
\\text{Perakis et al. (2023)} & \\checkmark & \\times & \\times & \\times & \\checkmark & \\times & \\checkmark & \\times & \\times & \\times & \\times \\\\
\\hline
\\end{array}
$$


$$
\\begin{array}{|c|c|c|c|c|c|c|c|c|c|}
\\hline 
& \\text{LP} & \\text{QP} & \\text{Convex} & \\text{Non convex} & \\text{Integer} & \\text{Uncertain} & \\text{Implicit diff.} & \\substack{\\text{Surr.} \\\\ \\text{loss}} & \\text{Surr. optim.} \\\\
\\hline
\\text{Amos and Kolter (2017)} & \\times & \\checkmark & \\times & \\times & \\times & \\checkmark & \\checkmark & \\times & \\checkmark \\\\
\\hline
\\text{Donti et al. (2017)} & \\times & \\checkmark & \\checkmark & \\times & \\times & \\checkmark & \\checkmark & \\times & \\times \\\\
\\hline
\\text{Agrawal et al. (2019)} & \\times & \\checkmark & \\checkmark & \\times & \\times & \\checkmark & \\checkmark & \\times & \\checkmark \\\\
\\hline
\\text{Vlastelica et al. (2019)} & \\checkmark & \\times & \\times & \\times & \\checkmark & \\times & \\times & \\checkmark & \\times \\\\
\\hline
\\text{Wilder et al. (2019a)} & \\checkmark & \\times & \\times & \\times & \\checkmark & \\times & \\checkmark & \\times & \\times \\\\
\\hline
\\text{Wilder et al. (2019b)} & \\times & \\checkmark & \\times & \\times & \\checkmark & \\times & \\times & \\checkmark & \\times \\\\
\\hline
\\text{Berthet et al. (2020)} & \\checkmark & \\times & \\times & \\times & \\checkmark & \\times & \\times & \\times & \\checkmark \\\\
\\hline
\\text{Elmachtoub et al. (2020)} & \\checkmark & \\times & \\times & \\times & \\times & \\times & \\times & \\checkmark & \\times \\\\
\\hline
\\text{Ferber et al. (2020)} & \\checkmark & \\times & \\times & \\times & \\checkmark & \\times & \\checkmark & \\times & \\times \\\\
\\hline
\\text{Mandi and Guns (2020)} & \\checkmark & \\times & \\times & \\times & \\checkmark & \\times & \\checkmark & \\times & \\times \\\\
\\hline
\\text{Mandi et al. (2020)} & \\checkmark & \\times & \\times & \\times & \\checkmark & \\times & \\times & \\checkmark & \\times \\\\
\\hline
\\text{Grigas et al. (2021)} & \\times & \\times & \\checkmark & \\times & \\times & \\times & \\times & \\times & \\checkmark \\\\
\\hline
\\text{Mulamba et al. (2021)} & \\checkmark & \\times & \\times & \\times & \\checkmark & \\times & \\times & \\times & \\checkmark \\\\
\\hline
\\text{Chung et al. (2022)} & \\times & \\times & \\checkmark & \\times & \\checkmark & \\times & \\times & \\checkmark & \\times \\\\
\\hline
\\text{Cristian et al. (2022)} & \\times & \\times & \\checkmark & \\times & \\times & \\times & \\times & \\times & \\checkmark \\\\
\\hline
\\text{Dalle et al. (2022)} & \\checkmark & \\times & \\times & \\times & \\checkmark & \\times & \\times & \\times & \\checkmark \\\\
\\hline
\\text{Elmachtoub and Grigas (2022)} & \\checkmark & \\times & \\times & \\times & \\checkmark & \\times & \\times & \\checkmark & \\times \\\\
\\hline
\\text{Jeong et al. (2022)} & \\checkmark & \\times & \\times & \\times & \\checkmark & \\times & \\times & \\checkmark & \\times \\\\
\\hline
\\text{Kallus and Mao (2022)} & \\times & \\times & \\checkmark & \\times & \\times & \\times & \\times & \\checkmark & \\times \\\\
\\hline
\\text{Kong et al. (2022)} & \\times & \\checkmark & \\checkmark & \\checkmark & \\checkmark & \\times & \\times & \\times & \\checkmark \\\\
\\hline
\\text{Lawless and Zhou (2022)} & \\checkmark & \\times & \\times & \\times & \\checkmark & \\times & \\times & \\checkmark & \\times \\\\
\\hline
\\text{Loke et al. (2022)} & \\checkmark & \\times & \\times & \\times & \\times & \\times & \\times & \\checkmark & \\times \\\\
\\hline
\\text{Mandi et al. (2022)} & \\checkmark & \\times & \\times & \\times & \\checkmark & \\times & \\times & \\times & \\checkmark \\\\
\\hline
\\text{Muñoz et al. (2022)} & \\checkmark & \\times & \\times & \\times & \\times & \\times & \\times & \\checkmark & \\times \\\\
\\hline
\\text{Shah et al. (2022)} & \\checkmark & \\checkmark & \\checkmark & \\checkmark & \\checkmark & \\times & \\times & \\times & \\checkmark \\\\
\\hline
\\text{Butler and Kwon (2023a)} & \\times & \\checkmark & \\times & \\times & \\times & \\times & \\checkmark & \\times & \\times \\\\
\\hline
\\text{Costa and Iyengar (2023)} & \\times & \\checkmark & \\checkmark & \\times & \\times & \\checkmark & \\checkmark & \\checkmark & \\times \\\\
\\hline
\\text{Estes and Richard (2023)} & \\checkmark & \\times & \\checkmark & \\times & \\times & \\times & \\times & \\checkmark & \\times \\\\
\\hline
\\text{Kotary et al. (2023)} & \\checkmark & \\checkmark & \\checkmark & \\checkmark & \\times & \\times & \\checkmark & \\times & \\times \\\\
\\hline
\\text{McKenzie et al. (2023)} & \\checkmark & \\times & \\times & \\times & \\times & \\times & \\checkmark & \\times & \\times \\\\
\\hline
\\text{Sun et al. (2023a)} & \\checkmark & \\times & \\times & \\times & \\times & \\times & \\times & \\checkmark & \\times \\\\
\\hline
\\text{Sun et al. (2023b)} & \\times & \\checkmark & \\times & \\checkmark & \\times & \\times & \\checkmark & \\times & \\times \\\\
\\hline
\\end{array}
$$

$$
\\begin{array}{|l|l|}
\\hline
\\text{Abbreviation} & \\text{Description} \\\\
\\hline
\\text{ADMM} & \\text{alternating direction method of multipliers} \\\\
\\text{CSO} & \\text{contextual stochastic optimization} \\\\
\\text{CVaR} & \\text{conditional value at risk} \\\\
\\text{DRO} & \\text{distributionally robust optimization} \\\\
\\text{DNN} & \\text{deep neural network} \\\\
\\text{ERM} & \\text{empirical risk minimization} \\\\
\\text{FP} & \\text{fixed point} \\\\
\\text{ILO} & \\text{integrated learning and optimization} \\\\
\\text{IFT} & \\text{implicit function theorem} \\\\
\\text{kNN} & k\\text{-nearest neighbor} \\\\
\\text{KKT} & \\text{Karush-Kuhn-Tucker} \\\\
\\text{KL} & \\text{Kullback-Leibler} \\\\
\\text{LDR} & \\text{linear decision rule} \\\\
\\text{LP} & \\text{linear program} \\\\
\\text{MDP} & \\text{Markov decision process} \\\\
\\text{ML} & \\text{machine learning} \\\\
\\text{MLE} & \\text{maximum likelihood estimation} \\\\
\\text{MILP} & \\text{mixed-integer linear program} \\\\
\\text{NW} & \\text{Nadaraya-Watson} \\\\
\\text{RKHS} & \\text{reproducing kernel Hilbert space} \\\\
\\text{SAA} & \\text{sample average approximation} \\\\
\\text{SLO} & \\text{sequential learning and optimization} \\\\
\\text{QP} & \\text{quadratic program} \\\\
\\hline
\\end{array}
$$


2. Contextual Optimization

$\\boldsymbol  z$ : decision: The order for today inventory

$\\mathcal Z\\subseteq \\mathbb R^{d_{\\boldsymbol  z}}$ : feasible set for orders

- e.g. $ \\mathcal{Z}=\\{z \\in \\mathbb{R} \\mid z \\geq 0\\} $

$ c(\\boldsymbol{z}, \\boldsymbol{y}) $ : cost function

- e.g. $ c(z, y)=h(z-y)^{+}+b(y-z)^{+} $ (h for over inventory, b for not enough inventory)

$ \\boldsymbol{y} \\in \\mathcal{Y} \\subseteq \\mathbb{R}^{d_{y}} $ : uncertain parameters : the everyday real need 

$ \\boldsymbol{x} \\in \\mathcal{X} \\subseteq \\mathbb{R}^{d_{x}} $ : a vector of relevant covariates : the history data 



$\\mathbb  P $: the joint distribution of :
- the covariates in $\\mathcal  X$
- the uncertain parameters in $\\mathcal  Y $
- e.g.: the distribution of data and real need 






# 2. Contextual Optimization : An overview

$\\boldsymbol  z$ : decision

$\\mathcal Z\\subseteq \\mathbb R^{d_{\\boldsymbol  z}}$ : feasible set 

$ c(\\boldsymbol{z}, \\boldsymbol{y}) $ : cost function

$ \\boldsymbol{y} \\in \\mathcal{Y} \\subseteq \\mathbb{R}^{d_{y}} $ : uncertain parameters

The uncertain parameters are unknown when making the decision.

$ \\boldsymbol{x} \\in \\mathcal{X} \\subseteq \\mathbb{R}^{d_{x}} $ : a vector of relevant covariates :
- correlated with the uncertain parameters $\\mathbb  y $
- we know it before choosing $\\mathbb  z $

$\\mathbb  P $: the joint distribution of :
- the covariates in $\\mathcal  X$
- the uncertain parameters in $\\mathcal  Y $

## 2.1 Contexual problem and policy

### CSO problem

Given:

- $\\boldsymbol  x$ : a vector of covariates
- $\\mathbb  P $ : joint distribution

Target:

- Find $z^*(\\boldsymbol  x)\\in\\mathcal Z $ : an optimal action
- minimize the expected costs on the covariate $\\boldsymbol x $

Formally:

#### (1)

$ z^{*}(\\boldsymbol{x}) \\in \\underset{\\boldsymbol{z} \\in \\mathcal{Z}}{\\operatorname{argmin}} \\mathbb{E}_{\\mathbb{P}(\\boldsymbol{y} \\mid \\boldsymbol{x})}[c(\\boldsymbol{z}, \\boldsymbol{y})] $
- $ \\mathbb{P}(\\boldsymbol{y} \\mid \\boldsymbol{x}) $ : the conditional distribution of $\\boldsymbol  y $ given the covariate $\\boldsymbol  x $
- A minimizer exists
  - e.g.: $\\mathcal Z $ is compact, $ \\mathbb{P}(\\boldsymbol{y} \\mid \\boldsymbol{x}) $ has bounded support, $ c(\\boldsymbol{z}, \\boldsymbol{y}) $ is continuous in $ \\boldsymbol{z} $ almost surely.

[(1)](#1) can be written using the expected cost operator $h(\\cdot,\\cdot)$ : 
- first argument: an action
- second argument: distribution

#### (2)

$ z^{*}(\\boldsymbol{x}) \\in \\underset{\\boldsymbol{z} \\in \\mathcal{Z}}{\\operatorname{argmin}} h(\\boldsymbol{z}, \\mathbb{P}(\\boldsymbol{y} \\mid \\boldsymbol{x})):=\\mathbb{E}_{\\mathbb{P}(\\boldsymbol{y} \\mid \\boldsymbol{x})}[c(\\boldsymbol{z}, \\boldsymbol{y})] $

### Optimal policy

Target: find the policy, provides the lowest long-term expected cost 

$ z^{*}(\\boldsymbol{x}) \\in \\underset{\\boldsymbol{z} \\in \\mathcal{Z}}{\\operatorname{argmin}} h(\\boldsymbol{z}, \\mathbb{P}(\\boldsymbol{y} \\mid \\boldsymbol{x})):=\\mathbb{E}_{\\mathbb{P}(\\boldsymbol{y} \\mid \\boldsymbol{x})}[c(\\boldsymbol{z}, \\boldsymbol{y})] $

- $ \\Pi:=\\{\\pi: \\mathcal{X} \\rightarrow \\mathcal{Z}\\} $

Solving [(1)](#1) naturally gives an optimal policy:

$ \\bar{\\pi}(\\boldsymbol{x}) \\in \\underset{\\boldsymbol{z} \\in \\mathcal{Z}}{\\operatorname{argmin}} h(\\boldsymbol{z}, \\mathbb{P}(\\boldsymbol{y} \\mid \\boldsymbol{x})) $ a.s. $ \\Leftrightarrow \\mathbb{E}_{\\mathbb{P}}[h(\\bar{\\pi}(\\boldsymbol{x}), \\mathbb{P}(\\boldsymbol{y} \\mid \\boldsymbol{x}))]=\\min _{\\pi \\in \\Pi} \\mathbb{E}_{\\mathbb{P}}[h(\\pi(\\boldsymbol{x}), \\mathbb{P}(\\boldsymbol{y} \\mid \\boldsymbol{x}))] $

- If a minimizer of $ h(\\boldsymbol{z}, \\mathbb{P}(\\boldsymbol{y} \\mid \\boldsymbol{x})) $ exists almost surely

We can see $\\pi^*, z^*(\\cdot)$ coincide

## 2.2 Mapping covariate to actions in a data-driven environment

Challenge: the joint distribution $\\mathbb P $ is generally unknown

Reality: we have historical data:

$ \\mathcal{D}_{N}=\\left\\{\\left(\\boldsymbol{x}_{i}, \\boldsymbol{y}_{i}\\right)\\right\\}_{i=1}^{N} $

assumed to be made of independent and identically distributed realizations of $ (\\boldsymbol{x}, \\boldsymbol{y}) \\in \\mathcal{X} \\times \\mathcal{Y} $

Aim: find a policy
that approximates well the optimal policy given by [(3)](#3)

Three main frameworks:

- decision rule optimization
- sequential learning and optimization
- integrated learning and optimization

### 2.2.1 Decision rule optimization 

There's a hypothesis class:

$ \\Pi^{\\theta}:=\\left\\{\\pi_{\\boldsymbol{\\theta}}\\right\\}_{\\boldsymbol{\\theta} \\in \\Theta} \\subseteq \\Pi $

- $ \\Pi^{\\theta}:=\\left\\{\\pi_{\\boldsymbol{\\theta}}\\right\\}_{\\boldsymbol{\\theta} \\in \\Theta} \\subseteq \\Pi $

$ \\hat{\\mathbb{P}}_{N} $ : the empirical distribution of $ (\\boldsymbol{x}, \\boldsymbol{y}) $ given historical data $ \\mathcal{D}_{N} $

Get the "best" parameter in $ \\Pi^{\\theta} $ by solving ERM (empirical risk minimization) :

#### (4)

$ \\quad \\boldsymbol{\\theta}^{*} \\in \\underset{\\boldsymbol{\\theta}}{\\operatorname{argmin}} H\\left(\\pi_{\\boldsymbol{\\theta}}, \\hat{\\mathbb{P}}_{N}\\right):=\\mathbb{E}_{\\hat{\\mathbb{P}}_{N}}\\left[c\\left(\\pi_{\\boldsymbol{\\theta}}(\\boldsymbol{x}), \\boldsymbol{y}\\right)\\right] $

Then:

Find the policy $  \\pi_{\\theta^{*}} \\in \\Pi^{\\theta} $ that minimizes the expected costs over the training data.

Approximations:

- The hypothesis class $\\Pi^{\\theta} $ may not contain the true optimal policy 
- The long-term expected costs are calculated over the $ \\hat{\\mathbb{P}}_{N} $ (empirical distribution) instead of the $\\mathbb P$, the true distribution

Disadvantage:

- Focus overall performance (the expectation), not robust
  - e.g. perform better on some sample, worse on some other sample

### 2.2.2 Learning and optimization 

**Predictive & Optimization**

**Predictive:**

$f_{\\boldsymbol \\theta }$ : general model 
- parameterized by $\\boldsymbol \\theta $
- provide the input of the optimization component 

$ f_{\\boldsymbol{\\theta}}(\\boldsymbol{x}) $ : predicted distribution 
- for any covariate $\\boldsymbol{x} $ 
- a predicted distribution
  - approximate the true conditional distribution $ \\mathbb{P}(\\boldsymbol{y} \\mid \\boldsymbol{x}) $ 
- learned from historical data

Decision:

Solve the CSO problem under $ f_{\\boldsymbol{\\theta}}(\\boldsymbol{x}) $ :

#### (5)

$ z^{*}\\left(\\boldsymbol{x}, f_{\\boldsymbol{\\theta}}\\right) \\in \\underset{\\boldsymbol{z} \\in \\mathcal{Z}}{\\operatorname{argmin}} h\\left(\\boldsymbol{z}, f_{\\boldsymbol{\\theta}}(\\boldsymbol{x})\\right) $

The only approximation:

- $ f_{\\boldsymbol{\\theta}} $ is an approximation of $ \\mathbb{P}(\\boldsymbol{y} \\mid \\boldsymbol{x}) $

**SLO(Sequential learning and optimization) :**

$\\rho$ : estimation error
- minimize it to obtain the contextual predictor
- between conditional distribution given by $ f_{\\boldsymbol{\\theta}}(\\boldsymbol{x}) $ and the true conditional distribution of $ \\boldsymbol{y} $ given $ \\boldsymbol{x} $ 

Solve:

#### (6)

$ \\min _{\\boldsymbol{\\theta}} \\rho\\left(f_{\\boldsymbol{\\theta}}, \\hat{\\mathbb{P}}_{N}\\right)+\\Omega(\\boldsymbol{\\theta}) $ 

- $ \\rho\\left(f_{\\boldsymbol{\\theta}}, \\hat{\\mathbb{P}}_{N}\\right):=\\mathbb{E}_{\\hat{\\mathbb{P}}_{N}}\\left[\\mathfrak{D}\\left(f_{\\boldsymbol{\\theta}}(\\boldsymbol{x}), \\boldsymbol{y}\\right)\\right] $

- $ \\mathfrak{D} $ is a divergence function
  - negative log-likelihood & regularization term $ \\Omega(\\boldsymbol{\\theta}) $ controls the complexity of $ f_{\\theta} $

#### Definition 1 (Expected value-based model)

cost function $ c(\\boldsymbol{x}, \\boldsymbol{y}) $ of the decision model is linear in $ \\boldsymbol{y} $ 

Now: 

estimating a conditional distribution $\\to$ find the expected value of the uncertain parameter given the covariates

- Because : $ h(\\boldsymbol{z}, \\mathbb{P}(\\boldsymbol{y} \\mid \\boldsymbol{x}))= $ $ \\mathbb{E}_{\\mathbb{P}(\\boldsymbol{y} \\mid \\boldsymbol{x})}[c(\\boldsymbol{z}, \\boldsymbol{y})]=c\\left(\\boldsymbol{z}, \\mathbb{E}_{\\mathbb{P}(\\boldsymbol{y} \\mid \\boldsymbol{x})}[\\boldsymbol{y}]\\right) $ 

training the contextual predictor $\\to $ mean regression problem over a parameterized function $ g_{\\boldsymbol{\\theta}}(\\boldsymbol{x}) $

$ \\min _{\\boldsymbol{\\theta}} \\rho\\left(g_{\\boldsymbol{\\theta}}, \\hat{\\mathbb{P}}_{N}\\right)+\\Omega(\\boldsymbol{\\theta}) $ 

- $ \\rho\\left(g_{\\boldsymbol{\\theta}}, \\hat{\\mathbb{P}}_{N}\\right):=\\mathbb{E}_{\\hat{\\mathbb{P}}_{N}}\\left[d\\left(g_{\\boldsymbol{\\theta}}(\\boldsymbol{x}), \\boldsymbol{y}\\right)\\right] $

- for some distance metric $ d $, usually the mean squared errors

MSE (mean squared error):

$ g_{\\hat{\\boldsymbol{\\theta}}}(\\boldsymbol{x})=\\mathbb{E}_{\\mathbb{P}(\\boldsymbol{y} \\mid \\boldsymbol{x})}[\\boldsymbol{y}] $ 

 - as $ N \\rightarrow \\infty $



Obtain an action: 

$ z^{*}\\left(\\boldsymbol{x}, g_{\\boldsymbol{\\theta}}\\right) \\in \\underset{\\boldsymbol{z} \\in \\mathcal{Z}}{\\operatorname{argmin}} h\\left(\\boldsymbol{z}, \\delta_{g_{\\boldsymbol{\\theta}(\\boldsymbol{x})}}\\right)=\\underset{\\boldsymbol{z} \\in \\mathcal{Z}}{\\operatorname{argmin}} c\\left(\\boldsymbol{z}, g_{\\boldsymbol{\\theta}}(\\boldsymbol{x})\\right) $,

- For any new covariate $\\boldsymbol x$
- $z^*$ : an estimator of the mean of the conditional distribution
- $ \\delta_{y} $ : Dirac distribution (all mass at $\\boldsymbol y$)

These models: expected value-based models 

More general: conditional distribution-based models

Disadvantage:

-  ignore the mismatch between the
prediction divergence $ \\mathfrak{D} $ and the cost function $ c(\\boldsymbol{x}, \\boldsymbol{y}) $

- a small prediction error about $ \\mathbb{P}(\\boldsymbol{y} \\mid \\boldsymbol{x}) $ may have a large impact on the prescription

**Integrated learning and optimization**

Goal:

maximize the prescriptive performance of the induced policy
- train the predictive component to minimize the task loss (as in [(3)](#3))
- higher MSE but nearly-optimal 

We have:

#### (9)

$ \\min _{\\boldsymbol{\\theta}} H\\left(z^{*}\\left(\\cdot, f_{\\boldsymbol{\\theta}}\\right), \\hat{\\mathbb{P}}_{N}\\right)=\\min _{\\boldsymbol{\\theta}} \\mathbb{E}_{\\hat{\\mathbb{P}}_{N}}\\left[c\\left(z^{*}\\left(\\boldsymbol{x}, f_{\\boldsymbol{\\theta}}\\right), \\boldsymbol{y}\\right)\\right] $
- Finding the best parameterization of a contextual predictor
  - minimizes the downstream
expected costs of the CSO solution


- minimizes the expected cost of the policy over the empirical distribution

## Summary

Design choices:

- type of loss function during training
  - e.g. decision rule/sequential/integrated paradigm
- class of predictive model
  - e.g. linear/neural network/random forest

# 3 Dicision rule optimization 

Decision rules:
- obtained by solving ERM in Problem [(4)](#4)
- minimize the cost of a policy on the task
  - that is, downstream optimization problem 

Advantage:
- once trained, no optimization problem needs

Define decision rule approach as:

employing a parameterized mapping $ \\pi_{\\boldsymbol{\\theta}}(\\boldsymbol{x}) $

- e.g.: linear/neural network


## 3.1 Linear decision rules

1: SAA(sample-average approximation)

for a newsvendor problem:

Use LDRs(linear decision rules)

Two variants with and without regularization:

$ \\min _{\\pi: \\exists \\boldsymbol{\\theta} \\in \\mathbb{R}^{d} \\boldsymbol{x}, \\pi(\\boldsymbol{x})=\\boldsymbol{\\theta}^{\\top} \\boldsymbol{x}, \\forall \\boldsymbol{x}} H\\left(\\pi, \\hat{\\mathbb{P}}_{N}\\right)+\\Omega(\\pi)=\\min _{\\boldsymbol{\\theta}} \\frac{1}{N} \\sum_{i=1}^{N} u\\left(y_{i}-\\boldsymbol{\\theta}^{\\top} \\boldsymbol{x}_{i}\\right)^{+}+o\\left(\\boldsymbol{\\theta}^{\\top} \\boldsymbol{x}_{i}-y_{i}\\right)^{+}+\\lambda\\|\\boldsymbol{\\theta}\\|_{k}^{2} $

- $u$: per unit backordering (underage) cost 
- $o$: per unit holding (overage) cost 

2: For linear demand model:

Generalization error for ERM model scales as :

- $ \\mathrm{O}\\left(d_{x} / \\sqrt{N}\\right) $ , when there is no regularization
- $ \\mathrm{O}\\left(d_{\\boldsymbol{x}} /(\\sqrt{N} \\lambda)\\right) $, with regularization

Need balance (to get optimal performance):

- generalization error
- regularization bias

Consider unconstrained problems because:
- difficult to ensure the feasibility of policies 
- maintain computational tractability

3. General theory for generalization

- Based on Rademacher complexity
- beyond LDR

LDRs may not be asymptotically optimal in general 

To generalize LDRs:

- decision rules that linear in transformations of the covariate vector 
- lift covariate vector to RKHS(reproducing kernel Hilbert space)

## 3.2 RKHS-based decision rules

To:

Obtain decision rules: more flexible than linear ones with respect to $\\boldsymbol x$:

lift the covariate vector to RKHS

- LDRs might achieve better performance 

Let:

$ K: \\mathcal{X} \\times \\mathcal{X} \\rightarrow \\mathbb{R} $: symmetric positive definite kernel 
- associated with the chosen RKHS 
  - e.g.: $ K\\left(\\boldsymbol{x}_{1}, \\boldsymbol{x}_{2}\\right):=\\exp \\left(-\\left\\|\\boldsymbol{x}_{1}-\\boldsymbol{x}_{2}\\right\\|^{2} /\\left(2 \\sigma^{2}\\right)\\right) $

$ \\left\\{\\varphi: \\mathcal{X} \\rightarrow \\mathbb{R} \\mid \\exists L \\in \\mathbb{N}, \\boldsymbol{v}_{1}, \\boldsymbol{v}_{2}, \\cdots, \\boldsymbol{v}_{L} \\in \\mathcal{X}, \\varphi(\\boldsymbol{x})=\\sum_{l=1}^{L} a_{l} K\\left(\\boldsymbol{v}_{l}, \\boldsymbol{x}\\right), \\forall \\boldsymbol{x} \\in \\mathcal{X}\\right\\} $

- the RKHS $\\mathcal H_K$
- Given $K$
- the closure of a set functions
- $ \\varphi_{1}(\\boldsymbol{x})=\\sum_{i=1}^{L_{1}} a_{1}^{i} K\\left(\\boldsymbol{v}_{1}^{i}, \\boldsymbol{x}\\right) $
- $ \\varphi_{2}(\\boldsymbol{x})=\\sum_{j=1}^{L_{2}} a_{2}^{j} K\\left(\\boldsymbol{v}_{2}^{j}, \\boldsymbol{x}\\right) $
- $ \\left\\langle\\varphi_{1}, \\varphi_{2}\\right\\rangle=\\sum_{i=1}^{L_{1}} \\sum_{j=1}^{L_{2}} a_{1}^{i} a_{2}^{j} K\\left(\\boldsymbol{v}_{1}^{i}, \\boldsymbol{v}_{2}^{j}\\right) $: inner product

1: approximate the optimal policy:
- with a linear policy in the RKHS
  - $ \\pi_{\\varphi}(\\boldsymbol{x}):=\\langle\\varphi, K(\\boldsymbol{x}, \\cdot)\\rangle $ when $ d_{\\boldsymbol{z}}=1 $

using the representer theorem, the solution of :

$ \\min _{\\varphi \\in \\mathcal{H}_{K}} H\\left(\\pi_{\\varphi}, \\hat{\\mathbb{P}}_{N}\\right)+\\lambda\\|\\varphi\\|_{2}^{2} $

- regularized problem 

takes the form $ \\pi^{*}(\\boldsymbol{x})=\\sum_{i=1}^{N} K\\left(\\boldsymbol{x}_{i}, \\boldsymbol{x}\\right) a_{i}^{*} $

reduce the decision rule problem to:

$ \\min _{\\boldsymbol{a} \\in \\mathbb{R}^{N}} H\\left(\\sum_{i=1}^{N} K\\left(\\boldsymbol{x}_{i}, \\cdot\\right) a_{i}, \\hat{\\mathbb{P}}_{N}\\right)+\\lambda \\sum_{i=1}^{N} \\sum_{j=1}^{N} K\\left(\\boldsymbol{x}_{i}, \\boldsymbol{x}_{j}\\right) a_{i} a_{j} $

can be extended to $ d_{z}>1 $ by employing one RKHS for each $ z_{i} $

Some applications:

- Data-driven single item newsvendor
- single risky asset portfolio problems 
  - establish bounds on the out-of-sample performance 
- asymptotic optimality of RKHS-based policies 
- two-stage capacity planning problem 
  - multivariate demand 
  - vector-valued capacity decisions 
    - the underlying demand distribution is difficult to estimate in practice
- optimize over policies that are linear in the RKHS 
  - associatied with Gaussain kernerl
  - identify generalization error bounds 
  - for large dimension problems:
    - slow convergence rate 
    - propose instead using a data-dependent random forest kerenl

## 3.3 Non-linear decision rules

1: value of training a DNN

- learn the ordering policy of a newsvendor problem 

**neural networks**

- universal approximation property
  - approximate any continuous function arbitrarily well 
- For constrained problem:
  - softmax as final layer to ensure decisions lies in a simplex
    - 2: portfolio optimization problem 
- in general, not land in feasible space. to circumvent:
  - 3: application-specific differentiable repair layer
    - project the solution back to feasibility 
  - 4: obtained by SGD(stochastic gradient descent) approximately minimize the Bayesian posterior loss

Optimal solution of a newsvendor problem is a quantile of demand distribution:

- 5: train an additive ensemble of decision trees using quantile regression
  - produce thr ordering decision  
  - Test the algorithms on a real-world dataset from a large German bakery chain 
- 6: optimize decision tree-based decision rules 
  - address the multi-item newsvendor, treatment planning, optimal stopping problems 
- 7: tutorial on DNN-based decision rule optimization 

8: piecewise-affine decision rules 

- provice non-asymptotic and asymptotic consistency results
  - for unconstrained and constrained problems 
- learn policy through: stochastic majorization-minimization algorithm
- experiment on constrained newsvendor problem 
  - piecewise-affine decision rules outperform RKHS-based policies 

## 3.4 Distributionally robust decision rules 

Assume parammetric form $ \\Pi^{\\theta} $ for the policy, but:

1: distributionally robust contextual newsvendor problem 

- under type-1 Wasserstein ambiguity set
- without assuming an explicit structure on the policy class 

$ W_{p}\\left(\\mathbb{P}_{1}, \\mathbb{P}_{2}\\right)=\\inf _{\\gamma \\in \\mathcal{M}\\left(\\mathcal{Y}^{2}\\right)}\\left(\\int_{\\mathcal{Y} \\times \\mathcal{Y}}\\left\\|y_{1}-y_{2}\\right\\|^{p} \\gamma\\left(d y_{1}, d y_{2}\\right)\\right)^{\\frac{1}{p}} $

- type-$p$ Wasserstein distance between $ \\mathbb{P}_{1} $ and $ \\mathbb{P}_{2} $
- $ \\gamma $ is a joint distribution of $ y_{1} $ and $ y_{2} $ 
  - with marginals $ \\mathbb{P}_{1} $ and $ \\mathbb{P}_{2} $

2: avoids the degeneracies of ERM
- for generic $\\Pi  $
- by define an optimal "Shapley" extension 
  - to the scenario-based optimal policy

That is:

$ \\min _{\\pi \\in \\Pi} \\sup _{\\mathbb{Q} \\in \\mathcal{M}(\\mathcal{X} \\times \\mathcal{Y})}\\left\\{H(\\pi, \\mathbb{Q}): \\mathcal{W}\\left(\\mathbb{Q}, \\hat{\\mathbb{P}}_{N}\\right) \\leq r\\right\\} \\equiv \\min _{\\pi: \\hat{\\mathcal{X}} \\rightarrow \\mathcal{Z} }\\sup _{\\mathbb  Q\\in \\mathcal M ({\\mathcal { \\hat X }} \\times \\mathcal{Y})}\\left\\{H(\\pi, \\mathbb{Q}): \\mathcal{W}\\left(\\mathbb{Q}, \\hat{\\mathbb{P}}_{N}\\right) \\leq r\\right\\} $

- $ \\hat{\\mathcal{X}}:=\\cup_{i=1}^{N}\\left\\{\\boldsymbol{x}_{i}\\right\\} $ 
- $ \\mathcal{M}(\\hat{\\mathcal{X}} \\times \\mathcal{Y}) $ is the set of all distribution supported on $ \\hat{\\mathcal{X}} \\times \\mathcal{Y} $.

3: in non-contextual setting

4: use LDRs to solve dynamic optimization problems with side information

5: pertubed distributions in Wasserstein ambiguity set:
- have a different conditional information structure 
  - than estimated conditional distribution 
- DRO(distributionally robust optimization) with causal transport metric 
  - place an additional causality constraint on transport plan
  - compare to Wasserstein metric 

6: Bayesian interpretation of decision rule optimization 
- using SGD 
- provide an unbaised estimate of worst-case objective function of a DRO problem 
  - as long as a uniqueness condition is satisfied 
- Wasserstein ambiguity set violates this condition 
- use KL(Kullback-Leibler) divergence to train models 

# 4 SLO(Sequential learning and optimization )

- a more traditional setting 
  - sconditional distribution is learned from data 
  - used directlly in optimization model 
- attempt to produce disicions:
  - robust to model misspecification 

## 4.1 Learning conditional distribution 

employed discrete models for $ f_{\\boldsymbol{\\theta}}(\\boldsymbol{x}) $

- motivatied from computational perspective
  - CSO problem [(5)](#5) is easier to solve 

CSO under continuous distribution:
- needs to be first replaced by SAA to be solved

Difficult: assess probability of outcomes:
- that not present in the dataset 
- justifying fixing the support of $\\boldsymbol y $ to its observed values

### 4.1.1 Residual-based distribution 

1: use the errors of a trained regression model 
- construct conditional distributions 

Let: 

- $ g_{\\hat{\\theta}} $ be a regression model trained to predict
  - the response $ \\boldsymbol{y} $ 
  - from the covariate $ \\boldsymbol{x} $

minimizing an estimation error $ \\rho $ as in [(7)](#7)

$ \\boldsymbol{\\epsilon}_{i}=\\boldsymbol{y}_{i}-g_{\\hat{\\boldsymbol{\\theta}}}\\left(\\boldsymbol{x}_{i}\\right) $: residual error of sample $i $

$ \\left\\{\\boldsymbol{\\epsilon}_{i}\\right\\}_{i=1}^{N} $: set of residuals measured on the historical data 

- used to form the conditional distribution 

$ f_{\\boldsymbol{\\theta}}(\\boldsymbol{x})=\\mathbb{P}^{\\mathrm{ER}}(\\boldsymbol{x}):=\\frac{1}{N} \\sum_{i=1}^{N} \\delta_{\\operatorname{proj}_{\\mathcal{Y}}\\left(\\mathrm{g}_{\\hat{\\boldsymbol{\\theta}}}(\\boldsymbol{x})+\\boldsymbol{\\epsilon}_{\\mathrm{i}}\\right)} $: the conditional distribution 
- $ \\operatorname{proj}_{y} $ the projection on the support $ \\mathcal{Y} $

the rCSO(residual-based CSO):

#### 10

$ (\\mathbf{r C S O}) \\min _{\\boldsymbol{z} \\in \\mathcal{Z}} h\\left(\\boldsymbol{z}, \\mathbb{P}^{\\mathrm{ER}}(\\boldsymbol{x})\\right) $


Advantage:

- can be applied in conjunction with any trained regression model 

2: conditional distribution for two-stage and multi-stage CSO 
- use the residual obtained from parametric regression on historical data

Notice: historical data is used twice 

- train the regression model $g_{\\boldsymbol \\theta } $
- measure the residuals $\\boldsymbol \\varepsilon _i $

Lead to: underestimation of distribution of the residual error

To remove bias:

3: a leave-one-out model (jackknife)

- measure the residuals as: $ \\tilde{\\boldsymbol{\\epsilon}}_{i}=\\boldsymbol{y}_{i}-g_{\\hat{\\boldsymbol{\\theta}}_{-i}}\\left(\\boldsymbol{x}_{i}\\right) $ 
  -  $ \\hat{\\boldsymbol{\\theta}}_{-i} $ is trained using all except the $i $-th sample $ \\left(\\boldsymbol{x}_{i}, \\boldsymbol{y}_{i}\\right) $
- can be applied to heteroskedastic case in 3 
  - obtain this conditional distribution :
  - $ f_{\\boldsymbol{\\theta}}(\\boldsymbol{x}):=\\frac{1}{N} \\sum_{i=1}^{N} \\delta_{\\operatorname{proj}}^{\\mathcal{Y}}\\left(\\mathrm{g}_{\\hat{\\boldsymbol{\\theta}}}(\\boldsymbol{x})+\\hat{\\mathrm{Q}}(\\boldsymbol{x}) \\hat{\\boldsymbol{\\epsilon}}_{\\mathrm{i}}\\right) $
    - by first estimating the conditional covariance matrix $ \\hat{Q}(\\boldsymbol{x}) $
    - form the residuals:  $ \\hat{\\boldsymbol{\\epsilon}}_{i}=\\left[\\hat{Q}\\left(\\boldsymbol{x}_{i}\\right)\\right]^{-1}\\left(\\boldsymbol{y}_{i}-g_{\\hat{\\boldsymbol{\\theta}}}\\left(\\boldsymbol{x}_{i}\\right)\\right) $

### 4.1.2 Weight-based distribution 

A typical approach for formulating the CSO problem:

assign weights to observations of the uncertain parameters in the historical data 
- solve wSAA(weighted SAA problem) given by:

#### (11)

$ (\\mathbf{w S A A}) \\min _{z \\in \\mathcal{Z}} h\\left(\\boldsymbol{z}, \\sum_{i=1}^{N} w_{i}(\\boldsymbol{x}) \\delta_{\\boldsymbol{y}_{i}}\\right) $

- $ f_{\\boldsymbol{\\theta}}(\\boldsymbol{x})=\\sum_{i=1}^{N} w_{i}(\\boldsymbol{x}) \\delta_{\\boldsymbol{y}_{i}} $: conditional distribution 

  - fully determined by the function used to assign a weight to historical samples 


Different approaches be proposed 
- to determine the sample weights with ML method 

**Weights based on proximity**

Sample weights can be assigned based on the distance between:

- covariate $\\boldsymbol x $
- each historical sample $\\boldsymbol x_i$ 

Instance: (kNN)$k$-nearest neighbor estimation 

- gives equal weight to $k $ closest samples 
- 0 weight for all other samples 
- $ w_{i}^{\\mathrm{kNN}}(\\boldsymbol{x}):=(1 / k) \\mathbb{1}\\left[\\boldsymbol{x}_{i} \\in \\mathcal{N}_{k}(\\boldsymbol{x})\\right] $
  - $ \\mathcal{N}_{k}(\\boldsymbol{x}) $ the set of $ k $ nearest neighbors of $\\boldsymbol  x$
  - $ \\mathbb{1}[\\cdot] $ : the indicator function.

Though: simple

Benefit: asymptotic consistency
- guarantee prescriptive performance 

Another way: kernel density estimators 

NW(Nadaraya-Watson) kernel estimator employ a weight function:

$ w_{i}^{\\mathrm{KDE}}(\\boldsymbol{x}):=\\frac{K\\left(\\left(\\boldsymbol{x}-\\boldsymbol{x}_{i}\\right) / \\boldsymbol{\\theta}\\right)}{\\sum_{j=1}^{N} K\\left(\\left(\\boldsymbol{x}-\\boldsymbol{x}_{j}\\right) / \\boldsymbol{\\theta}\\right)} $

- $ K $ : kernel function 
- $ \\boldsymbol{\\theta} $ : its bandwidth parameter
- Can use different kernel function 
  - e.g. Gaussian kernel: $ K(\\boldsymbol{\\Delta}) \\propto \\exp \\left(-\\|\\boldsymbol{\\Delta}\\|^{2}\\right) $

Also: bayesian approach that :
- exploits the Dirichlet process mixture 
  - to assign sample weights

  **Weights based on random forest**

  Weights can be designed 
  - based on random forest regressors

  Simplest setting:
  - weight function of a decision tree regressor is given by:

  $ w_{i}^{t}(\\boldsymbol{x}):=\\frac{\\mathbb{1}\\left[\\mathcal{R}_{t}(\\boldsymbol{x})=\\mathcal{R}_{t}\\left(\\boldsymbol{x}_{i}\\right)\\right]}{\\sum_{j=1}^{N} \\mathbb{1}\\left[\\mathcal{R}_{t}(\\boldsymbol{x})=\\mathcal{R}_{t}\\left(\\boldsymbol{x}_{j}\\right)\\right]} $

  - $ \\mathcal{R}_{t}(\\boldsymbol{x}) $ : the terminal node of tree $ t $ 
    -  contains covariate $ \\boldsymbol{x} $

  A decision tree:
  - assign equal weights to all historical sample 
    - that end in the same leaf node as $\\boldsymbol  x $

  Random forest weight function:
  - generalize this idea 
  - over many random decision trees 

  Weight function is defined as:

  $ w_{i}^{\\mathrm{RF}}(\\boldsymbol{x}):=\\frac{1}{T} \\sum_{t=1}^{T} w_{i}^{t}(\\boldsymbol{x}) $

  - $ w_{i}^{t} $ the weight function of tree $ t $

  Random forests are trained for:

  - perform an inference task
    - e.g. regression, classification
  - also used and interpreted as:
  - nonparametric conditional density estimators

  1: conditions for the asymptotic optimality and consistency of prescriptions 
  - obtained by solving problem [(11)](#11)
  - with weights functions given by kNN, NW kernel estimator, local linear regression 

### 4.1.3 Expected value-based models 

When cost function is linear:

training pipeline of SLO:

reduces to conditional mean estimation 

1: train regression trees 
- forecast daily expected sales 
  - for different product categories
- inventory and pricing peoblem

May attempt to approximate the doncitional density $ f_{\\boldsymbol{\\theta}}(\\boldsymbol{x}) $ using a point prediction $ g_{\\boldsymbol{\\theta}}(\\boldsymbol{x}) $

2: a last-mile delivery problem 
- customer orders are assigned to drivers 
- replace conditional distribution of stochastic travel time 
  - with point predictor 
  - accounts for the number of stops, total distance of the trip 

## 4.2 Regularization and distributionally robust optimization 

Non-parametric conditional density estimation method benefit from asymptotic consistency, but:

- produce overly optimistic policies 
  - when size of covariate vector is large 

To circumvent this issue:

- regularize the CSO problem
- cast it as a DRO problem 
  - attempts to minimize the worst-case expected cost 
  - over the set of distributions $ \\mathcal{B}_{r}\\left(f_{\\boldsymbol{\\theta}}(\\boldsymbol{x})\\right) $
    - lie at a distance $r$
    - from the estimated distribution 
- $ f_{\\boldsymbol{\\theta}}(\\boldsymbol{x}) $

1: generate bootstrap data 
- from training set 
- use as prxy for "out-of-sample disappointment"
  - of action $\\boldsymbol z $
  - resulting from out-of-sample cost
    - exceeding the budget 
    - given by $ \\sup _{\\mathbb{Q}_{y} \\in \\mathcal{B}_{r}\\left(f_{\\theta}(\\boldsymbol{x})\\right)} h\\left(\\boldsymbol{z}, \\mathbb{Q}_{y}\\right) $
- for NW kernel estimator and KNN estimator:
  - DRO under a range of ambiguity set 
  - can be reformulated as convex optimization problem 
- Use KL divergence
  - measure distance between :
    - probability distributions 
  - obtain:
    - guarantees with respect to estimate-then-optimize model 
    - taking bootstrap data as proxy 
    - for out-of-sample data 

2: Taking center of Wasserstein ambiguity set:
- be NW kernel estimator 

Show that: 

- distributionally robust newsvendor and CVaR(conditional value at risk) portfolio optimization problems 
  - can be reformulated as convex program
- provide conditions to obtain:
  - asymptotic convergence 
  - out-of-sample guarantees on the solutions of DRO model 

3: study distributionally robust kNN regression problem 
- by combining point estimation of outcome
  - with DRO model over Wasserstein ambiguity set 
- use kNN predict the outcome 
  - based on weighted distance metric 
    - constructed from the estimate 

4: study a distributionally robust contextual portfolio allocation problem 
- worst-case conditional return-risk tradeoff is computed
  - over an optimal transport ambiguity set 
    - consisting of pertubations of joint distributions of covariates and returns 

- generalize the mean-variance and mean-CVaR model 
  - distributionally robust models are equivalent to 
    - semi-definite 
    - second-order cone representable program 

5: solve a DRO problem with novel ambiguity set 
- based on trimming the empirical conditional distribution 
  - i.e. reducing the weights over the support points 
- show thelink between trimming a distribution and partial mass transportation problem 
- 6: application in the optimal power flow problem 

7: Distributionally robust extension of rCSO model 
- hedges against all distributions 
  - lie in $r$ radius of (Wasserstein) ambiguity ball 
    - centered at the estimated distribution $\\mathbb  P ^{ER }(\\boldsymbol  x )$

8: a DRO model to solve two-stage multi-item joint production and pricing problem 
- with a partitioned-moment-based ambiguity set 
- constructed by clustering the residual 
  - estimated from an additive demand model 

9: an expected value-based model 
- suggest an ambiguity set that is informed by the estimation metric 
  - used to train $ g_{\\hat{\\theta}} $.
- that is:

$ \\min _{\\boldsymbol{z} \\in \\mathcal{Z}} \\sup _{\\boldsymbol{\\theta} \\in \\mathcal{U}(\\hat{\\boldsymbol{\\theta}}, r)} c\\left(\\boldsymbol{z}, g_{\\boldsymbol{\\theta}}(\\boldsymbol{x})\\right) $

- $ \\mathcal{U}(\\hat{\\boldsymbol{\\theta}}, r):=\\left\\{\\boldsymbol{\\theta} \\in \\boldsymbol{\\theta} \\mid \\rho\\left(g_{\\boldsymbol{\\theta}}, \\hat{\\mathbb{P}}_{N}\\right) \\leq \\rho\\left(g_{\\hat{\\boldsymbol{\\theta}}}, \\hat{\\mathbb{P}}_{N}\\right)+r\\right\\} $
- finite-dimensional convex reformulations can be obtained 
  - when $ g_{\\boldsymbol{\\theta}}(\\boldsymbol{x}):=\\boldsymbol{\\theta}^{T} \\boldsymbol{x} $
- promote the use of "robustness optimization" form 

# 5 Integrated learning and optimization 


ILO is an end-to-end framework that :

includes three components in the training pipeline: 

- (i) a prediction model that:
  -  maps the covariate to a predicted distribution (or possibly a point prediction), 
- (ii) an optimization model that:
  -  takes as input a prediction and returns a decision,
- (iii) a task-based loss function that :
  -  captures the downstream optimization problem.

The parameters of the prediction model are trained to : 

- maximize the prescriptive performance of the policy,
  -  i.e., it is trained on the task loss incurred by this induced policy 
  -  rather than the estimation loss.

Next:

we discuss several methods for implementing the ILO approach

- describing the different models that are used in ILO([Section 5.1]()) 
- present the algorithms used
to perform the training
- divide the algorithms into four categories :
  - unrolling([Section 5.2]())
  - implicit differentiation([Section 5.3]())
  - a surrogate differentiable loss function([Section 5.4]())
  - a differentiable optimizer([Section 5.5]())


## 5.1 Models

1: Train a prediction model 

- using a loss that:
  - influenced by performance of an action 
    - prescribed by conditional expected value-based decision rule
- in a protfolio management context 

More recent 
- integrate full optimization model into pipeline 

We next:
- summarize how ILO is applied to 2 contextual optimization model 
- introduce 2 additional popular task models 

### Expected value-based model 

Most literature:
- perform ILO on expected value-based optimization model 

Following the notation in [Definition 1](#definition-1-expected-value-based-model) :

$ \\mathcal{L}(\\boldsymbol{\\theta}):=H\\left(z^{*}\\left(\\cdot, g_{\\boldsymbol{\\theta}}\\right), \\hat{\\mathbb{P}}_{N}\\right)= $ $ \\mathbb{E}_{\\mathfrak{P}_{N}}\\left[c\\left(z^{*}\\left(\\boldsymbol{x}, g_{\\boldsymbol{\\theta}}\\right), \\boldsymbol{y}\\right)\\right] $
- loss, training pipeline interested in.

$ g_{\\boldsymbol{\\theta}}(\\boldsymbol{x}) $ 
- a point predictor for $ \\boldsymbol{y} $, 
-  we interpret as a prediction of $ \\mathbb{E}[\\boldsymbol{y} \\mid \\boldsymbol{x}] $.

This already raises challenges related to:
- the non-convexity of the integrated loss function $ \\mathcal{L}(\\boldsymbol{\\theta}) $ 
-  its differentiation with respect to $ \\boldsymbol{\\theta} $ :

$ \\begin{aligned} \\nabla_{\\boldsymbol{\\theta}} \\mathcal{L}(\\boldsymbol{\\theta}) & =\\frac{1}{N} \\sum_{i=1}^{N} \\nabla_{\\boldsymbol{\\theta}} c\\left(z^{*}\\left(\\boldsymbol{x}_{i}, g_{\\boldsymbol{\\theta}}\\right), \\boldsymbol{y}_{i}\\right) \\\\ & =\\left.\\frac{1}{N} \\sum_{i=1}^{N} \\sum_{j=1}^{d_{z}} \\sum_{k=1}^{d_{\\boldsymbol{y}}} \\frac{\\partial c\\left(z^{*}\\left(\\boldsymbol{x}_{i}, g_{\\boldsymbol{\\theta}}\\right), \\boldsymbol{y}_{i}\\right)}{\\partial z_{j}} \\frac{\\partial z_{j}^{*}\\left(\\boldsymbol{x}_{i}, \\hat{\\boldsymbol{y}}\\right)}{\\partial \\hat{y}_{k}}\\right|_{\\hat{\\boldsymbol{y}}=g_{\\theta}\\left(\\boldsymbol{x}_{i}\\right)} \\nabla_{\\boldsymbol{\\theta}}\\left[g_{\\boldsymbol{\\theta}}\\left(\\boldsymbol{x}_{i}\\right)\\right]_{k}\\end{aligned} $

- $ \\frac{\\partial z_{j}^{*}\\left(\\boldsymbol{x}_{i}, \\hat{\\boldsymbol{y}}\\right)}{\\partial \\hat{y}_{k}} $ : the most problematic evaluation
  - e.g.:  when $ z^{*}\\left(\\boldsymbol{x}_{i}, g_{\\boldsymbol{\\theta}}\\right) $ is the solution of a LP(Linear program) 
    - its gradient is either null or non-existent

### Conditional distribution-based model 

In the context of :

learning a conditional distribution model : $ f_{\\theta}(\\boldsymbol{x}) $

1: First study ILO problem 

- model distribution of uncertain parameter 
  - using parametric distribution 
- for newsvendor problem:
  - ILO outperform :
    - DRO with neural networks
    - SLO with MLE(maximum likelihood estimation)
  - when there is model misspecification 

Since then:

- formulate CSO problem as weighted SAA model (refer to [Section 4.1.2](#412-weight-based-distribution))

- prediction model amounts to identify vector of weights to assign to each historical sample 

Taken by 2:
- train random forest regressor in integrated fashion to assign weights 

by 3:
- how to train general differentiable models 
  - to predict probabilities of uncertain parameter $\\boldsymbol y$ with finite support 

### Regret minimization task

tackle ILO problem from regret 

1: contextual point predictor $ g_{\\boldsymbol{\\theta}}(\\boldsymbol{x}) $ is learned by:

- minimizing regret associated with implementing the prescribed action 
  - based on mean estimator $ g_{\\boldsymbol{\\theta}}(\\boldsymbol{x}) $ 
  - instead of based on the realized parameters $ \\boldsymbol{y} $
  - a.k.a: optimal hindsight or wait-and-see decision 

Value of an expected value-based policy  $ \\pi_{\\boldsymbol{\\theta}}(\\boldsymbol{x}):=  z^{*}\\left(\\boldsymbol{x}, g_{\\boldsymbol{\\theta}}\\right) $ is measured as the expected regret defined as:

#### (13)

$ H_{\\text {Regret }}\\left(\\pi_{\\boldsymbol{\\theta}}, \\mathbb{P}\\right):=\\mathbb{E}_{\\mathbb{P}}\\left[c\\left(\\pi_{\\boldsymbol{\\theta}}(\\boldsymbol{x}), \\boldsymbol{y}\\right)-c\\left(z^{*}(\\boldsymbol{x}, \\boldsymbol{y}), \\boldsymbol{y}\\right)\\right] $

Minimizing the expected regret: 
- returns the same optimal parameter vector $ \\boldsymbol{\\theta} $ as the [ILO problem (9)](#9). 

Because:

$ H_{\\text {Regret }}\\left(\\pi, \\hat{\\mathbb{P}}_{N}\\right)=\\mathbb{E}_{\\hat{\\mathbb{P}}_{N}}\\left[c(\\pi(\\boldsymbol{x}), \\boldsymbol{y})-c\\left(z^{*}(\\boldsymbol{x}, \\boldsymbol{y}), \\boldsymbol{y}\\right)\\right]=H\\left(\\pi, \\hat{\\mathbb{P}}_{N}\\right)-\\mathbb{E}_{\\hat{\\mathbb{P}}_{N}}\\left[c\\left(z^{*}(\\boldsymbol{x}, \\boldsymbol{y}), \\boldsymbol{y}\\right)\\right] $

- both $ H_{\\text {Regret }}\\left(\\pi, \\hat{\\mathbb{P}}_{N}\\right) $ and $ H\\left(\\pi, \\hat{\\mathbb{P}}_{N}\\right) $ have the same set of minimizers

### Optimal action imitation task 

ILO has some connections to inverse optimization :

- learning the parameters of an optimization model 
  - given data about its optimal solution

one can :

replace the original objective of ILO 
- with an objective that seeks 
- to produce a $ z^{*}\\left(\\boldsymbol{x}, f_{\\boldsymbol{\\theta}}\\right) $ 
  - that is as close as possible to the optimal hindsight action 
  - and, therefore, closer to the regret objective. 

Specifically, to learn a policy that "imitates" the optimal hindsight action: 

one can first augment the data set 
- with $ \\boldsymbol{z}_{i}^{*}:=z^{*}\\left(\\boldsymbol{x}_{i}, \\boldsymbol{y}_{i}\\right) $ to get $ \\left\\{\\left(\\boldsymbol{x}_{i}, \\boldsymbol{y}_{i}, \\boldsymbol{z}_{i}^{*}\\right)\\right\\}_{i=1}^{N} $. 

Thereafter:

a prediction model $ f_{\\boldsymbol{\\theta}}(\\boldsymbol{x}) $ is learned in a way : 
- that the action $ z^{*}\\left(\\boldsymbol{x}_{i}, f_{\\boldsymbol{\\theta}}\\right) $ is as close as possible to $ \\boldsymbol{z}_{i}^{*} $
  -  for all samples in the training set:

#### (14)

$ H_{\\text {Imitation }}\\left(\\pi, \\hat{\\mathbb{P}}_{N}^{\\prime}\\right):=\\mathbb{E}_{\\hat{\\mathbb{P}}_{N}^{\\prime}}\\left[d\\left(\\pi(\\boldsymbol{x}), \\boldsymbol{z}^{*}\\right)\\right]=\\mathbb{E}_{\\hat{\\mathbb{P}}_{N}}\\left[d\\left(\\pi(\\boldsymbol{x}), z^{*}(\\boldsymbol{x}, \\boldsymbol{y})\\right)\\right] $


- $ \\hat{\\mathbb{P}}_{N}^{\\prime} $ : the empirical distribution 
  - on the lifted tuple $ \\left(\\boldsymbol{x}, \\boldsymbol{y}, z^{*}(\\boldsymbol{x}, \\boldsymbol{y})\\right) $ 
  - based on the augmented data set 
  - and a distance function $ d\\left(\\boldsymbol{z}, \\boldsymbol{z}^{*}\\right) $. 

Note that:

there is no reason to believe that: 

the best imitator under a general distance function, 
- e.g., $ \\left\\|\\boldsymbol{z}-\\boldsymbol{z}^{*}\\right\\|_{2} $, 

performs well under our original metric $ H\\left(\\pi, \\hat{\\mathbb{P}}_{N}\\right) $.

One exception:

For $ d\\left(\\boldsymbol{z}, \\boldsymbol{z}^{*}\\right):=c(\\boldsymbol{z}, \\boldsymbol{y})-c\\left(\\boldsymbol{z}^{*}, \\boldsymbol{y}\\right) $, 
- where we allow the distance to also depend on $ \\boldsymbol{y} $, 
- for which we recover the regret minimization approach
- therefore the same solution as with $ H\\left(\\pi, \\hat{\\mathbb{P}}_{N}\\right) $. 

## 5.2 Training by unrolling 

An approach to obtain Jacobian matrix $ \\boldsymbol{\\kappa} \\frac{\\partial z^{*}(\\boldsymbol{x}, \\hat{\\boldsymbol{y}})}{\\partial \\hat{\\boldsymbol{y}}} $ : unrolling 

it involves:

- approximating the optimization problem with an iterative solver
  - e.g.:  first-order gradient-based method 

Each operation is stored on the computational graph, 
- then allows, in principle, for computing gradients through classical back-propagation methods. 

Unfortunately: this approach requires extensive amounts of memory. 

Besides this: 

the large size of the computational graph 
- exacerbates the vanishing and exploding gradient problems 
  - typically associated with training neural networks

## Training using implicit differentiation 

Implicit differentiation allows:
- a memory-efficient backpropagation 
- as opposed to unrolling 
  - (we refer to Bai et al. 2019, for discussion on training constant memory implicit models using a fixed-point - FP - equation and feedforward networks of infinite depths).

1: appear to be the first to have employed implicit differentiation methods to train an ILO model
- which they refer to as OptNet. 

They consider expected value-based optimization models 
- take the form of constrained quadratic programs (QP) with equality and inequality constraints. 

They show how the implicit function theorem (IFT - Halkin 1974) can be used to differentiate $ z^{*}\\left(\\boldsymbol{x}, g_{\\boldsymbol{\\theta}}\\right) $ with respect to $ \\boldsymbol{\\theta} $
- using the Karush-Kuhn-Tucker (KKT) conditions 
  -  are satisfied at optimality. 

Further:

they provide a custom solver based on a primal-dual interior method

- to simultaneously solve multiple QPs on GPUs in batch form, 
- permitting 100-times speedups compared to Gurobi and CPLEX. 

This approach is extended to conditional stochastic and strongly convex optimization models in Donti et al. (2017): 

They use sequential quadratic programming (SQP) to obtain quadratic approximations of the objective functions of the convex program at each iteration 

- until convergence to the solution and then differentiate the last iteration of SQP to obtain the Jacobian. 

For a broader view of implicit differentiation: we refer to the surveys by Duvenaud et al. (2020) and Blondel et al. (2022).

To solve large-scale QPs with linear equality and box inequality constraints:

2 Butler and Kwon (2023a) use the ADMM algorithm to decouple the differentiation procedure for primal and dual variables

thereby:
- decomposing the large problem into smaller subproblems. 

Their procedure relies on: 
- implicit differentiation of the FP equations of the alternating direction method of multipliers (ADMM) algorithm (ADMM-FP). 

They show that: 
- unrolling the iterations of the ADMM algorithm on the computational graph (Sun et al. 2016, Xie et al. 2019) results in higher computation time than ADMM-FP. 

Their empirical results on a portfolio optimization problem with 254 assets suggest that : 

computational time can be reduced by a factor of almost five 
- by using ADMM-FP compared to OptNet, 

mostly due to the use of the ADMM algorithm in the forward pass. 

Note that the experiments in Butler and Kwon (2023a) were conducted on a
CPU.

To extend OptNet to a broader class of problems:

3 introduce cvxpylayers that 
- relies on converting disciplined convex programs in the domain-specific language 
  - used by CVXPY into conic programs. 

They implicitly differentiate the residual map of the homogeneous self-dual embedding associated with the conic program.

4: note that using KKT conditions for constrained optimization problems with DNN-based policies"
- is computationally costly 
  - as "cvxpylayers struggles with solving problems containing more than 100 variables" (see also Butler and Kwon 2023a).
-  An alternative is to use projected gradient descent (PGD) 
   - where DNN-based policies are updated using an iterative solver 
   - and projected onto the constraint set $ \\mathcal{Z} $ at each iteration 
   - and the associated FP system (Donti et al. 2021, Chen et al. 2021, Blondel et al. 2022) is used to obtain the Jacobian.
 - Since a closed-form solution for the projection onto $ \\mathcal{Z} $ is unavailable in many cases, 
   - the projection step may be costly, 
   - and in some cases, PGD may not even converge to a feasible point (Rychener et al. 2023). 

To avoid computing the projection in the forward pass, 5 solve the expected value-based CSO problem using: 
- Davis-Yin operator splitting (Davis and Yin 2017) 
- while the backward pass uses the Jacobian-free backpropagation (Fung et al. 2022) 
  - in which the Jacobian matrix is replaced with an identity matrix (see also Sahoo et al. 2023, where a similar approach is used for expected value-based models).

To mitigate the issues with unrolling: 6 propose FP folding (fold-opt) that:
- allows analytically differentiating the FP system of general iterative solvers, 
  - e.g., ADMM, SQP, and PGD. 

By unfolding (i.e., partial unrolling), some of the steps of unrolling are grouped in analytically differentiable update function $ \\mathcal{T}: \\mathbb{R}^{d_{y}} \\rightarrow \\mathbb{R}^{d_{y}} $ :

$ z_{k+1}(\\boldsymbol{x}, \\hat{\\boldsymbol{y}})=\\mathcal{T}\\left(z_{k}(\\boldsymbol{x}, \\hat{\\boldsymbol{y}}), \\hat{\\boldsymbol{y}}\\right) $

Realizing that $ z^{*}(\\boldsymbol{x}, \\hat{\\boldsymbol{y}}) $ is the FP of the above system:
- they use the IFT to obtain a linear system (a differential FP condition) 
  - that can be solved to obtain the Jacobian. 

This effectively decouples the forward and backward pass enabling 
- the use of black box solvers like Gurobi for the forward pass 
- while cvxpylayers is restricted to operator splitting solvers like ADMM. 


An added benefit of using fold-opt is that: 

it can solve non-convex problems. 

In the case of portfolio optimization, the authors note that :

- the superior performance of their model with respect to cvxpylayers can be explained by the precise calculations made in the forward pass by Gurobi.



While speedups can be obtained for sparse problems, Sun et al. (2023b) remark that:
- the complexity associated with differentiating the KKT conditions is cubic in the total number of decision variables and constraints in general. 

They propose an alternating differentiation framework (called Alt-Diff) to:
- solve parameterized convex optimization problems 
- with polyhedral constraints using ADMM 
  - that decouples the objective and constraints. 

This procedure results in:

a smaller Jacobian matrix 
- when there are many constraints 
- since the gradient computations for primal, dual, and slack variables are done alternatingly. 

The gradients are shown to converge to those obtained by differentiating the KKT conditions. 

The authors employ truncation of iterations to compensate for the slow convergence of ADMM when compared to interior-point methods 

and provide theoretical upper bounds on the error in the resulting gradients. 

Alt-Diff is shown to achieve the same accuracy with truncation and lower computational time when compared to cvxpylayers:
- for an energy generation scheduling problem.

Motivated by OptNet, several extensions have been proposed to solve linear and combinatorial problems. 

7 solve LP-representable combinatorial optimization problems and LP relaxations of combinatorial problems during the training phase. 

Their model, referred to as QPTL (Quadratic Programming Task Loss):

- adds a quadratic penalty term to the objective function of the linear problem. 

This has two advantages: 
- it recovers a differentiable linear-quadratic program, and the added term acts as a regularizer, 
- which might avoid overfitting. 

To solve a general mixed-integer LP (MILP), 8 develop a cutting plane method MIPaal,
- which adds a given number of cutting planes in the form of constraints $ S \\boldsymbol{z} \\leq \\boldsymbol{s} $ to the LP relaxation of the MILP.

Instead of adding a quadratic term, 9 propose Intopt based on the interior point method to solve LPs
- that adds a log barrier term to the objective function and differentiates the homogeneous self-dual formulation of the LP. 

Their experimental analyses show that: 
- this approach performs better on energy cost-aware scheduling problems than QPTL using the data from Ifrim et al. (2012).

10 introduce an ILO framework with the weighted average of Sharpe ratio and MSE loss as a task loss and replace the optimization problem with a surrogate DRO problem. 

By using convex duality:

they reformulate the minimax problem as a minimization problem and learn the parameters (e.g., size of ambiguity set) using implicit differentiation instead of cross-validation (CV). 

More specifically, the DRO model uses a deviation risk measure (e.g., variance) to control variability in the portfolio returns associated with the prediction errors $ \\boldsymbol{\\epsilon}_{i}= $ $ \\boldsymbol{y}_{i}-g_{\\theta}\\left(\\boldsymbol{x}_{i}\\right): $

$ \\underset{\\boldsymbol{z}}{\\operatorname{argmin}} \\max _{\\mathbb{Q} \\in \\mathcal{B}_{r}^{\\phi}\\left(\\hat{\\mathbb{P}}_{N}\\right)} \\mathbb{E}_{\\mathbb{Q}}\\left[\\left(\\boldsymbol{\\epsilon}^{\\top} \\boldsymbol{z}-\\mathbb{E}_{\\mathbb{Q}}\\left[\\boldsymbol{\\epsilon}^{\\top} \\boldsymbol{z}\\right]\\right)^{2}\\right] $

- the distribution of errors lies in $ \\phi $-divergence (e.g., Hellinger distance) based ambiguity set $ \\mathcal{B}_{r}^{\\phi}\\left(\\hat{\\mathbb{P}}_{N}\\right)=\\left\\{\\mathbb{Q}: \\mathbb{E}_{\\hat{\\mathbb{P}}}[\\phi(\\mathbb{Q} / \\hat{\\mathbb{P}})] \\leq r\\right\\} $ centered at $ \\hat{\\mathbb{P}}_{N}=\\frac{1}{N} \\sum_{i=1}^{N} \\delta_{\\epsilon_{i}} $.

For convex problems, the optimality conditions are given by KKT conditions, 

can be represented as $ F(\\boldsymbol{\\theta}, \\boldsymbol{z})=0 $ 
- $ F: \\mathbb{R}^{d_{\\boldsymbol{x}}} \\times \\mathbb{R}^{d_{\\boldsymbol{z}}} \\rightarrow \\mathbb{R}^{m} $, 
  - $ m $ is proportional to the number of constraints that define $ \\mathcal{Z} $. 

From the classical IFT (Dontchev et al. 2009), we know that: 

if $ F $ is continuously differentiable and the Jacobian matrix with respect to $ \\boldsymbol{z} $, 
- denoted by $ \\nabla_{\\boldsymbol{z}} F(\\boldsymbol{\\theta}, \\boldsymbol{z}(\\boldsymbol{\\theta})) $, 

is non-singular at the point $ (\\overline{\\boldsymbol{\\theta}}, \\overline{\\boldsymbol{z}}) $, 

then:

there exists a neighborhood around $ \\overline{\\boldsymbol{\\theta}} $ 
- for which the gradient of the optimal solution with respect to the parameters is given by:

$ \\frac{\\partial \\boldsymbol{z}^{*}(\\boldsymbol{\\theta})}{\\partial \\boldsymbol{\\theta}}=-\\left(\\nabla_{\\boldsymbol{z}} F(\\boldsymbol{\\theta}, \\boldsymbol{z}(\\boldsymbol{\\theta}))\\right)^{-1} \\nabla_{\\boldsymbol{\\theta}} F(\\boldsymbol{\\theta}, \\boldsymbol{z}(\\boldsymbol{\\theta})) $

When the Jacobian matrix $ \\nabla_{\\boldsymbol{z}} F(\\boldsymbol{\\theta}, \\boldsymbol{z}(\\boldsymbol{\\theta})) $ is singular, classical IFT cannot be applied. 

This occurs in linear programs and can also arise in smooth QPs as shown in 11

11 obtain a generalization of IFT to non-smooth functions:
- using conservative Jacobians that generalize Clarke Jacobians (Clarke 1990) for locally Lipschitz function $ F $. 

They also derive conservative Jacobians for conic optimization layers (Agrawal et al. 2019).

Further, 12 illustrate using cvxpylayers that in a bilevel program 

- which is a composition of a quadratic function 
  - with the solution map of a linear program, 

gradient descent does not converge but gets stuck in a "limit cycle of non-critical points" even though invertibility condition does not hold only on a set of measure 0 (defined by a line) 
- where the solution map moves from extreme point to another. 

As this example illustrates, the convergence of gradient methods based on IFT can be impacted by the non-invertibility of the Jacobian matrix and nonsmoothness 
- which is difficult to verify a priori. 

As a result, research efforts have been directed toward designing surrogate loss functions and perturbation-based models for CSO problems that could circumvent the need to use the IFT.

## 5.4  Training using a surrogate differentiable loss function

As discussed in Section 5.1, 

minimizing directly the task loss in [(9)](#9) or the regret in [(13)](#13) is computationally difficult in most cases. 

For instance: 

the loss may be piecewise-constant as a function of the parameters of a prediction model and, 
- thus, may have no informative gradient. 

To address this issue, several surrogate loss functions with good properties, 
- e.g., differentiability and convexity,

have been proposed to train ILO models.

### 5.4.1 SPO+

In CSO problems, 1 first tackle the potential nonuniqueness of $ z^{*}\\left(\\boldsymbol{x}, g_{\\boldsymbol{\\theta}}\\right) $ by introducing a Smart "Predict, then Optimize" (SPO) model 
- where the decision-maker chooses to minimize the empirical average of the regret 
  - under the worst-case optimal solution as defined below:

#### (15)

$ \\begin{aligned} \\text { (SPO) } \\quad \\min _{\\boldsymbol{\\theta}} \\max _{\\pi} & H_{\\text {Regret }}\\left(\\pi, \\hat{\\mathbb{P}}_{N}\\right), \\\\ & \\text { s.t. } \\pi(\\boldsymbol{x}) \\in \\underset{\\boldsymbol{z} \\in \\mathcal{Z}}{\\operatorname{argmin}} c\\left(\\boldsymbol{z}, g_{\\boldsymbol{\\theta}}(\\boldsymbol{x})\\right), \\forall \\boldsymbol{x} .\\end{aligned} $

In the expected value-based model, they show that the SPO objective reduces to training the prediction model according to the ERM problem:

$ \\boldsymbol{\\theta}^{\\star} \\in \\underset{\\boldsymbol{\\theta}}{\\operatorname{argmin}} \\rho_{\\text {SPO }}\\left(g_{\\boldsymbol{\\theta}}, \\hat{\\mathbb{P}}_{N}\\right):=\\mathbb{E}_{\\hat{\\mathbb{P}}_{N}}\\left[\\ell_{\\text {SPO }}\\left(g_{\\boldsymbol{\\theta}}(\\boldsymbol{x}), \\boldsymbol{y}\\right)\\right] $

- $ \\ell_{\\mathrm{SPO}}(\\hat{\\boldsymbol{y}}, \\boldsymbol{y}):=\\sup _{\\overline{\\boldsymbol{z}} \\in \\operatorname{argmin}_{\\boldsymbol{z} \\in \\mathcal{Z}} c(\\boldsymbol{z}, \\hat{\\boldsymbol{y}})} c(\\overline{\\boldsymbol{z}}, \\boldsymbol{y})-c\\left(z^{*}(\\boldsymbol{x}, \\boldsymbol{y}), \\boldsymbol{y}\\right) $

Since the SPO loss function is nonconvex and discontinuous in $ \\hat{\\boldsymbol{y}} $ (Ho-Nguyen and Kılıç-Karzan 2022, Lemma 1), Elmachtoub and Grigas (2022) focus on the linear objective $ c(\\boldsymbol{z}, \\boldsymbol{y}):=\\boldsymbol{y}^{T} \\boldsymbol{z} $ and replace the SPO loss with a convex upper bound called SPO+:

$ \\ell_{\\text {SPO }+}(\\hat{\\boldsymbol{y}}, \\boldsymbol{y}):=\\sup _{\\boldsymbol{z} \\in \\mathcal{Z}}(\\boldsymbol{y}-2 \\hat{\\boldsymbol{y}})^{T} \\boldsymbol{z}+2 \\hat{\\boldsymbol{y}}^{T} z^{*}(\\boldsymbol{x}, \\boldsymbol{y})-\\boldsymbol{y}^{T} z^{*}(\\boldsymbol{x}, \\boldsymbol{y}) $

 has a closed-form expression for its subgradient:

#### (16)

$ 2\\left(z^{*}(\\boldsymbol{x}, \\boldsymbol{y})-z^{*}(\\boldsymbol{x}, 2 \\hat{\\boldsymbol{y}}-\\boldsymbol{y})\\right) \\in \\nabla_{\\hat{\\boldsymbol{y}}} \\ell_{\\mathbf{s P O}+}(\\hat{\\boldsymbol{y}}, \\boldsymbol{y}) $

Loke et al. (2022) propose a decision-driven regularization model (DDR) 
- that combines prediction accuracy - and decision quality 
in a single optimization problem with loss function as follows:

$ \\ell_{\\mathrm{DDR}}(\\hat{\\boldsymbol{y}}, \\boldsymbol{y})=d(\\hat{\\boldsymbol{y}}, \\boldsymbol{y})-\\lambda \\min _{\\boldsymbol{z} \\in \\mathcal{Z}}\\left\\{\\mu \\boldsymbol{y}^{\\top} \\boldsymbol{z}+(1-\\mu) \\hat{\\boldsymbol{y}}^{\\top} \\boldsymbol{z}\\right\\} $

and SPO+ being a special case with $ \\mu=-1, \\lambda=1 $, and $ d(\\hat{\\boldsymbol{y}}, \\boldsymbol{y})=2 \\hat{\\boldsymbol{y}}^{\\top} z^{*}(\\boldsymbol{x}, \\boldsymbol{y})-\\boldsymbol{y}^{T} z^{*}(\\boldsymbol{x}, \\boldsymbol{y}) $.

#### SPO+ for combinatorial problems

Evaluating the gradient of $ S P O+l o s s $ in [(16)](#16) requires solving the optimization problem [(8)](#8) to obtain $ z^{*}(\\boldsymbol{x}, 2 \\hat{\\boldsymbol{y}}-\\boldsymbol{y}) $ for each data point. 

This can be computationally demanding when the optimization model in [(8)](#8) is an NP-hard problem. 

1 propose a SPO-relax approach that : 

- computes the gradient of SPO+ loss by solving instead a continuous relaxation when [(8)](#8) is a MILP. 

They also suggest: 
- speeding up the resolution using a warm-start for learning with a pre-trained model that:
  -  uses MSE as the loss function. 
- Another way proposed to speed up the computation is: warm-starting the solver. 
  - For example, $ z^{*}(\\boldsymbol{x}, \\boldsymbol{y}) $ can be used as a starting point for MILP solvers or to cut away a large part of the feasible space.

Mandi et al. (2020) show that:
- for weighted and unweighted knapsack problems as well as energycost aware scheduling problems (CSPLib, Problem 059, Simonis et al. 2014), SPO-relax results in:
- faster convergence and similar performance compared to SPO+ loss. 

Also, SPO-relax provides low regret solutions and faster convergence compared to QPTL 
- in the aforementioned three problems, 
- except in the weighted knapsack problem with low capacity.

With a focus on exact solution approaches, Jeong et al. (2022) study the problem of:

minimizing the regret in [(13)](#13) assuming a linear prediction model $ g_{\\boldsymbol{\\theta}}(\\boldsymbol{x})=\\boldsymbol{\\theta} \\boldsymbol{x} $ with $ \\boldsymbol{\\theta} \\in \\mathbb{R}^{d_{\\boldsymbol{z}} \\times d_{\\boldsymbol{x}}} $. 

Under the assumption that : 

$ z^{*}\\left(\\boldsymbol{x}, g_{\\boldsymbol{\\theta}}\\right) $ is unique for all $ \\boldsymbol{\\theta} $ and $ \\boldsymbol{x} $, 

the authors reformulate the bilevel SPO problem as a single-level MILP using symbolic variable elimination. 

They show that:
- their model can achieve up to two orders of magnitude improvement in expected regret compared to SPO+ on the training set.

Muñoz et al. (2022) applies a similar idea of representing the set of optimal solutions with a MILP. 

They rely on the KKT conditions of the problem defining $ z^{*}\\left(\\boldsymbol{x}, g_{\\boldsymbol{\\theta}}\\right) $
- to transform the bilevel integrated problem into a single-level MILP. 

Finally, Estes and Richard (2023) use the SPO loss function
- to solve a two-stage LP with right-hand side uncertainty. 

They propose a lexicographical ordering rule to select the minimal solution 
- when there are multiple optima and approximate the resulting piecewise-linear loss function, lex-SPO, by a convex surrogate to find the point predictor.

#### SPO Trees. 

Elmachtoub et al. (2020) propose a model (SPOT) to construct decision trees that:

- segment the covariates based on the SPO loss function
-  while retaining the interpretability in the end-to-end learning framework.

Their model outperforms classification and regression trees (CART) in the numerical experiments 

on a news recommendation problem using a real-world dataset 

and on the shortest path problem with synthetic data (also used in Elmachtoub and Grigas (2022)).

Guarantees. Elmachtoub and Grigas (2022) show that: 

under certain conditions, the minimizers of the SPO loss, SPO+ loss and MSE loss are almost always equal to $ \\mathbb{E}_{\\mathbb{P}(\\boldsymbol{y} \\mid \\boldsymbol{x})}[\\boldsymbol{y}] $
- given that $ \\mathbb{E}_{\\mathbb{P}(\\boldsymbol{y} \\mid \\boldsymbol{x})}[\\boldsymbol{y}] \\in \\mathcal{H} $. 

Thus, $ \\mathbf{S P O}+ $ is Fisher consistent (see Definition 4 in Appendix A) with respect to the SPO loss. 

This means that: 
- minimizing the surrogate loss also minimizes the true loss function. 

Ho-Nguyen and Kılınç-Karzan (2022) show that: 

for some examples of a multiclass classification problem, SPO+ is Fisher inconsistent, 
- while MSE loss is consistent. 

However, complete knowledge of the distribution is a limitation in practice
- where the decision-maker has access to only the samples from the distribution.

As a result, Ho-Nguyen and Kılınç-Karzan (2022) and Liu and Grigas (2021) provide calibration bounds:
- that hold for a class of distributions $ \\mathcal{D} $ on $ \\mathcal{X} \\times \\mathcal{Y} $ and ensure that:
- a lower excess risk of predictor for MSE and SPO+, respectively, translates to lower excess SPO risk (see Definition 5 in Appendix A).

In many ML applications, one seeks to derive finite-sample guarantees, 
- which are given in the form of a generalization bound,
  - i.e., an upper bound on the difference between the true risk of a loss function and its empirical risk estimate for a given sample size $ N $. 
A generalization bound for the SPO loss function is given in El Balghiti et al. (2022) (extension of El Balghiti et al. 2019) based on Rademacher complexity (see Definition 6 in Appendix A) of the SPO loss composed with the prediction functions $ g_{\\boldsymbol{\\theta}} \\in \\mathcal{H} $. 

More specifically, the bound achieved in El Balghiti et al. (2019) is $ \\mathrm{O}\\left(\\sqrt{\\frac{\\log (N)}{N}}\\right) $, and tighter bounds with respect to action and feature dimension are obtained using SPO function's structure 

and if $ \\mathcal{Z} $ satisfies a "strength" property. 


Hu et al. (2022) show that for linear CSO problems, the generalization bound for MSE loss and SPO loss is $ \\mathrm{O}\\left(\\sqrt{\\frac{1}{N}}\\right) $ 

while faster convergence rates for the SLO model compared to ILO model are obtained under certain low-noise assumptions. 

Elmachtoub et al. (2023) show that :

for non-linear optimization problems, SLO models stochastically dominate ILO in terms of their asymptotic optimality gaps
- when the hypothesis class covers the true distribution.

When the model is misspecified, they show that:

ILO outperforms SLO asymptotically in a general nonlinear setting.

### 5.4.2 Surrogate loss for a stochastic forest.

Kallus and Mao (2022) propose an algorithm called StochOptForest, 
- which generalizes the random-forest based local parameter estimation procedure in Athey et al. (2019). 

A second-order perturbation analysis of stochastic optimization problems allows them to scale to larger CSO problems 

since they can avoid solving an optimization problem at each candidate split. 

The policies obtained using their model are shown to be asymptotically consistent, 

and the benefit of ILO is illustrated by comparing their approach to the random forests of Bertsimas and Kallus (2020)
- on a set of problems with synthetic and real-world data.

### 5.4.3. Other surrogates. 

Wilder et al. (2019b) introduce ClusterNet to solve hard combinatorial graph optimization problems:
- by learning incomplete graphs. The model combines graph convolution networks
- to embed the graphs in a continuous space
- and uses a soft version of k-means clustering to obtain a differential proxy for the combinatorial problems,
  - e.g., community detection and facility location.

Numerical experiments on a synthetic data set show that:
- ClusterNet outperforms the two-stage SLO approach of first learning the graph and then optimizing, 
- as well as other baselines used in community detection and facility location.

Focusing on combinatorial problems, Vlastelica et al. (2019) propose a differentiable black-box (DBB) approach to tackle the issue that : 

the Jacobian of $ z^{*}\\left(\\boldsymbol{x}, g_{\\boldsymbol{\\theta}}\\right) $ is zero almost everywhere 

by approximating the true loss function 
- using an interpolation controlled in a way that
  -  balances between "informativeness of the gradient" and "faithfulness to the original function".

Algorithmically, this is done by perturbing the prediction $ g_{\\boldsymbol{\\theta}}(\\boldsymbol{x}) $ in the direction $ \\nabla_{\\boldsymbol{z}} c\\left(z^{*}\\left(\\boldsymbol{x}, g_{\\boldsymbol{\\theta}}\\right), \\boldsymbol{y}\\right) $ and obtaining a gradient of the surrogate loss based on the effect of this perturbation on the resulting perturbed action.

Chung et al. (2022) introduce a computationally tractable ILO model : 

to solve non-linear CSO problems. 

Using the first-order Taylor expansion of the task loss around the prediction, 

they introduce a reweighted MSE loss function 

- where weights are determined by taking the gradient of task loss with respect to the prediction. 

To solve a large-scale multi-facility inventory allocation problem 
- with few samples for each facility, 

they use a single random forest that:

can predict the demand across facilities and products.

Assuming that each tree in the random forest provides an independent and identically distributed realization of the uncertain parameter, 

they obtain the conditional distribution of uncertain parameter, $ f_{\\theta_{0}}=\\frac{1}{T} \\sum_{t=1}^{T} \\delta_{\\hat{\\boldsymbol{y}}^{t}} $, 
- where $ \\hat{\\boldsymbol{y}}^{t} $ is the prediction of tree $ t $.

For each feature $ \\boldsymbol{x}_{i} $ and conditional distribution $ f_{\\boldsymbol{\\theta}_{0}} $, 

they obtain an optimal allocation, $ z_{i}^{j}= $ $ z^{*}\\left(\\boldsymbol{x}, f_{\\boldsymbol{\\theta}_{0}}\\right) $ for facility $ j $ 
- that minimizes the average unmet demand. In the last step, they retrain the random forest to minimize the reweighted MSE loss function:

#### (17)

$ \\underset{\\boldsymbol{\\theta}}{\\operatorname{argmin}} \\sum_{i=1}^{N} \\sum_{j=1}^{M} \\sum_{t=1}^{T} \\mathbb{1}\\left[\\hat{y}_{i}^{t, j} \\geq s_{i}^{j}+z_{i}^{j}\\right]\\left|f_{\\boldsymbol{\\theta}}\\left(\\boldsymbol{x}_{i}\\right)-\\hat{y}_{i}^{t, j}\\right| $

- $ M $ is the number of facilities, 
- $ \\hat{y}_{i}^{t, j} $ and $ s_{i}^{j} $ denote the demand and inventory levels, respectively, at facility $ j $. 

The above model [(17)](#17) solves the optimization problem once during training, 

and is shown to be scalable for a medical allocation problem in Sierra Leone when compared to Kallus and Mao (2022)
- where splitting of the feature space is done based on the task loss.

Lawless and Zhou (2022) introduce a loss function similar to Chung et al. (2022) that:

weighs the prediction error with a regret term as follows:

#### (18)

$ d\\left(g_{\\boldsymbol{\\theta}}(\\boldsymbol{x}), \\boldsymbol{y}\\right)=\\left[c\\left(z^{*}\\left(\\boldsymbol{x}, g_{\\boldsymbol{\\theta}}\\right), \\boldsymbol{y}\\right)-c\\left(z^{*}(\\boldsymbol{x}, \\boldsymbol{y}), \\boldsymbol{y}\\right)\\right]\\left(\\boldsymbol{y}-g_{\\boldsymbol{\\theta}}(\\boldsymbol{x})\\right)^{2} $

Learning optimal $ \\boldsymbol{\\theta} $ from the above formulation involves an $ \\operatorname{argmin} $ differentiation. 

So, the authors provide a two-step polynomial time algorithm to approximately solve the above problem:

It first computes a pilot estimator $ g_{\\boldsymbol{\\theta}_{0}} $
- by solving [(7)](#7) with $ d\\left(g_{\\boldsymbol{\\theta}}(\\boldsymbol{x}), \\boldsymbol{y}\\right)=\\left(g_{\\boldsymbol{\\theta}}(\\boldsymbol{x})-\\boldsymbol{y}\\right)^{2} $ 

and then solving [(7)](#7) with the distance function in [(18)](#18) where:
-  $ c\\left(z^{*}\\left(\\boldsymbol{x}, g_{\\boldsymbol{\\theta}}\\right), \\boldsymbol{y}\\right) $ is substituted with $ c\\left(z^{*}\\left(\\boldsymbol{x}, g_{\\boldsymbol{\\theta}_{0}}\\right), \\boldsymbol{y}\\right) $. 

The authors show that their simple algorithm performs comparably to SPO+.

We conclude this subsection on surrogate loss functions by : mentioning the efforts in Sun et al. (2023a) to learn a cost point estimator (in an expected value-based model)
- to imitate the hindsight optimal solution.

This is done by designing a surrogate loss function that:
- penalizes how much the optimal basis optimality conditions are violated. 

They derive generalization error bounds for this new loss function and employ them to provide a bound on the sub-optimality of the minimal $ \\theta $.

## 5.5  Training using a surrogate differentiable optimizer

### 5.5.1  Differentiable perturbed optimizer

One way of obtaining a differentiable optimizer is:
- to apply a stochastic perturbation to the parameters predicted by the ML model. 

Taking the case of expected value-based models as an example:

the key idea is that:
- although the gradient of the solution of the contextual problem with respect to the predicted parameters $ \\hat{\\boldsymbol{y}}:=g_{\\boldsymbol{\\theta}}(\\boldsymbol{x}) $ is zero almost everywhere
- if we perturb the predictor using a noise with differentiable density
- then the expectation of the solution of the perturbed contextual problem:

$ \\bar{z}^{\\varepsilon}\\left(\\boldsymbol{x}, g_{\\boldsymbol{\\theta}}\\right)=\\mathbb{E}_{\\Psi}\\left[\\tilde{z}^{\\varepsilon}\\left(\\boldsymbol{x}, g_{\\boldsymbol{\\theta}}, \\Psi\\right)\\right] $ with $ \\tilde{z}^{\\varepsilon}\\left(\\boldsymbol{x}, g_{\\boldsymbol{\\theta}}, \\Psi\\right):=\\underset{\\boldsymbol{z} \\in \\mathcal{Z}}{\\operatorname{argmin}} c\\left(\\boldsymbol{z}, g_{\\boldsymbol{\\theta}}(\\boldsymbol{x})+\\varepsilon \\Psi\\right) $

- where $ \\varepsilon>0 $ controls the amount of perturbation

and more generally of the expected cost of the associated random policy $ \\mathbb{E}_{\\Psi}\\left[H\\left(\\tilde{z}^{\\varepsilon}\\left(\\cdot, g_{\\boldsymbol{\\theta}}, \\Psi\\right), \\hat{\\mathbb{P}}_{N}\\right)\\right] $ can be shown to be smooth and differentiable. 

This idea is proposed and exploited in Berthet et al. (2020), which:
- focus on a bi-linear cost $ c(\\boldsymbol{z}, \\boldsymbol{y}):=\\boldsymbol{y}^{T} \\boldsymbol{z} $ thus simplifying $ \\mathbb{E}_{\\Psi}\\left[H\\left(\\tilde{z}^{\\varepsilon}\\left(\\cdot, g_{\\boldsymbol{\\theta}}, \\Psi\\right), \\hat{\\mathbb{P}}_{N}\\right)\\right]=H\\left(\\bar{z}^{\\varepsilon}\\left(\\cdot, g_{\\boldsymbol{\\theta}}\\right), \\hat{\\mathbb{P}}_{N}\\right) $. 

Further, they show that:

when an imitation ILO model is used 
- with a special form of Bregman divergence 

to capture the difference between $ z^{*}(\\boldsymbol{x}, \\boldsymbol{y}) $ and $ \\tilde{z}^{\\varepsilon}(\\boldsymbol{x}, \\hat{\\boldsymbol{y}}, \\Psi) $, 

the gradient of $ H_{\\text {Imitation }}\\left(\\tilde{z}^{\\varepsilon}\\left(\\cdot, g_{\\boldsymbol{\\theta}}, \\Psi\\right), \\hat{\\mathbb{P}}_{N}^{\\prime}\\right) $ can be computed directly without needing to determine the Jacobian of $ \\bar{z}^{\\varepsilon}\\left(\\boldsymbol{x}, g_{\\boldsymbol{\\theta}}\\right) $ (Blondel et al. 2020):

$ H_{\\text {Imitation }}\\left(\\tilde{z}^{\\varepsilon}\\left(\\cdot, g_{\\boldsymbol{\\theta}}, \\Psi\\right), \\hat{\\mathbb{P}}_{N}^{\\prime}\\right):=\\mathbb{E}_{\\hat{\\mathbb{P}}_{N}}\\left[\\ell_{\\mathrm{PFYL}}\\left(g_{\\boldsymbol{\\theta}}(\\boldsymbol{x}), \\boldsymbol{y}\\right)\\right] $

- $ \\ell_{\\text {PFYI }} $ is a perturbed Fenchel-Young loss (PFYL) given by:

- $ \\ell_{\\mathrm{PFYL}}(\\hat{\\boldsymbol{y}}, \\boldsymbol{y}):=\\hat{\\boldsymbol{y}}^{T} z^{*}(\\boldsymbol{x}, \\boldsymbol{y})-\\mathbb{E}_{\\Psi}\\left[(\\hat{\\boldsymbol{y}}+\\varepsilon \\Psi)^{T} \\tilde{\\boldsymbol{z}}^{\\varepsilon}(\\boldsymbol{x}, \\hat{\\boldsymbol{y}}, \\Psi)\\right]+\\varepsilon \\Omega_{\\mathrm{PFYL}}\\left(z^{*}(\\boldsymbol{x}, \\boldsymbol{y})\\right) $

- $ \\Omega_{\\mathrm{PFYL}}(\\boldsymbol{z}) $ is the Fenchel dual of $ F(\\boldsymbol{y}):=-\\mathbb{E}_{\\Psi}\\left[(\\boldsymbol{y}+\\Psi)^{T} \\tilde{z}^{\\varepsilon}(\\boldsymbol{x}, \\boldsymbol{y}, \\Psi)\\right] $. 
- The gradient of the FenchelYoung loss with respect to the model prediction is given by:
  - $ \\nabla_{\\hat{\\boldsymbol{y}}} \\ell_{\\mathrm{PFYL}}(\\hat{\\boldsymbol{y}}, \\boldsymbol{y})=z^{*}(\\boldsymbol{x}, \\boldsymbol{y})-\\overline{\\boldsymbol{z}}^{\\varepsilon}(\\boldsymbol{x}, \\hat{\\boldsymbol{y}}) $


Evaluating this gradient can be done through:

Monte Carlo evaluations by sampling perturbations and solving the corresponding perturbed problems.

Dalle et al. (2022) introduce a multiplicative perturbation: 

with the advantage that:

it preserves the sign of $ g_{\\theta}(\\boldsymbol{x}) $ without adding any bias:

$ \\tilde{\\boldsymbol{z}}^{\\varepsilon}\\left(\\boldsymbol{x}, g_{\\boldsymbol{\\theta}}, \\Psi\\right):=\\underset{\\boldsymbol{z} \\in \\mathcal{Z}}{\\operatorname{argmin}} c\\left(\\boldsymbol{z}, g_{\\boldsymbol{\\theta}}(\\boldsymbol{x}) \\odot \\exp \\left(\\varepsilon \\Psi-\\varepsilon^{2} / 2\\right)\\right) $

- $ \\odot $ is the Hadamard dot-product and the exponential is taken elementwise. 

Dalle et al. (2022) and Sun et al. (2023c) also show that: 

there is a one-to-one equivalence between the:
- perturbed optimizer approach
- and using a regularized randomized version of the CSO problem for combinatorial problems with linear objective functions. 


Finally, Dalle et al. (2022) show an intimate connection between:
- the perturbed minimizer approach proposed by Berthet et al. (2020) 
- and surrogate loss functions approaches

such as SPO+ by casting them as special cases of a more general surrogate loss formulation.

Mulamba et al. (2021) and Kong et al. (2022) consider an "energy-based" perturbed optimizer defined by its density of the form:

#### (19)

$ \\tilde{\\boldsymbol{z}}^{\\varepsilon}\\left(\\boldsymbol{x}, f_{\\boldsymbol{\\theta}}\\right) \\sim \\frac{\\exp \\left(-h\\left(\\boldsymbol{z}, f_{\\boldsymbol{\\theta}}(\\boldsymbol{x})\\right) / \\varepsilon\\right)}{\\int \\exp \\left(-h\\left(\\boldsymbol{z}^{\\prime}, f_{\\boldsymbol{\\theta}}(\\boldsymbol{x})\\right) / \\varepsilon\\right) d \\boldsymbol{z}^{\\prime}} $,

- $\\varepsilon  = 1$

This general form of perturbed optimizer:
- captures a varying amount of perturbation 
  - through $ \\varepsilon $, 
  - with $ \\tilde{\\boldsymbol{z}}^{\\varepsilon}\\left(\\boldsymbol{x}, f_{\\boldsymbol{\\theta}}\\right) $ converging in distribution to $ z^{*}\\left(\\boldsymbol{x}, f_{\\boldsymbol{\\theta}}\\right) $ as $ \\varepsilon $ goes to zero. 

They employ the negative log-likelihood to measure the divergence between:
- $ \\tilde{\\boldsymbol{z}}^{\\varepsilon}\\left(\\boldsymbol{x}, f_{\\boldsymbol{\\theta}}\\right) $
-  and the hindsight optimal solution $ z^{*}(\\boldsymbol{x}, \\boldsymbol{y}) $. 

Given the difficulties associated with calculating the partition function in the denominator of [(19)](#19), Mulamba et al. (2021) devise a surrogate loss function:
- based on noise-contrastive estimation,
-  which replaces likelihood with relative likelihood
-   when compared to a set of sampled suboptimal solutions.

This scheme is shown to improve the performance over SPO+ and DBB
- in terms of expected regret performance for linear combinatorial CSO.
- 
Based on the noise contrastive estimation approach of Mulamba et al. (2021), Mandi et al. (2022) note that:
- ILO for combinatorial problems can be viewed as a learning-to-rank problem. 

They propose surrogate loss functions,
- with closed-form expressions for gradients,
  -  that are used to train to rank feasible points in terms of performance on the downstream optimization problem. 

Unlike Mulamba et al. (2021), Kong et al. (2022) tackles the partition function challenge
- by employing a self-normalized importance sampler
  - that provides a discrete approximation. 

To avoid overfitting, the authors also introduce a regularization that :

penalizes the KL divergence between 
- the perturbed optimizer distribution 
- and a subjective posterior distribution over perturbed optimal hindsight actions $ \\mathbb{P}\\left(\\tilde{\\boldsymbol{z}}^{\\varepsilon}(\\boldsymbol{x}, \\boldsymbol{y}) \\mid \\boldsymbol{y}\\right) $ :

$ \\begin{array}{l}H_{\\text {Imitation }}\\left(\\tilde{\\boldsymbol{z}}^{\\varepsilon}\\left(\\cdot, f_{\\boldsymbol{\\theta}}\\right), \\hat{\\mathbb{P}}_{N}^{\\prime}\\right):= \\\\ \\\\ \\quad-\\mathbb{E}_{\\hat{\\mathbb{P}}_{N}}\\left[\\log \\left(\\mathbb{P}\\left(\\tilde{\\boldsymbol{z}}^{\\varepsilon}\\left(\\boldsymbol{x}, f_{\\boldsymbol{\\theta}}\\right)=z^{*}(\\boldsymbol{x}, \\boldsymbol{y})\\right) \\mid \\boldsymbol{x}, \\boldsymbol{y}\\right)\\right]+\\lambda \\mathbb{E}_{\\hat{\\mathbb{P}}_{N}}\\left[\\operatorname{KL}\\left(\\mathbb{P}\\left(\\tilde{\\boldsymbol{z}}^{\\varepsilon}(\\boldsymbol{x}, \\boldsymbol{y}) \\mid \\boldsymbol{y}\\right) \\| \\tilde{\\boldsymbol{z}}^{\\varepsilon}\\left(\\boldsymbol{x}, f_{\\boldsymbol{\\theta}}\\right) \\mid \\boldsymbol{x}, \\boldsymbol{y}\\right)\\right]\\end{array} $

The authors show that: 

their model outperforms ILO trained using SQP and cvxpylayers
- in terms of computational time

and gives lower task loss than sequential models trained using MLE and policy learning with neural networks.

### 5.5.2 Supervised learning 

Grigas et al. (2021) solve a CSO problem with a convex and nonnegative decision regularizer $ \\Omega(\\boldsymbol{z}) $ assuming that:

the uncertain parameter $ \\boldsymbol{y} $ has discrete support. 

Their model, called ICEO- $ \\lambda $, is thus trained by solving:

#### (20)

$ \\begin{array}{rll}\\text { (ICEO- } \\lambda) & \\min _{\\boldsymbol{\\theta}} & H\\left(z_{\\lambda}^{*}\\left(\\cdot, f_{\\boldsymbol{\\theta}}\\right), \\hat{\\mathbb{P}}_{N}\\right)+\\lambda \\mathbb{E}_{\\hat{\\mathbb{P}}_{N}}\\left[\\Omega\\left(z_{\\lambda}^{*}\\left(\\boldsymbol{x}, f_{\\boldsymbol{\\theta}}\\right)\\right)\\right] \\\\ & \\text { s.t. } & z_{\\lambda}^{*}\\left(\\boldsymbol{x}, f_{\\boldsymbol{\\theta}}\\right)=\\underset{\\boldsymbol{z}}{\\operatorname{argmin}} c\\left(\\boldsymbol{z}, f_{\\boldsymbol{\\theta}}(\\boldsymbol{x})\\right)+\\lambda \\Omega(\\boldsymbol{z}), \\forall \\boldsymbol{x} .\\end{array} $

The regularization:
- ensures uniqueness and Lipschitz property of $ z_{\\lambda}^{*}\\left(\\boldsymbol{x}, f_{\\boldsymbol{\\theta}}\\right) $ with respect to $ f_{\\theta} $ 
- leads to finite-sample guarantees. 

To circumvent the challenge associated with nondifferentiability of $ z_{\\lambda}^{*}\\left(\\boldsymbol{x}, f_{\\boldsymbol{\\theta}}\\right) $ with respect to $ \\boldsymbol{\\theta} $:
- they replace $ z_{\\lambda}^{*}\\left(\\boldsymbol{x}, f_{\\boldsymbol{\\theta}}\\right) $ with a smooth approximation $ \\tilde{z}_{\\lambda}\\left(\\boldsymbol{x}, f_{\\boldsymbol{\\theta}}\\right) $
  - that is learned using a random data set $ \\left(\\boldsymbol{p}_{i}, \\boldsymbol{z}_{i}\\right) $ generated by sampling $ \\boldsymbol{p}_{i} $ from the probability simplex over the discrete support 
- and then finding the optimal solution $ \\boldsymbol{z}_{i} $. 

They show asymptotic optimality and consistency of their solutions:

- when the hypothesis class is wellspecified. 

They compare their approach to other ILO pipelines and to the SLO approach that estimates the conditional distribution using cross-entropy.

Cristian et al. (2022) introduce the ProjectNet model:
- to solve uncertain constrained linear programs in an end-to-end framework
- by training an optimal policy network,
- which employs a differentiable approximation of the step of projection to feasibility.



Another approach, related to Berthet et al. (2020), that generalizes beyond LPs is given in Shah et al. (2022) that:
- constructs locally optimized decision losses (LODL)
- with supervised learning 
- to directly evaluate the performance of the predictors on the downstream optimization task. 

To learn a convex LODL for each data point:

this approach first generates labels in the neighborhood of label $ \\boldsymbol{y}_{i} $ in the training set, 
- e.g., by adding Gaussian noise, 
  
and then chooses the parameter that:
- minimizes the MSE between LODL and the downstream task loss. 

The LODL is used in place of the task-specific surrogate optimization layers 

and outperforms SLO on three resource allocation problems (linear top-1 item selection problem, web advertising, and portfolio optimization). 

The numerical experiments indicate that:
- handcrafted surrogate functions only perform better for the web advertising problem.

## 5.6 Applications 

Tian et al. (2023a) and Tian et al. (2023b) use SPOT and noise-contrastive estimation method (Mulamba et al. 2021), respectively, 

to solve the maritime transportation problem. 

A comprehensive tutorial on prescriptive analytics methods for logistics is given in Tian et al. (2023c). 

SPO has been used in solving last-mile delivery (Chu et al. 2023) and ship inspection problems (Yan et al. 2020, 2021, 2023). 

Demirović et al. (2019) and Demirović et al. (2020) minimize the same expected regret as SPO for specific applications related to ranking optimization and dynamic programming problems, respectively.


Perrault et al. (2020) solve a Stackelberg security game with the ILO framework by:
- learning the attack probability distribution over a discrete set of targets
- to maximize a surrogate for the defender's expected utility. 

They show that: their model results in higher expected utility for the defender on synthetic and human subjects data than the sequential models that learn the attack probability by minimizing the cross entropy loss. 

Wang et al. (2020) replace the large-scale optimization problem with a low dimensional surrogate by reparameterizing the feasible space of decisions. 

They observe significant performance improvements for non-convex problems compared to the strongly convex case.

Stratigakos et al. (2022) solve an integrated forecasting and optimization model
- for trading in renewable energy 

that: trains an ensemble of prescriptive trees
- by randomly splitting the feature space $ \\mathcal{X} $ based on the task-specific cost function. 

Sang et al. (2022) introduce an ILO framework for electricity price prediction for energy storage system arbitrage. 

They present a hybrid loss function 

- to measure prediction and decision errors 

and a hybrid stochastic gradient descent learning method. 

Sang et al. (2023) solve a voltage regulation problem using:
- a similar hybrid loss function, 

and backpropagation is done by 
- implicitly differentiating the optimality conditions of a secondorder cone program.

Liu et al. (2023b) use a DNN to : 
- model the routing behavior of users in a transportation network 
- and learn the parameters by minimizing the mismatch between:
  - the flow prescribed by the variational inequality
  - and the observed flow. 

The backward pass is obtained by:
- applying the IFT to the variational inequality. 

Wahdany et al. (2023) propose an integrated model for wind-power forecasting that:
- learns the parameters of a neural network to optimize the energy system costs under the system constraints.

Vohra et al. (2023) apply similar ideas to:
- develop end-to-end renewable energy generation forecasts, 

using multiple contextual sources such as satellite images and meteorological time series.

Butler and Kwon (2023b) solves the contextual mean-variance portfolio (MVP) optimization problem by:
- learning the parameters of the linear prediction model using the ILO framework. 

The covariance matrix is estimated using:
- the exponentially weighted moving average model.

They provide analytical solutions to :
- unconstrained and equality-constrained MVP optimization problems

and show that:
- they outperform SLO models based on ordinary least squares regression. 

These analytical solutions lead to lower variance when:

compared with the exact solutions of the corresponding inequality-constrained MVP optimization problem.

# 6 Active research directions

## Uncertainty in constraints. 

Most studies on contextual optimization assume that:

- there is no uncertainty in the constraints. 

If constraints are also uncertain, the SAA solutions that ignore the covariates information might not be feasible (Rahimian and Pagnoncelli 2022). 

Bertsimas and Kallus (2020) have highlighted the challenges in using ERM in a constrained CSO problem. 

Rahimian and Pagnoncelli (2022) solve a conditional chance-constrained program that :
- ensures with a high probability that the solution remains feasible under the conditional distribution 
- given the realized covariates. 

Although they do not focus on contextual optimization, interesting links can be found with the literature on constraint learning (Fajemisin et al. 2023) and inverse optimization (Chan et al. 2021).


## Risk aversion. 

There has been a growing interest in studying contextual optimization in the risk-averse setting.

Specifically, one can consider replacing the risk-neutral expectation from [(1)](#1) with a risk measure such as value-at-risk.

By doing so, one would expect, with a high probability, that:
- a decision-maker's loss is lower than a particular threshold. 

One can easily represent such a risk measure using an uncertainty set which represents the set of all possible outcomes that may occur in the future. 

The resulting uncertainty set should be carefully chosen:
- It should capture the most relevant scenarios to balance the trade-off between avoiding risks and obtaining returns. 

The recently proposed Conditional Robust Optimization (CRO) paradigm by Chenreddy et al. (2022) (see also Ohmori 2021, Sun et al. 2023b, Peršak and Anjos 2023) consists in learning a conditional set $ \\mathcal{U}(\\boldsymbol{x}) $ to solve the following problem:

### (21)

(CRO) $ \\min _{\\boldsymbol{z} \\in \\mathcal{Z}} \\max _{\\boldsymbol{y} \\in \\mathcal{U}(\\boldsymbol{x})} c(\\boldsymbol{z}, \\boldsymbol{y}) $

- where $ \\mathcal{U}(\\boldsymbol{x}) $ is an uncertainty set designed to contain with high probability the realization of $ \\boldsymbol{y} $ conditionally on observing $ x $.

Their approach solves the CRO problem sequentially where:
- $ \\mathcal{U}(\\boldsymbol{x}) $ is learned first
-  and is subsequently used to solve the downstream RO problem. 

A challenging problem is to learn the uncertainty set to minimize the downstream cost function.

## Toolboxes and benchmarking. 

Several toolboxes and packages have been proposed recently to train decision pipelines. 

Agrawal et al. (2019) provide the cvxpylayers library, which includes a subclass of convex optimization problems as differentiable layers in auto-differentiation libraries in PyTorch, TensorFlow, and JAX. 

Other libraries for differentiating non-linear optimization problems for end-to-end learning include:

higher (Grefenstette et al. 2019), JAXopt (Blondel et al. 2022), TorchOpt (Ren et al. 2022), and Theseus (Pineda et al. 2022). 

Tang and Khalil (2022) introduce an open-source software package called PyEPO (Pytorch-based End-to-End Predict-then-Optimize) implemented in Python for ILO of problems that are linear in uncertain parameters. They implement various existing methods, such as SPO+, DBB, and PFYL. 

They also include new benchmarks and comprehensive experiments highlighting the advantages of integrated learning. 

Dalle et al. (2022) provide similar tools for combinatorial problems in Julia.

Comparisons of existing approaches in fixed simulation settings are scarce, especially with realworld data. 

Buttler et al. (2022) provide a meta-analysis of selected methods on an unconstrained newsvendor problem on four data sets from the retail and food sectors. 

They highlight that there is no single method that clearly outperforms all the others on the four data sets. Mandi et al. (2023) carried out a comprehensive benchmarking of ILO frameworks tailored for expected value-based models on seven distinct problems using public datasets.

## Endogenous uncertainty. 

While there has been some progress in studying problems where the decision affects the uncertain parameters (Basciftci et al. 2021, Liu et al. 2022), the literature on decision-dependent uncertainty with covariates is sparse (Bertsimas and Kallus 2020, Bertsimas and Koduri 2022). 

An example could be:
- a facility location problem where demand changes once a facility is located in a region
- or a price-setting newsvendor problem whose demand depends on the price (Liu and Zhang 2023). 

In these problems, the causal relationship between demand and prices is unknown. 

These examples offer interesting parallels with the research on heterogeneous treatment effects
- such as Wager and Athey (2018), 
  - which introduce causal forests for estimating treatment effects and provide asymptotic consistency results. 
- Alley et al. (2023) study a price-setting problem and provide a new loss function to isolate the causal effects of price on demand from the conditional effects due to other covariates.

## Data privacy. 

Another issue is that:

- the data might come from multiple sources and contain sensitive private information, so it cannot be directly provided in its original form to the system operator. 

Differential privacy techniques (see, e.g., Abadi et al. 2016) can be used to obfuscate data but may impact predictive and prescriptive performance. 

Mieth et al. (2023) determine the data quality after obfuscation in an optimal power flow problem with a Wasserstein ambiguity set and use a DRO model to determine the data value for decision-making.

## Interpretability & explainability. 

Decision pipelines must be trusted to be implemented. 

This is evident from the European Union legislation "General Data Protection Regulation" that requires entities using automated systems to provide "meaningful information about the logic involved" in making decisions, known popularly as the "right to explanation" (Doshi-Velez and Kim 2017, Kaminski 2019). 

For instance, a citizen has the right to ask a bank for an explanation in the case of loan denial. 

While interpretability has received much attention in predictive ML applications (Rudin 2019), it remains largely unexplored in a contextual optimization, 
- i.e., prescriptive context. 

Interpretability requires transparent decision pipelines that are intelligible to users,
- e.g., built over simple models such as decision trees or rule lists. 

In contrast, explainability may be achieved with an additional algorithm on top of a black box or complex model. 

Feature importance has been analyzed in a prescriptive context by Serrano et al. (2022): 

They introduce an integrated approach that solves a bilevel program with an integer master problem optimizing (cross-)validation accuracy. 

To achieve explainability, Forel et al. (2023) adapt the concept of counterfactual explanations to explain a given data-driven decision through differences of context that make this decision optimal, or better suited than a given expert decision. 

Having identified these differences, it becomes possible to correct or complete the contextual information, if necessary, or otherwise to give explanative elements supporting different decisions. 

Another research direction could be to train tree-based models (such as optimal classification trees) to approximate the policy of a complex learning-and-optimization pipeline. 

This has interesting connections with model distillation,
- i.e., the idea in the ML community of approximating a large model by a smaller one,

and the work of Bertsimas and Stellato (2021), which learns the mapping from the problem parameters to optimal decisions through interpretable models.

## Fairness. Applying decisions based on contextual information can raise fairness issues when the context is made of protected attributes. 

This has been studied especially in pricing problems, to ensure that:
- different customers or groups of customers are proposed prices that don't differ significantly(Cohen et al. 2021, 2022).

## Finite sample guarantees for ILO. 

In Grigas et al. (2021), the authors derive finite-sample guarantees for ILO under the assumption of discrete support for the uncertain parameter. 

An open problem is to derive generalization bounds on the performance of ILO models for non-linear problems where the uncertain parameters have continuous support.

## Correcting for in-sample bias of data-driven optimization. 

When devising an optimal policy based on a finite number of samples, it is desired that low in-sample risk translates to low out-of-sample risk. 

However, decision rule optimization in [(4)](#4) or learning and optimization model in [(5)](#5) are known to produce optimistically biased estimates of the true expected cost of the prescribed policy (Ban and Rudin 2019, Costa and Iyengar 2023, Gupta et al. 2022). 

While one can replace this estimation with an unbiased one
- if data was reserved for this purpose,

this is usually considered a wasteful use of data
- given that it could instead have been used to obtain a better-performing policy. 

Recent research has identified ways of circumventing this issue by estimating and correcting for the in-sample bias in contextual (Gupta et al. 2022) and non-contextual (Ito et al. 2018, Gupta and Rusmevichientong 2021, Iyengar et al. 2023) stochastic optimization problems
- under the assumption that errors in the estimation of uncertain parameters are normally distributed. 

In addition to correcting the bias using Stein's lemma, Gupta and Rusmevichientong (2021) show that :

- certain "Bayes-inspired" and regularized policies achieve the same performance as optimal in-sample policy in small-data large-scale regimes.

A promising future research direction could be:

to build a general framework to learn the insample policies that :

- directly minimize the debiased objective functions. 

In this regard, one might find inspiration from the work of Gupta and Rusmevichientong (2021) addressing a similar issue in the non-contextual setting.

## Multi-agent decision-making. 

A multi-agent perspective becomes necessary in transportation and operations management problems, - where different agents have access to different sources of information (i.e. covariates). 

In this regard, some recent work by Heaton et al. (2022) identifies the Nash equilibrium of contextual games using implicit differentiation of variational inequalities and jacobian-free backpropagation.

## Costly label acquisition. 

In many applications, it is costly to gather observations of uncertain vectors and covariate pairs. 

For instance, in personalized pricing, surveys can be sent to customers to obtain information on the sensitivity of purchasing an item with respect to its price. 

However, creating, sending, and collecting the surveys may have a cost. 

Liu et al. (2023a) develop an active learning approach to obtain labels to solve the SPO problem, 
- while the more general case of developing active learning methods for non-linear contextual optimization is an interesting future direction. 

Besbes et al. (2023) provide theoretical results on the trade-off between the quality and quantity of data in a newsvendor problem, thus guiding decision-makers on how to invest in data acquisition strategies.

## Multi-stage contextual optimization. 

Most works on contextual optimization focus on single and two-stage problems. 

Ban et al. (2019) and Rios et al. (2015) use the residuals of the regression model to build multi-stage scenario trees and solve multi-stage CSO problems. 

Bertsimas et al. (2023) generalize the weighted SAA model for multi-stage problems. 

Qi et al. (2023) propose an end-to-end learning framework to solve a real-world multistage inventory replenishment problem.

## sequential decision-making with uncertainty. 

Inverse reinforcement learning (Ng et al. 2000) focuses on learning rewards that are consistent with observed trajectories. 

In the econometrics literature on dynamic discrete choice modeling the focus lies more broadly on estimating structural parameters of Markov decision processes (MDPs) (Rust 1988, Aguirregabiria and Mira 2010) including rewards, transition functions and discount factors. 

On both topics, estimates are typically obtained through MLE employing a soft version of the Bellman operator (e.g., Rust 1987, Ziebart et al. 2008).

In the context of model-based reinforcement learning, so-called decision awareness 
- (i.e. explicitly training components of a reinforcement learning system to help the agent improve the total amount of collected reward, Nikishin et al. 2022b) 
is receiving increasing attention (e.g., Joseph et al. 2013, Farahmand et al. 2017, Farahmand 2018, Grimm et al. 2020). 

For example, Nikishin et al. (2022a) introduce an approach that combines learning and planning to optimize expected returns for both tabular and non-tabular MDPs. 

They employ the soft version of the Bellman operator for efficient parameter learning using the IFT and show that:
- their state-action value function has a lower approximation error than that of MLE in tabular MDPs.

---

Another interesting research direction is to challenge the assumption that: 

the joint distribution of the covariate and uncertain parameters is stationary. 

Neghab et al. (2022) study a newsvendor model with a hidden Markov model underlying the distribution of the covariates and demand.

---

Finally, an area that requires attention is the deployment of models for real-world applications 

- by tackling computational hurdles associated with decision-aware learning in MDPs, 

- such as large state-action pairs and high-dimensional policy spaces (Wang et al. 2023). 

An example is a service call scheduling problem 
- that is formulated as a restless multi-armed bandit (RMAB) problem in Mate et al. (2022) 
- to improve maternal and child health in a non-profit organization. 

They model each beneficiary as an arm, apply a clustering method to learn the dynamics, 

and then use the Whittle Index policy to solve the RMAB. 

Wang et al. (2023) use decision-focused learning to solve RMAB,
- where the computational difficulty in differentiating the Whittle index policy of selecting the top-k arms, 
- is mitigated by making a soft-top-k selection of arms which is an optimal transport problem (Xie et al. 2020).



placeholder

placeholder

placeholder

placeholder

placeholder

`,N7=`# Crowdsourcing Exploration 

Suppose in market:

$A, B$: Two providers

$S = \\{A,B\\}$

$p_i,i\\in S$: provider's service quality 

$
\\begin{cases}
1, &w.p.\\quad p_i \\\\ 
0, &w.p.\\quad 1-p_i 
\\end{cases}
$: consumer receive reward

$p_i$ is known to designer and consumers
- a common prior belief
- $\\text{Beta}\\{s_1^i,f_1^i\\}, s_1^i,f_1^i\\in \\mathbb Z_+$

--- 

Progress:

1. at beginning of $t\\in T, T= \\{ 1, 2, \\dots\\}$: consumer visit the platform, observe information pretaining to experience of past consumers, choose provider 

2. Complete service, before the end of $t$, report positive or negative 

$x_t = \\{x_t^A,x_t^B\\}$: information state
- $ x_{t}^{i}=\\left\\{s_{t}^{i}, f_{t}^{i}\\right\\} $
- $s_t^i$: accumulated number of successful service outcomes for provider $i$ up to period $t$ 

$Beta(s_t^i,f_t^i)$:Bayesian posterior belief when system state is $x_t$

$ r\\left(x_{t}, i\\right)=\\frac{s_{t}^{i}}{s_{t}^{i}+f_{t}^{i}} $ :  the expected reward of the next customer to use provider $i$

---

History: not observable
- "message policy"

Designer's objective:
- maximize the expected sum of consumers’ discounted rewards over an infinite horizon
- applying a discount factor of $\\delta\\in [0,1)$

# 4. Analysis Preliminaries

## Equilibrium and Model Dynamics

Two main feature
- messaging policy
- choice strategy

$X\\in\\mathbb Z_+^4$: possible states of platform 
- s.t. $x_t\\in X, \\forall t\\in T$

$M$: feasible message in period $t$

$g(\\cdot)$: messaging policy, $X\\to M$

$\\mathcal G$: possible polices 

$c_t(\\cdot)$: period-$t$ consumer's choice strategy 
- $M\\to S$

$S$: service 

$\\mathcal C_t$: possible strategies for period-$t$ consumer 

$c(\\cdot) :=[c_1(\\cdot),c_2(\\cdot),\\dots]$

--- 

Controlled Markov chain: $g, c$
- $\\{(x_t,y_t);t\\in T\\}$: state-action pair 

$y_t = c_t(g(x_t))$

$r(x_t,i) = \\dfrac{s_t^i}{s_t^i+f_t^i}$: reward 

The state in period $t+1$:

$ x_{t+1}^{i}=x_{t}^{i} $ for $ i \\neq y_{t}, \\quad x_{t+1}^{i}=\\left\\{\\begin{array}{l}\\left\\{s_{t}^{i}+1, f_{t}^{i}\\right\\} \\text { w.p. } r\\left(x_{t}, i\\right) \\\\ \\left\\{s_{t}^{i}, f_{t}^{i}+1\\right\\} \\text { w.p. } 1-r\\left(x_{t}, i\\right)\\end{array} \\quad\\right. $ for $ i=y_{t} $.

--- 

Sequence:

2. Consumer observe policy, choose strategy $c_t$ to maximize reward 

period-$t$ to message $m$, $c_t^*(m)$ maximize:

$ E_{x_{t}}\\left[r\\left(x_{t}, c_{t}\\right) \\mid g\\left(x_{t}\\right)=m\\right] $
 

1. At beginning, designer commit policy that maximize dscounted rewards. $g^(x_t)$ maximizes:

$ E\\left[\\sum_{t \\in T} \\delta^{t-1} r\\left(x_{t}, y_{t}\\right)\\right] $, for $ y_{t}=c_{t}^{*}\\left(g\\left(x_{t}\\right)\\right) $

## Incentive-Compatible Recommendation Policies

### Definition 1 (ICRP: Incentive-Compatible Recommendation Policy) 

> A recommendation policy:
>
> #### (1)
>
> $ g\\left(x_{t}\\right)=\\left\\{\\begin{array}{ll}A & \\text { w.p. } \\quad q_{x_{t}} \\\\ B & \\text { w.p. } 1-q_{x_{t}}\\end{array}\\right. $
>
> - $q_{x_t}\\in[0,1],\\forall x_t\\in X$
> - It's incentive-compatible, if:
>   - $c_t^*(g(x_t))=g(x_t),\\forall x_t\\in X, t\\in T$


### Lemma 1

> For any arbitrary messaging policy $g$, there exists an $ICRP$ $g'$ which induces a $DOE$ equilibrium in the game between the designer and the consumers.

---

Examples:

## First Best 

The Gittins index for service $ i $ when in state $ z^{i} $ is denoted by $ G_{i}\\left(z^{i}\\right) $ and given by

#### (2)

$
G_{i}\\left(z^{i}\\right)=\\sup _{\\tau>0} \\frac{E\\left[\\sum_{t=0}^{\\tau-1} \\delta^{t} r\\left(x_{t}^{i}, i\\right) \\mid x_{0}^{i}=z^{i}\\right]}{E\\left[\\sum_{t=0}^{\\tau-1} \\delta^{t} \\mid x_{0}^{i}=z^{i}\\right]},
$

- $\\tau$: past-measurable stopping time 
- $r(x_t^i,i)$: instantaneous expected reward of provider $i$ in state $x_t^i$

# 5 Simple Case: Incumbent Provider $B$

Setting:

$A$ quality is ex ante unknown 

$B$ is known 

$Beta(s_1^A,f_1^A)$: $A$'s service 

$r(x_t,A)=\\dfrac{s_t^A}{s_t^A+f_t^A}$: reward on sercive $A$ in period $t$

$r_B = r(x_t,B) = p_B$

## 5.1 First Best 

$B$ has constant Gittins index:

$G_B := G_B(x_t) = r_B$

For $A$:

### Lemma 2

> System-optimal provider choices are characterized as follows:
>
> (i) If $ G_{A}\\left(x_{1}\\right) \\leq G_{B} $, then any experimentation with service $ A $ is suboptimal; 
> that is, it is systemoptimal to use service $ B $ in all periods $ t \\in T $.
>  
> (ii) If $ G_{A}\\left(x_{1}\\right)>G_{B} $, then it is system-optimal to experiment with service $ A $ at least once in period $ t=1 $. In any period $ t>1 $, there exists an integer $ s^{*}(t) $ such that if $ s_{t}^{A} \\geq s^{*}(t) $ it is system-optimal to continue experimentation with service $ A $ in period $ t $, while if $ s_{t}^{A}<s^{*}(t) $ it is system-optimal to choose service $ B $ in period $ t $ and forever after. The period-t threshold $ s^{*}(t) $ is uniquely defined by:
>
> $ s^{*}(t)=\\left\\{\\min s_{t}^{A}: s_{t}^{A}, f_{t}^{A} \\in \\mathbb{Z}_{+}^{2},\\left(s_{t}^{A}-s_{1}^{A}\\right)+\\left(f_{t}^{A}-f_{1}^{A}\\right)=t-1, G_{A}\\left(x_{t}\\right)>G_{B}\\right\\} $

## 5.2 The Two Extreme Modes of Information Provision 

- NI: No information 
- FI: Full information 

### Lemma 3

> Consumers' choice under FI:
>
> (i) If $ r\\left(x_{1}, A\\right) \\leq r_{B} $, then consumers choose service $ B $ in all periods $ t \\in T $.
> 
> (ii) If $ r\\left(x_{1}, A\\right)>r_{B} $, then the period-1 consumer chooses service $ A $. In any period $ t>1 $, there exists an integer $ \\bar{s}(t) $ such that if $ s_{t}^{A} \\geq \\bar{s}(t) $ the period- $ t $ consumer chooses service $ A $, while if $ s_{t}^{A}<\\bar{s}(t) $ service $ B $ is chosen in period $ t $ and forever after. The period-t threshold $ \\bar{s}(t) $ is uniquely defined by
> 
> $\\bar{s}(t)=\\left\\{\\min s_{t}^{A}: s_{t}^{A}, f_{t}^{A} \\in \\mathbb{Z}_{+}^{2},\\left(s_{t}^{A}-s_{1}^{A}\\right)+\\left(f_{t}^{A}-f_{1}^{A}\\right)=t-1, r\\left(x_{t}, A\\right)>r_{B}\\right\\}$

### Lemma 4

> The thresholds $ s^{*}(t) $ and $ \\bar{s}(t) $ satisfy $ s^{*}(t) \\leq \\bar{s}(t) $

### Example 1

> Assume $A$ is $Beta(1,1)$
> $B$ is $0.27$
> $\\delta = 0.9$
> After $2$ negative in $A$, everyone choose $B$

---

### Proposition 1

> Denote by $ \\pi^{N I} $ and $ \\pi^{F I} $ the platform's expected payoff under policies belonging to the NI and FI regimes, respectively. Then
>
> $\\pi^{N I} \\leq \\pi^{F I} \\leq \\pi^{*}$
>
> where $ \\pi^{*} $ denotes the platform's first-best expected payoff.

## 5.3 Strategic Information Provision

### Proposition 2

> For initial system state $ x_{1} $, let $ g^{*} $ be an optimal messaging policy and denote by $ \\pi\\left(g^{*}\\right) $ the platform's expected payoff under policy $ g^{*} $. Then $ \\pi\\left(g^{*}\\right)=\\pi^{*} $, unless both $ r\\left(x_{1}, A\\right) \\leq r_{B} $ and $ G_{A}\\left(x_{1}\\right)>G_{B} $ hold.

Table 1
$
\\begin{array}{cccc}
x_{4}^{A}=\\left(s_{4}^{A}, f_{4}^{A}\\right) & P\\left(x_{4}^{A}\\right) & \\text{consumer prefers} & \\text{designer prefers} \\\\
\\hline \\hline
(4,1) & 0.25 & \\mathrm{A}\\left(r_{A}=0.8\\right) & \\mathrm{A}\\left(G_{A}=0.87\\right) \\\\
(3,2) & 0.25 & \\mathrm{A}\\left(r_{A}=0.6\\right) & \\mathrm{A}\\left(G_{A}=0.71\\right) \\\\
(2,3) & 0.25 & \\mathrm{A}\\left(r_{A}=0.4\\right) & \\mathrm{A}\\left(G_{A}=0.52\\right) \\\\
(1,4) & 0.25 & \\mathrm{B}\\left(r_{A}=0.2\\right) & \\mathrm{A}\\left(G_{A}=0.30\\right)
\\end{array}
$

How to make $(1,4)$ customer choose $A$?

$
(4,1)\\} m_{1} \\\\ (3,2)\\} m_{2}
$

$ \\left.\\begin{array}{l} (2,3) \\\\ (1,4)\\end{array}\\right\\} m_{3} 
$

Then for $m_3$, $r = \\dfrac{1}{2}\\cdot 0.4 + \\dfrac{1}{2}\\cdot 0.2 =0.3 > 0.27$ 

## 5.4 Comments 

### Commitment vs. Cheap Talk 

When talk with period-$t$ customer:

- if recommend $B$:
  - $G_B>G_A$
  - $r_B>r_A$

### Information vs. Payments

Sometimes only information can't achieve **First Best **

# 6 General Case 

Both is ex ante unknown 

$r(x_1, A)\\ge r(x_1, B)$

### Proposition 3

> For initial system state $ x_{1} $, let $ g^{*} $ be an optimal messaging policy. Then $ \\pi\\left(g^{*}\\right)= $ $ \\pi^{*} $ if and only if there exists an ICRP which recommends service $ B $ whenever $ G_{B}\\left(x_{t}\\right)>G_{A}\\left(x_{t}\\right) $.

### Example 2

> $A$: $Beta(10,2)$
> $B$: $Beta(2,2)$
> $\\delta = 0.99$
>
> Notice: if $A$ fails in $t = 1 $ to $t=4$, consumer will still choose $A$, even if $B$ may be better

## 6.1 Optimal ICRPs

We need to choose best $q_{x_t}$ such that:


$ g\\left(x_{t}\\right)=\\left\\{\\begin{array}{ll}A & \\text { w.p. } \\quad q_{x_{t}} \\\\ B & \\text { w.p. } 1-q_{x_{t}}\\end{array}\\right. $

Then we need:

#### (4)

$ \\begin{array}{r}\\qquad \\max _{g\\left(x_{t}\\right)} E\\left[\\sum_{t \\in T} \\delta^{t-1} r\\left(x_{t}, g\\left(x_{t}\\right)\\right)\\right] \\\\ \\text { s.t. } E_{x_{t}}\\left[r\\left(x_{t}, A\\right) \\mid g\\left(x_{t}\\right)=A\\right] \\geq E_{x_{t}}\\left[r\\left(x_{t}, B\\right) \\mid g\\left(x_{t}\\right)=A\\right], \\quad \\forall t \\in T, \\\\ E_{x_{t}}\\left[r\\left(x_{t}, B\\right) \\mid g\\left(x_{t}\\right)=B\\right] \\geq E_{x_{t}}\\left[r\\left(x_{t}, A\\right) \\mid g\\left(x_{t}\\right)=B\\right], \\quad \\forall t \\in T,\\end{array} $

- every $t$ is IC 

We introduce some notation to deal with it:

$X_t$:  the set of states that are reachable from the initial state $x_1$ in period $t$

$ X=\\bigcup_{t \\in T} X_{t} $: total state space 

$\\mathcal P_{kiz}$: transition probability from $k$ through $i$ to $z$

$\\Delta_a$: Dirac delta function concentrated at $a$

### Proposition 4

> The optimal ICRP is given by:
>
> $ q_{k}^{*}=\\frac{\\rho(k, A)}{\\sum_{i \\in S} \\rho(k, i)} $
>
> where $\\rho(k,i)$ solves:
>
> $ \\begin{array}{rlr}\\max _{\\rho} & \\sum_{k \\in X} \\sum_{i \\in S} \\rho(k, i) r(k, i) & \\\\ \\text { s.t. } & \\sum_{k \\in X_{t}} \\rho(k, B)[r(k, B)-r(k, A)] \\geq 0, & \\forall t \\in T, \\\\ & \\sum_{k \\in X} \\sum_{i \\in S} \\rho(k, i)\\left(\\Delta_{z}(k)-\\delta \\mathcal{P}_{k i z}\\right)=\\Delta_{x_{1}}(z), & \\forall z \\in X, \\\\ & \\rho(k, i) \\geq 0, & \\forall k \\in X, i \\in S .\\end{array} $

Note:

- $\\rho$: the flow weight
  - constrain 1: make sure when recommend $B$, it's better 
  - constrain 2: make sure the flow is balance 
  - constrain 3: the flow is non-negative 

## 6.2 The Value of Information Obfuscation

$p_{x_t}$: the probability that state in period $t$ is $x_t$

First, we solve period-$t$ LP:

#### (6)

$ \\begin{array}{rlr}\\max _{\\rho} & \\sum_{k \\in X} \\sum_{i \\in S} \\rho(k, i) r(k, i) & \\\\ \\text { s.t. } & \\sum_{k \\in X_{t}} \\rho(k, B)[r(k, B)-r(k, A)] \\geq 0, & \\forall t \\in T, \\\\ & \\sum_{k \\in X} \\sum_{i \\in S} \\rho(k, i)\\left(\\Delta_{z}(k)-\\delta \\mathcal{P}_{k i z}\\right)=\\Delta_{x_{1}}(z), & \\forall z \\in X, \\\\ & \\rho(k, i) \\geq 0, & \\forall k \\in X, i \\in S .\\end{array} $

Then, store $q_{x_t}$
- designer’s recommendation policy for period $t$

Then, use $p_{x_t}$ to calculate $p_{x_{t+1}}$

Until: $t=K$ is reached 

# 7 Extensions 

## 7.1 Imperfect Knowledge of Consumers' Arrival Times 

### Proposition 5

> Let $g\\ g(^*)$  denote an ICRP (the optimal ICRP) when consumers have perfect knowledge of their arrival times. Then:
>
> (i) $ g $ remains an ICRP under any arbitrary belief held by consumers over their arrival times.
> 
> (ii) If $ v^{*} $ is an optimal ICRP under a specific set of consumer beliefs, we have $ \\pi\\left(v^{*}\\right) \\geq \\pi\\left(g^{*}\\right) $.

## 7.2 Combining Information with Monetary Subsidies

The designer can choose for each message $ m \\in M $ used in period $ t $ an accompanying subsidy plan $ \\left\\{\\kappa_{t}^{i}(m)\\right\\}_{i \\in S} $, where the subsidy $ \\kappa_{t}^{i}(m) \\geq 0 $ can be claimed by the consumer if she chooses to use provider $ i $.

### Definition 2 (ICRSP: Incentive-Compatible Recommendation-with-Subsidies Policy)

> A recommendation-with-subsidies policy is a messaging-with-subsidies policy defined as:
> 
> #### (7)
> 
> $ v\\left(x_{t}\\right)=\\left\\{\\begin{array}{ll}A,\\left\\{\\kappa_{t}^{i}(A)\\right\\}_{i \\in S} & \\text { w.p. } \\quad q_{x_{t}} \\\\ B,\\left\\{\\kappa_{t}^{i}(B)\\right\\}_{i \\in S} & \\text { w.p. } 1-q_{x_{t}}\\end{array}\\right. $
>
> where $ q_{x_{t}} \\in[0,1] $ for all $ x_{t} \\in X $, and $ \\kappa_{t}^{i}(j)=0 $ for all $ i, j \\in S, i \\neq j $. A recommendation-withsubsidies policy is said to be incentive-compatible if for all $ x_{t} \\in X $, each period- $ t $ consumer follows the recommendation she receives.

#### Proposition 6

> For any arbitrary messaging-with-subsidies policy $ v $, there exists an ICRSP $ v^{\\prime} $ which achieves a (weakly) higher expected platform payoff.

### Example 3

> $ A $ is $ \\operatorname{Beta}(5,5) $
> $ B $ has a known quality of $ r_{B}=0.53 $ 
> 
> the ex ante preferable provider for the consumers is $ B $. 
> 
> Consider the minimum total subsidies required to induce exploration of provider $ A $ in the first two periods under a FI policy versus under an ICRSP. 
> 
> In the first period, for the customer to choose provider $ A $, both policies must offer a minimum subsidy of $ \\kappa_{1}^{A}=p_{B}-r\\left(x_{1}, A\\right)=0.53-0.5=0.03 $ (i.e., assuming $ \\kappa_{1}^{B}=0 $ ). 
> 
> However, in the second-period: 
> 
> (i) Under FI, the state $ x_{2} $ is disclosed to the period- 2 consumer and a minimum subsidy $ \\kappa_{2}^{A}\\left(x_{2}\\right)= $ $ \\max \\left\\{p_{B}-r\\left(x_{2}, A\\right), 0\\right\\} $ must be offered in order for the consumer to choose provider $ A $. 
> 
> If the period- 1 trial was successful (occurs w.p. 0.5 ), then $ \\kappa_{2}^{A}=\\max \\{0.53-0.55,0\\}=0 $. If the period-1 trial was unsuccessful (occurs w.p. 0.5), then $ \\kappa_{2}^{A}=\\max \\{0.53-0.45,0\\}=0.08 $. 
> 
> Thus, the ex ante expected period- 2 subsidy is $ E\\left[\\kappa_{2}^{A}\\left(x_{2}\\right)\\right]=0.5 \\times 0.08=0.04 $. 
> 
> (ii) Under an ICRSP, the designer in period 2 recommends provider $ A $ irrespective of the period-1 outcome. 
> 
> For this recommendation to be incentive-compatible, it must be accompanied by a subsidy of $ \\kappa_{2}^{A}(A)=\\max \\left\\{p_{B}-E\\left[r\\left(x_{2}, A\\right)\\right], 0\\right\\}=\\max \\{0.53-(0.5 \\times 0.55+0.5 \\times 0.45), 0\\}=0.03 $. 
> 
> Thus, in the above example, the ICRSP achieves the same consumer actions in the first and second periods as a FI-with-subsidies policy, but at a $ 25 \\% $ lower subsidy cost.

`,I7=`
$x$: Covariates 

$y$: Walk-in 

$z$: time period opened 

---

The helper function:

$D\\left( (x,z), (x^i,z^i) \\right) = \\alpha_1 \\cdot d_{\\text{time}}(x,x^i) + \\alpha_2 \\cdot \\frac{|z - z^i|}{z_{\\text{max}}}$
- $(x,z)$: the "covariate, decision" pair 
- $(x^i, z^i)$: the $i$-th data 
- $d_{\\text{time}}: $ the distance between $x$

To simulate the distribution of $y$:

$\\hat{Y}(z|x) = \\sum_{i=1}^N w_i(x,z) \\cdot y^i$

Where:

$w_i(x,z) = \\frac{1}{D\\left( (x,z), (x^i,z^i) \\right) + \\epsilon} \\cdot \\mathbb{I}\\left[ (x^i,z^i) \\in \\text{TopK}(D) \\right]$

- $\\epsilon$: in case the denominator is $0$


---

Service speed:

$v(Y) = v_0 + \\gamma Y$

Wait cost:

$W(Y) = \\dfrac{Y}{v(Y)} = \\dfrac{Y}{v_0+\\gamma Y}$

Cost function:

$c(z,Y(z)) = C_1\\cdot W(\\hat{Y}(z|x) ) + C_2 z $
$c(z,Y(z)) = C_1\\cdot W(\\hat{Y}(z|x) ) + C_2 z $



Get distribution:

$\\argmin_{w_i}c(z,Y(z))$

Get decision:

$z^*(x) = \\argmin_{z\\in\\mathcal Z}\\mathbb E[c(z;Y(z))\\mid X=x]$

`,B7=`# 3 Predicting Delivery Time 

#### (1)

$DeliveryTime  _{i}=  Distance  _{i}+\\epsilon_{i}$


#### (2)

$DeliveryTime  _{i}=  Workload  _{i}+  Workload  _{i}^{1 / 2}+  Distance  _{i}+\\epsilon_{i}$

#### (3)

$DeliveryTime  _{i k}=\\eta_{k}+  Workload  _{i k}+  Workload  _{i}^{1 / 2}+  Distance  _{i k}+\\epsilon_{i k} $

# 4 Courier Assigned Location Mismatch (CALM) Metric

$M$: territories 

$d_{ij}$: distance 

$\\boldsymbol \\zeta\\in\\mathbb R_+^M$: current assigned location vector

$\\zeta_i$: number of customers in $i$

$\\boldsymbol \\xi\\in\\Delta^M$: prior assigned location vector 
- $\\Delta^M:=\\{\\boldsymbol \\xi\\in\\mathbb R_+^M:\\boldsymbol 1^\\top\\boldsymbol \\xi = 1\\}$

$\\xi_j$: proportion of past assignments to zone $j$

- $\\boldsymbol  \\xi=\\boldsymbol{\\zeta} / \\mathbf{1}^{\\top} \\boldsymbol{\\zeta} $: assigned location = past assignments

### Definition 1 (Creterion of Courier Assigned Location Mismatch Metric)

> $ \\rho(\\boldsymbol{\\zeta}, \\boldsymbol{\\xi}): \\mathbb{R}_{+}^{M} \\times \\Delta^{M} \\rightarrow \\mathbf R_+$
>
> It satisfies:
>
> (a) **Matched Assignment**
>
> For any $ \\boldsymbol{\\zeta} \\in \\mathbb{R}_{+}^{M}, \\boldsymbol{\\xi} \\in \\Delta^{M} $ : 
> 
> $ \\rho(\\boldsymbol{\\zeta}, \\boldsymbol{\\xi})=\\mathbf{0} $ if and only if $ \\boldsymbol{\\zeta}=\\boldsymbol{\\xi} \\cdot \\mathbf{1}^{\\top} \\boldsymbol{\\zeta} $
>
> (b) **Basic Location Mismatch**
>
> For any $ i, j \\in[M] $ : 
>
> $\\rho\\left(\\boldsymbol{e}_{i}, \\boldsymbol{e}_{j}\\right)=d_{i j}$
>
> (c) **Positive Homogeneous**
>
> For any $ \\boldsymbol{\\zeta} \\in \\mathbb{R}_{+}^{M}, \\boldsymbol{\\xi} \\in \\Delta^{M}, \\alpha>0 $ :
>
> $\\rho(\\alpha \\boldsymbol{\\zeta}, \\boldsymbol{\\xi})=\\alpha \\rho(\\boldsymbol{\\zeta}, \\boldsymbol{\\xi}) .$
>
> (d) **Sub-additive**
>
> For any $ \\boldsymbol{\\zeta}_{1}, \\boldsymbol{\\zeta}_{2} \\in \\mathbb{R}_{+}^{M}, \\boldsymbol{\\xi} \\in \\Delta^{M} $ : 
>
> $\\rho\\left(\\boldsymbol{\\zeta}_{1}+\\boldsymbol{\\zeta}_{2}, \\boldsymbol{\\xi}\\right) \\leq \\rho\\left(\\boldsymbol{\\zeta}_{1}, \\boldsymbol{\\xi}\\right)+\\rho\\left(\\boldsymbol{\\zeta}_{2}, \\boldsymbol{\\xi}\\right) $

### Definition 2(The $\\ell_p$-Based CALM Metric)

> For given $ p \\in[1, \\infty) $, we define the $ \\ell_{p} $-based CALM metric as the following function $ \\rho(\\boldsymbol{\\zeta}, \\boldsymbol{\\xi}): \\mathbb{R}_{+}^{M} \\times \\Delta^{M} \\rightarrow \\mathbb{R}_{+} $,
>
> #### (4)
>
> $\\begin{array}{rlr} \\rho(\\boldsymbol{\\zeta}, \\boldsymbol{\\xi})=\\min & \\left(\\sum_{i \\in[M] j} \\sum_{j \\in[M]}\\left(d_{i j} s_{i j}\\right)^{p}\\right)^{1 / p} & \\\\ \\text { s.t. } & \\sum_{i \\in[M]} s_{i j}=\\xi_{j} \\mathbf{1}^{\\top} \\boldsymbol{\\zeta} & \\forall j \\in[M] \\\\ & \\sum_{j \\in[M]} s_{i j}=\\zeta_{i} & \\forall i \\in[M] \\\\ & \\boldsymbol{s} \\geq \\mathbf{0} . & \\end{array}$

### Theorem 1

> The $ \\ell_{p} $-based CALM metric satisfies the properties of the assigned location mismatch metric for all $ p \\in[1, \\infty] $

# 5 The Service Oriented Routing (SOR) Model 


$ \\mathcal{G}=(\\{0\\} \\cup[N], \\mathcal{A}) $: a completed directed graph 
- node 0 represents the depot 
- $ \\mathcal{A}=\\{(i, j) \\mid i, j \\in\\{0\\} \\cup[N], i \\neq j\\} $ is the arc set. 

$ n $: Each customer node 

$ q_{n} $: demand  

$ c_{a} $: travel distance. each arc $ a \\in A $ has a travel distance . 

$ Q $: Capacity. Each courier has a capacity. 

For a subset $ \\mathcal{S} \\subseteq[N] $, 

$ \\mathcal{A}^{+}(\\mathcal{S})=\\{(i, j) \\in \\mathcal{A} \\mid i \\in \\mathcal{S}, j \\notin \\mathcal{S}\\} $ 

$ \\mathcal{A}^{-}(\\mathcal{S})=\\{(i, j) \\in \\mathcal{A} \\mid i \\notin \\mathcal{S}, j \\in \\mathcal{S}\\} $. 

$ \\boldsymbol{x}_{k}=\\left(x_{k 1}, \\cdots, x_{k N}\\right) \\in\\{0,1\\}^{N} $: the assignment of customer nodes to courier $ k $, 

- $ x_{k n}=1 $ if node $ n $ is served by courier $ k $ 
- $ x_{k n}=0 $ otherwise. 

For each $ k \\in[K] $: 

$ \\boldsymbol{y}_{k}=\\left(y_{k a}\\right)_{a \\in \\mathcal{A}} \\in\\{0,1\\}^{|\\mathcal{A}|} $, 
- $ y_{k a}=1 $ if courier $ k $ travels from along arc $a$
- $y_{ka} = 0$ otherwise 

The constraint for the routing problem is defined by:

$ \\mathcal{X}=\\left\\{\\begin{array}{l|ll}\\left(\\boldsymbol{x}_{k}, \\boldsymbol{y}_{k}\\right)_{k \\in[K]} & \\begin{array}{ll}\\sum_{k \\in[K]} x_{k n}=1 & \\forall n \\in[N] \\\\ \\sum_{\\left.a \\in \\mathcal{A}^{+}+\\{0\\}\\right)} y_{k a}=\\sum_{a \\in \\mathcal{A}^{-}(\\{0\\})} y_{k a}=1 & \\forall k \\in[K] \\\\ \\sum_{a \\in \\mathcal{A}^{+}(\\{n\\})} y_{k a}=\\sum_{a \\in \\mathcal{A}^{-}(\\{n\\})} y_{k a}=x_{k n} & \\forall n \\in[N], k \\in[K] \\\\ \\sum_{a \\in \\mathcal{A}^{+}(\\mathcal{S})} y_{k a} \\geq x_{k n} & \\forall n \\in \\mathcal{S}, \\mathcal{S} \\subseteq[N], k \\in[K] \\\\ \\sum_{n \\in[N]} q_{n} x_{k n} \\leq Q & \\forall k \\in[K] \\\\ \\boldsymbol{x}_{k} \\in\\{0,1\\}^{N}, \\boldsymbol{y}_{k} \\in\\{0,1\\}^{|\\mathcal{A}|} & \\forall k \\in[K]\\end{array}\\end{array}\\right\\} $

- all the nodes are served
- every courier is used 
- whether a node is served by a particular courier
- subtour elimination
-  capacity constraints of the couriers

$ \\mu\\left(\\boldsymbol{y}_{k}\\right) $ to denote the routing distance for courier $k$

$ \\mu\\left(\\boldsymbol{y}_{k}\\right)=\\sum_{a \\in \\mathcal{A}} c_{a} y_{k a} $

- $ c_{a} $ is the travel distance along arc $ a \\in \\mathcal{A} $.

---

$N$: customers

$\\boldsymbol x\\in\\{0,1\\}^N$: decision variable

- $n$ is selected if $x_n = 1$

$ \\mathbf{1}^{\\top} \\boldsymbol{x} \\in\\{0,1, \\cdots, L-1\\} $,: Total workload 
- $L-1$: maximum workload 

$ g\\left(\\boldsymbol{w}_{L}, \\boldsymbol{x}\\right):=\\sum_{\\ell \\in[L]} w_{\\ell} \\delta_{\\ell}(\\boldsymbol{x}) $: generic workload dependency function 

- $ \\boldsymbol{w}_{L}:=\\left(w_{1}, \\ldots, w_{L}\\right) $
- #### (7)
- $ \\delta_{\\ell}(\\boldsymbol{x}):=\\left\\{\\begin{array}{l}1 \\text { if } \\mathbf{1}^{\\top} \\boldsymbol{x}=\\ell-1 \\\\ 0 \\text { otherwise }\\end{array}, \\quad \\forall \\ell \\in[L]\\right. $

$ \\hat{\\beta}_{1}+\\hat{\\beta}_{2}\\left(\\mathbf{1}^{\\top} \\boldsymbol{x}\\right)+\\hat{\\beta}_{3}\\left(\\mathbf{1}^{\\top} \\boldsymbol{x}\\right)^{1 / 2} $: Workload function 

Then: 

$ \\hat{w}_{\\ell}=\\hat{\\beta}_{1}+\\hat{\\beta}_{2}(\\ell-1)+\\hat{\\beta}_{3}(\\ell-1)^{1 / 2} \\quad \\forall \\ell \\in[L] $.

$\\boldsymbol h_m \\in\\{0,1\\}^N,\\forall m\\in[M]$:
- $h_{mn}=1$ if customer $n$ is in zone $m$

- $\\boldsymbol  h_m^\\top\\boldsymbol  x_k$: number of customer nodes 

Then SOR model:

#### (8)

$ \\begin{array}{rlr}\\hat{Z}=\\min & \\sum_{k \\in[K]} \\mu\\left(\\boldsymbol{y}_{k}\\right) & \\\\ \\text { s.t. } & g\\left(\\hat{\\boldsymbol{w}}_{L}, \\boldsymbol{x}_{k}\\right)+\\hat{w}_{L+1} \\mu\\left(\\boldsymbol{y}_{k}\\right)+\\hat{w}_{L+2} \\lambda_{k} \\leq T_{k} & \\forall k \\in[K] \\\\ & \\rho\\left(\\boldsymbol{H} \\boldsymbol{x}_{k}, \\hat{\\boldsymbol{\\xi}}_{k}\\right) \\leq \\lambda_{k} & \\forall k \\in[K] \\\\ & \\left(\\boldsymbol{x}_{k}, \\boldsymbol{y}_{k}\\right)_{k \\in[K]} \\in \\mathcal{X}, \\boldsymbol{\\lambda} \\in \\mathbb{R}^{K}, & \\end{array} $

- $ T_{k} $ :the predetermined delivery time deadline for courier $ k$,
- $ \\hat{w}_{L+1}, \\hat{w}_{L+2} $: the corresponding estimated weights for travel distance and the CALM metric 
- $ \\hat{\\boldsymbol{\\xi}}_{k} $  the prior assigned location vector of courier $ k $ determined from historical data.

### Theorem 2

> The SOR model as presented in Problem (8) is equivalent to the following mixed integer linear optimization problem:
>
> #### (9)
>
> $ \\begin{array}{rlr}\\hat{Z}=\\min & \\sum_{k \\in[K]} \\sum_{a \\in \\mathcal{A}} c_{a} y_{k a} & \\\\ \\text { s.t. } & \\sum_{\\ell \\in[L]} \\hat{w}_{\\ell} z_{k \\ell}+\\hat{w}_{L+1} \\sum_{a \\in \\mathcal{A}} c_{a} y_{k a}+\\hat{w}_{L+2} \\lambda_{k} \\leq T_{k} & \\forall k \\in[K] \\\\ & \\rho_{k}\\left(\\boldsymbol{x}_{k}\\right) \\leq \\lambda_{k} & \\forall k \\in[K] \\\\ & \\mathbf{1}^{\\top} \\boldsymbol{x}_{k}=\\sum_{\\ell \\in[L]}(\\ell-1) z_{k \\ell} & \\forall k \\in[K] \\\\ & \\mathbf{1}^{\\top} \\boldsymbol{z}_{k}=1 & \\forall k \\in[K] \\\\ & \\boldsymbol{z}_{k} \\in\\{0,1\\}^{L} & \\forall k \\in[K] \\\\ & \\left(\\boldsymbol{x}_{k}, \\boldsymbol{y}_{k}\\right)_{k \\in[K]} \\in \\mathcal{X}, \\boldsymbol{\\lambda} \\in \\mathbb{R}^{K}, & \\end{array} $
>
> Where:
>
> #### (10)
>
> $ \\rho_{k}\\left(\\boldsymbol{x}_{k}\\right)=\\left\\{\\begin{array}{ll}\\min & \\sum_{i, j \\in[M]} d_{i j} s_{i j} \\\\ \\text { s.t. } & \\sum_{i \\in[M]} s_{i j}=\\hat{\\xi}_{k j} \\mathbf{1}^{\\top} \\boldsymbol{x}_{k} \\forall j \\in[M] \\\\ \\sum_{j \\in[M]} s_{i j}=\\boldsymbol{h}_{i}^{\\top} \\boldsymbol{x}_{k} \\quad \\forall i \\in[M] \\\\ \\boldsymbol{s} \\geq \\mathbf{0} \\\\ & =\\left\\{\\begin{array}{ll}\\max & \\sum_{i \\in[M]} u_{i} \\boldsymbol{h}_{i}^{\\top} \\boldsymbol{x}_{k}+\\sum_{j \\in[M]} v_{j} \\hat{\\xi}_{k j} \\mathbf{1}^{\\top} \\boldsymbol{x}_{k} \\\\ \\text { s.t. } & u_{i}+v_{j} \\leq d_{i j} \\\\ \\boldsymbol{u}, \\boldsymbol{v} \\in \\mathbb{R}^{M} .\\end{array} \\quad \\forall i, j \\in[M]\\right.\\end{array}\\right. $







placeholder

placeholder

placeholder

placeholder

placeholder

placeholder

placeholder





Idea 

- residual with z 
`,L7=`# 投资收益分析

## 金融投资市值分析

$C_t$: 时刻 t 的收入现金流

$ P V_{0}=\\sum_{h=0}^{\\infty} \\frac{C_{h}}{1+R_{0, h}} $

- $R_{t,t+h}$: $t+h$ 时刻向时刻 t 的折现率

$ P V_{t}=\\sum_{h=0}^{\\infty} \\frac{C_{t+h}}{1+R_{t, t+h}} $

- $C_{t+h}$固定：债券（固定收益）
- 反之：股票（浮动收益）

-

$C_{t+h}$: 由产品决定，与市场无关

$R_{t,t+h}$: 租金价格，取决于供求关系，不确定性风险是所有产品的系统性风险

---

收入现金流 + 利率（资金租金价格）

-> 产品市场价值 

-> 产品市场价格

-> 收益率（投资收益水平）

## 利率 

年化利率：资金租用价格

### 储蓄利率

无风险投资

$Ark$: 到期收益
- $r$: 年化利率 
- $k$: 年期
- $A$: 本金

$A(1+rk)$: 到期账户金额

单利

---

自动转存：

$A(1+rk)^n$: 账户金额

复利

$k$: 计息周期

--- 

没有流动性

不能反映金融市场中资金的租金价格

为金融产品提供一种计息规范

### 同业拆借利率

银行之间的短期资金借贷利率

- 拆进利率（Bid Rate）: 银行愿意借入的利率
- 拆出利率（Offered Rate）: 银行愿意借出的利率

拆进利率小于拆出利率

差额为银行的收益

--- 

市场利率由供求关系决定：

- 资金紧张 - 利率上升
- 资金宽松 - 利率下降

利率促进资金供求平衡：

- 利率下降 - 供给减少 需求增加
- 利率上升 - 供给增加 需求减少

### LIBOR

LIBOR: 伦敦同业拆借利率

国际金融市场贷款的参考利率

我国对外筹资成本：6个月LIBOR + 0.5% p.a. (per annum)

实际天数对 360 天报价

#### 例子：

设6个月期LIBOR为 $8%$

实际利息率：

$181 / 360 \\times 8\\% = 4.0222\\%$

---

可以影响整个金融市场的风险因子

LIBOR 值是如何变动的

### 无风险利率 

国债 - 有固定未来现金流

短期国债，流动性强

短期国债：贴现国债

$S = 100 - P\\dfrac{T}{360}$

- $P$: 报价
- $100$: 面值
- $S$: 现金价格
- $T$: 交易日 - 到期日

#### 国债例子

60天到期， 报价4.0

$S = 100 - 4 \\dfrac{60}{360}$ = 99.33

$R_t = \\dfrac{100-S}{S}\\dfrac{360}{T}$: 年化利率

即期利率：$R_{0,t}$：计算未来 t 时刻现金流现值的折现率 

远期利率：在未来 s 时刻至未来 t 时刻的利率

$ \\begin{aligned} & \\left(1+s \\cdot R_{s}\\right)\\left(1+(t-s) \\cdot R_{s, t}\\right)=1+t \\cdot R_{t} \\\\ \\Rightarrow & R_{s, t}=\\frac{1}{t-s} \\cdot\\left(\\frac{1+t \\cdot R_{t}}{1+s \\cdot R_{s}}-1\\right)=4.6084 \\%\\end{aligned} $

### 利率期限结构

$R_T $关于 $T$ 的函数

估计利率：

#### 插值估计

线性估计：

$ \\frac{R_{\\tau}-R_{T_{1}}}{\\tau-T_{1}}=\\frac{R_{T_{2}}-R_{T_{1}}}{T_{2}-T_{1}} \\Rightarrow R_{\\tau}=R_{T_{1}}+\\left(\\tau-T_{1}\\right) \\cdot \\frac{R_{T_{2}}-R_{T_{1}}}{T_{2}-T_{1}} $

远期利率插值：

$ \\begin{array}{l}\\frac{T_{2} \\cdot R_{T_{2}}-T_{1} \\cdot R_{T_{1}}}{\\left(T_{2}-T_{1}\\right)\\left(1+T_{1} \\cdot R_{T_{1}}\\right)}=R_{T_{1}, T_{2}}=R_{T_{1}, \\tau}=\\frac{\\tau \\cdot R_{\\tau}-T_{1} \\cdot R_{T_{1}}}{\\left(\\tau-T_{1}\\right)\\left(1+T_{1} \\cdot R_{T_{1}}\\right)} \\\\ \\Rightarrow R_{\\tau}=\\left(T_{1} \\cdot R_{T_{1}}+\\frac{\\tau-T_{1}}{T_{2}-T_{1}} \\cdot\\left(T_{2} \\cdot R_{T_{2}}-T_{1} \\cdot R_{T_{1}}\\right) / \\tau\\right.\\end{array} $   




`,O7=`# 问题

设当前日期 2025－02－01 的利率期限结构如下：
$
\\begin{array}{|c|c|}
\\hline
\\text{到期日} & \\text{即期利率} \\\\
\\hline
2025/3/1 & 1.631 \\\\
\\hline
2025/5/1 & 1.645 \\\\
\\hline
2025/8/1 & 1.656 \\\\
\\hline
2025/11/1 & 1.666 \\\\
\\hline
2026/2/1 & 1.674 \\\\
\\hline
\\end{array}
$

表1利率期限结构表

请据此估算到期日为 2025－6－30 的即期利率。

# 解答

使用线性插值：

$\\dfrac{R-1.645}{90-60} = \\dfrac{1.656-1.645}{120-60}$

得到：

$R = 1.6505$

使用远期利率插值：

$
\\dfrac{120 \\cdot 1.656 - 60 \\cdot 1.645}{(120-60)(1+60\\cdot 1.645)}
=\\dfrac{90R - 60\\cdot 1.645}{(90 - 60)(1 + 60\\cdot 1.645)}
$

得到：

$R = 1.6523$

`,j7=`# Model 

Consider $[t, t+\\Delta t]$ return:


$R_{t,t+\\Delta t} = \\dfrac{S(t+\\Delta t) / S(t) - 1}{\\Delta t}$

$\\Rightarrow S(t+\\Delta t) = S(t)(1+\\Delta t \\cdot R_{t,t+\\Delta t})$

复利：

$S(t+\\Delta t) = S(t) + (1 + \\dfrac{\\Delta t}{m}R^{t,t+\\Delta t})^m$

得到：

$S(t+\\Delta t) = S(t)e^{\\Delta t \\cdot \\bar R_{t, t+\\Delta t}}$

--- 

# 布朗运动

$\\Delta x = x(t+\\Delta t) - x(t)$

$E(\\Delta x) = 0$

$Var(\\Delta x) = \\sigma^2 (\\Delta t)$

Then:

$\\Delta x \\sim N(0, \\sigma^2(\\Delta t))$

## 维纳过程

$\\Delta x = \\varepsilon \\sqrt{\\Delta t}, \\varepsilon \\sim N(0, 1)$

# 股价行为

$S(t)$: $t$时刻的股价

$R_{t, t+ \\Delta t} = (\\dfrac{S(t+\\Delta t)}{S(t)} - 1)\\cdot\\dfrac{1}{\\Delta  t}$

$\\Rightarrow S(t+\\Delta t) = S(t) (1+\\Delta t \\cdot R_{t, t + \\Delta t})$

$\\Rightarrow S(t+\\Delta t) = S(t) (1+\\dfrac{\\Delta t}{m} \\cdot \\bar R_{t, t + \\Delta t})^m$

$= S(t)e^{\\Delta t \\cdot\\bar R_{t,t+\\Delta t}} $

Then:

$\\ln S(t+\\Delta t ) - \\ln S(t) = \\Delta t \\cdot \\bar R_{t, t+\\Delta t}$

$G(t) := \\ln (S_t)$

$\\Delta G \\sim N(\\bar \\mu \\cdot\\Delta t,\\sigma^2 \\cdot \\Delta t)$

Then:

$\\Delta G = \\bar \\mu \\cdot \\Delta t + \\sigma\\cdot \\Delta x$
- $\\Delta x$是维纳过程
- 称为广义维纳过程


`,V7=`# 两个基本问题

- 资本定价问题
- 风险管理问题

---

注意到：

$P_0 \\equiv \\sum_{t=1}^{2n}\\dfrac{P_0\\cdot\\dfrac{i}{2}}{(1+\\dfrac{i}{2})^t} + \\dfrac{P_0}{(1+\\dfrac{i}{2})^{2n}}$

$$
\\begin{aligned}
&RHS\\\\ 
&=P_0 (\\dfrac{i}{2} ( \\sum_{t=1}^{2n}\\dfrac{1}{(1+\\dfrac{i}{2})^t}) + \\dfrac{1}{(1+\\dfrac{i}{2})^{2n}})\\\\ 
&=P_0(\\dfrac{i}{2}\\cdot \\dfrac{1}{1+\\dfrac{i}{2}}(\\dfrac{1-(1+\\dfrac{i}{2})^{-2n}}{1-(1+\\dfrac{i}{2})^{-1}}) + \\dfrac{1}{(1+\\dfrac{i}{2})^{2n}})\\\\ 
&= P_0 (1- (1+\\dfrac{i}{2})^{-2n} + (1+\\dfrac{i}{2})^{-2n})\\\\
&= P_0 
\\end{aligned}
$$

美国买家 瑞士卖家 外汇市场 期货市场

## 内容安排

投资收益分析：
- 风险管理问题 
  - 战略手段
    - 投资风险决策分析
    - 投资组合理论分析
  - 技术手段
    - 期货套期保值分析
    - 期权套期保值分析
    - 期权风险套利分析
- 资本定价问题
  - 战术手段
    - 资本资产定价模型
    - 套利定价模型
  - 技术手段
    - 期货定价模型
    - 期权定价模型
  
  假设：
  - 风险是金融产品的固有属性，不受市场影响
  - 金融市场为弱有效市场，本质是风险和收益的交易场所
  - 期望效用最大的决策准测，在风险和收益中权衡




placeholder


placeholder

placeholder

placeholder

placeholder

`,W7=`# Static 

**Static Games of Complete Information**

Static: make decision simultaneously

Complete information: everyone has the same information 

## Normal form 

Players, strategies, payoffs

- Bi-matrix 
  - 2 players
  - Each has a finite number of strategies 

Example:

$
\\begin{array}{c|cc}
 & \\text{ (C)} & \\text{(D)} \\\\
\\hline
\\text{(C)} & (-1, -1) & (-3, 0) \\\\
\\text{(D)} & (0, -3) & (-2, -2) \\\\
\\end{array}
$

## Solving

Dominated strategy
- A strategy **Always** does better regardless of other players' choices

### Iterate

- find Strictly dominated strategy, eliminate it.

Example:


$
\\begin{array}{c|ccc}
 & \\text{ (Left)} & \\text{(Middle)} & \\text{(Right)} \\\\
\\hline
\\text{(Up)} & (1, 0) & (1, 2) & (0, 1) \\\\
\\text{(Down)} & (0, 3) & (0, 1) & (2, 0) \\\\
\\end{array}
$

Right is dominated by Middle:



$
\\begin{array}{c|cc}
 & \\text{ (Left)} & \\text{(Middle)} \\\\
\\hline
\\text{(Up)} & (1, 0) & (1, 2) \\\\
\\text{(Down)} & (0, 3) & (0, 1) \\\\
\\end{array}
$

Down is dominated by Up 



$
\\begin{array}{c|cc}
 & \\text{ (Left)} & \\text{(Middle)} \\\\
\\hline
\\text{(Up)} & (1, 0) & (1, 2) \\\\
\\end{array}
$

Left is dominated by Middle 

$
\\begin{array}{c|c}
 & \\text{(Middle)} \\\\
\\hline
\\text{(Up)} & (1, 2) \\\\
\\end{array}
$

## Nash Equilibrium

When in a combination:

- Every player **CANNOT** do better by choosing a different choice.

`,X7="",U7=`# Problem 1.4

## Problem 

> 1.4. Suppose there are $ n $ firms in the Cournot oligopoly model. Let $ q_{i} $ denote the quantity produced by firm $ i $, and let $ Q=q_{1}+\\cdots+ $ $ q_{n} $ denote the aggregate quantity on the market. Let $ P $ denote the market-clearing price and assume that inverse demand is given by $ P(Q)=a-Q $ (assuming $ Q<a $, else $ P=0 $ ). Assume that the total cost of firm $ i $ from producing quantity $ q_{i} $ is $ C_{i}\\left(q_{i}\\right)=c q_{i} $. That is, there are no fixed costs and the marginal cost is constant at $ c $, where we assume $ c<a $. Following Cournot, suppose that the firms choose their quantities simultaneously. What is the Nash equilibrium? What happens as $ n $ approaches infinity?

## Solution 

Denote $\\pi_i$ as $i$-th firm's payoff, then:

$\\pi_i = (P-c)q_i = q_i(a-Q - c)$

To maximize the payoff, we have:

$a-Q-c-q_i = 0$

That is:

$q_i = a - Q - c$

Then we sum the $n$ firms up:

$\\sum_{i=1}^n q_i = Q = n(a-Q-c)$

Then we get:

$Q = \\dfrac{n(a-c)}{n+1}$

Then:

$q_i = \\dfrac{a-c}{n+1}$

Therefore, the Nash Equilibruim is :

$(\\dfrac{a-c}{n+1},\\dots,\\dfrac{a-c}{n+1})$

When $n$ goes to infinity:


$\\lim_{n\\to\\infty}\\dfrac{a-c}{n+1} = 0$

# Problem 1.5

## Problem 

> 1.5. Consider the following two finite versions of the Cournot duopoly model. First, suppose each firm must choose either half the monopoly quantity, $ q_{m} / 2=(a-c) / 4 $, or the Cournot equilibrium quantity, $ q_{c}=(a-c) / 3 $. No other quantities are feasible. Show that this two-action game is equivalent to the Prisoners' Dilemma: each firm has a strictly dominated strategy, and both are worse off in equilibrium than they would be if they cooperated. Second, suppose each firm can choose either $ q_{m} / 2 $, or $ q_{c} $, or a third quantity, $ q^{\\prime} $. Find a value for $ q^{\\prime} $ such that the game is equivalent to the Cournot model in Section 1.2.A, in the sense that ( $ q_{c}, q_{c} $ ) is a unique Nash equilibrium and both firms are worse off in equilibrium than they could be if they cooperated, but neither firm has a strictly dominated strategy.

## Solution (a)

The payoff matrix is:

$$
\\begin{array}{l|l|l|}
& q_m/2 & q_c \\\\ 
\\hline q_m/2& (\\dfrac{(a-c)^2}{8},\\dfrac{(a-c)^2}{8})&(\\dfrac{5(a-c)^2}{48}, \\dfrac{5(a-c)^2}{36})\\\\
\\hline q_c&(\\dfrac{5(a-c)^2}{36}, \\dfrac{5(a-c)^2}{48})&(\\dfrac{(a-c)^2}{9}, \\dfrac{(a-c)^2}{9})\\\\
\\hline
\\end{array}
$$

Then: $q_m/2$ is strictly dominated by $q_c$, however,

$(q_m/2, q_m/2) $ is worse than $(q_c, q_c)$

It correspond with Prisoners' Dilemma.

## Solution (b)

Assume $q' = \\dfrac{a-c}{k}$, then:

$$
\\begin{array}{l|l|l|l|}
& q_m/2 & q_c &q'\\\\ 
\\hline q_m/2& (\\dfrac{(a-c)^2}{8},\\dfrac{(a-c)^2}{8})&(\\dfrac{5(a-c)^2}{48}, \\dfrac{5(a-c)^2}{36})&(\\dfrac{(3k-4)(a-c)^2}{16k}, \\dfrac{(3k-4)(a-c)^2}{4k^2})\\\\
\\hline q_c&(\\dfrac{5(a-c)^2}{36}, \\dfrac{5(a-c)^2}{48})&(\\dfrac{(a-c)^2}{9}, \\dfrac{(a-c)^2}{9})&(\\dfrac{(2k-3)(a-c)^2}{9k}, \\dfrac{(2k-3)(a-c)^2}{3k^2})\\\\
\\hline q'&(\\dfrac{(3k-4)(a-c)^2}{4k^2},\\dfrac{(3k-4)(a-c)^2}{16k})&( \\dfrac{(2k-3)(a-c)^2}{3k^2},\\dfrac{(2k-3)(a-c)^2}{9k})&(\\dfrac{(k-2)(a-c)^2}{k^2},\\dfrac{(k-2)(a-c)^2}{k^2})\\\\ 
\\hline
\\end{array}
$$

To make $(q_c, q_c)$ a Nash Equilibruim, we need:

$\\dfrac{1}{9} > \\dfrac{2k-3}{3k^2}$

To make $q_m/2$ not be dominated by $q_c$, we need:

$\\dfrac{3k-4}{16k}\\ge\\dfrac{2k-3}{9k  }$

To make $q'$ not be dominated, we need:

$\\max(\\dfrac{3k-4}{4k^2}-\\dfrac{5}{36},\\dfrac{2k-3}{3k^2}-\\dfrac{1}{9},\\dfrac{k-2}{k^2}-\\dfrac{2k-3}{9k}) \\ge 0$

combined them together, we get:

$k = \\dfrac{12}{5}$

that is:

$$
\\begin{array}{l|l|l|l|}
& q_m/2 & q_c &q'\\\\ 
\\hline q_m/2& (\\dfrac{(a-c)^2}{8},\\dfrac{(a-c)^2}{8})&(\\dfrac{5(a-c)^2}{48}, \\dfrac{5(a-c)^2}{36})&(\\dfrac{(a-c)^2}{12}, \\dfrac{5(a-c)^2}{36})\\\\
\\hline q_c&(\\dfrac{5(a-c)^2}{36}, \\dfrac{5(a-c)^2}{48})&(\\dfrac{(a-c)^2}{9}, \\dfrac{(a-c)^2}{9})&(\\dfrac{(a-c)^2}{12}, \\dfrac{5(a-c)^2}{48})\\\\
\\hline q'&(\\dfrac{5(a-c)^2}{36},\\dfrac{(a-c)^2}{12})&( \\dfrac{5(a-c)^2}{48},\\dfrac{(a-c)^2}{12})&(\\dfrac{5(a-c)^2}{72},\\dfrac{5(a-c)^2}{72})\\\\ 
\\hline
\\end{array}
$$
`,H7=`# Channel Structures of Online Retail Platforms

# Modeling Framework: The Base Case 

$M$: Manufacturer

$I$: Online intermediary 

Options:

- Model R: reselling channel 
- Model A: agency channel 
- Model D: dual channel 

Model R:
- unit wholesale price 
- intermediary determine quantity 

Model A:
- determine quantity 
- pay unit commission rate $r$
  - exogenous 

Inverse demand function:

$p = a - q_M- q_I + e$

- $a$: potential market size
- $q_M$: manufacturer quantity (agency)
- $q_I$: intermediary quantity (reselling)
- $e$: service effort by intermediary

$\\dfrac{ke^2}{2}$: cost of service effort 

Model A:

1. Manufacturer decide $q_M$ and intermediary decide $e$
2. $p$ realised 

Model R:

1. Manufacturer decide $w$
2. intermediary decide $q_I$ and $e$
3. $p$ realised 

Model D:

1. Manufacturer decide $w$
2. intermediary decide $q_I$
3. Manufacturer decide $q_M$ and intermediary decide $e$
4. $p$ realised 


### Assumption 1

> $ k>\\underline{k} \\equiv \\max \\left[\\frac{1}{2}, \\frac{r}{2}, \\frac{1}{3-r}, \\frac{r(4-r)}{4(3-r)}+\\frac{1}{4} \\sqrt{\\frac{(2-r)^{2}\\left(r^{2}-4 r+12\\right)}{(r-3)^{2}}}\\right]= $ $ \\frac{r(4-r)}{4(3-r)}+\\frac{1}{4} \\sqrt{\\frac{(2-r)^{2}\\left(r^{2}-4 r+12\\right)}{(r-3)^{2}}} $.

- profit functions are concave 
- service effort is not low 

# 4 Equilibruim Price and Effort Decisions 

## 4.1 Centralized Model 

system profit:

$pQ - \\dfrac{ke^2}{2}$

optimal solution:

$ \\begin{array}{l}Q^{*}=\\frac{a k}{2 k-1}, \\\\ e^{*}=\\frac{a}{2 k-1} .\\end{array} $

## 4.2 Model A 

For Manufacturer:

$ \\max _{q_{M}}\\left(a-q_{M}+e\\right) q_{M}(1-r) $

For intermediary:

$ \\max _{e}\\left(a-q_{M}+e\\right) q_{M} r-\\frac{1}{2} k e^{2} $.

The equilibrium:

$ \\begin{array}{l}q_{M}^{A}=\\frac{a k}{2 k-r}, \\\\ e^{A}=\\frac{a r}{2 k-r} .\\end{array} $

Then we get:

$ \\begin{array}{l}\\pi_{M}^{A}=\\frac{a^{2} k^{2}(1-r)}{(r-2 k)^{2}}, \\\\ \\pi_{I}^{A}=\\frac{a^{2} k r}{4 k-2 r} .\\end{array} $

## 4.3 Model R 

Given $w$, intermediary have:

$ \\max _{e, q_{I}}\\left(a-q_{I}+e-w\\right) q_{I}-\\frac{1}{2} k e^{2} $

Then we get:

$ \\begin{array}{l}\\hat{q}_{I}(w)=\\frac{k(a-w)}{2 k-1}, \\\\ \\hat{e}(w)=\\frac{a-w}{2 k-1} .\\end{array} $

Then for manufacturer:

$ \\max _{w} w \\hat{q}_{I}(w) $

Then:

$ \\begin{aligned} w^{R} & =\\frac{a}{2} \\\\ q_{I}^{R} & =\\frac{a k}{2(2 k-1)} \\\\ e^{R} & =\\frac{a}{2(2 k-1)}\\end{aligned} $

Finally:

$ \\begin{array}{l}\\pi_{M}^{R}=\\frac{a^{2} k}{4(2 k-1)}, \\\\ \\pi_{I}^{R}=\\frac{a^{2} k}{8(2 k-1)} .\\end{array} $

## 4.4 Model D 

Given $w, q_I$, for manufacturer:

$ \\max _{q_{M}} w q_{I}+\\left(a-q_{M}-q_{I}+e\\right) q_{M}(1-r) $.

For intermediary:

$ \\begin{array}{l}\\max _{e}\\left(a-q_{M}-q_{I}+e-w\\right) q_{I}+\\left(a-q_{M}-q_{I}+e\\right) q_{M} r \\\\ \\quad-\\frac{1}{2} k e^{2}\\end{array} $

Then we get:

$ \\begin{array}{l}\\hat{q}_{M}\\left(q_{I}\\right)=\\frac{a k+(1-k) q_{I}}{2 k-r}, \\\\ \\hat{e}\\left(q_{I}\\right)=\\frac{a r+(2-r) q_{I}}{2 k-r} .\\end{array} $

For intermediary:

$ \\begin{array}{l}\\max _{q_{I}}\\left(a-\\hat{q}_{M}\\left(q_{I}\\right)-q_{I}+\\hat{e}\\left(q_{I}\\right)-w\\right) q_{I} \\\\ \\quad+\\left(a-\\hat{q}_{M}\\left(q_{I}\\right)-q_{I}+\\hat{e}\\left(q_{I}\\right)\\right) \\hat{q}_{M}\\left(q_{I}\\right) r-\\frac{1}{2} k\\left(\\hat{e}\\left(q_{I}\\right)\\right)^{2}\\end{array} $

Then we get:

$ \\hat{q}_{I}(w)=\\frac{a k(1-r)-w(2 k-r)}{k(2-r)} $.

For manufacturer:

$ \\begin{array}{r}\\max _{w} w \\hat{q}_{I}(w)+\\left(a-\\hat{q}_{I}(w)-\\hat{q}_{M}\\left(\\hat{q}_{I}(w)\\right)\\right. \\\\ \\left.+\\hat{e}\\left(\\hat{q}_{I}(w)\\right)\\right) \\hat{q}_{M}\\left(\\hat{q}_{I}(w)\\right)(1-r) .\\end{array} $

Finally:

$ \\begin{aligned} w^{D} & =\\frac{a k(1-r)\\left(2 k^{2}(3-r)-k r(4-r)-2(1-r)\\right)}{2(k(3-r)-1)(k-r+1)(2 k-r)}, \\\\ q_{I}^{D} & =\\frac{a k(2-r)(1-r)}{2(k(3-r)-1)(k-r+1)}, \\\\ q_{M}^{D} & =\\frac{a k(k(3-r)-r+1)}{2(k(3-r)-1)(k-r+1)}, \\\\ e^{D} & =\\frac{a((3-r) r k+2(1-r))}{2(k(3-r)-1)(k-r+1)} .\\end{aligned} $

# 5 Equilibrium Profits and Channel Structure

### Proposition 1

> (a) Wholesale price effect: $ w^{D}<w^{R} $ and $ \\partial w^{D} / \\partial r<0 $. 
> 
> (b) Channel flexibility effect: $ \\partial q_{M}^{D} / \\partial r> $ $ 0, \\partial q_{I}^{D} / \\partial r<0, \\partial\\left(q_{M}^{D}+q_{I}^{D}\\right) / \\partial r>0 $ and $ \\partial e^{D} / \\partial r>0 $.


### Proposition 2

> (a) $ \\pi_{I}^{D} \\geq \\pi_{I}^{A}, \\pi_{M}^{D} \\geq \\pi_{M}^{A} $, and $ \\pi_{I}^{D}+ $ $ \\pi_{M}^{D} \\geq \\pi_{I}^{A}+\\pi_{M}^{A} $. 
> 
> (b) There exists $ \\tilde{r}_{S C} $ such that $ \\pi_{I}^{D}+\\pi_{M}^{D} \\geq $ $ \\pi_{I}^{R}+\\pi_{M}^{R} $ if $ r \\geq \\tilde{r}_{S C} $ and $ \\pi_{I}^{D}+\\pi_{M}^{D}<\\pi_{I}^{R}+\\pi_{M}^{R} $ otherwise. 
> 
> (c) There exists $ \\tilde{r}_{I} \\in(0,1 / 2) $ such that $ \\pi_{I}^{D} \\geq \\pi_{I}^{R} $ if $ r \\geq \\tilde{r}_{I} $ and $ \\pi_{I}^{D}<\\pi_{I}^{R} $ otherwise. 
> 
> (d) There exist $ \\tilde{r}_{M} $ and $ \\tilde{k}_{M} $ such that $ \\pi_{M}^{D} \\geq \\pi_{M}^{R} $ if 
> (i) $ k \\geq \\tilde{k}_{M} $ and $ r \\leq 1 / 2 $ or 
> (ii) $ k>1 $ and $ 1 / 2<r \\leq \\tilde{r}_{M} $, and $ \\pi_{M}^{D}<\\pi_{M}^{R} $ otherwise.

---

$
\\begin{array}{|c|c|c|c|}
\\hline
\\text{Regions} & \\text{Profit Comparison} & \\text{Regions} & \\text{Profit Comparison} \\\\
\\hline
A & \\pi_{I}^{D} \\geq \\pi_{I}^{R}, \\pi_{M}^{D}<\\pi_{M}^{R} & C & \\pi_{I}^{D}<\\pi_{I}^{R}, \\pi_{M}^{D}<\\pi_{M}^{R} \\\\
\\hline
B & \\pi_{I}^{D} \\geq \\pi_{I}^{R}, \\pi_{M}^{D} \\geq \\pi_{M}^{R} & D & \\pi_{I}^{D}<\\pi_{I}^{R}, \\pi_{M}^{D} \\geq \\pi_{M}^{R} \\\\
\\hline
\\end{array}
$

![Figure 1](image-15.png)

### Corollary 1

> As $ k \\rightarrow \\infty, e_{I}^{D} \\rightarrow 0, q_{I}^{D} \\rightarrow 0, q_{M}^{D} \\rightarrow q_{M}^{A}= $ $ Q^{*} $, and $ \\pi_{I}^{D}+\\pi_{M}^{D} \\rightarrow \\pi_{I}^{A}+\\pi_{M}^{A}=a^{2} / 4 $.

### Proposition 3

> (a) When the intermediary chooses the channel structure, the equilibrium is dual channel if $ r \\geq \\tilde{r}_{I} $ (Regions A and B) and reselling channel otherwise (Regions $ C $ and $ D $ ). 
> 
> (b) When the manufacturer chooses the channel structure, the equilibrium is dual channel if 
> (i) $ k \\geq $ $ \\tilde{k}_{M} $ and $ r \\leq 1 / 2 $ or 
> (ii) $ k>1 $ and $ 1 / 2<r \\leq \\tilde{r}_{M} $ (Regions $ B $ and $ D) $ and reselling channel otherwise (Regions $ A $ and $ C) $.
> 
> (c) Both firms prefer dual channel if (i) $ k \\geq \\tilde{k}_{M} $ and $ \\tilde{r}_{I} \\leq r \\leq $ $ 1 / 2 $ or (ii) $ k>1 $ and $ 1 / 2<r \\leq \\tilde{r}_{M} $ (Region B). (d) Both firms prefer reselling channel if $ k<\\tilde{k}_{M} $ and $ r<\\tilde{r}_{I} $ (Region C).

# Extensions

$$
\\begin{array}{|c|c|c|c|}
\\hline
\\text{Regions} & \\text{Profit Comparison} & \\text{Regions} & \\text{Profit Comparison} \\\\
\\hline
A & \\pi_{I}^{D} \\geq \\pi_{I}^{R},\\; \\pi_{M}^{D} < \\pi_{M}^{R} & C & \\pi_{I}^{D} < \\pi_{I}^{R},\\; \\pi_{M}^{D} < \\pi_{M}^{R} \\\\
\\hline
B & \\pi_{I}^{D} \\geq \\pi_{I}^{R},\\; \\pi_{M}^{D} \\geq \\pi_{M}^{R} & D & \\pi_{I}^{D} < \\pi_{I}^{R},\\; \\pi_{M}^{D} \\geq \\pi_{M}^{R} \\\\
\\hline
\\end{array}
$$

![Figure 2 (a)](image-16.png)

![Figure 2 (b)](image-17.png)

## 6.1 Observable Service Effort 

![Figure 3 (a)](image-18.png)

![Figure 3 (b)](image-19.png)

## 6.2 Simultaneous Quantity Decisions

## 6.3 Manufacturer Service Effort 

### Proposition 4 


> (a) There exists $ \\tilde{r}_{I} \\in(0,1 / 4) $ such that $ \\pi_{I}^{A} \\geq $ $ \\pi_{I}^{R} $ if $ r \\geq \\tilde{r}_{I} $ and $ \\pi_{I}^{A}<\\pi_{I}^{R} $ otherwise. 
> 
> (b) There exist $ \\tilde{r}_{M} \\in $ $ (1 / 2,1) $ such that $ \\pi_{M}^{A} \\geq \\pi_{M}^{R} $ if $ r \\leq \\tilde{r}_{M} $ and $ \\pi_{M}^{A}<\\pi_{M}^{R} $ otherwise.

$$
\\begin{array}{|c|c|c|c|}
\\hline
\\text{Regions} & \\text{Profit Comparison} & \\text{Regions} & \\text{Profit Comparison} \\\\
\\hline
A & \\pi_{I}^{A} \\geq \\pi_{I}^{R},\\; \\pi_{M}^{A} < \\pi_{M}^{R} & C & \\pi_{I}^{A} < \\pi_{I}^{R},\\; \\pi_{M}^{A} < \\pi_{M}^{R} \\\\
\\hline
B & \\pi_{I}^{A} \\geq \\pi_{I}^{R},\\; \\pi_{M}^{A} \\geq \\pi_{M}^{R} & D & \\pi_{I}^{A} < \\pi_{I}^{R},\\; \\pi_{M}^{A} \\geq \\pi_{M}^{R} \\\\
\\hline
\\end{array}
$$

![Figure 4 (a)](image-20.png)

![Figure 4 (b)](image-21.png)

### Proposition 5

> (a) There exist $ \\tilde{r}_{I 1} \\in(1 / 2,1) $ and $ \\tilde{r}_{12} \\in $ $ (0,1 / 4) $ such that $ \\pi_{I}^{A} \\geq \\pi_{I}^{R} $ if 
> (i) $ k \\leq 1 / 2 $ and $ r \\leq \\tilde{r}_{11} $ or 
> (ii) $ k>1 / 2 $ and $ r \\geq \\tilde{r}_{12} $ and $ \\pi_{I}^{A}<\\pi_{I}^{R} $ otherwise. 
> 
> (b) $ \\pi_{M}^{A} \\geq \\pi_{M}^{R} $ if $ r \\leq \\tilde{r}_{M} \\equiv 1 / 2 $ and $ \\pi_{M}^{A}<\\pi_{M}^{R} $ otherwise.

`,G7=`# 

## Example 1: Bertrand model of duopoly

Best respond function : 

$p^m = \\dfrac{a+c}{2}$

$B_1(p_2) = \\begin{cases}
\\{p_1:p_1>p_2\\} & if: p_2 < c \\\\
\\{p_1: p_1 \\ge p_2\\} &if: p_2 = c \\\\ 
\\oslash & if: e<p_2\\le p^m \\\\ 
p^m & if: p^m < p_2 
\\end{cases}
$


$B_1(p_1) = \\begin{cases}
\\{p_2:p_2>p_1\\} & if: p_1 < c \\\\
\\{p_2: p_2 \\ge p_1\\} &if: p_1 = c \\\\ 
\\oslash & if: e<p_1\\le p^m \\\\ 
p^m & if: p^m < p_1 
\\end{cases}
$

## Example 2: Public good

$u_1(c_1, c_2) = v_1(c_1+c_2) + w_1 - c_1$

$u_2(c_1, c_2) = v_2(c_1+ c_2) + w_2 - c_2$


Best response:
s} r_
$$                                                                                   

$$                                                                                   
1 - c_2 & if : c_2<r_
$R_1(c_2) = \\begin{case1 \\\\ 0& if:c_2 \\ge r_1 \\end{cases}$


$R_2(c_1) = \\begin{cases} r_2 - c_1 & if : c_1<r_2 \\\\ 0& if:c_1 \\ge r_2 \\end{cases}$


## Example 3: Farmers 

$u_i(g_1,\\dots,g_n) = g_i \\cdot v(g_1+\\dots+g_n)-cg_1$




`,K7=`# 1

## Problem 

> 1. Consider the following game.
> $\\begin{array}{|l|l|l|l|l|}\\hline & w & x & y & z \\\\ \\hline a & 4,4 & 1,1 & 0,2 & 0,1 \\\\ \\hline b & 1,1 & 1,2 & 1,0 & 1,6 \\\\ \\hline c & 0,0 & 2,0 & 3,2 & 0,1 \\\\ \\hline d & 0,0 & 0,5 & 0,2 & 6,1 \\\\ \\hline\\end{array}$
> (a) Find a mixed strategy for the row player to strictly dominate strategy b.
> (b) Compute the set of all Nash equilibria (including mixed strategies). Hint: In any mixed strategy Nash equilibrium, we put zero probability on strictly dominated strategies.

## Solution (a)

Notice:

$\\dfrac{7}{18}a+\\dfrac{7}{18}c+\\dfrac{4}{18}d = (\\dfrac{14}{9}, \\dfrac{7}{6},\\dfrac{7}{6}, \\dfrac{4}{3}) > (1, 1, 1, 1)$

## Solution (b)

After eliminate b:


$\\begin{array}{|l|l|l|l|l|}\\hline & w & x & y & z \\\\ \\hline a & 4,4 & 1,1 & 0,2 & 0,1 \\\\ \\hline c & 0,0 & 2,0 & 3,2 & 0,1 \\\\ \\hline d & 0,0 & 0,5 & 0,2 & 6,1 \\\\ \\hline\\end{array}$

z is strictly dominated by y:

$\\begin{array}{|l|l|l|l|}\\hline & w & x & y \\\\ \\hline a & 4,4 & 1,1 & 0,2  \\\\ \\hline c & 0,0 & 2,0 & 3,2  \\\\ \\hline d & 0,0 & 0,5 & 0,2 \\\\ \\hline\\end{array}$

d is strictly dominated by a and c:

$\\begin{array}{|l|l|l|l|}\\hline & w & x & y \\\\ \\hline a & 4,4 & 1,1 & 0,2  \\\\ \\hline c & 0,0 & 2,0 & 3,2  \\\\ \\hline\\end{array}$

x is strictly dominated by y:


$\\begin{array}{|l|l|l|l|}\\hline & w  & y \\\\ \\hline a & 4,4  & 0,2  \\\\ \\hline c & 0,0 & 3,2  \\\\ \\hline\\end{array}$

Therefore the mixed nash equilibrium:

$\\left(\\left(\\dfrac{1}{2}, 0, \\dfrac{1}{2}, 0\\right),\\left(\\dfrac{3}{7}, 0, \\dfrac{4}{7}, 0\\right)\\right)$

# 1.12

## Problem 

> Find the mixed-strategy Nash equilibrium of the following normal-form game.
> $\\begin{array}{|c|c|c|}\\hline  & L & R \\\\ \\hline T & 2,1 & 0,2 \\\\ \\hline B & 1,2 & 3,0 \\\\ \\hline\\end{array}$


## Solution 

We need:

$l+2r = 2l$

$2t+b = 3b$

Then the nash equilibrium:

$((\\dfrac{1}{2},\\dfrac{1}{2}),(\\dfrac{2}{3},\\dfrac{1}{3}))$

# 1.13 

## Problem 

> Each of two firms has one job opening. Suppose that (for reasons not discussed here but relating to the value of filling each opening) the firms offer different wages: firm $ i $ offers the wage $ w_{i} $, where $ (1 / 2) w_{1}<w_{2}<2 w_{1} $. Imagine that there are two workers, each of whom can apply to only one firm. The workers simultaneously decide whether to apply to firm 1 or to firm 2 . If only one worker applies to a given firm, that worker gets the job; if both workers apply to one firm, the firm hires one worker at random and the other worker is unemployed (which has a payoff of zero). Solve for the Nash equilibria of the workers' normal-form game. (For more on the wages the firms will choose, see Montgomery [1991].)

## Solution 

Pure strategy equilibrium:

$(T, R), (B, L)$

Mixed strategy equilibrium:

we have:

$\\dfrac{1}{2}w_1l + w_1r = w_2l + \\dfrac{1}{2}w_2r$

$\\dfrac{1}{2}w_1u+w_1d = w_2u + \\dfrac{1}{2}w_2d$

Then we get:

$\\left(\\left(\\frac{2 w_{1}-w_{2}}{w_{1}+w_{2}}, \\frac{2 w_{2}-w_{1}}{w_{1}+w_{2}}\\right),\\left(\\frac{2 w_{1}-w_{2}}{w_{1}+w_{2}}, \\frac{2 w_{2}-w_{1}}{w_{1}+w_{2}}\\right)\\right)$

`,Z7=`# Quality in Supply Chain Encroachment

# 3 Model and Benchmark Analysis

## 3.1 Basic Model 

$ U(u, p ; \\theta)=\\theta u-p $: Consumerm surplus 

- $u>0$: quality 
- $p$: price 
- $\\theta\\in[0,1]$: sensitivity

$q = 1-p/u$: demand 

$p = u(1-q)$: inverse demand function 

$ku^2$: manufacturer unit cost 

---

Timeline:

1. manufacturer decide $u$, $w$
2. retailer decide $q_R$
3. manufacturer decide $q_M$ (if exists)

## 3.2 Benchmark: No Encroachment

We have:

$ \\Pi_{R}^{N}\\left(q_{R}, w, u\\right)=\\left(u\\left(1-q_{R}\\right)-w\\right) q_{R} $

By maximize it, we have:

$ q_{R}^{N}(w, u)=\\frac{1}{2}-w /(2 u) $

Then for manufacturer:

$ \\max _{w, u}\\left(w-k u^{2}\\right) q_{R}^{N}(w, u)=\\max _{w, u}\\left(w-k u^{2}\\right)\\left(\\frac{1}{2}-\\frac{w}{2 u}\\right) $

Then:

$ w^{N}(u)=\\frac{k u^{2}}{2}+\\frac{u}{2} $

Then:

$ \\Pi_{M}^{N}(u)=\\frac{u(1-k u)^{2}}{8} \\quad $ and $ \\quad \\Pi_{R}^{N}(u)=\\frac{u(1-k u)^{2}}{16} $

Finally:

$ \\Pi_{M}^{N}=\\frac{1}{54 k} \\quad $ and $ \\quad \\Pi_{R}^{N}=\\frac{1}{108 k} $

# 4 Encroachment with Uniform Quality

## 4.1  Sequential Quantity Decisions

for manufacturer:

$ \\max _{q_{M}}\\left\\{\\left(w-k u^{2}\\right) q_{R}+\\left(u-u q_{M}-u q_{R}-c-k u^{2}\\right) q_{M}\\right\\} $

Then we get:

$ q_{M}^{u}\\left(q_{R}, w, u\\right)=  \\left(\\frac{1}{2}-q_{R} / 2-c /(2 u)-k u / 2\\right)^{+} $

Then for retailer:

$ \\max _{q_{R}}\\left(u\\left(1-q_{R}-q_{M}^{U}\\left(q_{R}, w, u\\right)\\right)-w\\right) q_{R} $

Then we get:

$ \\begin{array}{l}q_{R}^{u}(w, u)=\\frac{1}{2}-\\frac{w}{u}+\\frac{k u}{2}+\\frac{c}{2 u} \\quad \\text { and } \\\\ q_{M}^{u}(w, u)=\\frac{1}{4}+\\frac{w}{2 u}-\\frac{3 k u}{4}-\\frac{3 c}{4 u} .\\end{array} $

For manufacturer:

$ \\begin{array}{l}\\max _{w, u}\\left\\{\\left(w-k u^{2}\\right) q_{R}^{U}(w, u)\\right. \\\\ \\left.\\quad+\\left(u-u q_{M}^{u}(w, u)-u q_{R}^{U}(w, u)-c-k u^{2}\\right) q_{M}^{u}(w, u)\\right\\} .\\end{array} $

Then:

$ w^{U}(u)=\\frac{k u^{2}}{2}+\\frac{u}{2}-\\frac{c}{6} $

$ \\begin{array}{c}q_{R}^{U}\\left(w^{u}(u), u\\right)=\\frac{2 c}{3 u} \\text { and } \\\\ q_{M}^{U}\\left(w^{U}(u), u\\right)=-\\frac{k u}{2}-\\frac{5 c}{6 u}+\\frac{1}{2} .\\end{array} $

Then:

$ \\begin{array}{l}\\Pi_{M}^{u}(u)=\\frac{k^{2} u^{3}}{4}+\\frac{k c u}{2}+\\frac{7 c^{2}}{12 u}-\\frac{k u^{2}}{2}+\\frac{u}{4}-\\frac{c}{2} \\quad \\text { and } \\\\ \\Pi_{R}^{U}(u)=\\frac{2 c^{2}}{9 u}\\end{array} $

---

Weg get, retailer is better off with encroachment if and only if:

$ \\frac{3\\left(u-k u^{2}\\right)}{4 \\sqrt{2}}<c<\\frac{3\\left(u-k u^{2}\\right)}{5} $

### Proposition 1

> (i) There exists a threshold $ \\tilde{c} $ such that the manufacturer encroaches if and only if $ c<\\tilde{c} $. 
> 
> (ii) Under encroachment, (a) the product quality $ u^{u} $ is first increasing and then decreasing in $ c $, and (b) there exists a threshold $ c^{u} $ such that $ u^{U} \\geq u^{N} $, if $ c \\leq c^{u} $ and $ u^{U}<u^{N} $ otherwise. 
> 
> (iii) When encroachment happens, the manufacturer always wins, $ \\Pi_{M}^{U}-\\Pi_{M}^{N}>0 $, and the retailer always loses, $ \\Pi_{R}^{U}-\\Pi_{R}^{N}<0 $.

## 4.2 Simultaneous quantity Decisions

### Proposition 2 

> (i) When both firms choose quantities simultaneously, there exists a threshold $ \\tilde{c}^{\\prime} $ such that the manufacturer encroaches if and only if $ c<\\tilde{c}^{\\prime} $. Under encroachment, there exists $ c_{L} $ such that the retailer always loses $ \\left(\\Pi_{R}^{S}<\\Pi_{R}^{N}\\right) $, whereas the manufacturer loses $ \\left(\\Pi_{M}^{S}<\\Pi_{M}^{N}\\right) $ if and only if $ c_{L}<c<\\tilde{c}^{\\prime} $. (ii) The manufacturer is more likely to encroach under simultaneous than under sequential quantity decisions: $ \\tilde{c}<\\tilde{c}^{\\prime} $.

![Figure 1](image-23.png)

![Figure 2](image-24.png)

![Figure 3](image-25.png)

# 5 Encroachment with Quality Differentiation

- $u$: direct channel 
- $tu (t\\in (0, 1] or t \\ge 1)$: indirect channel 

### Proposition 3

> Under encroachment, the manufacturer never offers a product of strictly lower quality through the direct channel.


$\\begin{array}{lccc}
\\hline
c & t^{*} & u^{*} & q_{M}^{*} \\\\
\\hline
0 \\leq c < c_{1} & t^{*} = \\frac{6}{5} - \\frac{2}{5} \\sqrt{4 - \\frac{5c}{k u^{* 2}}} < 1 & u^{*} > \\sqrt{\\frac{4c}{3k}} & q_{M}^{*} > 0 \\\\
c_{1} < c \\leq c_{2} & t^{*} = 1 & u^{*} < \\sqrt{\\frac{4c}{3k}} & q_{M}^{*} > 0 \\\\
c > c_{2} & \\text{N/A} & \\text{N/A} & q_{M}^{*} = 0 \\\\
\\hline
\\end{array}$

### Proposition 4

> (i) There exist two thresholds $ c_{1}<c_{2} $ that characterize the manufacturer's equilibrium decisions as given in Table 1. 
> 
> (ii) When encroachment happens, the manufacturer always wins $ \\left(\\Pi_{M}^{*}>\\Pi_{M}^{N}\\right) $ and the retailer always loses $ \\left(\\Pi_{R}^{*}<\\Pi_{R}^{N}\\right) $.

![Figure 4](image-26.png)

![Figure 5](image-27.png)

### Corollary 2

> Given $ c>0 $, as $ k $ increases (i) the manufacturer becomes less likely to encroach or quality differentiate (i.e., both $ c_{1} $ and $ c_{2} $ decrease); and (ii) the retailer's profit first decreases and then increases.

# 6 Extension 

## 6.1 Segmentation Through the Retailer 

No direct channel, two product through retailer:

$w_1, w_2, u_1, u_2$

### Proposition 5

> When encroachment happens, the manufacturer always wins $ \\left(\\Pi_{M}^{*}-\\Pi_{M}^{N 2}>0\\right) $, and the retailer always loses $ \\left(\\Pi_{R}^{*}-\\Pi_{R}^{N 2}<0\\right) $

## 6.2 Encroachment with Fixed cost of Quality 

$\\max (ku^2, kt^2u^2)$: fixed cost of quality 

### Proposition 6

> Under encroachment, (i) quality differentiation is not optimal (i.e., $ t=1 $ ) and (ii) the manufacturer always wins and the retailer always loses.

## 6.3 No Quality Commitment for Direct Channel


(i) the manufacturer announces the product quality $ u_{R} $ and the wholesale price $ w $; 

(ii) the retailer chooses the order quantity $ q_{R} $; 

(iii) the manufacturer determines the product quality $ u_{M} $ and selling quantity $ q_{M} $.

### Proposition 7

> If the encroaching manufacturer cannot commit to a level of quality in the direct-channel product, then quality differentiation across channels is always optimal.

![Figure 6](image-28.png)

## 6.4 Generalized Cost Function

$\\begin{cases}
b&u\\le u_0\\\\ 
b+k(u-u_0)^2&u>u_0
\\end{cases}$: unit cost

### Proposition 8

> There exists a threshold $ \\bar{k}>0 $ such that 
> 
> (i) if $ k \\leq \\bar{k} $, then the retailer always loses from encroachment; 
> 
> (ii) if $ k>\\bar{k} $, then there exist $ \\underline{c} $ and $ \\bar{c} $ such that the retailer wins from encroachment when $ \\underline{c}<c<\\bar{c} $.

![Figure 7](image-29.png)

![Figure 8](image-30.png)



`,Y7="",Q7=`# Introduction

## What is a game?

- Decisions (single-person decision problem)
  - take the world as given, make best decision for yourself
- Games (multiple-person decison problem)
  - you best decision depends on what others do, and what they do may depend on what they think you do...

## Prisoner's Dilemma

- GPA race
- Grade inflation
- Arms race 

## What is Game Theory?

- A formal way to analyze **strategic interaction** among a group of rational players ( or agents ) who behave strategically

### Classifying Games

- Zero-sum / non-zero sum 
- One-shot / repeated 
- Fixed / manipulable rules 
- Enforceable / unenforceable cooperative agreements 
- Simultaneous / sequential moves 
- Complete / private information 

### Four main part

Static / Dynamic + Complete / private 

## Terminology 

- Players 
  - Participants in the game 
- Strategies 
  - A complete plan of actions 
    - Might be conditioned on history
- Payoffs
  - Some numerical representation of the objectives of each player 
    - Could take account fairness / reputation, etc.
    - Does not mean players are narrowly selfish
- Equilibrium
  - Players play strategies that are $mutual best response to each other$

### Standard Assumptions 

- Rationality
  - Players are perfect calculators and implementers of their desired strategy 
- Common knowledge of rules 
  - All players know the game being played 
  - All players know that all players know the game being played 
  - etc.

`,J7=`# 1.2 

## Problem 

> In the following normal-form game, what strategies survive iterated elimination of strictly dominated strategies? What are the pure-strategy Nash equilibria?
>
> $\\begin{array}{c|c|c|c|} & L & C & R \\\\ \\hline T & 2,0 & 1,1 & 4,2 \\\\\\hline M & 3,4 & 1,2 & 2,3 \\\\ \\hline B & 1,3 & 0,2 & 3,0 \\\\ \\hline \\end{array}$

## Solution （1）

$B$ is dominated by $T$:


$\\begin{array}{c|c|c|c|} & L & C & R \\\\ \\hline T & 2,0 & 1,1 & 4,2 \\\\\\hline M & 3,4 & 1,2 & 2,3 \\\\\\hline \\end{array}$

$C$ is dominated by $R$:

$\\begin{array}{c|c|c|} & L & R \\\\ \\hline T & 2,0 & 4,2 \\\\\\hline M & 3,4 & 2,3 \\\\\\hline \\end{array}$

Then we can't eliminate any other strategies

## Solution (2)

$(T,R)$ is a pure-strategy Nash equilibrium:
- Player 1 can't be better off ($M,B$ is $2, 3$ seperatly)
- Player 2 can't be better off ($L,C$ is $0, 1$ seperatly)

$(M,L)$ is a pure-strategy Nash equilibrium:
- Player 1 can't be better off ($M,B$ is $1, 2$ seperatly)
- Player 2 can't be better off ($L,C$ is $2, 3$ seperatly)

# 1.3

> Players 1 and 2 are bargaining over how to split one dollar. Both players simultaneously name shares they would like to have, $ s_{1} $ and $ s_{2} $, where $ 0 \\leq s_{1}, s_{2} \\leq 1 $. If $ s_{1}+s_{2} \\leq 1 $, then the players receive the shares they named; if $ s_{1}+s_{2}>1 $, then both players receive zero. What are the pure-strategy Nash equilibria of this game?

## Solution

For player 1, given $s_2$, he will choose:

$s_1 = 1 - s_2$

to maximize his payoff

Similarly, player 2 will choose:

$s_2 = 1 - s_1$

Both direct us to:

$s_1 + s_2 = 1$

Therefore, any $(s_1, s_2)$ that satisfies this formula is a pure-strategy Nash equilibrium.

Moreover, there's a special case:

$(s_1, s_2) = (1,1)$

In this case:
- when a player want to change to any $s>0$, the sum is over 1 and he receive zero, 
- if he changes to $s=0$, it satisfies $s_1 + s_2 \\le 1$ but he chooses 0 so the payoff is 0, 

Therefore, he can't be better off.



`,e8=`# 1 Solution 

## (1)

### Answer

$$
\\begin{array}{|l|l|l|l|l|l|l|l|l|}
\\hline 3 & 8 & 5 & 7 & 6 & 4 & 2 & 1 & 9 \\\\
\\hline 7 & 9 & 4 & 5 & 1 & 2 & 6 & 8 & 3 \\\\
\\hline 2 & 1 & 6 & 3 & 9 & 8 & 7 & 5 & 4 \\\\
\\hline 5 & 7 & 3 & 4 & 8 & 9 & 1 & 2 & 6 \\\\
\\hline 9 & 4 & 1 & 2 & 7 & 6 & 5 & 3 & 8 \\\\
\\hline 8 & 6 & 2 & 1 & 5 & 3 & 9 & 4 & 7 \\\\
\\hline 6 & 3 & 8 & 9 & 2 & 5 & 4 & 7 & 1 \\\\
\\hline 1 & 5 & 9 & 8 & 4 & 7 & 3 & 6 & 2 \\\\
\\hline 4 & 2 & 7 & 6 & 3 & 1 & 8 & 9 & 5 \\\\
\\hline
\\end{array}
$$

### Steps

$$
\\begin{array}{|l|l|l|l|l|l|l|l|l|}
\\hline & 8 & 5 & & & & 2 & 1 & \\\\
\\hline & 9 & 4 & & 1 & 2 & & & 3 \\\\
\\hline & & & 3 & & & 7 & & 4 \\\\
\\hline 5 & & 3 & 4 & & 9 & & & \\\\
\\hline & 4 & & 2 & & 6 & & 3 & \\\\
\\hline & & & 1 & & 3 & 9 & & 7 \\\\
\\hline 6 & & 8 & & & 5 & & & \\\\
\\hline 1 & & & 8 & 4 & & 3 & 6 & \\\\
\\hline & 2 & 7 & & & & 8 & 9 & \\\\
\\hline
\\end{array}
$$

We can rule out 3's sequentially in first, seventh, eighth room: 

$$
\\begin{array}{|l|l|l|l|l|l|l|l|l|}
\\hline 3 & 8 & 5 & & & & 2 & 1 & \\\\
\\hline & 9 & 4 & & 1 & 2 & & & 3 \\\\
\\hline & & & 3 & & & 7 & & 4 \\\\
\\hline 5 & & 3 & 4 & & 9 & & & \\\\
\\hline & 4 & & 2 & & 6 & & 3 & \\\\
\\hline & & & 1 & & 3 & 9 & & 7 \\\\
\\hline 6 & 3 & 8 & & & 5 & & & \\\\
\\hline 1 & & & 8 & 4 & & 3 & 6 & \\\\
\\hline & 2 & 7 & & 3 & & 8 & 9 & \\\\
\\hline
\\end{array}
$$

We can rule out the seventh room's numbers:


$$
\\begin{array}{|l|l|l|l|l|l|l|l|l|}
\\hline 3 & 8 & 5 & & & & 2 & 1 & \\\\
\\hline & 9 & 4 & & 1 & 2 & & & 3 \\\\
\\hline & & & 3 & & & 7 & & 4 \\\\
\\hline 5 & & 3 & 4 & & 9 & & & \\\\
\\hline & 4 & & 2 & & 6 & & 3 & \\\\
\\hline & & & 1 & & 3 & 9 & & 7 \\\\
\\hline 6 & 3 & 8 & & & 5 & & & \\\\
\\hline 1 & 5 & 9 & 8 & 4 & & 3 & 6 & \\\\
\\hline 4 & 2 & 7 & & 3 & & 8 & 9 & \\\\
\\hline
\\end{array}
$$

We can sequentially rule out the eighth, ninth room's numbers:

$$
\\begin{array}{|l|l|l|l|l|l|l|l|l|}
\\hline 3 & 8 & 5 & & & & 2 & 1 & \\\\
\\hline & 9 & 4 & & 1 & 2 & & & 3 \\\\
\\hline & & & 3 & & & 7 & & 4 \\\\
\\hline 5 & & 3 & 4 & & 9 & & & \\\\
\\hline & 4 & & 2 & & 6 & & 3 & \\\\
\\hline & & & 1 & & 3 & 9 & & 7 \\\\
\\hline 6 & 3 & 8 & 9 & 2 & 5 & 4 & 7 & 1 \\\\
\\hline 1 & 5 & 9 & 8 & 4 & 7 & 3 & 6 & 2 \\\\
\\hline 4 & 2 & 7 & 6 & 3 & 1 & 8 & 9 & 5 \\\\
\\hline
\\end{array}
$$

We can sequentially rule out the sixth, fifth, fourth room's numbers:

$$
\\begin{array}{|l|l|l|l|l|l|l|l|l|}
\\hline 3 & 8 & 5 & & & & 2 & 1 & \\\\
\\hline & 9 & 4 & & 1 & 2 & & & 3 \\\\
\\hline & & & 3 & & & 7 & & 4 \\\\
\\hline 5 & 7 & 3 & 4 & 8 & 9 & 1 & 2 & 6 \\\\
\\hline 9 & 4 & 1 & 2 & 7 & 6 & 5 & 3 & 8 \\\\
\\hline 8 & 6 & 2 & 1 & 5 & 3 & 9 & 4 & 7 \\\\
\\hline 6 & 3 & 8 & 9 & 2 & 5 & 4 & 7 & 1 \\\\
\\hline 1 & 5 & 9 & 8 & 4 & 7 & 3 & 6 & 2 \\\\
\\hline 4 & 2 & 7 & 6 & 3 & 1 & 8 & 9 & 5 \\\\
\\hline
\\end{array}
$$

We can sequentially rule out the first, second third room's numbers:

$$
\\begin{array}{|l|l|l|l|l|l|l|l|l|}
\\hline 3 & 8 & 5 & 7 & 6 & 4 & 2 & 1 & 9 \\\\
\\hline 7 & 9 & 4 & 5 & 1 & 2 & 6 & 8 & 3 \\\\
\\hline 2 & 1 & 6 & 3 & 9 & 8 & 7 & 5 & 4 \\\\
\\hline 5 & 7 & 3 & 4 & 8 & 9 & 1 & 2 & 6 \\\\
\\hline 9 & 4 & 1 & 2 & 7 & 6 & 5 & 3 & 8 \\\\
\\hline 8 & 6 & 2 & 1 & 5 & 3 & 9 & 4 & 7 \\\\
\\hline 6 & 3 & 8 & 9 & 2 & 5 & 4 & 7 & 1 \\\\
\\hline 1 & 5 & 9 & 8 & 4 & 7 & 3 & 6 & 2 \\\\
\\hline 4 & 2 & 7 & 6 & 3 & 1 & 8 & 9 & 5 \\\\
\\hline
\\end{array}
$$

## (2)

Answer: It's not a game.

Proof: Notice the definition of a "Game": Game is a **multiple-person decison problem**,
- however, sudoku is a single player game, there's no other person.

Moreover: In a game **you best decision depends on what others do**,
- however, your decision depends on the board, not others.

# 2 Solution 

## Solution

May 2

## Steps

We first establish a sheet:

$$
\\begin{array}{|l|l|l|l|l|l|l|}
\\hline & 2 & 5 & 10 & 15 & 28 & 30 \\\\
\\hline Jan & & & ? & ? & & ? \\\\
\\hline Mar & & & ? & & ? & \\\\
\\hline May & ? & & & ? & & \\\\
\\hline Jul & ? & ? & & & & ? \\\\
\\hline
\\end{array}
$$

Xiaoming knows Xiaohong doesn't know either:
- It can't be a Month where there's a day with only one month (e.g. March, with 28 being the day with only one month)
  - Otherwise, Xiaohong will know the month throught the day.

Thus, we eliminate March(Because of March 28) and July (Because of July 5)

Then we get:


$$
\\begin{array}{|l|l|l|l|l|l|l|}
\\hline & 2 & 5 & 10 & 15 & 28 & 30 \\\\
\\hline Jan & & & ? & ? & & ? \\\\
\\hline Mar & & & \\text{x} & & \\text{x} & \\\\
\\hline May & ? & & & ? & & \\\\
\\hline Jul & \\text{x} & \\text{x} & & & & \\text{x} \\\\
\\hline
\\end{array}
$$

Xiaohong now know the day:
- It must be a day with only one month (e.g. 2, with May), otherwise, she won't know it.
Thus, we eliminate 15(It has more than one month)

Then we get:


$$
\\begin{array}{|l|l|l|l|l|l|l|}
\\hline & 2 & 5 & 10 & 15 & 28 & 30 \\\\
\\hline Jan & & & ? & \\text{x} & & ? \\\\
\\hline Mar & & & \\text{x} & & \\text{x} & \\\\
\\hline May & ? & & & \\text{x} & & \\\\
\\hline Jul & \\text{x} & \\text{x} & & & & \\text{x} \\\\
\\hline
\\end{array}
$$

Xiaoming now know the day:
- It must be a month with only one day (the only answer May 2), otherwise, he won't know it.
Thus, we can get the final answer: **May 2**


`,t8=`# The Bright Side of Supplier Encroachment

# Note 

## Methodology

Backward induction:

- set some variables as given
- solve the optimize problem 
- replace the value back to eliminate the variables

## Intuitions

Why Everyone benefits from encroachment?

- $\\Pi_{M}^{E} - \\Pi_{M}^{N} = \\underbrace{\\frac{3(a-2c)^2}{24b}}_{\\text{Increase in wholesale profit}} + \\underbrace{\\frac{2c^2}{24b}}_{\\text{Supplement from retail profit}} > 0 $
- $CS^{E} - CS^{N} = \\underbrace{\\frac{(9a-2c)(3a-2c)}{288b}}_{\\text{Price reduction and increased choice}} > 0$
- $c \\in \\left(\\underbrace{\\frac{3a}{4\\sqrt{2}}}_{\\text{Lower bound: avoid excessive squeezing of the retailer}}, \\underbrace{\\frac{3a}{5}}_{\\text{Upper bound: ensure manufacturer's retail competitiveness}}\\right)$

---

Balancing Cost Disadvantages

When $c$ is moderate:

- The manufacturer can credibly compete with the retailer without fully displacing it
- The retailer benefits from a lower $w$, offsetting partial sales loss to encroachment.

--- 

Summary:

Supplier encroachment, when strategically executed, transforms a zero-sum game into a Pareto improvement:

- **Manufacturers** gain from optimized wholesale pricing and direct retail profits.

- **Retailers** benefit if wholesale price cuts offset competitive losses.

- **Consumers** enjoy lower prices and expanded choice.

# 2 The basic model 

In vertical supply chain
- manufacturer(supplier) sell wholesale product to retailer 
- retailer sell product to final consumer 
- manufacturer may sell product directly to consumers

Some additional retail competition are examined in 3.4

Consumer demand:

- $P = a-bQ$
  - $a, b > 0$
  - $P$: price
  - $Q$: quantity

manufacturer produce good at constant unit (marginal) cost: $0$

retailer selling cost: $0$

- manufacturer's unit cost of selling to consumer: $c\\in [0,a)$

- manufacturer unit price: $w$

- Linear pricing arrangement

---

Timing:

1. the manufacturer establishes its wholesale price ($w$). 
2. the retailer chooses its profit-maximizing retail output $ q_{R} $. 
3. the manufacturer determines the number of units $ \\left(q_{M}\\right) $ of the homogeneous product it will sell directly to consumers 

Backward induction is employed to identify the equilibrium of the game 

Key properties are presented in 3

# 3 Findings

## 3.1 The No-Encroachment Setting 

Benchmark:
- the manufacturer can only reach consumers through its retailer. 

the retailer chooses its output $ q_{R} $ to maximize its monopoly profit from retail sales, 
- taking the unit wholesale price $ w $ as given. 

---

The retailer's problem is:

#### (1)

$ \\underset{q_{R}}{\\operatorname{Maximize}}\\left[a-b q_{R}\\right] q_{R}-w q_{R} $

We get:

the retailer's output in the no-encroach-ment setting given unit wholesale price:

#### (2)

$ q_{R}^{N}(w)=\\frac{a-w}{2 b} $

Anticipating the retailer's response , the manufacturer chooses $ w $, solving:

#### (3)

$ \\underset{w}{\\operatorname{Maximize}} w q_{R}^{N}(w) \\Leftrightarrow \\underset{w}{\\operatorname{Maximize}} \\frac{w[a-w]}{2 b} $

Then the equilibrium:

#### (4)

$ w^{N}=\\frac{a}{2} \\quad $ and $ \\quad q_{R}^{N}=\\frac{a}{4 b} $

We get profit:

#### (5)

$ \\Pi_{R}^{N}=\\frac{a^{2}}{16 b} \\quad $ and $ \\quad \\Pi_{M}^{N}=\\frac{a^{2}}{8 b} $

Consumer surplus:

#### (6)

$ C S^{N}=\\int_{0}^{q_{R}^{N}} b\\left[q_{R}^{N}-q\\right] d q=\\frac{b}{2}\\left[q_{R}^{N}\\right]^{2}=\\frac{a^{2}}{32 b} $

## 3.2 The Encroachment Setting 

In this setting:

- manufacturer can sell the product directly to consumers 
  - after setting the wholesale price
  - and supplying the wholesale product to the (incumbent) retailer.

---

Given wholesale price $ w $ and retailer supply $ q_{R} $, the manufacturer chooses $ q_{M} $ to:

#### (7)

$ \\underset{q_{M}}{\\operatorname{Maximize}}\\left[a-b q_{R}-b q_{M}\\right] q_{M}-c q_{M}+w q_{R} $

We get:

#### (8)

$ q_{M}^{E}\\left(q_{R}\\right)=\\frac{a-c-b q_{R}}{2 b} $

Given $w$, retailer choose $q_R$:

#### (9)

$ \\underset{q_{R}}{\\operatorname{Maximize}}\\left[a-b q_{R}-b q_{M}^{E}\\left(q_{R}\\right)\\right] q_{R}-w q_{R} $

We get:

#### (10)

$ q_{R}^{E}(w)=\\frac{a+c-2 w}{2 b} $

Substitute [(8)](#8) and [(8)](#10) into [(7)](#7) :

#### (11)

$ w^{E}=\\frac{a}{2}-\\frac{c}{6}, \\quad q_{R}^{E}=\\frac{2 c}{3 b}, \\quad $ and $ \\quad q_{M}^{E}=\\frac{3 a-5 c}{6 b} $

Then we get:

#### (12)

$ \\begin{array}{c}\\Pi_{R}^{E}=\\frac{2 c^{2}}{9 b}, \\quad \\Pi_{M}^{E}=\\frac{3 a^{2}-6 a c+7 c^{2}}{12 b}, \\quad \\text { and } \\\\ C S^{E}=\\frac{b}{2}\\left[q_{R}^{N}+q_{M}^{N}\\right]^{2}=\\frac{[3 a-c]^{2}}{72 b} .\\end{array} $

## 3.3 No Encroachment vs Encroachment 

Proposition 1 confirm that:
- Encroachment benefits manufacturer and consumer 
- manufacturer will encroach $ \\left(q_{M}^{E}>0\\right) $ if and only if its retail cost disadvantage is not too pronounced.

### Proposition 1 

> The manufacturer encroaches if and only if $ c<3 a / 5 $. 
> 
> The manufacturer and consumers both benefit from encroachment in this case: 
> 
> $ \\Pi_{M}^{E}-\\Pi_{M}^{N}= $ $ \\left(3[a-2 c]^{2}+2 c^{2}\\right) /[24 b]>0 $ 
> and $ C S^{E}-C S^{N}=[9 a-2 c] \\times $ $ [3 a-2 c] /[288 b]>0 $.

Key point: encroachment by the manufacturer can alter its preferred wholesale price

Fact: The manufacturer sets a lower wholesale price in the encroachment setting

the retailer may benefit from manufacturer encroachment

### Proposition 2

> Encroachment that increases retailer profit arises if and only if $ c \\in(3 a /[4 \\sqrt{2}], 3 a / 5) $

We get: systematic reduction in the wholesale price secure Pareto gains

- manufacturer reduces the price of the wholesale product in order to increase the retailer's demand for the input and thereby expand the use of the efﬁcient sales channel
- the substantial wholesale price reduction outweighs the direct reduction in demand due to the manufacturer's retail sales, and the retailer beneﬁts from encroachment

---

If the wholesale price is a result of bargaining between the parties

Suppose:

Wholesale price is determined by generalized Nash bargaining,
- the weights $ \\beta \\in(0,1] $ and $ 1-\\beta $ reflect the bargaining strengths of the manufacturer and the retailer, respectively. 

Encroachment that produces Pareto gains will arise in this setting
- if and only if $ c \\in(3 a /[4 \\sqrt{2}], 3 a /[7-2 \\beta]) $. The interval is nonempty whenever the manufacturer's bargaining strength is sufficiently pronounced 
  - (i.e., $ \\beta> $ $ [7-4 \\sqrt{2}] / 2 \\approx 0.67) $. 

Intuitively, substantial manufacturer bargaining strength produces relatively high wholesale prices in the absence of encroachment, which permits the wholesale price reductions that generate Pareto gains under encroachment.

---

Increase in industry profit:

$ \\Pi_{R}^{E}+\\Pi_{M}^{E}-\\left[\\Pi_{R}^{N}+\\Pi_{M}^{N}\\right]=\\frac{9 a^{2}-72 a c+116 c^{2}}{144 b} $

We get Proposition 3:

### Proposition 3

> Encroachment that increases industry profit arises if and only if $ c \\in[0,3 a /[2[6+\\sqrt{7}]]) $ or $ c \\in $ $ (3 a / 2[6-\\sqrt{7}], 3 a / 5) $.

Increase profit when:

- retailer's downstream cost advantage is sufﬁciently pronounced
- or sufficiently limited 

Industry profit can increase by as much as $ 28 \\% $ when the retailer's downstream cost advantage is pronounced $ (c>0.45 a) $
- primary effect of encroachment is to reduce the wholesale price and thereby limit losses from double marginalization. 

Industry profit can increase by as much as $ 33 \\% $ when the retailer's cost advantage is limited $ (c<0.17 a) $,
- encroachment enables the manufacturer to profit from serving retail customers directly and thereby limit losses from double marginalization by using a direct channel.

---

Consider **simultaneous encroachment setting**:

#### (14)

$ w^{E}=\\frac{a}{2}-\\frac{c}{10}, \\quad q_{R}^{E}=\\frac{2 c}{5 b}, \\quad $ and $ \\quad q_{M}^{E}=\\frac{5 a-7 c}{10 b} $

And:

#### (15)

$ \\begin{aligned} \\Pi_{R}^{E}=\\frac{4 c^{2}}{25 b}, \\quad \\Pi_{M}^{E} & =\\frac{5 a^{2}-10 a c+9 c^{2}}{20 b}, \\quad \\text { and } \\\\ C S^{E} & =\\frac{[5 a-3 c]^{2}}{200 b} .\\end{aligned} $

We get:

### Proposition 4

> The retailer, the manufacturer, and consumers all are better off under sequential encroachment than under simultaneous encroachment

## 3.4 The Effect of Additional Retail Competition 

Suppose:

- retailer (denoted $ R $ ) now faces competition from $ n \\geq 0 $ incumbent rivals 
  - (where rival $ i $ is denoted $ R_{i}^{\\prime} $ ). 
- For simplicity, each rival is presumed to be a vertically integrated producer of a substitute good who operates with unit cost $c$. 
- The inverse demand function is: $ P=a-b\\left[q_{R}+\\sum_{i} q_{R_{i}^{\\prime}}+q_{M}\\right] $, 
  - $ q_{R}, q_{R_{i}^{\\prime}} $, and $ q_{M} $ denote the retail output of retailer $ R $, established rival $ R_{i}^{\\prime} $, and the manufacturer, respectively.

Using the method in [3.1](#31-the-no-encroachment-setting), when no encroachment:

#### (16)

$ \\begin{array}{c}w^{N}(n)=\\frac{a+n c}{2[1+n]}, \\quad q_{R}^{N}(n)=\\frac{a+n c}{2 b[2+n]}, \\quad \\text { and } \\\\ q_{R_{i}^{\\prime}}^{N}(n)=\\frac{a[3+2 n]-c[4+3 n]}{2 b\\left[2+3 n+n^{2}\\right]} .\\end{array} $

Using the method in [3.2](#32-the-encroachment-setting), When encroachment:

#### (17)

$ \\begin{array}{c}w^{E}(n)=\\frac{a[3+n]+c\\left[-1+5 n+2 n^{2}\\right]}{2\\left[3+6 n+2 n^{2}\\right]}, \\\\ q_{R}^{E}(n)=\\frac{n a+c\\left[2+3 n+2 n^{2}\\right]}{b\\left[3+6 n+2 n^{2}\\right]}, \\\\ q_{R_{i}^{\\prime}}^{E}(n)=\\frac{a[3+2 n]-c[5+4 n]}{b\\left[3+6 n+2 n^{2}\\right]}, \\quad \\text { and } \\\\ q_{M}^{E}(n)=\\frac{a[3+2 n]-c[5+4 n]}{2 b\\left[3+6 n+2 n^{2}\\right]} .\\end{array} $

When encroachment arise:
- the manufacturer and consumers gain for all $n$

Profit:

#### (18)

$ \\begin{array}{c}\\Pi_{R}^{N}(n)=\\frac{[a+n c]^{2}}{4 b[2+n]^{2}} \\text { and } \\\\ \\Pi_{R}^{E}(n)=\\frac{\\left[n a+c\\left(2+3 n+2 n^{2}\\right)\\right]^{2}}{2 b\\left[3+6 n+2 n^{2}\\right]^{2}}\\end{array} $

### Proposition 5

> For all $n\\ge 0$
>
> (i) Encroachment arises if and only if $ c<[3+2 n] $ a/ [ $ 5+4 n] $, in which case both the manufacturer and consumers benefit from encroachment; and
> 
> (ii) Encroachment that increases retailer profit arises if and only if
>
> $ \\begin{array}{c}c \\in\\left(f(n) a, \\frac{[3+2 n] a}{[5+4 n]}\\right), \\text { where } \\\\ f(n)=\\frac{9+36 n+40 n^{2}+16 n^{3}+2 n^{4}}{7 n+4 n^{2}-4 n^{3}-2 n^{4}+\\sqrt{2}[2+n]^{2}\\left[3+9 n+8 n^{2}+2 n^{3}\\right]} .\\end{array} $
>

#### Corollary

> The range of $ c $ values for which the retailer benefits from encroachment increases as $ n $ increases, i.e., $ [3+2 n] a /[5+4 n]-f(n) a $ is increasing in $ n $

- As $n$ increases, retailer R is weakened by the larger number of retail rivals it faces.

retailer R's demand becomes more sensitive to the established wholesale price as $ n $ increases.
- (Retailer R's demand decreases as $ w $ increases at the rate $ 2[1+n] /[2+n] $, which is an increasing function of n.) 

In response to this increased sensitivity, the manufacturer lowers the input price.

This benefit of encroachment accrues exclusively to retailer $ R $. 

In contrast, the burden of the revenue reduction caused by encroachment is shared by all incumbent retailers.

Consequently, the range of $ c / a $ realizations in which retailer $ R $ gains from encroachment increases as the number of incumbent retailers ( $ n $ ) increases. 

Importantly, the range in which encroachment secures retailer gains in the absence of incumbent retail competition (i.e., when $ n=0 $, as specified in Proposition 2 and as illustrated by the region between the vertical intercepts of the two curves in Figure 1): is smaller than the corresponding range in the presence of incumbent retail competition.

# 4 Extensions

## 4.1 Imperfect Substitutes

- $n=0$

- not perfect substitute 

---

Let the (inverse) demand curve for the retail product of firm $ i $ be $ P_{i}=a-q_{i}-k q_{j} $,
- $ P_{i} $ is the price of firm $ i^{\\prime} $ s product, 
- $ q_{i} $ and $ q_{j} $ are the retail outputs of firms $ i $ and $ j $, respectively (for $ i, j=R, M $ ). 
- The parameter $ k \\in(0,1) $ represents the degree of product substitution. 

The demands for the two retail products become independent as $ k $ approaches 0 . 

The retail products become perfect substitutes (as in [3](#3)) as $ k $ approaches 1 .

We get:

#### (19)

$ \\begin{array}{c}w^{E}(k)=\\frac{a}{2}-\\frac{k^{2}[a(1-k)+c k]}{2\\left[8-5 k^{2}\\right]} \\\\ q_{R}^{E}(k)=\\frac{2[a(1-k)+c k]}{8-5 k^{2}}, \\\\ q_{M}^{E}(k)=\\frac{[a-c]\\left[8-3 k^{2}\\right]-2 a k}{2\\left[8-5 k^{2}\\right]}\\end{array} $

We can see: when the manufacturer encroaches, consumers and the manufacturer both beneﬁt for all values of $k$

Profit:

#### (20)

$ \\begin{aligned} \\Pi_{R}^{E}(k) & =\\left[a-q_{R}^{E}(k)-k q_{M}^{E}(k)\\right] q_{R}^{E}(k)-w q_{R}^{E}(k) \\\\ & =\\frac{\\left[4-2 k^{2}\\right][a(1-k)+c k]^{2}}{\\left[8-5 k^{2}\\right]^{2}} .\\end{aligned} $

Compare [(20)](#20) and [(5)](#5) we get:

### Proposition 6

> With imperfect substitutes:
>
> (i) Encroachment arises if and only if $ c< $ ([8-2k$ \\left.\\left.3 k^{2}\\right] a\\right) /\\left[8-3 k^{2}\\right] $, in which case both the manufacturer and consumers benefit from encroachment; and
> 
> (ii) Encroachment that increases retailer profit arises if and only if:
>
> $ \\begin{array}{c}c \\in\\left(g_{1}(k) a, \\frac{\\left[8-2 k-3 k^{2}\\right] a}{\\left[8-3 k^{2}\\right]}\\right), \\text { where } \\\\ g_{1}(k)=\\frac{128-112 k-64 k^{2}+57 k^{3}}{4\\left[\\left(8-5 k^{2}\\right) \\sqrt{4-2 k^{2}}+8\\left(2-2 k-k^{2}+k^{3}\\right)\\right]}\\end{array} $
>
> 

- manufacturer always encroaches
- does not affect retailer's profit 

Retailer

- benefits from more homogeneity ($k$ increase) for lower wholesale price
- harmed by more intense competition 

## 4.2 Price Competition 

Suppose set price rather than quantities:

#### (21)

$ \\begin{array}{c}\\widetilde{w}^{E}(k)=\\frac{a}{2}-\\frac{k^{2}[a(1-k)+c k]}{2\\left[8-5 k^{2}+k^{4}\\right]}, \\\\ \\tilde{q}_{R}^{E}(k)=\\frac{\\left[2-k^{2}\\right][a(1-k)+c k]}{\\left[1-k^{2}\\right]\\left[8-5 k^{2}+k^{4}\\right]}, \\quad \\text { and } \\\\ \\tilde{q}_{M}^{E}(k)=\\frac{[a-c]\\left[8-7 k^{2}+k^{4}\\right]-a k\\left[6-5 k^{2}+k^{4}\\right]}{2\\left[1-k^{2}\\right]\\left[8-5 k^{2}+k^{4}\\right]}\\end{array} $

The retailer's profit:

#### (22)

$ \\begin{aligned} \\widetilde{\\Pi}_{R}^{E}(k) & =\\left[a-\\tilde{q}_{R}^{E}(k)-k \\tilde{q}_{M}^{E}(k)\\right] \\tilde{q}_{R}^{E}(k)-w \\tilde{q}_{R}^{E}(k) \\\\ & =\\frac{\\left[4-2 k^{2}\\right][a(1-k)+c k]^{2}}{\\left[1-k^{2}\\right]\\left[8-5 k^{2}+k^{4}\\right]^{2}} .\\end{aligned} $

We get:

### Proposition 7

> Under retail price competition:
>
> $ \\begin{aligned} \\widetilde{\\Pi}_{R}^{E}(k) & =\\left[a-\\tilde{q}_{R}^{E}(k)-k \\tilde{q}_{M}^{E}(k)\\right] \\tilde{q}_{R}^{E}(k)-w \\tilde{q}_{R}^{E}(k) \\\\ & =\\frac{\\left[4-2 k^{2}\\right][a(1-k)+c k]^{2}}{\\left[1-k^{2}\\right]\\left[8-5 k^{2}+k^{4}\\right]^{2}} .\\end{aligned} $
>
> (i) Encroachment arises if and only if $ c<[8-6 k- $ $ \\left.7 k^{2}+5 k^{3}+k^{4}-k^{5}\\right] a /\\left[8-7 k^{2}+k^{4}\\right] $, in which case both the manufacturer and consumers benefit from encroachment; and
> 
> (ii) Encroachment that increases retailer profit arises if and only if
> $\\begin{array}{l}c \\in\\left(g_{2}(k) a, \\frac{\\left[8-6 k-7 k^{2}+5 k^{3}+k^{4}-k^{5}\\right] a}{\\left[8-7 k^{2}+k^{4}\\right]}\\right), \\quad \\text { where } \\\\g_{2}(k)=\\frac{128-176 k-64 k^{2}+153 k^{3}-51 k^{5}+11 k^{7}-k^{9}}{4\\left[\\left(8-5 k^{2}+k^{4}\\right) \\sqrt{4-6 k^{2}+2 k^{4}}+8\\left(2-2 k-k^{2}+k^{3}\\right)\\right]} \\end{array}$

## 4.3 Nonlinear Costs 

Suppose manufacturer's cost:

$cq_M+c_2[q_M]^2$

We have:

$ \\begin{aligned} w^{E}\\left(c_{2}\\right)= & \\frac{a}{2}-\\frac{c+a c_{2}}{6+22 c_{2}+16 c_{2}^{2}}, \\quad q_{R}^{E}\\left(c_{2}\\right)=\\frac{2\\left[c+a c_{2}\\right]}{3+8 c_{2}} \\\\ & q_{M}^{E}\\left(c_{2}\\right)=\\frac{3 a\\left[1+2 c_{2}\\right]-c\\left[5+8 c_{2}\\right]}{6+22 c_{2}+16 c_{2}^{2}}\\end{aligned} $


Also, the retailer's profit:

$ \\Pi_{R}^{E}\\left(c_{2}\\right)=\\frac{2\\left[1+2 c_{2}\\right]\\left[c+a c_{2}\\right]^{2}}{\\left[1+c_{2}\\right]\\left[3+8 c_{2}\\right]^{2}} $

Then we have:

### Proposition 8

> In nonlinear costs:
>
> (i) Encroachment arises if and only if $ c<3\\left[1+2 c_{2}\\right] $ a/ [ $ \\left.5+8 c_{2}\\right] $, in which case both the manufacturer and consumers benefit from encroachment; and
>
> (ii) Encroachment that increases retailer profit arises if and only if
> 
> $\\begin{array}{c}c \\in\\left(h\\left(c_{2}\\right) a, \\frac{3\\left[1+2 c_{2}\\right] a}{\\left[5+8 c_{2}\\right]}\\right), \\text { where } \\\\h\\left(c_{2}\\right)=\\frac{9+57 c_{2}+80 c_{2}^{2}}{4\\left[8 c_{2}\\left(1+2 c_{2}\\right)+\\left(3+8 c_{2}\\right) \\sqrt{2+6 c_{2}+4 c_{2}^{2}}\\right]} \\end{array}$

`,n8=`# Supplier Encroachment with Multiple Retailers

# Intuitions

## Proposition 1

1. Wholesale price independence from $ n $ : The supplier sets $ w=a / 2 $, balancing profit margin and retailer participation. Retailers' Cournot competition ensures their total output adjusts to $ n $, but the supplier's optimal markup remains fixed as it depends only on market potential $ a $.

2. Retailer quantities vs. total output: More retailers dilute individual orders ( $ q_{r_{i}} \\downarrow $ ) but intensify competition, increasing total output ( $ \\sum q_{r_{j}} \\uparrow $ ).

3. Profit dynamics: Supplier benefits from more retailers (no double marginalization), while retailers suffer from competition. Total supply chain profit rises due to reduced deadweight loss.

**Counterintuitive Aspect**:

- The wholesale price $ w^{n}=a / 2 $ being independent of $ n $ seems odd-intuitively, more retailers might incentivize the supplier to lower $ w $ to encourage ordering. However, in Cournot competition, retailers' aggregate output $ \\sum q_{r_{j}}=\\frac{n(a-w)}{n+1} $ increases with $ n $, so the supplier maximizes profit at $ w=a / 2 $ regardless of $ n $.

## Proposition 2

Supplier encroachment depends on its direct-selling cost $ c $.
- Low $ c \\leq \\underline{c} $ : Encroachment occurs-direct selling is efficient enough.
- Intermediate $ \\underline{c}<c \\leq \\bar{c} $ : Threat of encroachment disciplines retailers to limit orders, avoiding actual encroachment.
- High $ c>\\bar{c} $ : Encroachment is too costly; equilibrium mirrors no-encroachment.

**Counterintuitive Aspect**:

The threat of encroachment (without actual encroachment) can discipline retailers. Retailers selfregulate orders to $ q_{r_{i}}=\\frac{a-c}{n} $, preventing supplier entry. This strategic deterrence is a non-obvious equilibrium outcome.

## Corollary 1

1. Thresholds $ \\underline{c}, \\bar{c} \\downarrow n $ : More retailers reduce the supplier's incentive to encroach (higher competition dilutes direct-selling gains). 

2. Wholesale price $ w^{e n} \\downarrow n $ under EO: With encroachment, more retailers force the supplier to lower $ w $ to retain their participation. 

3. Constant total output under TE: Retailers collectively maintain $ \\sum q_{r_{j}}=a-c $ to deter encroachment, regardless of $ n $. 


**Counterintuitive Aspect**: 

- Total retailer output $ \\sum q_{r_{j}}=a-c $ under TE is invariant to $ n $. Despite more retailers, each reduces individual orders to keep total output fixed, strategically avoiding supplier entry.

## Proposition 3

- $ n>4 $ : Retailers are always harmed by encroachment. More retailers amplify competition, leaving no room for wholesale price concessions. 

- $ n \\leq 4 $ : Retailers may benefit if $ c \\in\\left[\\underline{c}_{r}, \\bar{c}_{r}\\right] $. Supplier's moderate $ c $ allows a lower $ w $ (to enable encroachment), which offsets competition losses. 

**Counterintuitive Aspect**: 

Small $ n $ allows retailers to gain from encroachment. The supplier's need to balance encroachment profits with wholesale revenue can lead to a lower $ w $, paradoxically boosting retailer profits.

## Proposition 4

- $ n<3 $ : Supplier always benefits from encroachment-direct selling adds a high-margin channel. 

- $ n \\geq 3 $ : Encroachment can harm the supplier if $ c \\in\\left[\\underline{c}_{s}, \\bar{c}_{s}\\right] $. Moderate $ c $ forces the supplier into a suboptimal trade-off: encroachment cannibalizes wholesale revenue more than it adds profit. 
 
**Counterintuitive Aspect**:
 
Encroachment option can reduce supplier profit. When $ c $ is moderate, the threat of encroachment forces the supplier to lower $ w $, but retailers' disciplined orders are insufficient to offset lost wholesale revenue.

## Proposition 5

Supplier prefers encroachment for very low or high $ c $, but enrolls new retailers for intermediate $ c $. 

- Low $ c $ : Direct selling dominates (low cost). 

- High $ c $ : Indirect channel expansion avoids costly encroachment. 

- Mid $ c $ : Enrolling retailers balances competition and scale.

**Counterintuitive Aspect**: 

Supplier may prefer encroachment even at higher $ c $. For $ c $ near thresholds, channel substitutability and economies of scale tilt the balance toward direct selling.

## Proposition 6

With imperfect substitution $ (\\theta<1) $ :

- Retailers benefit from encroachment only if $ n $ is small and $ \\theta $ is low (weak competition).

- Supplier harm from encroachment persists for $ n \\geq 3 $, but thresholds shrink as $ \\theta \\uparrow $.

**Counterintuitive Aspect**:

Lower $ \\theta $ (weaker substitution) expands the range where retailers benefit. Reduced cannibalization allows coexistence of direct/indirect channels, creating win-win scenarios.

## Proposition 7

With fixed cost $ f $ to add retailers:

- Low $ c \\leq \\underline{c}_{f} $ : Encroachment dominates.

- Intermediate $ c \\in\\left(\\underline{c}_{f}, \\bar{c}_{f}\\right) $ : Supplier balances enrolling retailers and deterring encroachment.

- High $ c \\geq \\bar{c}_{f} $ : No encroachment; enrolls retailers up to $ n^{e n f} $.


**Counterintuitive Aspect**:

Fixed costs create non-monotonic strategies. For moderate $ c $, enrolling more retailers (despite $ f $ ) is better than encroachment, but only up to a threshold.

## Proposition 8

Under sequential retailer decisions:

1. First-mover advantage: Retailer $ r_{1} $ may benefit from encroachment if $ n \\leq 6 $, leveraging early commitment.

2. Later retailers always lose: Followers face entrenched competition.

3. Supplier harm: For $ n \\geq 2 $, sequentiality amplifies profit loss from encroachment due to strategic retailer adjustments.



**Counterintuitive Aspect**:

Sequentiality creates asymmetry: early retailers can exploit encroachment to gain, while later ones lose. Supplier's profit loss arises from retailers' preemptive order reductions.

## Key unifying insight

**Strategic Deterrence vs. Cannibalization**:

Encroachment creates a tension-its threat disciplines retailers (raising total output), but its execution risks cannibalizing wholesale revenue. The equilibrium hinges on whether supplier gains from direct selling outweigh lost wholesale profits. Small $ n $ and moderate $ c $ often lead to lose-lose outcomes, revealing the fragility of encroachment as a strategy.




# 3 Model Setting 

$s$: Supplier 

$r_i, i = 1, 2, \\cdots, n$: Retailers 

$n$: number of retailers 

$w$: wholesale price 

$p=a-Q$: inverse demand function 
- $a>0$: market potential 
- $Q$: total quantity in market 
- $p$: market clearing price 

For $Q$:

- $Q = \\sum_{i=1}^nq_{r_i}$: Only retailer 
  - $q_{r_i} $: $r_i $ retailer's quantity 
- $Q = \\sum_{i=1}^nq_{r_i} + q_s$: Encroachment
  - $q_s$: selling quantity 

$c$: supplier unit selling cost 
- $c\\in(0,a)$

$0$: retailer's unit selling cost 

---

Decision sequence:

1. Supplier decide $w$
2. retailers determine $q_{r_i}$ simultaneously 
3. supplier decide $q_s$

# Analysis 

## No Supplier Encroachment 

Profit function:

$ \\pi_{s}=w \\sum_{j=1}^{n} q_{r_{j}} $ 
$ \\pi_{r_{i}}=\\left(a-\\sum_{j=1}^{n} q_{r_{j}}^{n}-w\\right) q_{r_{i}}^{n} $

$r_i $'s order given $w$:

$ q_{r_{i}}(w)=\\dfrac{a-w}{(n+1)}, i=1,2, \\cdots, n $

Then $w$:

$w^n = \\dfrac{a}{2}$

Then:

$ q_{r_{i}}^{n}=\\dfrac{a}{2(n+1)}, \\pi_{r_{i}}^{n}=\\dfrac{a^{2}}{4(n+1)^{2}} $ and $ \\pi_{s}^{n}=\\dfrac{n a^{2}}{4(n+1)} $

Then:

### Proposition 1

> When the supplier cannot encroach into the retail market, in equilibrium,
>
> 1. the optimal wholesale price $ w^{n} $ is independent of $ n $, the number of downstream retailers;
> 
> 2. each retailer's order quantity $ q_{r_{i}}^{n} $. $ i=1,2, \\cdots, n $, decreases in $ n $ while the total demand of all retailers $ \\sum_{j=1}^{n} q_{r_{j}}^{n} $ increases in $ n $;
> 
> 3. the supplier's profit $ \\pi_{s}^{n} $ increases in $ n $ while that of a retailer $ \\pi_{r_{i}}^{n} $ decreases in $ n $. The total supply chain profit $ \\pi_{c}^{n}=\\pi_{s}^{n}+\\sum_{j=1}^{n} \\pi_{r_{j}}^{n} $ increases in $ n $.

## 4.2 Potential Supplier Encroachment 

Now:

#### (1)

$ \\pi_{s}=w \\sum_{j=1}^{n} q_{r_{j}}+\\left(a-\\sum_{j=1}^{n} q_{r_{j}}-q_{s}-c\\right) q_{s} $

Then:

#### (2)

$ q_{s}\\left(q_{r_{i}}\\right)=\\left(\\frac{a-\\sum_{j=1}^{n} q_{r_{j}}-c}{2}\\right)^{+} $

Then:

$ \\pi_{r_{i}}=\\left(a-\\sum_{j=1}^{n} q_{r_{j}}-q_{s}\\left(q_{r_{i}}\\right)-w\\right) q_{r_{i}} $

Then:

#### (3)

$ \\left(q_{r_{i}}(w), q_{s}(w)\\right)=\\left\\{\\begin{array}{ll}\\left(\\frac{a+c-2 w}{(n+1)}, \\frac{a-(2 n+1) c+2 n w}{2(n+1)}\\right) & \\text { if } w>\\frac{(2 n+1) c-a}{2 n} ; \\\\ \\left(\\frac{a-c}{n}, 0\\right) & \\text { if } \\frac{(n+1) c-a}{n}<w \\leq \\frac{(2 n+1) c-a}{2 n} ; \\\\ \\left(\\frac{a-w}{(n+1)}, 0\\right) & \\text { if } w \\leq \\frac{(n+1) c-a}{n} .\\end{array}\\right. $

Then we get:

$ \\pi_{s}(w)=\\left\\{\\begin{array}{ll}n w \\frac{a+c-2 w}{(n+1)}+\\left(\\frac{a-(2 n+1) c+2 n w}{2(n+1)}\\right)^{2}, & \\text { if } w>\\frac{(2 n+1) c-a}{2 n} ; \\\\ w(a-c), & \\text { if } \\frac{(n+1) c-a}{n}<w \\leq \\frac{(2 n+1) c-a}{2 n} \\\\ n w \\frac{a-w}{(n+1)}, & \\text { if } w \\leq \\frac{(n+1) c-a}{n} .\\end{array}\\right. $

Following Proposition:

### Proposition 2

> When the supplier has the option to encroach into the retail market, the supplier encroaches only when his unit direct-selling $ \\cos t c \\leq \\underline{c} $ and never encroaches when $ c>\\bar{c} $, where:
>
> $ \\bar{c}=\\frac{2(n+1)^{2}+n \\sqrt{2(n+1)}}{2(n+1)(2 n+1)} a $ and $ \\underline{c}=\\frac{n+2}{2+3 n} a $

### Table 1 Equilibrium Wholesale Price, Quantities and Profits: Potential Encroachment
$$
\\begin{array}{lcccc}
\\hline 
 & \\text{Encroachment occurrence (EO)} & \\text{Threat of encroachment (TE)} & \\text{No encroachment (NE)} \\\\
\\hline 
& \\boldsymbol{c} \\leq \\boldsymbol{\\underline{c}} & \\underline{\\boldsymbol{c}} < \\boldsymbol{c} \\leq \\overline{\\boldsymbol{c}} & \\boldsymbol{c} > \\overline{\\boldsymbol{c}} \\\\
\\hline 
\\boldsymbol{W}^{en} & \\dfrac{(n+2) a - n c}{2(n+2)} & \\dfrac{(2n+1) c - a}{2n} & \\dfrac{a}{2} \\\\
q_{r_{i}}^{en} & \\dfrac{2c}{(n+2)} & \\dfrac{a - c}{n} & \\dfrac{a}{2(n+1)} \\\\
q_{s}^{en} & \\dfrac{(n+2) a - (2 + 3n) c}{2(n+2)} & 0 & 0 \\\\
\\pi_{r_{j}}^{en} & \\dfrac{2c^{2}}{(n+2)^{2}} & \\dfrac{(a - c)^{2}}{2n^{2}} & \\dfrac{a^{2}}{4(n+1)^{2}} \\\\
\\pi_{s}^{en} & \\dfrac{n c((n+2) a - n c)}{(n+2)^{2}} + \\dfrac{((n+2) a - (2 + 3n) c)^{2}}{4(n+2)^{2}} & \\dfrac{((2n+1) c - a)(a - c)}{2n} & \\dfrac{n a^{2}}{4(n+1)} \\\\
\\hline
\\end{array}
$$

![Figure 1 (a)](image-1.png)

![Figure 1 (b)](image-2.png)

### Corollary 1

> When the supplier has the option to encroach into the retail market, in equilibrium
> 
> 1. the two direct-selling cost thresholds $ \\underline{c} $ and $ \\bar{c} $ both decrease in $ n $;
> 
> 2. the optimal wholesale price $ w^{e n} $ decreases in $ n $ under encroachment occurrence while increases in $ n $ under the threat of encroachment.
> 
> 3. Each retailer's order quantity $ q_{r_{i}}^{e n} $ decreases in $ n $. Nonetheless, the total order quantity $ \\Sigma_{j=1}^{n} \\eta_{r_{j}}^{e n} $ remains constant (i.e., $ \\Sigma_{j=1}^{n} q_{r_{j}}^{e n}=a-c $ ) under the threat of encroachment, and increases in $ n $ under encroachment occurrence.

![Figure 2 (a)](image-3.png)

![Figure 2 (b)](image-4.png)

## 4.3 Impact of Supplier Encroachment

### Proposition 3

> When the supplier can encroach into the retail market, in equilibrium
>
> 1. if the number of retailers $ n>4 $, a retailer is always worse off with supplier encroachment. 
> 
> 2. if $ n \\leq 4 $, a retailer can benefit from supplier encroachment when the direct-selling cost $ c \\in\\left[\\underline{c}_{r}, \\bar{c}_{r}\\right] $, where $ \\underline{c}_{r}=\\frac{\\sqrt{2}(n+2) a}{4(n+1)} $ and $ \\bar{c}_{r}=\\frac{2(n+1)-\\sqrt{2} n}{2(n+1)} a $.

![Figure 3 (a)](image-5.png)

![Figure 3 (b)](image-6.png)

### Proposition 4

> When the supplier can encroach into the retail market, in equilibrium
>
> 1. if the number of retailers $ n<3 $, the supplier always benefits from having the option to encroach into the retail market. 
> 
> 2. if $ n \\geq 3 $, the supplier becomes worse off when being endowed with the option of encroachment if his direct-selling cost $ \\mathcal{C}_{s} \\leq c \\leq \\bar{c}_{s} $, where $ \\underline{c}_{s}=\\frac{(n+1)(n+2)-\\sqrt{n(n+1)(n-2)(n+2)}}{5 n^{2}+7 n+2} a $ and $ \\bar{c}_{s}=\\min $ $ \\left\\{\\frac{(n+1)(n+2)+\\sqrt{n(n+1)(n-2)(n+2)}}{5 n^{2}+7 n+2} a, \\frac{2(n+1)^{2}-n \\sqrt{2(n+1)}}{2(n+1)(2 n+1)} a\\right\\} $.

![Figure 4 (a)](image-7.png)

![Figure 4 (b)](image-8.png)

# Discussion 

## 5.1 Market Penetration via Channel Expansion

### Proposition 5

> When there are $ n $ incumbent retailers in his indirect distribution channel, the supplier should encroach into the retail market and direct sell when his direct-selling cost
>
> $\\begin{array}{c} c \\in\\left[0, \\frac{n+2-\\sqrt{n^{2}-n+2}}{5 n+2} a\\right] \\cup\\left[\\frac{2(n+1)(n+2)-\\sqrt{2 n(n-1)(n+2)}}{2(2 n+1)(n+2)} a,\\right. \\\\ \\left.\\frac{2(n+1)(n+2)+\\sqrt{2 n(n-1)(n+2)}}{2(2 n+1)(n+2)} a\\right] . \\end{array} $
>
> Otherwise, the supplier should enroll a new retailer into his indirect channel.

![Figure 5 (a)](image-9.png)

![Figure 5 (b)](image-10.png)

![Figure 6](image-11.png)

## 5.2 Imperfect Product Substitution

Then:

$ p_{r_{i}}=a-\\sum_{j=1}^{n} q_{r_{j}}-\\theta q_{s^{\\prime}}, i=1,2, \\cdots, n $ and $ p_{s}=a-q_{s}-\\theta \\sum_{j=1}^{n} q_{r_{j}} $

- $ 0<\\theta \\leq 1 $

$ \\begin{array}{l}\\pi_{s}=w \\sum_{j=1}^{n} q_{r_{j}}+\\left(a-\\theta \\sum_{j=1}^{n} q_{r_{j}}-q_{s}-c\\right) q_{s^{\\prime}} \\\\ \\pi_{r_{i}}=\\left(a-\\sum_{j=1}^{n} q_{r_{j}}-\\theta q_{s}-w\\right) q_{r_{i}}, i=1,2, \\cdots, n\\end{array} $

### Proposition 6

> When the channels are imperfect substitutes, the equilibrium wholesale price, quantities and profits are as shown in Table 2. Moreover,
>
> 1. if $ n \\leq\\left[\\frac{2\\left(2-\\theta^{2}\\right)+2 \\sqrt{2\\left(2-\\theta^{2}\\right)}}{\\theta^{2}}\\right] $, the retailer can benefit from supplier encroachment when $ c \\in\\left[\\underline{c}_{r-\\theta}, \\bar{c}_{r-\\theta}\\right] $, where $\\begin{array}{l}\\text { where } \\quad \\bar{c}_{r-\\theta}=\\frac{\\sqrt{2\\left(2-\\theta^{2}\\right)}(n+1)-n \\theta}{\\sqrt{2\\left(2-\\theta^{2}\\right)}(n+1)} a \\\\\\underline{c}_{r-\\theta}=\\frac{4(n+1)-(3 n+2) \\theta^{2}-2(1-\\theta) \\sqrt{2\\left(2-\\theta^{2}\\right)(n+1)}}{2 \\theta \\sqrt{2\\left(2-\\theta^{2}\\right)}(n+1)} a\\end{array}$
>
> 2. if $ n \\geq 3 $, the supplier becomes worse off when being endowed with the option of encroachment when $ c \\in\\left[\\underline{c}_{s-\\theta}, \\overline{\\mathcal{C}}_{s-\\theta}\\right] $, where 
> 
> $ \\underline{\\mathcal{C}}_{s-\\theta}=\\frac{4 n^{2} \\theta^{2}-8 n^{2} \\theta+4 n^{2}+n \\theta^{2}-8 n \\theta+8 n-2 \\theta^{2}+4}{(2-\\theta)^{2} n^{2}+\\left(8-4 \\theta-\\theta^{2}\\right) n+4-2 \\theta^{2}+\\theta \\sqrt{n\\left(-n^{2}+n+2\\right)\\left(2 \\theta^{2}-4 n+3 n \\theta^{2}-4\\right)}} a $, and 
> 
> $ \\bar{c}_{s-\\theta}=\\min \\left(\\frac{\\left((4-2 \\theta) n+4-2 \\theta^{2}\\right)(n+1)-\\theta^{2} n \\sqrt{2(n+1)}}{4 n^{2}-2 n \\theta^{2}+8 n-2 \\theta^{2}+4} a\\right. $, $ \\left.\\frac{4 n^{2} \\theta^{2}-8 n^{2} \\theta+4 n^{2}+n \\theta^{2}-8 n \\theta+8 n-2 \\theta^{2}+4}{(2-\\theta)^{2} n^{2}+\\left(8-4 \\theta-\\theta^{2}\\right) n+4-2 \\theta^{2}-\\theta \\sqrt{n\\left(-n^{2}+n+2\\right)\\left(2 \\theta^{2}-4 n+3 n \\theta^{2}-4\\right)}} a\\right) $. where 
> 
> $ \\bar{c}_{\\theta}=\\frac{\\left((4-2 \\theta) n+4-2 \\theta^{2}\\right)(n+1)+\\theta^{2} n \\sqrt{2(n+1)}}{\\left(4 n+4-2 \\theta^{2}\\right)(n+1)} a $ and $ \\mathcal{c}_{\\theta}=\\frac{4-2 \\theta^{2}+\\left(4-2 \\theta-\\theta^{2}\\right) n}{4-2 \\theta^{2}+\\left(4-\\theta^{2}\\right) n} a $.

### Corollary 2

> When the direct and indirect channels are imperfect substitutes, the thresholds stated in Proposition $ 6, \\bar{c}_{r-\\theta}, \\underline{c}_{r-\\theta}, \\bar{c}_{s-\\theta}, \\underline{c}_{s-\\theta} $ all decrease in $ \\theta $


$\\begin{array}{|c|c|c|c|}
\\hline 
 & \\text{Encroachment occurrence} 
\\boldsymbol{C} < \\underline{\\boldsymbol{C}}_{g}
& \\text{Threat of encroachment} 
\\underline{\\boldsymbol{c}}_{\\theta} < \\boldsymbol{c} \\leq \\overline{\\boldsymbol{c}}_{\\theta}& \\text{No encroachment} 
c \\geq \\overline{\\boldsymbol{c}}_{\\theta}\\\\
\\hline 
W^{\\text{en}} & \\dfrac{\\left(4 - 2 \\theta^{2} + n \\theta^{5} + 4 n\\left(1 - \\theta^{2}\\right)\\right) a - n \\theta^{3} c}{8(1 + n) - 2(3 n + 2) \\theta^{2}} & \\dfrac{\\left(2 \\pi + 2 - \\theta^{2}\\right) c - \\left(2 \\pi(1 - \\theta) + \\left(2 - \\theta^{2}\\right)\\right) a}{2 \\pi \\theta} & \\dfrac{a}{2} \\\\
\\hline 
q_{r_{i}}^{en} & \\dfrac{2(1 - \\theta) a + 2 c \\theta}{4(1 + n) - (3 n + 2) \\theta^{2}} & \\dfrac{a - C}{n G} & \\dfrac{a}{2(n + 1)} \\\\
\\hline 
q_{s}^{\\text{en}} & \\dfrac{\\left(4 - 2 \\theta^{2} + \\left(4 - 2 \\theta - \\theta^{2}\\right) n\\right) a - \\left(4 - 2 \\theta^{2} + \\left(4 - \\theta^{2}\\right) \\pi\\right) c}{8(1 + \\pi) - 2(3 n + 2) \\theta^{2}} & 0 & 0 \\\\
\\hline 
\\pi_{r_{j}}^{en} & \\dfrac{2\\left(2 - \\theta^{2}\\right)(a(1 - \\theta) + c \\theta)^{2}}{\\left(4(n + 1) - (3 n + 2) b^{2}\\right)^{2}} & \\dfrac{\\left(2 - \\xi^{2}\\right)(\\bar{a} - c)^{2}}{2 \\pi^{2} \\theta^{2}} & \\dfrac{a^{2}}{4(n + 1)^{2}} \\\\
\\hline 
\\pi_{s}^{en} & \\dfrac{\\left(4 - 2 \\theta^{2} + m \\theta^{2}\\right)(a - c)^{2} + 8 n(1 - \\theta)(a - c) a + 4 n c^{2}}{16(n + 1) - 4(3 n + 2) \\theta^{2}} & \\dfrac{\\left(\\left(2 \\pi + 2 - \\theta^{2}\\right) c - \\left(2 n(1 - \\theta) + 2 - \\theta^{2}\\right) a\\right)(a - c)}{2 \\pi \\theta^{2}} & \\dfrac{n a^{2}}{4(n + 1)} \\\\
\\hline
\\end{array}$


## 5.3 Costly Channel Expansion 

$f$: fixed cost to enroll a retailer 

![Figure 7 (a)](image-12.png)

![Figure 7 (b)](image-13.png)

### Proposition 7

> When the supplier can proactively choose the number of retailers to enroll into his indirect channel, the equilibrium encroachment strategy, the optimal number of enrolled retailers and equilibrium profits are presented in Table 3, where $ n^{\\text {enf }} $ is a real number, $ n^{e n f *} $ is an integer, 
> 
> $\\bar{c}_{f}=\\frac{a+\\sqrt{2 f}+\\sqrt{2(2-\\sqrt{2}) a \\sqrt{f}-2 f}}{2} \\text { and }_{c_{f}}=\\frac{2 \\sqrt{2 f}+a}{3} $


$
\\begin{array}{|c|c|c|c|}
\\hline 
 & \\text{Encroachment occurrence} 
\\text{(EO) } c \\leq \\underline{c}_{f} & \\text{Threat of encroachment} 
\\text{(TE) } \\underline{\\boldsymbol{c}}_{f} < \\boldsymbol{c} \\leq \\overline{\\boldsymbol{c}}_{f} & \\text{No encroachment (NE)} 
\\boldsymbol{c} > \\overline{\\boldsymbol{c}}_{f} \\\\
\\hline 
n^{\\text{ent}} & c \\sqrt{\\dfrac{2}{7}} - 2 & \\dfrac{a - c}{\\sqrt{2 f}} & \\dfrac{a}{2 \\sqrt{f}} - 1 \\\\
\\hline 
n^{\\text{enf*}} &  \\arg \\max _{n \\in\\left\\{\\left\\lfloor n^{e n t}\\right\\rfloor,\\left\\lfloor n^{e n t}\\right\\rfloor+1,\\left\\lfloor n^{n t}\\right\\rfloor,\\left\\lfloor n^{n t}\\right\\rfloor+1\\right\\}} \\pi_{s}^{e n f}(n)  & & \\\\
\\hline 
\\pi_{r_{j}}^{\\text{enf}}\\left(n^{\\text{enf}}\\right) & f & f & f \\\\
\\hline 
\\pi_{s}^{\\text{enf}}\\left(n^{\\text{anf}}\\right) & (c - \\sqrt{2 f})^{2} + \\dfrac{(a - c)^{2}}{4} & (c - \\sqrt{2 f})(a - c) & \\dfrac{(a - 2 \\sqrt{f})^{2}}{4} \\\\
\\hline
\\end{array}
$

### Proposition 8

> When retailers make their ordering decisions sequentially
>
> 1. if $ n \\leq 6 $, retailer $ r_{1} $ can benefit from supplier encroachment when $ c \\in\\left[\\underline{c}_{r-S}, \\bar{c}_{r-S}\\right] $, where 
> 
> $\\begin{array}{l} \\underline{c}_{r-S}=\\min \\left\\{\\frac{2^{n}+1}{2^{n+3 / 2}} a, \\underline{c}_{S}\\right\\}, \\\\ \\bar{c}_{r-S}=\\left(1-\\frac{2^{2 n}-2^{n+1}+2}{\\sqrt{2^{n+2}\\left(2^{3 n-1}+2^{2 n}-2-2^{n} \\sqrt{2^{n-1}\\left(2^{n}-2\\right)}\\right)}}\\right) a \\text { and } \\\\ \\underline{c}_{S}=\\left(2^{n}+1\\right)\\left(3 \\times 2^{2 n}-2^{n+1}+2-\\sqrt{2^{n+3}\\left(2^{n}-2\\right)}\\right. \\\\ \\frac{\\left.\\left.-2 \\sqrt{2} \\sqrt{\\left(2^{n}+1\\right)^{-1}\\left(2^{2 n}-2^{n+1}+2\\right)\\left(2^{n}-1\\right) \\sqrt{2^{n+1}\\left(2^{n}-2\\right)}-2^{n}\\left(2^{n}-2\\right)}\\right)\\right)}{9 \\times 2^{3 n}-13 \\times 2^{2^{n}}+2^{n+4}-2-\\left(2^{n+1}+2\\right) \\sqrt{2^{n+1}\\left(2^{n}-2\\right) a}} \\end{array}$
> 
> 2. Retailer $ r_{i}, i=2,3, \\cdots, n $, is always worse off with supplier encroachment. 
> 
> 3. if $ n \\geq 2 $, the supplier becomes worse off when being endowed with the option to encroach if $ c \\in\\left[\\underline{c}_{s-S}, \\bar{c}_{s-S}\\right] $, where $ \\underline{c}_{s-S}= $ $ \\frac{2^{n}\\left(2^{n}+1\\right)-\\sqrt{2^{n}\\left(2^{n}-1\\right)\\left(2^{n}-3\\right)\\left(2^{n}+1\\right)}}{5 \\times 2^{2 n}-3 \\times 2^{n}} a \\quad $ and $ \\quad \\bar{c}_{s-S}= $ $ \\frac{2^{3 n}-2^{n} \\sqrt{2^{n+1}\\left(2^{n}-2\\right)}-\\sqrt{2^{n}\\left(2^{2 n-1}-2^{n}+1\\right)\\left(\\left(2^{n}-1\\right) \\sqrt{2^{n+1}\\left(2^{n}-2\\right)}+2\\right)}}{2^{n}\\left(2^{2 n+1}-2^{n+1}+2-\\sqrt{2^{n+1}\\left(2^{n}-2\\right)}\\right)} a $.

![Figure 8](image-14.png)






`,r8=`# Useful Taylor Expression:

$\\ln(1+x) = \\sum_{n=1}^{\\infty}\\dfrac{(-1)^{n+1}x^n}{n}$`,i8=`# 科技创新创业

- 链：科创链
- 科技创新创业投资：科金链
- 科技创新创业政策：科政链
- 科技创新创业服务：科服链

## 路径

- 什么是科技创新创业？构成？过程？
- 案例：难在哪里？
- 创新创业动态风险特性
- 科技创新创业融资之道
- 科技创新创业组织制度育生态环境
- 总结 创新创业经济学特性
- 我们的未来 创新创业创造财富，分析，思考

## 一 数字经济时代科技创新创业

### 党中央的精神

十九大报告：

创新型国家 - 创新型大学

企业家精神 - 创新创业

创新创业

商事制度

多层次资本市场

### 经济增长 =技术进步 x 组织方式（人力 资本 资源 制度）










`,a8=`# Exercise 2.58

Suppose we prepare a quantum system in an eigenstate$|\\psi\\rangle$
of some observable $M$, with corresponding eigenvalue $m$.

What is the average observed value of $M$, and the standard deviation?

---

## Solution:

$\\langle M \\rangle = \\langle \\psi | M | \\psi \\rangle = m$ ($M|\\psi \\rangle = m|\\psi\\rangle$)

$\\langle M^2 \\rangle = \\langle \\psi | M^2 | \\psi \\rangle = m^2$

$\\Delta(M) = \\sqrt{\\langle M^2 \\rangle - \\langle M \\rangle ^2} = \\sqrt{m^2 - m^2 } = 0$

--- 

# 2.107->2.108:

$$
\\begin{aligned}[l]
&\\left[A,B\\right] \\\\ 
=&AB - BA\\\\
=&(C-\\langle C\\rangle)(D-\\langle D\\rangle) - (D-\\langle D\\rangle)(C-\\langle C\\rangle) \\\\
=& CD - DC\\\\
 = &\\left[C,D\\right]
\\end{aligned}
$$

--- 

# Exercise 2.59

Suppose we have qubit in the state  $|0\\rangle $,
and we measure the observable  $X$ .
What is the average value of  $X$  ?
What is the standard deviation of  $X$  ?

 --- 

## Solution


$$
\\begin{aligned}[l]
& \\langle X \\rangle \\\\
 = & \\langle 0 | X |0 \\rangle \\\\
 = &0\\\\
\\\\
&\\langle X^2\\rangle \\\\
 = &\\langle I \\rangle \\\\
= &1\\\\
\\\\
&\\Delta(X)\\\\
 = &\\sqrt{\\langle X ^2\\rangle - \\langle X \\rangle ^ 2}\\\\
= & 1
\\end{aligned}
$$

--- 

# Exercise 2.60

Show that  $\\vec{v} \\cdot \\vec{\\sigma} $ has eigenvalues  $\\pm $1 ,
and that the projectors onto the corresponding eigenspaces are given by
$P_{ \\pm}=(I \\pm \\vec{v} \\cdot \\vec{\\sigma}) / 2 .$

--- 

## Solution

$\\vec v \\cdot \\vec \\sigma = v_x \\sigma_x + v_y\\sigma_y + v_z\\sigma_z$

$\\Rightarrow (\\vec v \\cdot \\vec \\sigma)^2 = v_x ^ 2 + v_y ^ 2 + v_z ^ 2 = |\\vec v|^2 = I$

$\\Rightarrow P = \\dfrac{I \\pm \\vec v \\cdot \\vec \\sigma}{2}$

---

# Exercise 2.61

Calculate the probability of obtaining the result $+1$
for a measurement of  $\\vec{v} \\cdot \\vec{\\sigma} $,
given that the state prior to measurement is  $|0\\rangle $.
What is the state of the system after the measurement if $+1$ is obtained?

---

## Solution

$p = \\langle 0 | P_+ | 0\\rangle = \\dfrac{1}{2}(\\langle 0| I | 0\\rangle + \\langle 0 | \\vec v \\cdot \\vec \\sigma | 0 \\rangle)$

$ = \\dfrac{1}{2}(1 + v_z)$

$|\\psi' \\rangle = \\dfrac{1}{2}(I +\\vec v \\cdot \\vec \\sigma)|0\\rangle = (1 + v_z)|0\\rangle + (v_x + iv_y)|1\\rangle$

$\\dfrac{|\\psi'\\rangle}{\\sqrt{\\langle \\psi'|\\psi'\\rangle}} = \\dfrac{(1 + v_z)|0\\rangle + (v_x + iv_y)|1\\rangle}{\\sqrt{2(1+v_z)}}$





`,o8=`# Phase

$e^{i\\theta}|\\psi\\rangle$ = $|\\psi\\rangle$, *global phase factor* is $e^{i\\theta}$.

$e^{i\\theta}|n$ = $a$, *relative phase factor* is $e^{i\\theta}$.

---

# Composite systems

The state space of a **composite** physical system is the **tensor product**
of the state spaces of the component physical systems.

---

# Exercise 2.66

Show that the average value of the observation $X_1Z_2$
for a two qubit system measured in the state $(|00\\rangle + |11\\rangle) / \\sqrt 2$ is zero.

---

## Solution

$\\langle X_1Z_2 \\rangle = \\langle (|00\\rangle + |11\\rangle) / \\sqrt 2 | X_1 Z_2 | (|00\\rangle + |11\\rangle) / \\sqrt 2 \\rangle$

$=\\langle (|00\\rangle + |11\\rangle) / \\sqrt 2 |(|10\\rangle - |01\\rangle)/\\sqrt 2\\rangle$

$=0 $

---
`,s8=`# Exercise 2.67

Suppose  $V$  is a Hilbert space with a subspace  $W$ .

Suppose $U: W \\rightarrow V$  is a linear operator which preserves inner products,

that is, for any $ \\left|w_{1}\\right\\rangle$  and  $\\left|w_{2}\\right\\rangle$  in  $W$ ,

$\\left\\langle w_{1}\\right| U^{\\dagger} U\\left|w_{2}\\right\\rangle=\\left\\langle w_{1} \\mid w_{2}\\right\\rangle$ .


Prove that there exists a unitary operator  $U^{\\prime}: V \\rightarrow V $ which extends $U$ .

That is, $ U^{\\prime}|w\\rangle=U|w\\rangle$  for all $ |w\\rangle $ in  $W $, but $ U^{\\prime}$  is defined on the entire space  $V$ . 

Usually we omit the prime symbol $'$ and just write $ U  $to denote the extension.

---

## Proof

### U is an isometry from W into V

$\\forall |w_1\\rangle, |w_2\\rangle \\in W, \\langle U w_1 | U w_2 \\rangle = \\langle w_1 | U^\\dagger U | w_2\\rangle = \\langle w_1 | w_2 \\rangle$

Therefore, $U$ is an isometry.

### Extend U to unitary operator U' on V

Let $W^\\perp$ denote the orthogonal complement of $W$ in $V$, so $V = W \\oplus W^\\perp$

Notice that $V = U(W) \\oplus U(W)^\\perp$

$U$ is isometry $\\Rightarrow$ $\\dim W = \\dim U(W) \\Rightarrow \\dim W^\\perp = \\dim U(W)^\\perp$

$\\Rightarrow \\exists T: W^\\perp \\rightarrow U(W)^\\perp$, $T$ is isometry

Define $U': V\\rightarrow V $ by: $U'|v\\rangle = U|w\\rangle + T|w^\\perp\\rangle$

where $|v\\rangle = |w\\rangle + |w^\\perp\\rangle, |w\\rangle \\in W, |w^\\perp\\rangle\\in W^\\perp$

### Show that U' is unitary

$\\forall |v_1\\rangle, |v_2\\rangle \\in V, |v_i \\rangle =|w_i\\rangle + |w_i^\\perp\\rangle,$ we have:

$$
\\begin{aligned}
\\langle U'v_1|U'v_2\\rangle & = \\langle Uw_1 + Tw_1^\\perp | U w_2 + T w_2^\\perp\\rangle \\\\
&=\\langle Uw_1|Uw_2\\rangle + \\langle Tw_1^\\perp | Tw_2^\\perp\\rangle\\\\
&=\\langle w_1 | w_2\\rangle + \\langle w_1^\\perp|w_2^\\perp\\rangle\\\\
&=\\langle v_1|v_2\\rangle
\\end{aligned}
$$

$\\Box$

---

# Thoughts on 2.127 - 2.131, the POVM universal measurement

There's a **quantum system** with **state space** $Q$

We want to perform a $\\sum_{i}M_i$, a **POVM** on $|\\psi\\rangle$, but it's not a projector

We introduce a **ancilla system** with **state space** $M$,  with orthonormal basis $|m\\rangle$,

We construct a composed system $Q\\otimes M$, and $|\\Psi\\rangle = |\\psi\\rangle\\otimes|0\\rangle$ (here $|0\\rangle$ can be any state)

We denote $U$ on $Q\\otimes M$ by $U|\\Psi\\rangle = \\sum_i M_i|\\psi\\rangle|m\\rangle$,

we can see $U$ is unitary and preserves inner products, therefore:

$$
\\begin{aligned}
\\langle\\Psi_1|U^\\dagger U|\\Psi_2\\rangle &= \\sum_{i, j}\\langle\\psi_1|M_i^\\dagger \\langle m_i|M_j|\\psi_2\\rangle| m_j\\rangle\\\\
&=\\sum_{i,j}\\langle\\psi_1|M_i^\\dagger M_j|\\psi_2\\rangle\\langle m_i|m_j\\rangle\\\\
&=\\sum_i \\langle\\psi_1|M_i^\\dagger M_i|\\psi_2\\rangle \\text{ (notice only when i = j it's not zero)}\\\\ 
&=\\langle\\psi_1|\\psi_2\\rangle
\\end{aligned}
$$

then we can perform measurement on $M$ instead, we have $P_m = I_Q \\otimes |m\\rangle\\langle m |$

then the probability:

$$
\\begin{aligned}
p(m) &= \\langle\\Psi|U^\\dagger P_mU|\\Psi\\rangle\\\\
&= \\sum_{i, j}\\langle\\psi|M_i^\\dagger \\langle m_i|P_m M_j|\\psi\\rangle| m_j\\rangle\\\\
&=\\sum_{i,j}\\langle\\psi|M_i^\\dagger M_j|\\psi\\rangle \\langle m_i|m\\rangle\\langle m|m_j\\rangle \\\\
&=\\langle\\psi |M^\\dagger_m M_m|\\psi\\rangle \\text{ ((notice only mi = m and mj = m it's not zero))}
\\end{aligned}
$$

the state:

$$
\\begin{aligned}
\\dfrac{P_m U |\\Psi\\rangle}{\\sqrt{p(m)} } &= \\frac{\\sum_i M_i|\\psi\\rangle|m_i\\rangle\\langle m_i|m\\rangle}{\\sqrt{p(m)}}\\\\
&=\\dfrac{M_m|\\psi\\rangle|m\\rangle}{\\sqrt{\\langle\\psi|M^\\dagger _m M_m|\\psi\\rangle}} \\text{ (notice only mi = m it's not zero)}\\\\
\\end{aligned}
$$

(the book made a mistake here)

therefore the state of system $M$ is $|m\\rangle$,

the state of system $Q$ is $\\dfrac{M_m|\\psi\\rangle|m\\rangle}{\\sqrt{\\langle\\psi|M^\\dagger _m M_m|\\psi\\rangle}}$

which correspond with **Postulate 3**  $\\square$

---

# Exercise 2.68

Prove that $\\dfrac{|00\\rangle + |11\\rangle}{\\sqrt{2}} \\ne |a\\rangle|b\\rangle$ for all single qubit states $|a\\rangle, |b\\rangle$

---

## Proof

let $|a\\rangle = \\alpha |0\\rangle + \\beta|1\\rangle, |b\\rangle = \\gamma|0\\rangle + \\delta|1\\rangle$,

$|a\\rangle|b\\rangle = \\dfrac{1}{2}\\alpha\\gamma|00\\rangle + \\dfrac{1}{2}\\alpha\\delta|01\\rangle + \\dfrac{1}{2}\\beta\\gamma|10\\rangle + \\dfrac{1}{2}\\beta\\delta|11\\rangle$

then $\\alpha\\delta = 0$ and $\\beta\\gamma = 0$, contradiction.

---

# Superdense coding

# Exercise 2.70

Suppose  $E$  is any positive operator acting on Alice's qubit.

Show that  $\\langle\\psi| E \\otimes I|\\psi\\rangle  $takes the same value 

when  $|\\psi\\rangle  $is any of the four Bell states. 

Suppose some malevolent third party ('Eve') intercepts Alice's qubit 

on the way to Bob in the superdense coding protocol. 

Can Eve infer anything about which of the four possible bit strings  

$00,01,10,11  $Alice is trying to send? 

If so, how, or if not, why not?

---

## Solution

1. notice that $\\langle \\psi | E \\otimes I | \\psi \\rangle = tr((E\\otimes I )|\\psi\\rangle\\langle\\psi|)$

2. No, she can only access to one bit and there's no useful information.

---

# Density operator

density operator, density matrix:

$\\rho \\equiv \\sum_i p_i|\\psi_i\\rangle\\langle\\psi_i|$

$\\rho \\rightarrow U\\rho U^\\dagger$

$\\rho_m = \\dfrac{M_m\\rho M_m^\\dagger}{tr(M^\\dagger_m M_m \\rho)}$

$\\rho = \\sum_i p_i \\rho_i =\\sum_m M_m \\rho M_m ^\\dagger$
`,l8=`# More density operator

$tr(\\rho) = 1$

$\\rho$ is a positive operator

# Postulates


## 1

$\\sum_i p_i \\rho_i$

## 2

$\\rho' = U\\rho U^\\dagger$

## 3

$p(m) = tr(M^\\dagger_mM_m\\rho)$

$\\dfrac{M_m\\rho M^\\dagger_m}{tr((M^\\dagger_mM_m\\rho)}$

$\\sum_mM^\\dagger_mM_m = I$

## 4

$\\rho_1\\otimes \\rho_2\\otimes\\cdots\\otimes\\rho_n$

## Pure state:

$\\rho = |\\psi\\rangle\\langle\\psi|$

---

# Exercise 2.71

(Criterion to decide if a state is mixed or pure) 

Let  $\\rho  $ be a density operator. 

Show that  $\\operatorname{tr}\\left(\\rho^{2}\\right) \\leq 1$ ,

with equality if and only if  $\\rho  $ is a pure state.

---

# Proof

$\\Rightarrow:$

$tr(\\rho^2) = 1 \\Rightarrow \\sum_i\\lambda_i^2 = 1\\Rightarrow $ one $\\lambda $ is 1

$\\Leftarrow:$

$\\rho = |\\psi\\rangle\\langle\\psi| \\Rightarrow \\rho^2 = \\rho \\Rightarrow tr(\\rho^2) = tr(\\rho) = 1$

---

# Same density matrices:

$|\\tilde \\psi_i\\rangle = \\sum_j u_{ij}|\\tilde \\phi_j\\rangle$

---

# Exercise 2.72

(Bloch sphere for mixed states) 

The Bloch sphere picture for pure states of a single qubit was introduced in Section 1.2. 

This description has an important generalization to mixed states as follows.

(1) Show that an arbitrary density matrix for a mixed state qubit may be written as

$\\rho=\\frac{I+\\vec{r} \\cdot \\vec{\\sigma}}{2}$

where  $\\vec{r}$  is a real three-dimensional vector such that  $\\|\\vec{r}\\| \\leq 1 $. 

This vector is known as the Bloch vector for the state  $\\rho $.


(2) What is the Bloch vector representation for the state  $\\rho=I / 2 $ ?

(3) Show that a state  $\\rho$  is pure if and only if  $\\|\\vec{r}\\|=1 $.

(4) Show that for pure states the description of the Bloch vector we have given coincides with that in Section 1.2.

---

## (1)

Exercise 2.60

## (2)

$\\vec r = (0, 0, 0)$

## (3)

)`,u8=`# Introduction to Supply chain management

## KYC - Know your Customer

FOXCONN

- Credits arbitrage
- Interest arbitrage
- Exchange rate arbitrage 
- Efficiency arbitrage 

Integration of Industry and Investment:
- Investment enhances Industry
- industry push investment 

---

Developing triangle
- Environment, resuorce, labor
- technology management brand
- capital, standard, creativity 

## KYW - Know your Want 

- 60s cost Mass product material flow manufacturing is king OM(operations management)
- 70s quality TPS/SIT 
- 80s flexibility FMS 
- 90s service mass customazation material / information flow 
- 00s speed vertical integration make capital flow cash is king 
- sustainbility ESG 

## KYCash - Know your Cash 

$\\sum_{n=0}^\\infty na_nx^{n-1} = \\dfrac{1}{x+2},x = 1:\\dfrac{1}{3}$`,h8=`# Why changes?

**Value disciplined** change 
- product 
- service 
- experience
- participation

# 3 Multiple

- multiple flows 
- multiple organizations 
- multiple functions 

# First Principle 

- Consider customer's needs 

# Know your Supply chain & Cash 


Observations:

- Facility 
- Efficiency 
- Levels 

## The Development chain 

R&D - Brand - Design - Procurement - Manufacturing - Distribution - Sales - Sales service 

A Parabola:

- global production network
- value added

---

- Development chain 
- supply chain

# Supply chain

Buy material - sell - pay - get money

- Buy material - sell: average sell / inventory period 
- sell - get money: average accounts receivable period 
- Buy material - pay: average accounts payable period 
- pay - get money: cash period

# Cash Conversion Cycle

> Cash Conversion Cycle = DIO + DSO – DPO

- DIO stands for Days Inventory Outstanding
- DSO stands for Days Sales Outstanding
- DPO stands for Days Payable Outstanding

`,c8="",m8=`# Mismatching Between Supply and Demand 

## Bullwhip Effect(agility)

- cost goes up 

### How to Solve

- managing uncertainty
- risk pooling 
  
## Value (Adaptability)

## Double Marginalization (Alignment)

### How to solve 

Risk sharing 
- global optimization 
- local optimization 
`,d8=`# CSR - Creating shared value 

## Responsibilities

- philanthropy
- ethical 
- legal
- compliance 

`,f8=`# 科技创新创业

- 链：科创链
- 科技创新创业投资：科金链
- 科技创新创业政策：科政链
- 科技创新创业服务：科服链

## 路径

- 什么是科技创新创业？构成？过程？
- 案例：难在哪里？
- 创新创业动态风险特性
- 科技创新创业融资之道
- 科技创新创业组织制度育生态环境
- 总结 创新创业经济学特性
- 我们的未来 创新创业创造财富，分析，思考

## 一 数字经济时代科技创新创业

### 党中央的精神

十九大报告：

创新型国家 - 创新型大学

企业家精神 - 创新创业

创新创业

商事制度

多层次资本市场

### 经济增长 =技术进步 x 组织方式（人力 资本 资源 制度）










`,p8=`#

## 创新和创业的区别？

- 创新：企业存在。产品、工艺、市场、组织、原材料创新
- 创业：企业不存在，通过技术经济过程让企业能生存

`,g8="",b8=`# MDA

- Mechanics
- Dynamics
- Aesthetics

## Aesthetics 

- Sensation 
- Fantasy
- Narrative
- Challenge 
- Fellowship
- Discovery 
- Expression 
- Submission 

## Dynamic Models 

- Challenge
  - Time Pressure 
  - Opponent play  
- Fellowship
  - Share information 
  - Supplying winning conditions that are more difficult to achieve alone 
- Expression
  - Buy, build and win items
  - Construct world 
  - 
- Narrative 

---

# Roadmap 

- Overall content 
- Experience 
- Analyse Dynamic 
- Mechanics

## Example 

- Theme

- Experience 

Challenge, narration, discovery, fantaasy 

- Challenge 
  - Find pattern, do assassin, and achievement 
    - 1. Easily be spotted
      - Enemy AI broad eyesight - a value 
      - Route dense  - the route 
      - Infamous point - the relation
    - 2. Find patterns and environment 
      - find route - screen 
      - repeat - route design 
      - time delay - 
      - item - 
    - 3.do assassin 
      - Climb - move mechanic 
      - Time delay to hide - 
      - Hidden places - 

# ARCS

- Attention
- Relevance
- Confidence 
- Satisfaction

## Attention 

- Perceptual arousal
- Inquiry arousal 
- Variability 

## Relevance 

- Goal orientation 
- Motive matching 
- Familiarity

## Confidence 

- Learning requirements 
- Success opportunities 
- Personal control 

## Satisfaction 

- Intrinsic reinforcement 
- Extrinsic rewards 
- Equity

---

# Combined with game design 

## Attention 

- Style, Character, UI, Story, SE 

## Relevance

- Relevated with real life

## Confidence

- Difficulty, Reward, Choices 

## Satisfaction

- Upgrade, tests.

# Immersion 

- Skill & Challenge 

- Boring - MindFlow - Anxiety 

## Everyonr MindFlow 

- Design 
- Focus 
- Visual

## Features of Immersion 

- target
- balance 
- reward 
- mind and move 
- time 
- focus 
- lose myself 
- control 
- targeted experience

## More detailed 

- Mindflow - Control - relax - bored - Indifferent - Worried - Anxiety - Motivate

## Stages 

- Ready 
  - Target 
  - Reward 
  - Balnace 
- Experience
  - Mind and move 
  - Focus 
  - Control 
- Effect 
  - Lose myself 
  - Time 
  - Targeted experience





`,y8=`# Conditional Expectation & Probability 

## Conditional Expectation 

When: $p_Y(y) > 0$

Then: 

$p_{X|Y}(x|y) = p(X=x|Y=y) = \\dfrac{p(X=x, Y=y)}{p_Y(y)}$

- $F_{X|Y}(x|y) = P\\{X\\le x|Y=y\\} = \\sum_{a\\le x}p_{X|Y}(a|y)$
- $E(X|Y=y) = \\sum_x xP\\{X=x|Y=y\\} = \\sum_x p_{X|Y} (x|y)$

## Formula 

$Var(X) = E[X^2] - (E[X])^2$

$Var(X) = E[Var(X|Y)] + Var(E[X|Y])$

# Conditional Probability 

## Example

> To maximize the probability of selecting the best award from a sequence of $n$ randomly ordered awards announced one by one (where each rejected award cannot be revisited and accepting an award ends the process)

Solution:

We use the strategy: Pass the first $k$ awards and select the first one that better than before

Denote: $X_k$ as using strategy pass first $k$ awards, $E$ as getting the best award.

If the place we stop (denote as $i$) is the best, we need:

1. The best award is at position $i$
2. The first $i-1$'s awards' best one should be in the first $k$ (Or we will stop in the middle)

Therefore:

$$
\\begin{array}{l}
P(E|X_k)\\\\ 
= \\sum_{i=k+1}^n\\dfrac{1}{n}\\cdot\\dfrac{k}{i-1}\\\\ 
= \\dfrac{k}{n}\\sum_{i=k+1}^n\\dfrac{1}{i-1}\\\\ 
\\approx \\dfrac{k}{n}(\\ln (n-1) - \\ln k)\\\\ 
\\end{array}
$$


To maximize the probability, let 

$f(k) = P(E|X_k) \\approx \\dfrac{k}{n}(\\ln (n-1) - \\ln k) $, 

then:

$$
\\begin{array}{l}
f'(k) = \\dfrac{\\ln (n-1) - \\ln (ek)}{n}
\\end{array}
$$

To maximize probability, we have:

$k = \\dfrac{n-1}{e}$




`,$8=`# Discrete Martingale

## 1

### Problem

> If $ \\left\\{Z_{n}, n \\geq 1\\right\\} $ is a martingale, prove that for $ 1 \\leq k<n $, 
> 
> $ \\mathbb{E}\\left[Z_{n} \\mid Z_{k}, \\ldots, Z_{1}\\right]=Z_{k} $ .
> 
> Similarly, if $ \\left\\{Z_{n}, n \\geq 1\\right\\} $ is a submartingale, prove that 
> 
> $\\mathbb{E}\\left[Z_{n} \\mid Z_{k}, \\ldots, Z_{1}\\right] \\geq Z_{k} $

### Proof (a)

Notice:

$$
\\begin{array}{l}
\\mathbb{E}\\left[Z_{n} \\mid Z_{k}, \\ldots, Z_{1}\\right]\\\\ 
=E[E[Z_n|Z_{n-1},\\dots,Z_1]|Z_k,\\dots,Z_1]\\\\ 
= E[Z_{n-1}|Z_k,\\dots,Z_1]
\\end{array}
$$

By induction, we can get:

$\\mathbb{E}\\left[Z_{n} \\mid Z_{k}, \\ldots, Z_{1}\\right]=Z_{k}$

### Proof (b)

Similarly, we have:

$$
\\begin{array}{l}
\\mathbb{E}\\left[Z_{n} \\mid Z_{k}, \\ldots, Z_{1}\\right]\\\\ 
=E[E[Z_n|Z_{n-1},\\dots,Z_1]|Z_k,\\dots,Z_1]\\\\ 
\\ge E[Z_{n-1}|Z_k,\\dots,Z_1]
\\end{array}
$$


By induction, we can get:

$\\mathbb{E}\\left[Z_{n} \\mid Z_{k}, \\ldots, Z_{1}\\right]\\ge Z_{k}$


## 2

### Problem 

> Let $ S_{0}=0, S_{n}=\\epsilon_{1}+\\cdots+\\epsilon_{n} $ for $ n \\geq 1 $, where $ \\left\\{\\epsilon_{i}\\right\\} $ are i.i.d. exponential random variables with $ \\lambda=1 $. Show that 
> 
> $X_{n}=2^{n} \\exp \\left(-S_{n}\\right), \\quad n \\geq 1$
> 
> is a martingale.

### Solution

First:

$$
\\begin{array}{l}
E[|X_n|]\\\\
=E[2^ne^{-n}]\\\\ 
< \\infty 
\\end{array}
$$

Then:

$$
\\begin{array}{l}
E[X_{n+1} | X_1,\\dots, X_n]\\\\ 
=E[2^{n+1}e^{-S_n}e^{-\\epsilon_{n+1}}]\\\\ 
= 2^{n+1}e^{-S_n}E[e^{-\\epsilon_{n+1}}]\\\\ 
= 2^{n+1}e^{-S_n}\\int_0^\\infty e^{-x} e^{-x} dx \\\\ 
= 2^ne^{-S_n} \\\\ 
=X_n
\\end{array}
$$

## 3

### Problem

> If $ X_{i}(i \\geq 1) $ are i.i.d. with $ \\mathbb{E}[|X|]<\\infty $, and $ N $ is a stopping time for $ \\left\\{X_{i}\\right\\} $ with $ \\mathbb{P}(N<\\infty)=1 $ and $ \\mathbb{E}[N]<\\infty $, show that 
> 
> $\\mathbb{E}\\left[\\sum_{i=1}^{N} X_{i}\\right]=\\mathbb{E}[N] \\mathbb{E}[X] . $

### Solution 

$$
\\begin{array}{l} 
E[\\sum_{i=1}^NX_i] \\\\ 
= E[\\sum_{i=1}^\\infty X_i I_{i\\le N}]\\\\ 
= \\sum_{i=1}^\\infty E[X] P(N\\ge i)\\\\ 
= \\sum_{i=1}^\\infty E[X]\\sum_{j=i}^\\infty P(N=j)\\\\ 
= \\sum_{j=1}^\\infty E[X] \\sum_{i=1}^j P(N=j) \\\\ 
=\\sum_{j=1}^\\infty E[X] jP(N=j) \\\\ 
= E[N]E[X]
\\end{array}
$$

## 4

### Problem 

>   Consider a process $ \\left\\{X_{n}, n \\geq 0\\right\\} $ where $ X_{0} $ is a positive integer. If $ X_{n}=0 $, then $ X_{n+1}=0 $. If $ X_{n}>0 $,
> 
> $X_{n+1}=\\left\\{\\begin{array}{ll}X_{n}+1, & \\text { with probability } 0.5 \\\\X_{n}-1, & \\text { with probability } 0.5\\end{array}\\right.$
>
> 
> (a) Show that $ X_{n} $ is a non-negative martingale.
> 
> (b) For $ X_{0}=i>0 $, use Kolmogorov's inequality for submartingales to bound$\\mathbb{P}\\left(\\exists n \\geq 0, X_{n} \\geq N \\mid X_{0}=i\\right)$

### Solution (a)

Notice $X_n \\ge 0$, and:

$$
\\begin{array}{l}
E[X_{n+1} | X_1,\\dots, X_n]\\\\ 
= E[X_{n+1}|X_n]\\\\ 
= \\begin{cases}
0.5(X_n+1)+0.5(X_n-1)& X_n >0 \\\\ 
X_n & X_n = 0
\\end{cases}\\\\ 
= X_n
\\end{array}
$$

Then:

$$
\\begin{array}{l}
E[|X_n|] \\\\ 
= E[X_n] \\\\ 
= E[X_0] \\\\ 
= X_0 < \\infty
\\end{array}
$$

### Solution (b)

$$
\\begin{array}{l}
P(\\max(X_0,\\dots,X_n)>N|X_0 = i)\\\\ 
\\le \\dfrac{E[X_n| X_0 = i]}{N} \\\\ 
= \\dfrac{i}{N}
\\end{array}
$$

which is the upper bound.



## 5

### Problem

> Prove Kolmogorov's Inequality: Let $ X_{1}, X_{2}, \\ldots $ be independent random variables with mean 0 . Define $ S_{k}=X_{1}+\\cdots+X_{k} $. For any $ a>0 $, show that: 
> 
> $ P\\left\\{\\max _{1 \\leq k \\leq n}\\left|S_{k}\\right| \\geq a\\right\\} \\leq \\frac{\\operatorname{Var}\\left(S_{n}\\right)}{a^{2}} $

### Proof (1)

> (1) Show that $ \\left\\{S_{k}, k=1,2, \\ldots\\right\\} $ is a martingale with mean 0 .

We have:

$E[|S_n|] \\le \\sqrt{E[S_n^2]} = Var[S_n] < \\infty$

Also:

$$
\\begin{array}{l}
E[S_{n+1}|S_1,\\dots,S_n]\\\\ 
=E[\\sum_{i=1}^{n+1}X_i|X_1,\\dots,X_n]\\\\ 
=E[X_1+\\dots+X_n|X_1,\\dots,X_n] + E[X_{n+1}]\\\\ 
= S_n
\\end{array}
$$

### Proof (2)

> (2) Define $ \\left\\{Z_{k}\\right\\} $ :
> 
> $Z_{k+1}=\\left\\{\\begin{array}{ll}S_{k+1}, & \\text { if } \\max _{1 \\leq i \\leq k}\\left|S_{i}\\right|<a \\\\Z_{k}, & \\text { if } \\max _{1 \\leq i \\leq k}\\left|S_{i}\\right| \\geq a\\end{array}\\right.$
> 
> with $ Z_{0}=0 $. Show $ \\left\\{Z_{k}\\right\\} $ is a martingale.

Notice $E[|Z_{n+1}|] < \\infty $, and:

$$
\\begin{array}{l}
E[Z_{n+1}|Z_1,\\dots,Z_n]\\\\ 
= E[S_{n+1}|Z_1,\\dots,Z_n]P(\\max_{1\\le i \\le n}|S_i| < a) + E[Z_n|Z_1,\\dots,Z_n]P(\\max_{1\\le i \\le n}|S_i| \\ge a) \\\\ 
= E[S_{n+1}|S_1,\\dots,S_n]P(\\max_{1\\le i \\le n}|S_i| < a) + Z_nP(\\max_{1\\le i \\le n}|S_i| \\ge a) \\\\ 
= S_nP(\\max_{1\\le i \\le n}|S_i| < a) + Z_nP(\\max_{1\\le i \\le n}|S_i| \\ge a) \\\\ 
= Z_nP(\\max_{1\\le i \\le n}|S_i| < a) + Z_nP(\\max_{1\\le i \\le n}|S_i| \\ge a) \\\\ 
= Z_n
\\end{array}
$$

### Proof (3)

> (3) For a martingale $ \\left\\{M_{k}\\right\\} $ with $ M_{0}=0 $, show:
> 
> $\\sum_{i=1}^{n} E\\left[\\left(M_{i}-M_{i-1}\\right)^{2}\\right]=E\\left[M_{n}^{2}\\right] .$

We have:

$$
\\begin{array}{l}
\\sum_{i=1}^nE[(M_i - M_{i-1})^2]\\\\ 
= \\sum_{i=1}^n E[E[M_i^2 - 2M_iM_{i-1}+M_{i-1}^2]|M_{i-1}] \\\\ 
= \\sum_{i=1}^n E[E[M_i^2] - M_{i-1}^2]\\\\ 
= \\sum_{i=1}^n E[M_i^2] - E[M_{i-1}^2] \\\\ 
= E[M_n^2] - E[M_0^2] \\\\ 
= E[M_n^2]
\\end{array}
$$

### Proof (4)

> (4) Use Chebyshev's inequality to show:
> 
> $P\\left\\{\\max _{1 \\leq k \\leq n}\\left|S_{k}\\right| \\geq a\\right\\} \\leq \\frac{E\\left[S_{n}^{2}\\right]}{a^{2}}=\\frac{\\operatorname{Var}\\left(S_{n}\\right)}{a^{2}} .$

We have:

$$
\\begin{array}{l}
P\\left\\{\\max _{1 \\leq k \\leq n}\\left|S_{k}\\right| \\geq a\\right\\}\\\\ 
= P\\{|Z_n|\\ge a\\} \\\\ 
\\le \\dfrac{E[Z_n^2]}{a^2}\\\\ 
\\le \\dfrac{E[S_n^2]}{a^2} \\\\ 
= \\dfrac{Var(S_n)}{a^2}
\\end{array}
$$

### Answer (5)

> (5) Does this proof apply to all $ \\left\\{S_{k}\\right\\} $ that are mean-0 martingales?

Answer: No 

The proof relies on the independent increments of $ \\left\\{S_{k}\\right\\} $. 

Specifically: 

- Step (3) assumes $ \\left\\{M_{k}\\right\\} $ has orthogonal increments (true for martingales). 

- Step (4) uses the fact that $ Z_{n}=S_{n} $ if no stopping occurs, which implicitly requires $ S_{n} $ to be a sum of independent variables. 

For general martingales, Kolmogorov's inequality does not hold; instead, Doob's inequality is used, which requires different techniques. Thus, independence is essential here.

# Chapter 4

## 2

### Problem 

> Suppose whether it rains today depends on the weather conditions of the previous three days. Explain how to analyze this system using a Markov chain. How many states must there be?

### Solution 

8, each day has 2 states, and there are:

$2^3 = 8$ 

states. 

## 3 

### Problem 

> In Exercise 2, suppose that if it has rained for the past three days, then it will rain today with probability 0.8; if there was no rain in the past three days, then it will rain today with probability 0.2; and in other cases, today's weather will be the same as yesterday's with probability 0.6. Determine the transition probability matrix $P$


### Solution 

We denote $R$ as rain and $N$ as no rain, then:

$$
\\begin{array}{|l|l|l|l|l|l|l|l|l|}
\\hline
 & \\text{R R R} & \\text{R R N} & \\text{R N R} & \\text{R N N} & \\text{N R R} & \\text{N N R} & \\text{N N R} \\\\ \\hline
\\text{R R R} & 0.8 & 0.2 & 0 & 0 & 0 & 0 & 0 \\\\ \\hline
\\text{R R N} & 0 & 0 & 0.4 & 0.6 & 0 & 0 & 0 \\\\ \\hline
\\text{R N R} & 0 & 0 & 0 & 0 & 0.6 & 0 & 0 \\\\ \\hline
\\text{R N N} & 0 & 0 & 0 & 0 & 0 & 0.4 & 0.6 \\\\ \\hline
\\text{N R R} & 0.6 & 0.4 & 0 & 0 & 0 & 0 & 0 \\\\ \\hline
\\text{N R N} & 0 & 0 & 0.4 & 0.6 & 0 & 0 & 0 \\\\ \\hline
\\text{N N R} & 0 & 0 & 0 & 0 & 0.6 & 0.2 & 0.8 \\\\ \\hline
\\text{N N N} & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\\\ \\hline
\\end{array}
$$

## 4

### Problem 

> Consider a process $ \\left\\{X_{n}, n \\geq 0\\right\\} $ taking values 0,1 , or 2 . Suppose 
> 
> $\\mathrm{P}\\left\\{X_{n+1}=j \\mid X_{n}=i, X_{n-1}=i_{n-1}, \\cdots, X_{0}=i_{0}\\right\\}=\\left\\{\\begin{array}{ll} P_{i j}^{\\mathrm{I}}, & \\text { if } n \\text { is even } \\\\ P_{i j}^{\\mathrm{II}}, & \\text { if } n \\text { is odd. } \\end{array}\\right. $
> 
>  Is $ \\left\\{X_{n}, n \\geq 0\\right\\} $ a Markov chain? If not, explain how to enlarge the state space to make it a Markov chain.

### Solution 

No, it depends on if $n$ is odd.

We can extend to $(i, k)$, where $k = \\begin{cases}0 &\\text {if } n \\text{ is odd}\\\\ 1 &\\text {if } n \\text{ is even}\\end{cases}$

## 5

### Problem 

> A Markov chain $ \\left\\{X_{n}, n \\geq 0\\right\\} $ with states $ 0,1,2 $ has the transition probability matrix: 
> 
> $ \\left[\\begin{array}{lll} \\frac{1}{2} & \\frac{1}{3} & \\frac{1}{6} \\\\ 0 & \\frac{1}{3} & \\frac{2}{3} \\\\ \\frac{1}{2} & 0 & \\frac{1}{2} \\end{array}\\right] . $
> 
>  Given $ \\mathrm{P}\\left(X_{0}=0\\right)=\\mathrm{P}\\left(X_{0}=1\\right)=\\frac{1}{4} $, find $ \\mathrm{E}\\left[X_{3}\\right] $.

### Solution 

Notice:

$$
\\begin{array}{l}
 \\left[\\begin{array}{lll} \\frac{1}{2} & \\frac{1}{3} & \\frac{1}{6} \\\\ 0 & \\frac{1}{3} & \\frac{2}{3} \\\\ \\frac{1}{2} & 0 & \\frac{1}{2} \\end{array}\\right]^3
=  \\left[\\begin{array}{lll} \\frac{13}{36} & \\frac{11}{54} & \\frac{47}{108} \\\\ \\frac{4}{9} & \\frac{4}{27} & \\frac{11}{27} \\\\ \\frac{5}{12} & \\dfrac{2}{9} & \\frac{13}{36} \\end{array}\\right]
\\end{array}
$$

Then:

$$
\\begin{array}{l}
[\\frac{1}{4},\\frac{1}{4},\\frac{1}{2}]\\left[\\begin{array}{lll} \\frac{13}{36} & \\frac{11}{54} & \\frac{47}{108} \\\\ \\frac{4}{9} & \\frac{4}{27} & \\frac{11}{27} \\\\ \\frac{5}{12} & \\dfrac{2}{9} & \\frac{13}{36} \\end{array}\\right]
\\\\
= \\left[\\frac{59}{144}, \\frac{43}{216}, \\frac{169}{432}\\right] 
\\end{array}
$$

Therefore:

$ \\mathrm{E}\\left[X_{3}\\right]=0 \\cdot \\frac{59}{144}+1 \\cdot \\frac{43}{216}+2 \\cdot \\frac{169}{432}=\\frac{43}{216}+\\frac{338}{432}=\\frac{53}{54} $

## 8

### Problem 

>  Suppose Coin 1 lands heads with probability 0.7, and Coin 2 lands heads with probability 0.6. If the coin tossed today lands heads, we choose Coin 1 to toss tomorrow; if it lands tails, we choose Coin 2 to toss tomorrow. Initially, we toss either Coin 1 or Coin 2 with equal probability.
> 
> (a) What is the probability that Coin 1 is tossed on the third day after starting?
> 
> (b) If the coin tossed on Monday lands heads, what is the probability that the coin tossed on Friday of the same week also lands heads?

### Solution (a)

The probability transition matrix:

$$
\\begin{array}{l|l|l|}
\\hline & 1 & 2 \\\\ 
\\hline 1 & 0.7 & 0.3 \\\\ 
\\hline 2 & 0.6 & 0.4 \\\\ 
\\hline 
\\end{array}
$$

Then for the third day:

$[0.5, 0.5]\\left[\\begin{array}{ll}0.7&0.3\\\\ 0.6&0.4\\end{array} \\right]^2 = [0.665, 0.335]$

So the probability is $0.665$

### Solution (b)

For Thursday:

$[1, 0]\\left[\\begin{array}{ll}0.7&0.3\\\\ 0.6&0.4\\end{array} \\right]^3 = [0.6667, 0.3333]$

Then for Friday:

$P(H) = 0.6667 * 0.7 + 0.3333 * 0.6 = 0.6667$

## 11 

### Problem 

> In Example 4.3, Gary was in glum 4 days ago. Given that he has not felt cheerful for a week, what is the probability that he is in glum today?
>
>  The transition probability matrix of $(C, S, G)$ (cheerful, so-so, glum) is: $\\boldsymbol{P}=\\left[\\begin{array}{lll} 0.5 & 0.4 & 0.1 \\\\ 0.3 & 0.4 & 0.3 \\\\ 0.2 & 0.3 & 0.5 \\end{array}\\right]$

### Solution

Notice:

$[\\dfrac{7}{15}, \\dfrac{8}{15}]\\left[\\begin{array}{ll}\\dfrac{4}{7}&\\dfrac{3}{7}\\\\ \\dfrac{3}{8}&\\dfrac{5}{8}\\end{array}\\right] = [\\dfrac{7}{15}, \\dfrac{8}{15}]$

Therefore, we can approximate that:

$[0, 1]\\left[\\begin{array}{ll}\\dfrac{4}{7}&\\dfrac{3}{7}\\\\ \\dfrac{3}{8}&\\dfrac{5}{8}\\end{array}\\right]^4 \\approx \\dfrac{8}{15}$

## 12

### Problem 

> For a Markov chain $ \\left\\{X_{n}, n \\geq 0\\right\\} $ with transition probabilities $ P_{i, j} $, consider the conditional probability $ \\mathrm{P}\\left(X_{n}=m \\mid X_{0}=i, X_{k} \\neq r\\right. $ for $ \\left.k=1, \\ldots, n\\right) $. Is this equal to the $ n $-step transition probability $ Q_{i, m}^{n} $ of a chain with state space excluding $ r $ and adjusted transitions $ Q_{i, j}=\\frac{P_{i, j}}{1-P_{i, r}} $ ? Prove or provide a counterexample.

### Solution

Consider a Markov chain with states $ \\{0,1,2\\} $ where $ r=2 $.

Transition probabilities from state 0: $ P_{0,0}=1 / 3, P_{0,1}=1 / 3, P_{0,2}=1 / 3 $.

Transition probabilities from state $ 1: P_{1,0}=1 / 2, P_{1,1}=1 / 4, P_{1,2}=1 / 4 $.

Then:

$Q_{0,0}^{2}=(1 / 2)(1 / 2)+(1 / 2)(2 / 3)=1 / 4+1 / 3=7 / 12$

$$
\\begin{array}{l }
\\mathrm{P}\\left(X_{2}=0 \\mid X_{0}=0, X_{1} \\neq 2, X_{2} \\neq 2\\right)\\\\ 
= \\dfrac{1 / 9+1 / 6}{1 / 9+1 / 9+1 / 6+1 / 12}\\\\ 
= 10 / 17 
\\end{array}
$$

Answer is No.

## 13 

### Problem

> Prove that if $ \\boldsymbol{P}^{r} $ has all positive entries for some $ r $, then $ \\boldsymbol{P}^{n} $ has all positive entries for $ n \\geq r $

### Solution 

We have:

$ P^{n}(i, j)=\\sum_{k} P^{r}(i, k) P^{n-r}(k, j)>0 $
`,v8=`## Conditional Expectation

$E[E[X|Y,W]|Y] = E[X|Y]$

# Martingale

## Stochastic Process

Stochastic Process: $\\{Z(t), t\\in T\\}$: A set of RV
- $Z(t)$: the **state** of process in time $t$

Components:

- **State Space**: the set for all possible $Z(t)$
- **Index Set**: $T$
- **Dependence Relationship**: Relationship between $Z(t)$

### Discrete Process

$T$ is a countable set 

### Continuous Process 

$T$ is a real number range 

## Martingale

Describe **fair game**

Two condition for SP:

- $E[|Z_n|] < \\infty$
- $E[Z_{n+1}|Z_1,\\dots,Z_n] = Z_n$

Example: A gambler's asset after $n$ games

### Corollaries

1. $E[Z_n] = E[E[Z_{n+1}|Z_1,\\dots,Z_n]] = E[Z_{n+1}]$
2. $E[Z_n] = E[Z_k] = E[Z_1], \\forall n>k>1$
3. $E[Z_m|Z_n,\\dots,Z_1] = Z_n, \\forall m>n$

### Example 

$X_i$ i.i.d. RV, has expectation $0$, $E[|X_i|]<\\infty$

Let $Z_n = \\sum_{i=1}^n X_i$

Then: $E[Z_{n+1}|Z_1, \\dots, Z_n] = Z_n$

$Z_n$ is a martingale 

--- 

(Doob Martingale)

$E[|X|]<\\infty, Z_n = E[X|Y_1,\\dots,Y_n]$


We first prove:

$E[Z_{n+1}|Z_1,\\dots,Z_n,Y] = Z_n$

Add conditional expectation for both side:

$E[E[Z_{n+1}|Z_1,\\dots,Z_n,Y]|Z_1,\\dots,Z_n] = E[Z_n|Z_1,\\dots,Z_n]$

For LHS:

$E[E[Z_{n+1}|Z_1,\\dots,Z_n,Y]|Z_1,\\dots,Z_n] = E[Z_{n+1}|Z_1,\\dots,Z_n]$

For RHS:

$E[Z_n|Z_1,\\dots,Z_n] = Z_n$

Then we prove the problem:

We want to prove:

$E[Z_{n+1}|Z_1,\\dots,Z_n,Y_1,\\dots ,Y_n] = Z_n$

For LHS:

$E[Z_{n+1}|Z_1,\\dots,Z_n,Y_1,\\dots ,Y_n] = E[Z_{n+1}|Y_1,\\dots ,Y_n]= Z_n$

---

$Z_n = \\sum_{i=1}^n(X_i - E[X_i | X_1,\\dots,X_{i=1}])$

## Stopping time

$N$: Stopping time: \${N=n}$ is completely decided by $Z_1, \\dots,Z_n$
- $P\\{N<\\infty\\} = 1$

- Example: Gamble until win 
- CounterExample: The lowest point of stock

### Stopping time process 

$\\bar{Z_n} = \\begin{cases}Z_n, &if: n\\le N\\\\ Z_N, &if: n>N\\end{cases} $

$\\{\\bar{Z_n}\\}$ is a Martingale:

Proof:

$$
\\begin{array}{ll}
&E[\\bar{Z_{n+1}}| \\bar Z_1,\\dots,\\bar Z_n] \\\\ 
&=E[\\bar{Z_{n+1}}| Z_1,\\dots,Z_n] \\\\ 
&= E[\\bar{Z_n} + I_{N \\ge n+1}(Z_{n+1} - Z_n)| Z_1,\\dots,Z_n]\\\\ 
&=\\bar{Z_n} + I_{n+1} E[(Z_{n+1} - Z_n)| Z_1,\\dots,Z_n]\\\\ 
&= \\bar{Z_n}
\\end{array}
$$

### Martingale Stopping Theorem

$P\\{N<\\infty\\} = 1$, if any condition meets, then $E[Z_N] = E[Z_1]$

1. $\\bar{Z_n}$ is uniformly bounded
- uniformly bounded: $\\exists M, s.t.; |\\bar{Z_n}|\\le M, \\forall n$
2. $N$ is bounded
- bounded: $\\exists M, s.t.: N\\le M, or: P(N\\le M ) = 1$
3. $E[N] < \\infty, \\exists M <\\infty ,s.t.: E[|Z_{n+1}-Z_n|\\mid Z_1,\\dots, Z_n] <M$
- $E[|Z_{n+1}-Z_n|\\mid Z_1,\\dots, Z_n]$ is bounded 

#### Example

(Wald Equation)

$X_i$ i.i.d. $E[|X|]<\\infty, P(N<\\infty) = 1, E[N]<\\infty $

Then:

$E[\\sum_{i=1}^NX_i] = E[N]E[X]$

## Sub, Super, Convergence

### Submartingale

$E[|Z_n|] <\\infty, E[Z_{n+1}|Z_1,\\dots,Z_n] \\ge Z_n$

- superfair game

### Supermartingale

$E[|Z_n|] <\\infty, E[Z_{n+1}|Z_1,\\dots,Z_n] \\le Z_n$

- subfair game 

### Stopping time theorem still meets 

### A corollary

\${Z_i}$ is Submartingale, $P\\{N<n\\} = 1$ then:

$E[Z_1]\\le E[Z_N]\\le E[Z_n]$

### Second corollary 

$\\{Z_n\\} $ is martingale, $f$ convex, then:

$\\{f(Z_n)\\}$ is Submartingale.


### Third corollary 

$\\{Z_n\\}$: non-negative Submartingale, $a>0$, then:

$P\\{\\max(Z_1,\\dots,Z_n)>a\\} \\le\\dfrac{E[Z_n]}{a}$

Proof: Let $N$ be the first time $Z_i > a$

$$
\\begin{array}{l}
P\\{\\max(Z_1,\\dots,Z_n)>a\\}K = P\\{Z_N>a\\} \\\\ 
\\le \\dfrac{E[Z_N]}{a} \\\\ 
\\le \\dfrac{E[Z_n]}{a}
\\end{array}
$$




--- 

$P\\{\\max(Z_1,\\dots,Z_n)>a\\} \\le\\dfrac{E[Z_n^2]}{a^2}$


### Martingale Convergence Theorem

$\\{Z_n\\}$ Martingale, $\\exists M<+\\infty$ s.t. $E[|Z_n|]\\le M,\\forall n$

 Then:

$ \\lim_{n\\to\\infty}Z_n \\overset{\\text{w.p. 1}}{\\to} a$


### Corollary  4

$\\{Z_n\\}$ Non-negative Martingale, then:

$ \\lim_{n\\to\\infty}Z_n \\overset{\\text{w.p. 1}}{\\to} a$


`,_8=`# 1

## Problem 

> Consider a Markov chain with a state space consisting of integers $ 0, \\pm 1, \\pm 2, \\ldots $, and transition probabilities:
> 
> $\\mathrm{P}_{\\mathrm{i}, \\mathrm{i}+1}=p=1-P_{i, i-1}, \\quad i=0, \\pm 1, \\pm 2, \\ldots$
> 
> where $ p \\in(0,1) $. We can directly establish recurrence in the symmetric case and determine the probability of eventually returning to state 0 in the asymmetric case.
> 
> (1) Let $ \\alpha $ denote the probability that the Markov chain eventually returns to state 0 given it is currently in state 1 . Show that $ \\alpha=1-p+p \\alpha^{2} $. (Hint: Condition on the next state.)
> 
> (2) Let $ \\beta=\\mathrm{P}\\{ $ eventually return to 0$ \\} $. Show that:
> 
> $ \\beta=\\mathrm{P}\\left\\{\\right. $ eventually return to $ \\left.0 \\mid X_{1}=1\\right\\} p+\\mathrm{P}\\left\\{\\right. $ eventually return to $ \\left.0 \\mid X_{1}=-1\\right\\}(1-p) $.
> 
> (3) Using the previous parts, show that if $ p=0.5 $ (symmetric random walk), all states are recurrent.
> 
> (4) Solve Problem 17 in Chapter 4 of the textbook.
> 
> (5) Referring to part (4), show that when $ p>0.5, \\mathrm{P}\\left\\{\\right. $ eventually return to $ \\left.0 \\mid X_{1}=-1\\right\\}=1 $.
> 
> (6) Combine part (5) with the transience of all states to show that when $ p>0.5, \\beta=2(1-p) $.
> 
> (7) Referring to part (4), show that when $ p<0.5, \\alpha=1 $.
> 
> (8) Combine part (7) with the transience of all states to show that when $ p<0.5, \\beta=2 p $.
> 
> (9) Combine parts (6) and (8) to derive the general form of $ \\beta $.

## Solution (1)

When moves to 2, we need $\\alpha^2$ to return to 0, therefore:

We have:

$\\alpha = (1-p) + p\\alpha^2$

## Solution (2)

Notice after first move, we can only be $1$ or $-1$, then the question is well explainerd 

## Solution (3)

After calculation, we have:

$\\alpha = 1$

Then:

$\\beta = p + 1-p = 1$

Also, it applies for every place.

## Solution (4)

Denote $X_n$ as the place at time $n$, $Z_n$ as the $n$-th move, then:

$E[Z_n] = p + (1-p)(-1) = 2p-1$

Then:

$\\dfrac{X_n}{n} = \\dfrac{1}{n}\\sum_{i=1}^nZ_n = 2p-1$

Therefore:

$X_n = n(2p-1)$

When $n\\to\\infty$, we have $X_n\\to\\infty$, which means any place can be only visited finite times.

## Solution (5)

$X_n\\to+\\infty$, then for any place less than $0$, $0$ is must visited 

## Solution (6)

We have:

$\\alpha = \\dfrac{1-p}{p}$

Then:

$\\beta =\\alpha p+(1-p) = 2(1-p)$

## Solution (7)

Same as [Solution 5](#solution-5)

## Solution (8)

Same as [Solution 6](#solution-6)

## Solution (9)

$\\beta = 2 \\min(p, 1-p)$

# Chapter 4

## Problem 14

> For each of the specified Markov chains below, classify the states and determine whether they are transient or recurrent. $ \\begin{array}{c} \\boldsymbol{P}_{1}=\\left[\\begin{array}{ccc} 0 & \\frac{1}{2} & \\frac{1}{2} \\\\ \\frac{1}{2} & 0 & \\frac{1}{2} \\\\ \\frac{1}{2} & \\frac{1}{2} & 0 \\end{array}\\right], \\quad \\boldsymbol{P}_{2}=\\left[\\begin{array}{cccc} 0 & 0 & 0 & 1 \\\\ 0 & 0 & 0 & 1 \\\\ \\frac{1}{2} & \\frac{1}{2} & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\end{array}\\right] \\\\ \\boldsymbol{P}_{3}=\\left[\\begin{array}{ccccc} \\frac{1}{2} & 0 & \\frac{1}{2} & 0 & 0 \\\\ \\frac{1}{4} & \\frac{1}{2} & \\frac{1}{4} & 0 & 0 \\\\ \\frac{1}{2} & 0 & \\frac{1}{2} & 0 & 0 \\\\ 0 & 0 & 0 & \\frac{1}{2} & \\frac{1}{2} \\\\ 0 & 0 & 0 & \\frac{1}{2} & \\frac{1}{2} \\end{array}\\right], \\quad \\boldsymbol{P}_{4}=\\left[\\begin{array}{ccccc} \\frac{1}{4} & \\frac{3}{4} & 0 & 0 & 0 \\\\ \\frac{1}{2} & \\frac{1}{2} & 0 & 0 & 0 \\\\ 0 & 0 & 1 & 0 & 0 \\\\ 0 & 0 & \\frac{1}{3} & \\frac{2}{3} & 0 \\\\ 1 & 0 & 0 & 0 & 0 \\end{array}\\right] \\end{array} $

## Solution 

$P_1$: all states communicates with each other.

All states are **recurrent**

---

$P_2$: $4\\to 3 \\to 1\\text{ or } 2\\to 4$

All staes are **recurrent**

---

$P_3$: no other path goes to $2$

Recurrent classes:

$\\{1,3\\}, \\{4,5\\}$

Transient classes:

$\\{2\\}$

---

$P_4$: no path goes to $5$, no other path goes to $4$


Recurrent classes:

$\\{1,2\\}, \\{3\\}$

Transient classes:

$\\{4\\},\\{5\\}$

## Problem 15

> Prove that if a Markov chain has $ M $ states and state $ j $ is reachable from state $ i $, then it can be reached in at most $ M $ steps.

## Solution 

If there are more than $M$ steps, we consider the index of the start and end, there must be a duplicated start index $m$ 

Then, $m$ is revisited, therefore, any path in between can be eliminated, until the path is not longer than $M$

## Problem 16 

## Solution 

If $P_{ij}\\ne 0$,$i\\to j, j \\nrightarrow i, $ then $i$ can't be recurrent, because there's a positive probability that $i\\to j$ and never comes back, resulting contradiction.

## Problem 20

> A transition probability matrix $ \\boldsymbol{P} $ is called doubly stochastic if the sum of each column is 1 , i.e., for all $ j $, 
> 
> $ \\sum_{i} P_{i j}=1 . $ 
> 
> If such a chain is irreducible and aperiodic with $ M+1 $ states $ 0,1, \\ldots, M $, prove that the long-run proportion is 
> 
> $ \\pi_{j}=\\frac{1}{M+1}, \\quad j=0,1, \\ldots, M $

## Solution 

`,x8=`# Markov Chain

## Definition 

1. $\\{X_n\\}$ finite

2. $ \\begin{array}{l}P\\left\\{X_{n+1}=j \\mid X_{n}=i, X_{n-1}=i_{n-1}, \\ldots X_{0}=i_{0}\\right\\} \\\\ =P\\left\\{X_{n+1}=j \\mid X_{n}=i\\right\\}=P_{i j},\\end{array} $`,w8=`# Problem

> Denote $N$ as the times needed to get three consecutive Heads when tossing a coin, find $P(N\\le 8)$

## Solution 

Denote $S_i$ as $i$ consecutive Heads happens, then:

$ P=\\left[\\begin{array}{llll}\\frac{1}{2} & \\frac{1}{2} & 0 & 0 \\\\ \\frac{1}{2} & 0 & \\frac{1}{2} & 0 \\\\ \\frac{1}{2} & 0 & 0 & \\frac{1}{2} \\\\ 0 & 0 & 0 & 1\\end{array}\\right] $
`,k8=`# Cheat sheet

$$
\\begin{array}{|c|c|c|c|c|}
\\hline
\\text{分布} & \\text{概率密度函数 (PDF)} & \\text{均值} & \\text{方差} & \\text{矩母函数 (MGF)} \\\\
\\hline
\\text{伯努利分布 } (p) & 
f(x) = p^x (1-p)^{1-x}, \\quad x \\in \\{0,1\\} & 
p & 
p(1-p) & 
1 - p + pe^t \\\\
\\hline
\\text{二项分布 } (n, p) & 
f(x) = \\binom{n}{x} p^x (1-p)^{n-x}, \\quad x \\in \\{0,1,\\dots,n\\} & 
np & 
np(1-p) & 
(1 - p + pe^t)^n \\\\
\\hline
\\text{泊松分布 } (\\lambda) & 
f(x) = \\frac{e^{-\\lambda} \\lambda^x}{x!}, \\quad x \\in \\{0,1,2,\\dots\\} & 
\\lambda & 
\\lambda & 
e^{\\lambda(e^t - 1)} \\\\
\\hline
\\text{几何分布 } (p) & 
f(x) = p(1-p)^{x-1}, \\quad x \\in \\{1,2,\\dots\\} & 
\\frac{1}{p} & 
\\frac{1-p}{p^2} & 
\\frac{pe^t}{1 - (1 - p)e^t} \\\\
\\hline
\\text{均匀分布 } (a, b) & 
f(x) = \\frac{1}{b-a}, \\quad x \\in [a,b] & 
\\frac{a + b}{2} & 
\\frac{(b - a)^2}{12} & 
\\frac{e^{tb} - e^{ta}}{t(b - a)} \\\\
\\hline
\\text{正态分布 } (\\mu, \\sigma^2) & 
f(x) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} e^{-\\frac{(x-\\mu)^2}{2\\sigma^2}}, \\quad x \\in \\mathbb{R} & 
\\mu & 
\\sigma^2 & 
e^{\\mu t + \\frac{1}{2}\\sigma^2 t^2} \\\\
\\hline
\\text{指数分布 } (\\lambda) & 
f(x) = \\lambda e^{-\\lambda x}, \\quad x \\geq 0 & 
\\frac{1}{\\lambda} & 
\\frac{1}{\\lambda^2} & 
\\frac{\\lambda}{\\lambda - t} \\\\
\\hline
\\text{伽马分布 } (\\alpha, \\beta) & 
f(x) = \\frac{\\beta^\\alpha x^{\\alpha-1} e^{-\\beta x}}{\\Gamma(\\alpha)}, \\quad x \\geq 0 & 
\\frac{\\alpha}{\\beta} & 
\\frac{\\alpha}{\\beta^2} & 
\\left(\\frac{\\beta}{\\beta - t}\\right)^\\alpha \\\\
\\hline
\\text{卡方分布 } (k) & 
f(x) = \\frac{x^{k/2-1} e^{-x/2}}{2^{k/2} \\Gamma(k/2)}, \\quad x \\geq 0 & 
k & 
2k & 
(1 - 2t)^{-k/2} \\\\
\\hline
\\end{array}
$$


# Probability

## Sample Space & Event

- Sample Space: $S$

- Event: $E$, a subset of $S$
  - Union: $E\\cup F$
    - $\\cup_{n=1}^\\infty E_n$
  - Intersection: $E\\cap F $ or $EF$
    - $\\cap_{n=1}^\\infty E_n$
  - Mutually Exclusive: $EF = \\oslash$
  - Complement: $E^c$


## Inclusion-Exclusion Principle

> $P(E\\cup F) = P(E) + P(F) - P(EF)$


## Conditional Probability

> $P(E|F) = \\dfrac{P(EF)}{P(F)}, P(F)>0$

## Independent Event

Events Independent if:

> $P(EF) = P(E)P(F)$
> - Or: $P(E|F) = P(E)$

For multiple events:

> $P(E_1\\dots E_r) = P(E_1)\\dots P(E_r), \\forall r\\le n$

## Bayes' Rule 

> $ P\\left(F_{j} \\mid E\\right)=\\dfrac{P\\left(F_{j} E\\right)}{P(E)}=\\dfrac{P\\left(E \\mid F_{j}\\right) P\\left(F_{j}\\right)}{\\sum_{i=1}^{n} P\\left(E \\mid F_{i}\\right) P\\left(F_{i}\\right)} $
> - $F_1,\\dots,F_n$ mutually exclusive 
> - Notice: $ \\cup_{i=1}^{n} F_{i}=S $
>
> Some corollaries:
>
> $ E=E \\cap S=E \\cap\\left(F \\cup F^{c}\\right)=E F \\cup E F^{c} $
>
> $ P(E)=P(E \\mid F) P(F)+P\\left(E \\mid F^{c}\\right) P\\left(F^{c}\\right) $
>
> $ P(D \\mid E)=\\dfrac{P(D E)}{P(E)}=\\dfrac{P(E \\mid D) P(D)}{P(E \\mid D) P(D)+P\\left(E \\mid D^{c}\\right) P\\left(D^{c}\\right)} $

# Random Variable (RV)

- $X$: Bounded Real Function definitioned on Sample Space 

- $F(\\cdot)$: Cumulative Distribution Function (CDF)
- $F(b) = P\\{X\\le b\\}, \\forall b $
  - $F(b)$ non-decreasing 
  - $ \\lim _{b \\rightarrow \\infty} F(b)=F(\\infty)=1 $
  - $ \\lim _{b \\rightarrow-\\infty} F(b)=F(-\\infty)=0 $
  - $ P(X<b)=\\lim _{h \\rightarrow 0^{+}} F(b-h) $

## Discrete Random Variable

- Probability Distribution Function (PDF)

$ p(a)=P\\{X=a\\} $

- Bernoulli 
- Binom 
- Geometry 
- Possion 

A special case:

When a Binom Distribution with small $p$ and large $n$

$$
\\begin{aligned}
&p(i)\\\\ 
=& \\binom{n}{i}p^i(1-p)^{n-i}\\\\ 
=& \\dfrac{n!}{i!(n-i)!}p^i(1-p)^{n-i}\\\\
\\overset{\\lambda=np}{=}&
\\dfrac{n(n-1)\\dots(n-i+1)}{i!}\\cdot\\dfrac{\\lambda^i}{n^i}\\cdot\\dfrac{(1-\\frac{\\lambda}{n})^n}{(1-\\frac{\\lambda}{n})^i}\\\\ 
=&1\\cdot \\dfrac{\\lambda^i}{n^i}\\cdot\\dfrac{e^{-\\lambda}}{1}\\\\
=&e^{-\\lambda}\\dfrac{\\lambda^i}{i!}
\\end{aligned}
$$

## Continuous Random Variable

pdf:

$P\\{X\\in B\\} = \\int_B f(x)dx, \\forall B$

An important approximation:
- $\\int_{a - \\epsilon/2}^{a +\\epsilon/2} f(x)dx \\approx \\epsilon f(a)$

cdf:

$F(a) = P\\{X\\in(-\\infty, a]\\} = \\int_{-\\infty}^a f(x)dx$

- Uniform
- Exponential
- Gamma
- Normal

## Expectation

Discrete:

- $E(X) = \\sum_{x:p(x)>0}xp(x)$

Continuous:

- $E(x) = \\int_{-\\infty}^{\\infty}xf(x)dx$

$$
\\begin{array}{|l|l|}
\\hline Bernoulli & p\\\\ 
\\hline Binom & np\\\\ 
\\hline Geometry & 1/p \\\\ 
\\hline Possion & \\lambda \\\\ 
\\hline Uniform & (\\alpha + \\beta) / 2 \\\\ 
\\hline Exponential & \\alpha / \\lambda \\\\ 
\\hline Normal & \\mu \\\\ 
\\hline
\\end{array}
$$

Corollaries:

- For Discrete RV:
  - $E[g(x)] = \\sum_{x:p(x)>0} g(x)p(x) $
- For Continuous RV:
  - $E[g(x)] = \\int_{-\\infty}^\\infty g(x)f(x)dx$

---

Moment:

- $E(X^n)$

Variation:

- $Var(X) = E[(X-E[X])^2] = E(X^2)-(EX)^2$

## Joint Distributino 

CDF:

$F(a,b) = P\\{X\\le a, Y\\le b\\}, -\\infty < a,b < \\infty $

PDF:

$p(x,y) = P\\{X=x, Y=y\\}$

Expectation:

- $E[g(X,Y)] = \\sum_x\\sum_y g(x,y)p(x,y)$
- $E[g(X,Y)] = \\int_{-\\infty}^\\infty\\int_{-\\infty}^\\infty g(x,y)f(x,y)dxdy$

### Independent

They are Independent if: $F(a,b) = F_X(a)F_Y(b),\\forall a,b$

- Discrete: $p(x,y) = p_X(x)p_Y(y)$
- Continuous: $f(x,y) = f_X(x)f_Y(y)$

If Independent:
- $E[g(X)h(Y)] - E[g(X)]E[h(Y)]$

### Covariation

$Cov(X,Y) = E[(X-E[X])(Y-E[Y])] = E[XY] - E[X]E[Y]$

- $Cov(X,X) = Var(X)$
- $Cov(X,Y) = Cov(Y,X)$
- $Cov(cX,Y) = cCov(X,Y)$
- $Cov(\\sum_{i=1}^n X_i,\\sum_{j=1}^m Y_j) = \\sum_{i=1}^n\\sum_{j=1}^m Cov(X_i, Y_j)$
- $Var(\\sum_{i=1}^n X_i) = \\sum_{i=1}^n Var(X_i) + 2\\sum_{i=1}^n \\sum_{j<i} Cov(X_i, X_j)$
- If $X,Y$ Independent, $Cov(X,Y) = =0$

---

Sample Average:

for i.i.d. RV:

$\\bar{X} = \\sum_{i=1}^n X_i / n$

- $E[\\bar{X}]= \\mu$
- $Var(\\bar{X}) = \\sigma^2/n$
- $Cov(\\bar{X},X_i-\\bar{X})=0$

---

Convolution:

Discrete:

- $P_{X+Y }(a) = \\sum_{y=-\\infty }^{+\\infty }P_X(a-y)P_Y(y)$

Continuous
- $F_{X+Y }(a) = \\int_{-\\infty }^\\infty F_X(a-y) g(y)dy $

---

Multivariate Transformation

Given $ n $ random variables $ X_{1}, \\ldots, X_{n} $ with a known joint density function, we aim to compute the joint density function of the transformed variables $ Y_{1}, \\ldots, Y_{n} $, where:
- $ Y_{1}=g_{1}\\left(X_{1}, \\ldots, X_{n}\\right), \\ldots, Y_{n}=g_{n}\\left(X_{1}, \\ldots, X_{n}\\right) $,
- Each $ g_{i} $ has continuous partial derivatives,
- The Jacobian determinant $ J\\left(x_{1}, \\ldots, x_{n}\\right) $ is non-zero at all points $ \\left(x_{1}, \\ldots, x_{n}\\right) $,
- The system of equations $ y_{1}=g_{1}\\left(x_{1}, \\ldots, x_{n}\\right), \\ldots, y_{n}=g_{n}\\left(x_{1}, \\ldots, x_{n}\\right) $ has a unique solution $ x_{i}=h_{i}\\left(y_{1}, \\ldots, y_{n}\\right) $.

Jacobian Determinant:
$
J\\left(x_{1}, \\ldots, x_{n}\\right)=\\left|\\begin{array}{ccc}
\\frac{\\partial g_{1}}{\\partial x_{1}} & \\cdots & \\frac{\\partial g_{1}}{\\partial x_{n}} \\\\
\\vdots & \\ddots & \\vdots \\\\
\\frac{\\partial g_{n}}{\\partial x_{1}} & \\cdots & \\frac{\\partial g_{n}}{\\partial x_{n}}
\\end{array}\\right|
$

Joint Density Function of $ Y_{1}, \\ldots, Y_{n} $
$
f_{Y_{1}, \\ldots, Y_{n}}\\left(y_{1}, \\ldots, y_{n}\\right)=f_{X_{1}, \\ldots, X_{n}}\\left(h_{1}\\left(y_{1}, \\ldots, y_{n}\\right), \\ldots, h_{n}\\left(y_{1}, \\ldots, y_{n}\\right)\\right) \\cdot\\left|J\\left(h_{1}, \\ldots, h_{n}\\right)\\right|^{-1}
$
where $ |J|^{-1} $ is the absolute value of the reciprocal of the Jacobian determinant evaluated at $ x_{i}= $ $ h_{i}\\left(y_{1}, \\ldots, y_{n}\\right) $.

#### Example for Jacobian Matrix 

(1):

> Assume $X_1,X_2\\sim N(0,1$ i.i.d. and $Y_1 = X_1+X_2,Y_2 = X_1-X_2$

We have:

$ X_{1}=\\frac{Y_{1}+Y_{2}}{2}, \\quad X_{2}=\\frac{Y_{1}-Y_{2}}{2} $

The Jacobian Matrix:

$ J=\\left|\\begin{array}{ll}\\frac{\\partial Y_{1}}{\\partial X_{1}} & \\frac{\\partial Y_{1}}{\\partial X_{2}} \\\\ \\frac{\\partial Y_{2}}{\\partial X_{1}} & \\frac{\\partial Y_{2}}{\\partial X_{2}}\\end{array}\\right|=\\left|\\begin{array}{cc}1 & 1 \\\\ 1 & -1\\end{array}\\right|=-2 \\Longrightarrow|J|^{-1}=\\frac{1}{2} $

Therefore:

$ f_{Y_{1}, Y_{2}}\\left(y_{1}, y_{2}\\right)=f_{X_{1}, X_{2}}\\left(\\frac{y_{1}+y_{2}}{2}, \\frac{y_{1}-y_{2}}{2}\\right) \\cdot \\frac{1}{2} $

We have:

$ f_{X_{1}, X_{2}}\\left(x_{1}, x_{2}\\right)=\\frac{1}{2 \\pi} e^{-\\frac{x_{1}^{2}+x_{2}^{2}}{2}} $

Then we get:

$ f_{Y_{1}, Y_{2}}\\left(y_{1}, y_{2}\\right)=\\frac{1}{4 \\pi} e^{-\\frac{y_{1}^{2}+y_{2}^{2}}{4}} $

Therefore, $Y_1, Y_2\\sim N(0,2)$

---

(2)

> Assume $ U_{1}, U_{2} \\sim \\operatorname{Uniform}(0,1) $, and $ Y_{1}=\\sqrt{-2 \\ln U_{1}} \\cos \\left(2 \\pi U_{2}\\right), \\quad Y_{2}=\\sqrt{-2 \\ln U_{1}} \\sin \\left(2 \\pi U_{2}\\right) $

We have:

$ U_{1}=e^{-\\frac{Y_{1}^{2}+Y_{2}^{2}}{2}}, \\quad U_{2}=\\frac{1}{2 \\pi} \\arctan \\left(\\frac{Y_{2}}{Y_{1}}\\right) $

Then Jacobian Matrix:

$ |J|=\\frac{1}{2 \\pi} e^{-\\frac{Y_{1}^{2}+Y_{2}^{2}}{2}} $, therefore $ |J|^{-1}=2 \\pi e^{\\frac{Y_{1}^{2}+Y_{2}^{2}}{2}} $

$ f_{Y_{1}, Y_{2}}\\left(y_{1}, y_{2}\\right)=f_{U_{1}, U_{2}}\\left(u_{1}, u_{2}\\right) \\cdot|J|^{-1}=1 \\cdot 2 \\pi e^{\\frac{v_{1}^{2}+v_{2}^{2}}{2}} \\cdot \\frac{1}{2 \\pi} e^{-\\frac{v_{1}^{2}+v_{2}^{2}}{2}}=\\frac{1}{2 \\pi} e^{-\\frac{-v_{1}^{2}+v_{2}^{2}}{2}} $

Therefore, $Y_1, Y_2\\sim N(0,1)$

---

(3)

> Assume $ X_{1}, X_{2} \\sim \\operatorname{Exp}(\\lambda) $ and $ Y_{1}=\\frac{X_{1}}{X_{2}}, \\quad Y_{2}=X_{2} $

We have:

$ X_{1}=Y_{1} Y_{2}, \\quad X_{2}=Y_{2} $

For Jacobian Matrix:

$ J=\\left|\\begin{array}{cc}\\frac{\\partial X_{1}}{\\partial Y_{1}} & \\frac{\\partial X_{1}}{\\partial Y_{2}} \\\\ \\frac{\\partial X_{2}}{\\partial Y_{1}} & \\frac{\\partial X_{2}}{\\partial Y_{2}}\\end{array}\\right|=\\left|\\begin{array}{cc}Y_{2} & Y_{1} \\\\ 0 & 1\\end{array}\\right|=Y_{2} \\Longrightarrow|J|^{-1}=\\frac{1}{\\left|Y_{2}\\right|} $

Then:

$ f_{Y_{1}, Y_{2}}\\left(y_{1}, y_{2}\\right)=f_{X_{1}, X_{2}}\\left(y_{1} y_{2}, y_{2}\\right) \\cdot \\frac{1}{\\left|y_{2}\\right|}=\\lambda^{2} e^{-\\lambda\\left(y_{1} y_{2}+y_{2}\\right)} \\cdot y_{2} $



---

## Moment Generating Function

Moment Generating Function (MGF) of a Random Variable $ X $ :
$
\\phi(t)=E\\left(e^{t X}\\right)=\\left\\{\\begin{array}{ll}
\\sum_{x} e^{t x} p(x) & \\text { (for discrete random variables) } \\\\
\\int_{-\\infty}^{\\infty} e^{t x} f(x) d x & \\text { (for continuous random variables) }
\\end{array}\\right.
$

1. Calculating Moments:

$
E\\left[X^{n}\\right]=\\phi^{(n)}(0)
$

- $ \\phi^{(n)}(t) $ is the $ n $-th derivative of $ \\phi(t) $.

2. Sum of Independent Random Variables:

> The MGF of the sum of independent random variables is the product of their individual MGFs. 

That is, if $ X_{1}, X_{2}, \\ldots, X_{n} $ are independent, then:

$
\\phi_{X_{1}+X_{2}+\\cdots+X_{n}}(t)=\\phi_{X_{1}}(t) \\cdot \\phi_{X_{2}}(t) \\cdots \\phi_{X_{n}}(t)
$
3. Uniqueness of Distribution:

The moment generating function uniquely determines the probability distribution of a random variable (if it exists).

4. Connection to Laplace Transform:

For $ t \\geq 0 $ and a non-negative random variable $ X $, the function $ g(t)=\\phi(-t)\\in [0,1] $. This is related to the Laplace transform of the distribution of $ X $.

5. Joint MGF:
- $\\phi (t_1,\\dots, t_n) = E[e^{(t_1X_1+\\cdots+t_nX_n)}]$

--- 

**Binomial MGF**

$ M_{X}(t)=\\sum_{k=0}^{n} e^{t k}\\binom{n}{k} p^{k}(1-p)^{n-k}=\\sum_{k=0}^{n}\\binom{n}{k}\\left(p e^{t}\\right)^{k}(1-p)^{n-k} $

We get:

$ M_{X}(t)=\\left(p e^{t}+(1-p)\\right)^{n} $

**Poisson MGF**

$ M_{X}(t)=\\sum_{k=0}^{\\infty} e^{t k} \\frac{\\lambda^{k} e^{-\\lambda}}{k!}=e^{-\\lambda} \\sum_{k=0}^{\\infty} \\frac{\\left(\\lambda e^{t}\\right)^{k}}{k!} $

Then: 

$ M_{X}(t)=e^{-\\lambda} \\cdot e^{\\lambda e^{t}}=e^{\\lambda\\left(e^{t}-1\\right)} $

**Normal MGF**

$ M_{X}(t)=\\int_{-\\infty}^{\\infty} e^{t x} \\cdot \\frac{1}{\\sqrt{2 \\pi \\sigma^{2}}} e^{-\\frac{(x-\\mu)^{2}}{2 \\sigma^{2}}} d x $

Look at the power:

$ t x-\\frac{(x-\\mu)^{2}}{2 \\sigma^{2}}=-\\frac{x^{2}-2\\left(\\mu+\\sigma^{2} t\\right) x+\\mu^{2}}{2 \\sigma^{2}} $

Then: 

$ M_{X}(t)=e^{\\mu t+\\frac{\\sigma^{2} t^{2}}{2}} $

**Exponential MGF**

$ M_{X}(t)=\\int_{0}^{\\infty} e^{t x} \\cdot \\lambda e^{-\\lambda x} d x=\\lambda \\int_{0}^{\\infty} e^{-(\\lambda-t) x} d x $

Then: 

$ M_{X}(t)=\\lambda \\cdot \\frac{1}{\\lambda-t}=\\frac{\\lambda}{\\lambda-t} \\quad(t<\\lambda) $

**Gamma MGF**

$ M_{X}(t)=\\int_{0}^{\\infty} e^{t x} \\cdot \\frac{\\lambda^{\\alpha}}{\\Gamma(\\alpha)} x^{\\alpha-1} e^{-\\lambda x} d x=\\frac{\\lambda^{\\alpha}}{(\\lambda-t)^{\\alpha}} \\cdot \\frac{\\Gamma(\\alpha)}{\\Gamma(\\alpha)} $

Then:

$ M_{X}(t)=\\left(\\frac{\\lambda}{\\lambda-t}\\right)^{\\alpha} $


## Theorem

### 1. Markov's Inequality (Proposition 2.6)

Statement:
Let $ X $ be a non-negative random variable. For any $ a>0 $ :
$
P\\{X \\geq a\\} \\leq \\frac{E\\lfloor X]}{a}
$

Proof:
Define the indicator function:
$
I_{\\{X \\geq a\\}}=\\left\\{\\begin{array}{ll}
1 & \\text { if } X \\geq a \\\\
0 & \\text { otherwise }
\\end{array}\\right.
$

Since $ X \\geq a \\cdot I_{\\{X \\geq a\\}} $, taking expectations on both sides:
$
E[X] \\geq E\\left[a \\cdot I_{\\{X \\geq a\\}}\\right]=a \\cdot P\\{X \\geq a\\}
$

Rearranging gives:
$
P\\{X \\geq a\\} \\leq \\frac{E[X]}{a}
$

### 2. Chebyshev's Inequality (Proposition 2.7)

Statement:
Let $ X $ be a random variable with mean $ \\mu $ and variance $ \\sigma^{2} $. For any $ k>0 $ :
$
P\\{|X-\\mu| \\geq k\\} \\leq \\frac{\\sigma^{2}}{k^{2}}
$

Proof:
Apply Markov's Inequality to the non-negative random variable $ (X-\\mu)^{2} $ :
$
P\\{|X-\\mu| \\geq k\\}=P\\left\\{(X-\\mu)^{2} \\geq k^{2}\\right\\} \\leq \\frac{E\\left[(X-\\mu)^{2}\\right]}{k^{2}}=\\frac{\\sigma^{2}}{k^{2}}
$

### 3. Strong Law of Large Numbers (Theorem 2.1)

Statement:
Let $ X_{1}, X_{2}, \\ldots $ be independent and identically distributed (i.i.d.) random variables with mean $ \\mu $. Then, as $ n \\rightarrow \\infty $ :
$
\\frac{X_{1}+X_{2}+\\cdots+X_{n}}{n} \\rightarrow \\mu \\quad \\text { with probability } 1 .
$

Proof Sketch (Simplified):
The full proof requires advanced tools (e.g., Borel-Cantelli lemma or martingale convergence). A key idea is to show that the sample mean converges almost surely by bounding the variance of partial sums. For i.i.d. variables:
1. Convergence in $ L^{2} $ :
$
\\operatorname{Var}\\left(\\frac{X_{1}+\\cdots+X_{n}}{n}\\right)=\\frac{\\sigma^{2}}{n} \\rightarrow 0 \\quad \\text { as } n \\rightarrow \\infty .
$
2. Borel-Cantelli Lemma:

For $ \\epsilon>0 $, use Chebyshev's inequality to show:
$
\\sum_{n=1}^{\\infty} P\\left(\\left|\\frac{S_{n}}{n}-\\mu\\right| \\geq \\epsilon\\right)<\\infty
$
implying almost sure convergence.

### 4. Central Limit Theorem (Theorem 2.2)

Statement:
Let $ X_{1}, X_{2}, \\ldots $ be i.i.d. random variables with mean $ \\mu $ and variance $ \\sigma^{2} $. As $ n \\rightarrow \\infty $, the distribution of the standardized sum converges to the standard normal distribution:
$
\\frac{X_{1}+\\cdots+X_{n}-n \\mu}{\\sqrt{n} \\sigma} \\xrightarrow{d} N(0,1) .
$

Equivalently:
$
P\\left\\{\\frac{X_{1}+\\cdots+X_{n}-n \\mu}{\\sqrt{n} \\sigma} \\leq a\\right\\} \\rightarrow \\frac{1}{\\sqrt{2 \\pi}} \\int_{-\\infty}^{a} e^{-x^{2} / 2} d x
$

Proof Sketch (Using Moment Generating Functions):
1. Standardization:

Let $ Y_{i}=\\frac{X_{i}-\\mu}{\\sigma} $, so $ E\\left[Y_{i}\\right]=0, \\operatorname{Var}\\left(Y_{i}\\right)=1 $.

2. MGF of the Sum:

The MGF of $ S_{n}=\\frac{Y_{1}+\\cdots+Y_{n}}{\\sqrt{n}} $ is:
$
M_{S_{n}}(t)=\\left(M_{Y}\\left(\\frac{t}{\\sqrt{n}}\\right)\\right)^{n}
$

3. Taylor Expansion:

Expand $ M_{Y}\\left(\\frac{t}{\\sqrt{n}}\\right) $ around $ t=0 $ :
$
M_{Y}\\left(\\frac{t}{\\sqrt{n}}\\right)=1+\\frac{t^{2}}{2 n}+o\\left(\\frac{1}{n}\\right)
$

4. Limit as $ n \\rightarrow \\infty $ :
$
\\lim _{n \\rightarrow \\infty} M_{S_{n}}(t)=e^{t^{2} / 2}
$
which is the MGF of $ N(0,1) $. By uniqueness of MGFs, the result follows.

### 5. Composed Random Variable Equality

For all $h$:

$ 
\\mathrm{E}\\left[S_{N} h\\left(S_{N}\\right)\\right]=\\mathrm{E}[N] \\mathrm{E}\\left[X_{1} h\\left(S_{M}\\right)\\right]
$

Where:

$P\\{M=n\\} = \\dfrac{nP\\{N=n\\}}{E[N]}$

Proof:

$$
\\begin{aligned}
&\\mathrm{E}\\left[S_{N} h\\left(S_{N}\\right)\\right]\\\\ 
&=\\mathrm{E}\\left[\\sum_{i=1}^{N} X_{i} h\\left(S_{N}\\right)\\right] \\\\ 
& =\\sum_{n=0}^{\\infty} \\mathrm{E}\\left[\\sum_{i=1}^{n} X_{i} h\\left(S_{N}\\right) \\mid N=n\\right] \\cdot \\mathrm{P}\\{N=n\\} \\\\ 
& = \\sum_{n=0}^{\\infty} n \\cdot \\mathrm{E}\\left[X_{1} h\\left(S_{n}\\right)\\right] \\cdot \\mathrm{P}\\{N=n\\} \\\\ 
&= \\mathrm{E}[N] \\cdot \\sum_{n=0}^{\\infty} \\mathrm{E}\\left[X_{1} h\\left(S_{n}\\right)\\right] \\cdot \\frac{n \\mathrm{P}\\{N=n\\}}{\\mathrm{E}[N]}\\\\ 
&=\\mathrm{E}[N] \\mathrm{E}\\left[X_{1} h\\left(S_{M}\\right)\\right]
\\end{aligned}
$$

### 6. A corollary

$
\\begin{array}{l}
\\mathrm{P}\\left\\{S_{N}=0\\right\\}=\\mathrm{P}\\{N=0\\} \\\\
\\mathrm{P}\\left\\{S_{N}=k\\right\\}=\\frac{1}{k} \\mathrm{E}[N] \\sum_{j=1}^{k} j \\alpha_{j} \\mathrm{P}\\left\\{S_{M-1}=k-j\\right\\}, \\quad k>0
\\end{array}
$

Proof:

Choose $h$ as indicator function, we get:

$ \\mathrm{P}\\left\\{S_{N}=k\\right\\}=\\frac{\\mathrm{E}[N]}{k} \\cdot \\mathrm{E}\\left[X_{1} \\mathbf{1}_{\\left\\{S_{M}=k\\right\\}}\\right] $

Then for RHS:

$$
\\begin{aligned}
& \\mathrm{E}\\left[X_{1} \\mathbf{1}_{\\left\\{S_{M}=k\\right\\}}\\right] \\\\ 
&=\\sum_{n=1}^{\\infty} \\mathrm{P}\\{M=n\\} \\cdot \\mathrm{E}\\left[X_{1} \\mathbf{1}_{\\left\\{S_{M}=k\\right\\}} \\mid M=n\\right] \\\\
& =\\sum_{n=1}^{\\infty} \\mathrm{P}\\{M=n\\}  \\cdot \\mathrm{E}\\left[X_{1} \\mathbf{1}_{\\left\\{S_{n}=k\\right\\}}\\right]\\\\
&=\\sum_{n=1}^{\\infty} \\mathrm{P}\\{M=n\\}  \\cdot \\sum_{j=1}^{k} j \\alpha_{j} \\cdot \\mathrm{P}\\left\\{S_{n-1}=k-j\\right\\} \\\\ 
& =\\sum_{j=1}^{k} j \\alpha_{j} \\cdot \\sum_{n=1}^{\\infty} \\mathrm{P}\\{M=n\\} \\cdot \\mathrm{P}\\left\\{S_{n-1}=k-j\\right\\} \\\\
&=\\sum_{j=1}^{k} j \\alpha_{j} \\cdot \\mathrm{P}\\left\\{S_{M-1}=k-j\\right\\}\\\\  
\\end{aligned}
$$

Finally:

$ \\mathrm{P}\\left\\{S_{N}=k\\right\\}=\\frac{\\mathrm{E}[N]}{k} \\cdot \\sum_{j=1}^{k} j \\alpha_{j} \\cdot \\mathrm{P}\\left\\{S_{M-1}=k-j\\right\\} $





placeholder


placeholder

placeholder

placeholder

placeholder

placeholder

`,S8=`# 2

## (1)

### Problem

> Are $ \\cup_{n=1}^{\\infty} E_{n} $ and $ \\cap_{n=1}^{\\infty} E_{n} $ events? If so, what do they represent?

### Solution

Yes, they are events.

$\\cup_{n=1}^\\infty E_n$ is the event that one of them happens

$\\cap_{n=1}^\\infty E_n$ is the event that all of them happen

## (2)

### Problem 

> Example: Three pairwise independent events that are not mutually independent.

### Solution 

Consider following setting:

$\\Omega = \\{\\omega_1,\\omega_2,\\omega_3,\\omega_4\\}, E_1 = \\{\\omega_1,\\omega_2\\}, E_2 = \\{\\omega_1,\\omega_3\\}, E_3 = \\{\\omega_1,\\omega_4\\}$

Then:

$P(E_1E_2) =\\dfrac{1}{4}, P(E_1)P(E_2) = \\dfrac{1}{2}\\cdot\\dfrac{1}{2} = \\dfrac{1}{4}$

same goes for $E_1E_3, E_2E_3$

However:

$P(E_1E_2E_3) = \\dfrac{1}{4}, P(E_1)P(E_2)P(E_3) = \\dfrac{1}{2}\\cdot\\dfrac{1}{2}\\cdot\\dfrac{1}{2} = \\dfrac{1}{8}$

## (3)

### Problem

> Statement: If $ F_{1}, \\ldots, F_{n} $ are mutually exclusive and exhaustive $ \\left(\\cup_{i=1}^{n} F_{i}=S\\right) $, then: $ P(E)=\\sum_{i=1}^{n} P\\left(E \\mid F_{i}\\right) P\\left(F_{i}\\right) . $

### Proof

Notice:

$P(E|F_i)P(F_i) = P(EF_i)$

Since $F_i\\cap F_j = \\oslash,\\forall i\\ne j$

We can get:

$EF_i\\cap EF_j = E(F_i\\cap F_j) = \\oslash$

Then:

$P(E) = P(ES) = P(E(\\cup_{i=1}^n F_i)) = \\sum_{i=1}^n P(EF_i) = \\sum_{i=1^n} P(E|F_i)P(F_i)$

## (4)

### Problem 

> Write Binomial Theorem

### Solution 

For any integers $ n \\geq 0 $ and real numbers $ a, b $ :
$
(a+b)^{n}=\\sum_{k=0}^{n}\\binom{n}{k} a^{n-k} b^{k} .
$

## (5)

### Problem 

> Expectation of $ X $ if $ Y=X+1 $ is Geometric

### Solution 

Since: $E[Y] = \\dfrac{1}{p}$

Then: $E[X] = E[Y-1] = E[Y]-1 = \\dfrac{1}{p} - 1$

## (6)

### Problem 

> Distribution of $ X+Y $ for Independent Poisson Variables

### Solution 

Assuming: $p(x) = e^{-\\lambda_1}\\dfrac{\\lambda_1^x}{x!},p(y) = e^{-\\lambda_2}\\dfrac{\\lambda_2^y}{y!},$

Then for $X+Y$

$\\begin{aligned}
&P(X+Y= z)\\\\ 
 &= \\sum_{i=0}^{z}e^{-\\lambda_1}\\dfrac{\\lambda_1^i}{i!}e^{-\\lambda_2}\\dfrac{\\lambda_2^{z-i}}{(z-i)!} \\\\
&=e^{-(\\lambda_1+\\lambda_2)}\\sum_{i=0}^{z}\\dfrac{\\lambda^i_1\\lambda_2^{z-i}}{i!(z-i)!} 
 \\end{aligned}$

Notice:

$(\\lambda_1+\\lambda_2)^z = z! \\sum_{i=0}^{z}\\dfrac{\\lambda^i_1\\lambda_2^{z-i}}{i!(z-i)!} $

Then:

$P(X+Y = z) =e^{-(\\lambda_1+\\lambda_2)}\\dfrac{(\\lambda_1+\\lambda_2)^z}{z!} $

Therefore:

$X+Y\\sim \\text{Poi}(\\lambda_1+\\lambda_2)$

## (7)

### Problem 

> Expected Number of Tosses Until First Head

### Solution 

Denote $E$ as "First toss is Head",then:

$\\begin{aligned}
&E(X)\\\\
& = E(X|E)P(E) + E(X|E^c)P(E^c) \\\\
&= 1\\cdot p + (\\dfrac{1}{p}+1)\\cdot (1-p)\\\\ 
&= \\dfrac{1}{p}
\\end{aligned}$

## (8)

### Problem 

> Consider $ n $ independent trials, where each trial results in one of $ 1, \\ldots, r $ with probabilities $ p_{1}, \\ldots, p_{r} $, respectively, such that $ p_{1}+\\cdots+p_{r}=1 $. Let $ N_{i} $ denote the number of trials resulting in outcome $ i $. The vector $ \\left(N_{1}, \\ldots, N_{r}\\right) $ follows a multinomial distribution. Using the conditional expectation formula, compute $ \\operatorname{Cov}\\left(N_{i}, N_{j}\\right) $

### Solution 

We have:

$E[N_i] = np_i$

Notice: $(N_i | N_j=y) \\sim \\text{B}(n-y, \\dfrac{p_i}{1-p_j})$

Then:

$E[N_iN_j|N_j=y] =y(n-y)\\dfrac{p_i}{1-p_j} $

$\\begin{aligned}
&E[N_iN_j]\\\\ 
&=E[E[N_iN_j|N_j]]\\\\ 
&=\\sum_{y=0}^n y(n-y)\\dfrac{p_i}{1-p_j}\\cdot \\binom{n}{y}p_j^y (1-p_j)^{n-y}
\\end{aligned}
$

Notice:

$\\sum_{y=0}^n y\\binom{n}{y}p_j^y (1-p_j)^{n-y} = E[N_j] = np_j$

$\\sum_{y=0}^n y^2\\binom{n}{y}p_j^y (1-p_j)^{n-y} = E[N_j^2] =(E[N_j])^2 + Var[N_j]= n^2p_j^2 + np_j(1-p_j)$

Then:

$$
\\begin{aligned}
&E[N_iN_j]\\\\ 
&=\\dfrac{p_i}{1-p_j}(n^2p_j- n^2p_j^2 - np_j(1-p_j))\\\\
&= p_i (n^2p_j - np_j)\\\\
&= n(n-1)p_ip_j
\\end{aligned}
$$

Then:

$\\begin{aligned} 
&Cov(N_j,N_j)\\\\ 
& = E[N_iN_j] - E[N_i]E[N_j] \\\\ 
&= n(n-1)p_ip_j - np_i\\cdot np_j\\\\ 
&=-np_ip_j 
\\end{aligned}
$

## (9)

### Problem 

> 9. Let $ X_{1}, X_{2}, \\ldots $ be i.i.d. random variables, and $ N $ be a non-negative integer-valued random variable independent of the $ X $-sequence. Define $ S_{0}=0 $ and $ S_{N}=\\sum_{i=1}^{N} X_{i} $ (a compound random variable). Assume $ N $ follows a Poisson distribution with mean $ \\lambda $.Assume $X_i$ is interger random variable, $P\\{X_1 = j\\} = a_j, j>0$. Moreover, $\\mathrm{P}\\{M=n\\}=\\frac{n \\mathrm{P}\\{N=n\\}}{\\mathrm{E}[N]}$. Find an expression for $ P_{n}= $ $ P\\left\\{S_{N}=n\\right\\}, n=0,1, \\ldots $

### Solution 

We have:

$
\\begin{aligned}
&P_n \\\\ 
&= \\sum_{k=0}^\\infty P(S_k=n)\\cdot P(N=k)\\\\ 
&=\\sum_{k=0}^n P(S_k=n)\\cdot P(N=k)\\\\ 
&=\\sum_{k=0}^n P(S_k=n)\\cdot e^{-\\lambda}\\dfrac{\\lambda^k}{k!}\\\\ 
\\end{aligned}
$

With MGF:

$\\phi(t) = E[e^{tS_N}]= \\sum_{n=0}^\\infty P_n e^{tn}$

$\\phi'(t) = \\sum_{n=0}^\\infty nP_ne^{tn}$

On the other hand:

$
\\begin{aligned}
&E[e^{tS_N}]\\\\ 
&= E[E[e^{tS_N}|N]]\\\\ 
&=E[(E[e^{tX_1}])^N]\\\\ 
&=e^{\\lambda(E[e^{tX_1}]-1)}\\\\ 
&=e^{\\lambda(\\sum_{j=1}^\\infty (a_j e^{tj})-1)}
\\end{aligned}
$

Then:

$\\phi'(t) = \\lambda \\sum_{j=1}^\\infty (ja_j e^{tj})\\phi(t)$

Replace $\\phi(t) $ and $\\phi'(t)$, we get:

$\\sum_{n=0}^{\\infty}nP_ne^{tn}= \\lambda \\sum_{j=1}^\\infty (ja_j e^{tj})\\sum_{n=0}^\\infty P_n e^{tn}$

To match the power of $e$, we get:

$nP_n = \\lambda \\sum_{j=1}^n ja_j P_{n-j}$

That is:

$ P_{n}=\\left\\{\\begin{array}{ll}e^{-\\lambda} & \\text { if } n=0, \\\\ \\frac{\\lambda}{n} \\sum_{j=1}^{n} j a_{j} P_{n-j} & \\text { if } n \\geq 1 .\\end{array}\\right. $


## (10)

### Problem 

> 10. If $ N $ follows a binomial distribution with parameters $ r $ and $ p $, find $ P_{n}=P\\left\\{S_{N}=n\\right\\}, n= $ $ 0,1, \\ldots $.

### Solution 

Notice:

$(M-1)\\sim \\text{B}(r-1,p)$

With the corollary:

$ \\mathrm{P}\\left\\{S_{N}=k\\right\\}=\\frac{\\mathrm{E}[N]}{k} \\cdot \\sum_{j=1}^{k} j \\alpha_{j} \\cdot \\mathrm{P}\\left\\{S_{M-1}=k-j\\right\\}, k>0 $

We denote $P_r(k) = P(S_{N_{(r)}}=k)$, where $N(r)\\sim \\text{B}(r,p)$, then:

$P_r(0) = (1-p)^r$

$P_r(k) = \\dfrac{rp}{k}\\sum_{j=1}^k ja_j P_{r-1}(k-j), k>0$

---

# Chapter 1

## 10

### Problem 

> Prove Bool's Inequality: $ \\mathrm{P}\\left(\\bigcup_{i=1}^{n} E_{i}\\right) \\leqslant \\sum_{i=1}^{n} \\mathrm{P}\\left(E_{i}\\right) $

### Solution 

We prove by induction:

When $n=1$, it is obvious that:

$P(E_1)\\le P(E_1)$

For $n-1$, assume that:

$ \\mathrm{P}\\left(\\bigcup_{i=1}^{n-1} E_{i}\\right) \\leqslant \\sum_{i=1}^{n-1} \\mathrm{P}\\left(E_{i}\\right) $

Then:

$$
\\begin{aligned}
&\\mathrm{P}\\left(\\bigcup_{i=1}^{n} E_{i}\\right)\\\\ 
&=\\mathrm{P}\\left(\\bigcup_{i=1}^{n-1} E_{i}\\right)+\\mathrm{P}\\left(E_{n}\\right)-\\mathrm{P}\\left(\\bigcup_{i=1}^{n-1} E_{i} \\cap E_{n}\\right)
 \\\\ 
 &\\le\\mathrm{P}\\left(\\bigcup_{i=1}^{n-1} E_{i}\\right)+\\mathrm{P}\\left(E_{n}\\right)\\\\ 
& \\le \\sum_{i=1}^{n-1} \\mathrm{P}\\left(E_{i}\\right)+\\mathrm{P}\\left(E_{n}\\right)\\\\ 
&=\\sum_{i=1}^{n} \\mathrm{P}\\left(E_{i}\\right)  
\\end{aligned}
$$

## 12

### Problem 

> Let $ E $ and $ F $ be mutually exclusive events in the sample space of a certain experiment. Suppose the experiment is repeated until either $ E $ or $ F $ occurs. What is the sample space of this super experiment? Prove that the probability of event $ E $ occurring before event $ F $ is
$
\\frac{\\mathrm{P}(E)}{\\mathrm{P}(E)+\\mathrm{P}(F)}
$

### Solution 

For the sample space:

$\\Omega = \\cup_{k=0}^\\infty \\{(E\\cup F)^c\\}^k\\times \\{E,F\\}$

Denote $G_E$ as "$E$ happens at first experiment",$G_F$ as "$F$ happens at first experiment", $H$ as the needed event. Notice that:

$
\\begin{aligned}
&P(H|(G_E\\cup G_F)^c) = P(H)\\\\ 
&P(H) \\\\ 
&= P(H|G_E)P(G_E)+ P(H|G_F)P(G_F) + P(H|(G_E\\cup G_F)^c)P((G_E\\cup G_F)^c)\\\\ 
&= 1\\cdot P(E) + 0 + P(H)\\cdot (1-P(E)- P(H))\\\\ 
\\end{aligned}
$

Then we get:

$P(H) = \\dfrac{P(E)}{P(E)+P(F)}$

## 23

### Problem 

> For events $ E_{1}, E_{2}, \\cdots, E_{n} $ Prove:
> 
> $\\mathrm{P}\\left(E_{1} E_{2} \\cdots E_{n}\\right)=\\mathrm{P}\\left(E_{1}\\right) \\mathrm{P}\\left(E_{2} \\mid E_{1}\\right) \\mathrm{P}\\left(E_{3} \\mid E_{1} E_{2}\\right) \\cdots \\mathrm{P}\\left(E_{n} \\mid E_{1} \\cdots E_{n-1}\\right)$

### Solution 

We prove by induction: 

For $n-1$, it's obvious that:

$P(E_1) = P(E_1)$

Then, assume case $n-1$ holds, that is: 

$P(E_1E_2\\cdots E_{n-1})
=P(E_1)P(E_2|E_1)P(E_3|E_1E_2)\\cdots P(E_{n-1}|E_1\\cdots E_{n-2})$

Notice:

$P(E_1E_2\\cdots E_n) = P(E_n|E_1\\cdots E_{n-1})P(E_1\\cdots E_{n-1})$

Then:

$
\\begin{aligned}
&P(E_1E_2\\cdots E_n)\\\\ 
& = P(E_n|E_1\\cdots E_{n-1})P(E_1\\cdots E_{n-1})\\\\ 
&=P(E_1)P(E_2|E_1)P(E_3|E_1E_2)\\cdots P(E_{n}|E_1\\cdots E_{n-1})
\\end{aligned}
$

## 28

### Problem 

> If the occurrence of $ B $ makes $ A $ more likely to occur, does the occurrence of $ A $ make $ B $ more likely to occur?

### Solution 

Yes.

We translate the problem into:

Given: $P(A|B)>P(A)$,

Prove or not: $P(B|A)>P(B)$

Notice:

$P(A|B)P(B) = P(AB) = P(B|A)P(A)$

Rearrange it:

$\\dfrac{P(A|B)}{P(A)}=\\dfrac{P(B|A)}{P(B)}$

Given $P(A|B)> P(A)$

We get:

$P(B|A)>P(B)$

## 39

### Problem 

> Assume that stores A, B, and C have 50, 75, and 100 employees, respectively. Among them, 50\\%, $ 60 \\% $, and $ 70 \\% $ are female. The probability of resignation is the same for all employees, regardless of gender. Now, an employee has resigned, and she is female. What is the probability that she worked at store C?

### Solution 

Denote $E$ as "Employee is female", $F$ as "Employee works in C, then:

$
\\begin{aligned}
&P(F|E) \\\\ 
&= \\dfrac{P(EF)}{P(E)}\\\\ 
&= \\dfrac{100 \\times 70\\%}{50\\times 50\\% + 75 \\times 60\\% +100 \\times 70\\%}\\\\ 
&= \\dfrac{1}{2}
\\end{aligned}
$

# Chapter 2

## 7

### Problem 

> Suppose a coin with a probability of 0.7 for landing heads is tossed 3 times. Let $ X $ denote the number of heads that appear in these 3 tosses. Determine the probability mass function of $ X $.

### Solution 

Notice:

$X\\sim \\text{B}(3,0.7)$

Then:

$ P(X=k)=\\left\\{\\begin{array}{ll}0.027, & \\text { if } k=0, \\\\ 0.189, & \\text { if } k=1, \\\\ 0.441, & \\text { if } k=2, \\\\ 0.343, & \\text { if } k=3\\end{array}\\right. $

## 23 

### Problem 

> Negative binomial distribution: Continuously toss a coin with probability $ p $ of landing heads until $ r $ heads appear. Derive the probability that the number of tosses required, $ X $, is $ n $ (where $ n \\geqslant r $ ):
> 
> $\\mathrm{P}\\{X=n\\}=\\binom{n-1}{r-1} p^{r}(1-p)^{n-r}, \\quad n \\geqslant r$


### Solution 

Notice that we need $r-1$ heads in $n-1$ times, then:

$P\\{X=n\\} = \\binom{n-1}{r-1}p^{r}(1-p)^{n-r}$

## 46

### Problem (a)

> If $ X $ is a non-negative integer-valued random variable, prove that:
> $\\mathrm{E}[X]=\\sum_{n=1}^{\\infty} \\mathrm{P}\\{X \\geqslant n\\}=\\sum_{n=0}^{\\infty} \\mathrm{P}\\{X>n\\} .$

### Solution (a)

Notice:

$$
\\begin{aligned}
&\\sum_{n=1}^{\\infty} \\mathrm{P}\\{X \\geqslant n\\}\\\\ 
&=  \\sum_{n=1}^{\\infty} \\sum_{k=n}^{\\infty} \\mathrm{P}\\{X=k\\}  \\\\ 
&= \\sum_{k=1}^{\\infty}  \\sum_{n=1}^{k}\\mathrm{P}\\{X=k\\}  \\\\ 
&= \\sum_{k=1}^\\infty k P\\{X=k\\} \\\\ 
&= E[X]
\\end{aligned}
$$

Also:

$$
\\begin{aligned}
&\\sum_{n=1}^{\\infty} \\mathrm{P}\\{X \\geqslant n\\}\\\\ 
&=\\sum_{n=1}^{\\infty} \\mathrm{P}\\{X > n-1\\}\\\\ 
&=\\sum_{n=0}^{\\infty} \\mathrm{P}\\{X > n\\}\\\\ 
\\end{aligned}
$$

### Problem (b)

> If $ X $ and $ Y $ are both non-negative integer-valued random variables, prove that:
> 
> $\\mathrm{E}[X Y]=\\sum_{n=1}^{\\infty} \\sum_{m=1}^{\\infty} \\mathrm{P}(X \\geqslant n, Y \\geqslant m) .$

### Solution 

Similarly:

$$
\\begin{aligned}
&\\sum_{n=1}^{\\infty} \\sum_{m=1}^{\\infty} \\mathrm{P}(X \\geqslant n, Y \\geqslant m) \\\\ 
&= \\sum_{n=1}^{\\infty} \\sum_{m=1}^{\\infty}\\sum_{x=n}^\\infty \\sum_{y=m}^\\infty  \\mathrm{P}(X =x, Y =y)\\\\ 
&=\\sum_{x=1}^{\\infty} \\sum_{y=1}^{\\infty}\\sum_{n=1}^x \\sum_{m=1}^y  \\mathrm{P}(X =x, Y =y)\\\\ 
&=\\sum_{x=1}^{\\infty} \\sum_{y=1}^{\\infty}xy\\mathrm{P}(X =x, Y =y)\\\\ 
&=E[XY]
\\end{aligned}
$$

## 48 

### Problem 

> If $ X $ is a non-negative random variable and $ g $ is a differentiable function with $ g(0)=0 $, then:
> 
> $\\mathrm{E}[g(X)]=\\int_{0}^{\\infty} \\mathrm{P}(X>t) g^{\\prime}(t) \\mathrm{d} t$
> 
> Prove the above result when $ X $ is a continuous random variable.

### Solution 

We have:

$$
\\begin{aligned}
&\\int_{0}^{\\infty} \\mathrm{P}(X>t) g^{\\prime}(t) \\mathrm{d} t \\\\ 
&=\\int_{0}^{\\infty} \\int_t^\\infty P(X=x) g^{\\prime}(t) \\mathrm d x \\mathrm{d} t \\\\ 
&=\\int_{0}^{\\infty} \\int_0^x P(X=x) g^{\\prime}(t) \\mathrm d t\\mathrm{d} x \\\\ 
&=\\int_0^\\infty g(x)P(X=x)\\mathrm d x \\\\ 
&= E[g(x)]
\\end{aligned}
$$

## 71 

### Problem 

> Prove that the sum of independent and identically distributed (i.i.d.) exponential random variables has a gamma distribution.

### Solution 

Notice for exponential distribution: 


$ M_{X}(t)=\\int_{0}^{\\infty} e^{t x} \\cdot \\lambda e^{-\\lambda x} d x=\\lambda \\int_{0}^{\\infty} e^{-(\\lambda-t) x} d x $

Then: 

$ M_{X}(t)=\\lambda \\cdot \\frac{1}{\\lambda-t}=\\frac{\\lambda}{\\lambda-t} \\quad(t<\\lambda) $

Also, for Gamma distribution:

$ M_{X}(t)=\\int_{0}^{\\infty} e^{t x} \\cdot \\frac{\\lambda^{\\alpha}}{\\Gamma(\\alpha)} x^{\\alpha-1} e^{-\\lambda x} d x=\\frac{\\lambda^{\\alpha}}{(\\lambda-t)^{\\alpha}} \\cdot \\frac{\\Gamma(\\alpha)}{\\Gamma(\\alpha)} $

Then:

$ M_{X}(t)=\\left(\\frac{\\lambda}{\\lambda-t}\\right)^{\\alpha} $

Therefore, for i.i.d. exponential distributions:

$M_{\\sum_{i=1}^{\\alpha} X_i}(t) = (\\dfrac{\\lambda}{\\lambda-t})^\\alpha $

Therefore:

$\\sum_{i=1}^{\\alpha} X_i\\sim \\text{Gamma}(\\alpha)$

# Chapter 3

## 7

### Problem 

> Suppose the joint probability mass function $ p(x, y, z) $ of $ X, Y $, and $ Z $ is given by:
> 
> $\\begin{array}{llll}p(1,1,1)=\\frac{1}{8}, & p(2,1,1)=\\frac{1}{4}, & p(1,1,2)=\\frac{1}{8}, & p(2,1,2)=\\frac{3}{16} \\\\p(1,2,1)=\\frac{1}{16}, & p(2,2,1)=0, & p(1,2,2)=0, & p(2,2,2)=\\frac{1}{4}\\end{array}$
> 
> What is $ \\mathrm{E}[X \\mid Y=2] $ ? What is $ \\mathrm{E}[X \\mid Y=2, Z=1] $ ?

### Solution 

We have:

$P(Y=2) = \\sum_{x,z}p(x,2,z) = \\dfrac{5}{16}$

With conditional probability:

$P(X=1|Y=2) = \\dfrac{P(X=1,Y=2)}{P(Y=2)} = \\dfrac{1}{5}$

$P(X=2|Y=2) = \\dfrac{P(X=2,Y=2)}{P(Y=2)} = \\dfrac{4}{5}$

Then:

$$
\\begin{aligned}
&E[X|Y=2]\\\\ 
&= \\sum_{x}x\\cdot P(X=x|Y=2) \\\\ 
&= \\dfrac{9}{5}
\\end{aligned}
$$

Similarly:


$$
\\begin{aligned}
&E[X|Y=2, Z=1]\\\\ 
&= \\sum_{x}x\\cdot P(X=x|Y=2, Z=1) \\\\ 
&= 1
\\end{aligned}
$$

## 14

### Problem 

> Let $ X $ be a uniform random variable on $ (0,1) $. Find $ \\mathrm{E}[X \\mid X<1 / 2] $

### Solution 

We have:

$p(x) = 1, x\\in (0, 1)$

Then:

$$
\\begin{aligned}
&E[X|X<\\dfrac{1}{2}]\\\\ 
&= \\int_0^1 xP(X=x|X<\\dfrac{1}{2}) dx \\\\ 
&=\\int_0^\\frac{1}{2}x\\dfrac{P(X=x)}{\\dfrac{1}{2}}dx \\\\ 
&= \\dfrac{1}{4}
\\end{aligned}
$$

## 27 

### Problem

> Continuously toss a coin with probability $ p $ of landing heads until the pattern $ \\mathrm{T}, \\mathrm{T}, \\mathrm{H} $ appears. (That is, you stop tossing when the most recent toss is heads, and the two tosses immediately before it are tails.) Let $ X $ be the number of tosses. Find $ \\mathrm{E}[X] $.

### Solution 

We give the solution by states:

We denote:

$S_0 $: the most recent toss is H or nothing

$S_1$: the most recent toss is T 

$S_2$: the most recent tosses are T, T

We denote:

$E_i$ as the tosses needed for T, T, H in state $i$

Then:

$E_0 = (1-p)E_1 + pE_0 + 1$

$E_1 = (1-p)E_2 + pE_0 + 1$

$E_2 = p\\cdot 0 + (1-p)E_2 + 1$

By solving this, we get:

$E_2 = \\dfrac{1}{p}$

$E_0 = \\dfrac{1/p}{1-2p+p^2}$

Therefore:

$E[X] = \\dfrac{1}{p(1-p)^2}$

## 57

### Problem 

> The number of storms in the next rainy season follows a Poisson distribution, but its parameter is uniformly distributed over $ (0,5) $. That is, $ \\Lambda $ is uniformly distributed over $ (0,5) $, and given $ \\Lambda=\\lambda $, the number of storms is a Poisson random variable with mean $ \\lambda $. Find the probability that there are at least three storms in this rainy season.

### Solution 

Denote $X$ as the number of storms in this rainy season.

Notice:

$p(\\lambda) = \\dfrac{1}{5}$

$P(X=x|\\Lambda = \\lambda) = \\dfrac{\\lambda^x}{x!}e^{-\\lambda}$

Then:

$$
\\begin{aligned}
&P(X\\ge 3)\\\\ 
&= \\int_0^5 P(X\\ge 3|\\Lambda = \\lambda) P(\\Lambda =\\lambda) d \\lambda \\\\ 
&= \\dfrac{1}{5}\\int_0^5(1-e^{-\\lambda} - \\lambda e^{-\\lambda} - \\dfrac{\\lambda^2}{2}e^{-\\lambda})d\\lambda \\\\ 
&=\\dfrac{1}{5}[\\lambda+e^{-\\lambda}+ (\\lambda + 1)e^{-\\lambda} + (\\dfrac{\\lambda^2}{2}+\\lambda+1)e^{-\\lambda}]^5_0\\\\ 
&=\\dfrac{1}{5}[\\lambda + (\\dfrac{\\lambda^2}{2}+2\\lambda+3)e^{-\\lambda}]^5_0\\\\
&=\\dfrac{2}{5} + \\dfrac{51}{10}e^{-5}\\\\
\\end{aligned}
$$

## 59

### Problem

> Assume that each new coupon collected is independent of the past, and the probability of collecting a coupon of type $ i $ is $ p_{i} $. A total of $ n $ coupons are collected. Let $ A_{i} $ denote the event "at least one of the $ n $ coupons is of type $ i $." For $ i \\neq j $, compute $ P\\left(A_{i} A_{j}\\right) $ using the following methods:
(a) Condition on the number of type $ i $ coupons $ N_{i} $ among the $ n $ coupons;
(b) Condition on the time $ F_{i} $ when the first type $ i $ coupon is collected;
(c) Use the identity $ \\mathrm{P}\\left(A_{i} \\cup A_{j}\\right)=\\mathrm{P}\\left(A_{i}\\right)+\\mathrm{P}\\left(A_{j}\\right)-\\mathrm{P}\\left(A_{i} A_{j}\\right) $.

### Solution (a)

We have:

$$
\\begin{aligned}
&P(A_iA_j)\\\\ 
&=\\sum_{k=1}^n P(A_j|N_i=k)P(N_i=k) \\\\ 
&= \\sum_{k=1}^n(1-(1-\\dfrac{p_j}{1-p_i})^{n-k})\\binom{n}{k}p_i^k(1-p_i)^{n-k}
\\end{aligned}
$$

### Solution (b)

Similarly, we have:

$$
\\begin{aligned}
&P(A_iA_j)\\\\ 
&=\\sum_{k=1}^n P(A_j|F_i=k)P(F_i=k) \\\\ 
&= \\sum_{m=1}^{n}\\left[1-\\left(1-\\frac{p_{j}}{1-p_{i}}\\right)^{m-1}\\left(1-p_{j}\\right)^{n-m}\\right]\\left(1-p_{i}\\right)^{m-1} p_{i}
\\end{aligned}
$$

### Solution (c)

We have:

$
\\begin{aligned}
&P(A_iA_j) \\\\ 
&= P(A_i) + P(A_j) - P(A_i \\cup A_j) \\\\ 
&= (1-(1-p_i)^n) + (1-(1-p_j)^n) - (1-(1-p_i-p_j)^n)\\\\ 
&= 1 - (1-p_i)^n - (1-p_j)^n + (1-p_i- p_j )^n
\\end{aligned}$


`,E8=`# Understanding React Hooks

React Hooks are functions that let you use state and other React features without writing a class.

Here is some content with a mathematical formula inline: $E = mc^2$

And a block formula:

$$
\\int_{-\\infty}^{+\\infty} e^{-x^2} dx = \\sqrt{\\pi}
$$

More content...
`;function kp(e){const t=[],n=String(e||"");let r=n.indexOf(","),i=0,a=!1;for(;!a;){r===-1&&(r=n.length,a=!0);const o=n.slice(i,r).trim();(o||!a)&&t.push(o),i=r+1,r=n.indexOf(",",i)}return t}function C8(e,t){const n={};return(e[e.length-1]===""?[...e,""]:e).join((n.padRight?" ":"")+","+(n.padLeft===!1?"":" ")).trim()}const P8=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,D8=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,T8={};function Sp(e,t){return(T8.jsx?D8:P8).test(e)}const A8=/[ \t\n\f\r]/g;function z8(e){return typeof e=="object"?e.type==="text"?Ep(e.value):!1:Ep(e)}function Ep(e){return e.replace(A8,"")===""}class rs{constructor(t,n,r){this.property=t,this.normal=n,r&&(this.space=r)}}rs.prototype.property={};rs.prototype.normal={};rs.prototype.space=null;function D$(e,t){const n={},r={};let i=-1;for(;++i<e.length;)Object.assign(n,e[i].property),Object.assign(r,e[i].normal);return new rs(n,r,t)}function No(e){return e.toLowerCase()}class ln{constructor(t,n){this.property=t,this.attribute=n}}ln.prototype.space=null;ln.prototype.boolean=!1;ln.prototype.booleanish=!1;ln.prototype.overloadedBoolean=!1;ln.prototype.number=!1;ln.prototype.commaSeparated=!1;ln.prototype.spaceSeparated=!1;ln.prototype.commaOrSpaceSeparated=!1;ln.prototype.mustUseProperty=!1;ln.prototype.defined=!1;let M8=0;const me=_i(),Ze=_i(),T$=_i(),H=_i(),Ce=_i(),ia=_i(),Rt=_i();function _i(){return 2**++M8}const Zc=Object.freeze(Object.defineProperty({__proto__:null,boolean:me,booleanish:Ze,commaOrSpaceSeparated:Rt,commaSeparated:ia,number:H,overloadedBoolean:T$,spaceSeparated:Ce},Symbol.toStringTag,{value:"Module"})),dh=Object.keys(Zc);class Im extends ln{constructor(t,n,r,i){let a=-1;if(super(t,n),Cp(this,"space",i),typeof r=="number")for(;++a<dh.length;){const o=dh[a];Cp(this,dh[a],(r&Zc[o])===Zc[o])}}}Im.prototype.defined=!0;function Cp(e,t,n){n&&(e[t]=n)}const F8={}.hasOwnProperty;function wa(e){const t={},n={};let r;for(r in e.properties)if(F8.call(e.properties,r)){const i=e.properties[r],a=new Im(r,e.transform(e.attributes||{},r),i,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(a.mustUseProperty=!0),t[r]=a,n[No(r)]=r,n[No(a.attribute)]=r}return new rs(t,n,e.space)}const A$=wa({space:"xlink",transform(e,t){return"xlink:"+t.slice(5).toLowerCase()},properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null}}),z$=wa({space:"xml",transform(e,t){return"xml:"+t.slice(3).toLowerCase()},properties:{xmlLang:null,xmlBase:null,xmlSpace:null}});function M$(e,t){return t in e?e[t]:t}function F$(e,t){return M$(e,t.toLowerCase())}const q$=wa({space:"xmlns",attributes:{xmlnsxlink:"xmlns:xlink"},transform:F$,properties:{xmlns:null,xmlnsXLink:null}}),R$=wa({transform(e,t){return t==="role"?t:"aria-"+t.slice(4).toLowerCase()},properties:{ariaActiveDescendant:null,ariaAtomic:Ze,ariaAutoComplete:null,ariaBusy:Ze,ariaChecked:Ze,ariaColCount:H,ariaColIndex:H,ariaColSpan:H,ariaControls:Ce,ariaCurrent:null,ariaDescribedBy:Ce,ariaDetails:null,ariaDisabled:Ze,ariaDropEffect:Ce,ariaErrorMessage:null,ariaExpanded:Ze,ariaFlowTo:Ce,ariaGrabbed:Ze,ariaHasPopup:null,ariaHidden:Ze,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Ce,ariaLevel:H,ariaLive:null,ariaModal:Ze,ariaMultiLine:Ze,ariaMultiSelectable:Ze,ariaOrientation:null,ariaOwns:Ce,ariaPlaceholder:null,ariaPosInSet:H,ariaPressed:Ze,ariaReadOnly:Ze,ariaRelevant:null,ariaRequired:Ze,ariaRoleDescription:Ce,ariaRowCount:H,ariaRowIndex:H,ariaRowSpan:H,ariaSelected:Ze,ariaSetSize:H,ariaSort:null,ariaValueMax:H,ariaValueMin:H,ariaValueNow:H,ariaValueText:null,role:null}}),q8=wa({space:"html",attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},transform:F$,mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:ia,acceptCharset:Ce,accessKey:Ce,action:null,allow:null,allowFullScreen:me,allowPaymentRequest:me,allowUserMedia:me,alt:null,as:null,async:me,autoCapitalize:null,autoComplete:Ce,autoFocus:me,autoPlay:me,blocking:Ce,capture:null,charSet:null,checked:me,cite:null,className:Ce,cols:H,colSpan:null,content:null,contentEditable:Ze,controls:me,controlsList:Ce,coords:H|ia,crossOrigin:null,data:null,dateTime:null,decoding:null,default:me,defer:me,dir:null,dirName:null,disabled:me,download:T$,draggable:Ze,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:me,formTarget:null,headers:Ce,height:H,hidden:me,high:H,href:null,hrefLang:null,htmlFor:Ce,httpEquiv:Ce,id:null,imageSizes:null,imageSrcSet:null,inert:me,inputMode:null,integrity:null,is:null,isMap:me,itemId:null,itemProp:Ce,itemRef:Ce,itemScope:me,itemType:Ce,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:me,low:H,manifest:null,max:null,maxLength:H,media:null,method:null,min:null,minLength:H,multiple:me,muted:me,name:null,nonce:null,noModule:me,noValidate:me,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:me,optimum:H,pattern:null,ping:Ce,placeholder:null,playsInline:me,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:me,referrerPolicy:null,rel:Ce,required:me,reversed:me,rows:H,rowSpan:H,sandbox:Ce,scope:null,scoped:me,seamless:me,selected:me,shadowRootClonable:me,shadowRootDelegatesFocus:me,shadowRootMode:null,shape:null,size:H,sizes:null,slot:null,span:H,spellCheck:Ze,src:null,srcDoc:null,srcLang:null,srcSet:null,start:H,step:null,style:null,tabIndex:H,target:null,title:null,translate:null,type:null,typeMustMatch:me,useMap:null,value:Ze,width:H,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Ce,axis:null,background:null,bgColor:null,border:H,borderColor:null,bottomMargin:H,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:me,declare:me,event:null,face:null,frame:null,frameBorder:null,hSpace:H,leftMargin:H,link:null,longDesc:null,lowSrc:null,marginHeight:H,marginWidth:H,noResize:me,noHref:me,noShade:me,noWrap:me,object:null,profile:null,prompt:null,rev:null,rightMargin:H,rules:null,scheme:null,scrolling:Ze,standby:null,summary:null,text:null,topMargin:H,valueType:null,version:null,vAlign:null,vLink:null,vSpace:H,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:me,disableRemotePlayback:me,prefix:null,property:null,results:H,security:null,unselectable:null}}),R8=wa({space:"svg",attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},transform:M$,properties:{about:Rt,accentHeight:H,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:H,amplitude:H,arabicForm:null,ascent:H,attributeName:null,attributeType:null,azimuth:H,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:H,by:null,calcMode:null,capHeight:H,className:Ce,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:H,diffuseConstant:H,direction:null,display:null,dur:null,divisor:H,dominantBaseline:null,download:me,dx:null,dy:null,edgeMode:null,editable:null,elevation:H,enableBackground:null,end:null,event:null,exponent:H,externalResourcesRequired:null,fill:null,fillOpacity:H,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:ia,g2:ia,glyphName:ia,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:H,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:H,horizOriginX:H,horizOriginY:H,id:null,ideographic:H,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:H,k:H,k1:H,k2:H,k3:H,k4:H,kernelMatrix:Rt,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:H,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:H,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:H,overlineThickness:H,paintOrder:null,panose1:null,path:null,pathLength:H,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Ce,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:H,pointsAtY:H,pointsAtZ:H,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Rt,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Rt,rev:Rt,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Rt,requiredFeatures:Rt,requiredFonts:Rt,requiredFormats:Rt,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:H,specularExponent:H,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:H,strikethroughThickness:H,string:null,stroke:null,strokeDashArray:Rt,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:H,strokeOpacity:H,strokeWidth:null,style:null,surfaceScale:H,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Rt,tabIndex:H,tableValues:null,target:null,targetX:H,targetY:H,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Rt,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:H,underlineThickness:H,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:H,values:null,vAlphabetic:H,vMathematical:H,vectorEffect:null,vHanging:H,vIdeographic:H,version:null,vertAdvY:H,vertOriginX:H,vertOriginY:H,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:H,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null}}),N8=/^data[-\w.:]+$/i,Pp=/-[a-z]/g,I8=/[A-Z]/g;function N$(e,t){const n=No(t);let r=t,i=ln;if(n in e.normal)return e.property[e.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&N8.test(t)){if(t.charAt(4)==="-"){const a=t.slice(5).replace(Pp,L8);r="data"+a.charAt(0).toUpperCase()+a.slice(1)}else{const a=t.slice(4);if(!Pp.test(a)){let o=a.replace(I8,B8);o.charAt(0)!=="-"&&(o="-"+o),t="data"+o}}i=Im}return new i(r,t)}function B8(e){return"-"+e.toLowerCase()}function L8(e){return e.charAt(1).toUpperCase()}const O8={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},I$=D$([z$,A$,q$,R$,q8],"html"),$u=D$([z$,A$,q$,R$,R8],"svg");function Dp(e){const t=String(e||"").trim();return t?t.split(/[ \t\n\r\f]+/g):[]}function j8(e){return e.join(" ").trim()}var B$={},Tp=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,V8=/\n/g,W8=/^\s*/,X8=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,U8=/^:\s*/,H8=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,G8=/^[;\s]*/,K8=/^\s+|\s+$/g,Z8=`
`,Ap="/",zp="*",ri="",Y8="comment",Q8="declaration",J8=function(e,t){if(typeof e!="string")throw new TypeError("First argument must be a string");if(!e)return[];t=t||{};var n=1,r=1;function i(b){var $=b.match(V8);$&&(n+=$.length);var w=b.lastIndexOf(Z8);r=~w?b.length-w:r+b.length}function a(){var b={line:n,column:r};return function($){return $.position=new o(b),u(),$}}function o(b){this.start=b,this.end={line:n,column:r},this.source=t.source}o.prototype.content=e;function s(b){var $=new Error(t.source+":"+n+":"+r+": "+b);if($.reason=b,$.filename=t.source,$.line=n,$.column=r,$.source=e,!t.silent)throw $}function l(b){var $=b.exec(e);if($){var w=$[0];return i(w),e=e.slice(w.length),$}}function u(){l(W8)}function h(b){var $;for(b=b||[];$=c();)$!==!1&&b.push($);return b}function c(){var b=a();if(!(Ap!=e.charAt(0)||zp!=e.charAt(1))){for(var $=2;ri!=e.charAt($)&&(zp!=e.charAt($)||Ap!=e.charAt($+1));)++$;if($+=2,ri===e.charAt($-1))return s("End of comment missing");var w=e.slice(2,$-2);return r+=2,i(w),e=e.slice($),r+=2,b({type:Y8,comment:w})}}function m(){var b=a(),$=l(X8);if($){if(c(),!l(U8))return s("property missing ':'");var w=l(H8),g=b({type:Q8,property:Mp($[0].replace(Tp,ri)),value:w?Mp(w[0].replace(Tp,ri)):ri});return l(G8),g}}function d(){var b=[];h(b);for(var $;$=m();)$!==!1&&(b.push($),h(b));return b}return u(),d()};function Mp(e){return e?e.replace(K8,ri):ri}var ek=tf&&tf.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(B$,"__esModule",{value:!0});var Fp=B$.default=nk,tk=ek(J8);function nk(e,t){var n=null;if(!e||typeof e!="string")return n;var r=(0,tk.default)(e),i=typeof t=="function";return r.forEach(function(a){if(a.type==="declaration"){var o=a.property,s=a.value;i?t(o,s,a):s&&(n=n||{},n[o]=s)}}),n}const rk=Fp.default||Fp,L$=O$("end"),Bm=O$("start");function O$(e){return t;function t(n){const r=n&&n.position&&n.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function ik(e){const t=Bm(e),n=L$(e);if(t&&n)return{start:t,end:n}}function ho(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?qp(e.position):"start"in e||"end"in e?qp(e):"line"in e||"column"in e?Yc(e):""}function Yc(e){return Rp(e&&e.line)+":"+Rp(e&&e.column)}function qp(e){return Yc(e&&e.start)+"-"+Yc(e&&e.end)}function Rp(e){return e&&typeof e=="number"?e:1}class gt extends Error{constructor(t,n,r){super(),typeof n=="string"&&(r=n,n=void 0);let i="",a={},o=!1;if(n&&("line"in n&&"column"in n?a={place:n}:"start"in n&&"end"in n?a={place:n}:"type"in n?a={ancestors:[n],place:n.position}:a={...n}),typeof t=="string"?i=t:!a.cause&&t&&(o=!0,i=t.message,a.cause=t),!a.ruleId&&!a.source&&typeof r=="string"){const l=r.indexOf(":");l===-1?a.ruleId=r:(a.source=r.slice(0,l),a.ruleId=r.slice(l+1))}if(!a.place&&a.ancestors&&a.ancestors){const l=a.ancestors[a.ancestors.length-1];l&&(a.place=l.position)}const s=a.place&&"start"in a.place?a.place.start:a.place;this.ancestors=a.ancestors||void 0,this.cause=a.cause||void 0,this.column=s?s.column:void 0,this.fatal=void 0,this.file,this.message=i,this.line=s?s.line:void 0,this.name=ho(a.place)||"1:1",this.place=a.place||void 0,this.reason=this.message,this.ruleId=a.ruleId||void 0,this.source=a.source||void 0,this.stack=o&&a.cause&&typeof a.cause.stack=="string"?a.cause.stack:"",this.actual,this.expected,this.note,this.url}}gt.prototype.file="";gt.prototype.name="";gt.prototype.reason="";gt.prototype.message="";gt.prototype.stack="";gt.prototype.column=void 0;gt.prototype.line=void 0;gt.prototype.ancestors=void 0;gt.prototype.cause=void 0;gt.prototype.fatal=void 0;gt.prototype.place=void 0;gt.prototype.ruleId=void 0;gt.prototype.source=void 0;const Lm={}.hasOwnProperty,ak=new Map,ok=/[A-Z]/g,sk=/-([a-z])/g,lk=new Set(["table","tbody","thead","tfoot","tr"]),uk=new Set(["td","th"]),j$="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function hk(e,t){if(!t||t.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const n=t.filePath||void 0;let r;if(t.development){if(typeof t.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=yk(n,t.jsxDEV)}else{if(typeof t.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof t.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=bk(n,t.jsx,t.jsxs)}const i={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:r,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:n,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:t.passKeys!==!1,passNode:t.passNode||!1,schema:t.space==="svg"?$u:I$,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:t.tableCellAlignToStyle!==!1},a=V$(i,e,void 0);return a&&typeof a!="string"?a:i.create(e,i.Fragment,{children:a||void 0},void 0)}function V$(e,t,n){if(t.type==="element")return ck(e,t,n);if(t.type==="mdxFlowExpression"||t.type==="mdxTextExpression")return mk(e,t);if(t.type==="mdxJsxFlowElement"||t.type==="mdxJsxTextElement")return fk(e,t,n);if(t.type==="mdxjsEsm")return dk(e,t);if(t.type==="root")return pk(e,t,n);if(t.type==="text")return gk(e,t)}function ck(e,t,n){const r=e.schema;let i=r;t.tagName.toLowerCase()==="svg"&&r.space==="html"&&(i=$u,e.schema=i),e.ancestors.push(t);const a=X$(e,t.tagName,!1),o=$k(e,t);let s=jm(e,t);return lk.has(t.tagName)&&(s=s.filter(function(l){return typeof l=="string"?!z8(l):!0})),W$(e,o,a,t),Om(o,s),e.ancestors.pop(),e.schema=r,e.create(t,a,o,n)}function mk(e,t){if(t.data&&t.data.estree&&e.evaluater){const r=t.data.estree.body[0];return r.type,e.evaluater.evaluateExpression(r.expression)}Io(e,t.position)}function dk(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);Io(e,t.position)}function fk(e,t,n){const r=e.schema;let i=r;t.name==="svg"&&r.space==="html"&&(i=$u,e.schema=i),e.ancestors.push(t);const a=t.name===null?e.Fragment:X$(e,t.name,!0),o=vk(e,t),s=jm(e,t);return W$(e,o,a,t),Om(o,s),e.ancestors.pop(),e.schema=r,e.create(t,a,o,n)}function pk(e,t,n){const r={};return Om(r,jm(e,t)),e.create(t,e.Fragment,r,n)}function gk(e,t){return t.value}function W$(e,t,n,r){typeof n!="string"&&n!==e.Fragment&&e.passNode&&(t.node=r)}function Om(e,t){if(t.length>0){const n=t.length>1?t:t[0];n&&(e.children=n)}}function bk(e,t,n){return r;function r(i,a,o,s){const u=Array.isArray(o.children)?n:t;return s?u(a,o,s):u(a,o)}}function yk(e,t){return n;function n(r,i,a,o){const s=Array.isArray(a.children),l=Bm(r);return t(i,a,o,s,{columnNumber:l?l.column-1:void 0,fileName:e,lineNumber:l?l.line:void 0},void 0)}}function $k(e,t){const n={};let r,i;for(i in t.properties)if(i!=="children"&&Lm.call(t.properties,i)){const a=_k(e,i,t.properties[i]);if(a){const[o,s]=a;e.tableCellAlignToStyle&&o==="align"&&typeof s=="string"&&uk.has(t.tagName)?r=s:n[o]=s}}if(r){const a=n.style||(n.style={});a[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return n}function vk(e,t){const n={};for(const r of t.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&e.evaluater){const a=r.data.estree.body[0];a.type;const o=a.expression;o.type;const s=o.properties[0];s.type,Object.assign(n,e.evaluater.evaluateExpression(s.argument))}else Io(e,t.position);else{const i=r.name;let a;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&e.evaluater){const s=r.value.data.estree.body[0];s.type,a=e.evaluater.evaluateExpression(s.expression)}else Io(e,t.position);else a=r.value===null?!0:r.value;n[i]=a}return n}function jm(e,t){const n=[];let r=-1;const i=e.passKeys?new Map:ak;for(;++r<t.children.length;){const a=t.children[r];let o;if(e.passKeys){const l=a.type==="element"?a.tagName:a.type==="mdxJsxFlowElement"||a.type==="mdxJsxTextElement"?a.name:void 0;if(l){const u=i.get(l)||0;o=l+"-"+u,i.set(l,u+1)}}const s=V$(e,a,o);s!==void 0&&n.push(s)}return n}function _k(e,t,n){const r=N$(e.schema,t);if(!(n==null||typeof n=="number"&&Number.isNaN(n))){if(Array.isArray(n)&&(n=r.commaSeparated?C8(n):j8(n)),r.property==="style"){let i=typeof n=="object"?n:xk(e,String(n));return e.stylePropertyNameCase==="css"&&(i=wk(i)),["style",i]}return[e.elementAttributeNameCase==="react"&&r.space?O8[r.property]||r.property:r.attribute,n]}}function xk(e,t){const n={};try{rk(t,r)}catch(i){if(!e.ignoreInvalidStyle){const a=i,o=new gt("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:a,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw o.file=e.filePath||void 0,o.url=j$+"#cannot-parse-style-attribute",o}}return n;function r(i,a){let o=i;o.slice(0,2)!=="--"&&(o.slice(0,4)==="-ms-"&&(o="ms-"+o.slice(4)),o=o.replace(sk,Sk)),n[o]=a}}function X$(e,t,n){let r;if(!n)r={type:"Literal",value:t};else if(t.includes(".")){const i=t.split(".");let a=-1,o;for(;++a<i.length;){const s=Sp(i[a])?{type:"Identifier",name:i[a]}:{type:"Literal",value:i[a]};o=o?{type:"MemberExpression",object:o,property:s,computed:!!(a&&s.type==="Literal"),optional:!1}:s}r=o}else r=Sp(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};if(r.type==="Literal"){const i=r.value;return Lm.call(e.components,i)?e.components[i]:i}if(e.evaluater)return e.evaluater.evaluateExpression(r);Io(e)}function Io(e,t){const n=new gt("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw n.file=e.filePath||void 0,n.url=j$+"#cannot-handle-mdx-estrees-without-createevaluater",n}function wk(e){const t={};let n;for(n in e)Lm.call(e,n)&&(t[kk(n)]=e[n]);return t}function kk(e){let t=e.replace(ok,Ek);return t.slice(0,3)==="ms-"&&(t="-"+t),t}function Sk(e,t){return t.toUpperCase()}function Ek(e){return"-"+e.toLowerCase()}const fh={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},Ck={};function Pk(e,t){const n=Ck,r=typeof n.includeImageAlt=="boolean"?n.includeImageAlt:!0,i=typeof n.includeHtml=="boolean"?n.includeHtml:!0;return U$(e,r,i)}function U$(e,t,n){if(Dk(e)){if("value"in e)return e.type==="html"&&!n?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return Np(e.children,t,n)}return Array.isArray(e)?Np(e,t,n):""}function Np(e,t,n){const r=[];let i=-1;for(;++i<e.length;)r[i]=U$(e[i],t,n);return r.join("")}function Dk(e){return!!(e&&typeof e=="object")}const Ip=document.createElement("i");function Vm(e){const t="&"+e+";";Ip.innerHTML=t;const n=Ip.textContent;return n.charCodeAt(n.length-1)===59&&e!=="semi"||n===t?!1:n}function Fn(e,t,n,r){const i=e.length;let a=0,o;if(t<0?t=-t>i?0:i+t:t=t>i?i:t,n=n>0?n:0,r.length<1e4)o=Array.from(r),o.unshift(t,n),e.splice(...o);else for(n&&e.splice(t,n);a<r.length;)o=r.slice(a,a+1e4),o.unshift(t,0),e.splice(...o),a+=1e4,t+=1e4}function Yt(e,t){return e.length>0?(Fn(e,e.length,0,t),e):t}const Bp={}.hasOwnProperty;function Tk(e){const t={};let n=-1;for(;++n<e.length;)Ak(t,e[n]);return t}function Ak(e,t){let n;for(n in t){const i=(Bp.call(e,n)?e[n]:void 0)||(e[n]={}),a=t[n];let o;if(a)for(o in a){Bp.call(i,o)||(i[o]=[]);const s=a[o];zk(i[o],Array.isArray(s)?s:s?[s]:[])}}}function zk(e,t){let n=-1;const r=[];for(;++n<t.length;)(t[n].add==="after"?e:r).push(t[n]);Fn(e,0,0,r)}function H$(e,t){const n=Number.parseInt(e,t);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"�":String.fromCodePoint(n)}function aa(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Pn=Xr(/[A-Za-z]/),Lt=Xr(/[\dA-Za-z]/),Mk=Xr(/[#-'*+\--9=?A-Z^-~]/);function Qc(e){return e!==null&&(e<32||e===127)}const Jc=Xr(/\d/),Fk=Xr(/[\dA-Fa-f]/),qk=Xr(/[!-/:-@[-`{-~]/);function ee(e){return e!==null&&e<-2}function Mt(e){return e!==null&&(e<0||e===32)}function _e(e){return e===-2||e===-1||e===32}const Rk=Xr(new RegExp("\\p{P}|\\p{S}","u")),Nk=Xr(/\s/);function Xr(e){return t;function t(n){return n!==null&&n>-1&&e.test(String.fromCharCode(n))}}function ka(e){const t=[];let n=-1,r=0,i=0;for(;++n<e.length;){const a=e.charCodeAt(n);let o="";if(a===37&&Lt(e.charCodeAt(n+1))&&Lt(e.charCodeAt(n+2)))i=2;else if(a<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(a))||(o=String.fromCharCode(a));else if(a>55295&&a<57344){const s=e.charCodeAt(n+1);a<56320&&s>56319&&s<57344?(o=String.fromCharCode(a,s),i=1):o="�"}else o=String.fromCharCode(a);o&&(t.push(e.slice(r,n),encodeURIComponent(o)),r=n+i+1,o=""),i&&(n+=i,i=0)}return t.join("")+e.slice(r)}function xe(e,t,n,r){const i=r?r-1:Number.POSITIVE_INFINITY;let a=0;return o;function o(l){return _e(l)?(e.enter(n),s(l)):t(l)}function s(l){return _e(l)&&a++<i?(e.consume(l),s):(e.exit(n),t(l))}}const Ik={tokenize:Bk};function Bk(e){const t=e.attempt(this.parser.constructs.contentInitial,r,i);let n;return t;function r(s){if(s===null){e.consume(s);return}return e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),xe(e,t,"linePrefix")}function i(s){return e.enter("paragraph"),a(s)}function a(s){const l=e.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=l),n=l,o(s)}function o(s){if(s===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(s);return}return ee(s)?(e.consume(s),e.exit("chunkText"),a):(e.consume(s),o)}}const Lk={tokenize:Ok},Lp={tokenize:jk};function Ok(e){const t=this,n=[];let r=0,i,a,o;return s;function s(_){if(r<n.length){const T=n[r];return t.containerState=T[1],e.attempt(T[0].continuation,l,u)(_)}return u(_)}function l(_){if(r++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,i&&y();const T=t.events.length;let D=T,C;for(;D--;)if(t.events[D][0]==="exit"&&t.events[D][1].type==="chunkFlow"){C=t.events[D][1].end;break}g(r);let F=T;for(;F<t.events.length;)t.events[F][1].end={...C},F++;return Fn(t.events,D+1,0,t.events.slice(T)),t.events.length=F,u(_)}return s(_)}function u(_){if(r===n.length){if(!i)return m(_);if(i.currentConstruct&&i.currentConstruct.concrete)return b(_);t.interrupt=!!(i.currentConstruct&&!i._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(Lp,h,c)(_)}function h(_){return i&&y(),g(r),m(_)}function c(_){return t.parser.lazy[t.now().line]=r!==n.length,o=t.now().offset,b(_)}function m(_){return t.containerState={},e.attempt(Lp,d,b)(_)}function d(_){return r++,n.push([t.currentConstruct,t.containerState]),m(_)}function b(_){if(_===null){i&&y(),g(0),e.consume(_);return}return i=i||t.parser.flow(t.now()),e.enter("chunkFlow",{_tokenizer:i,contentType:"flow",previous:a}),$(_)}function $(_){if(_===null){w(e.exit("chunkFlow"),!0),g(0),e.consume(_);return}return ee(_)?(e.consume(_),w(e.exit("chunkFlow")),r=0,t.interrupt=void 0,s):(e.consume(_),$)}function w(_,T){const D=t.sliceStream(_);if(T&&D.push(null),_.previous=a,a&&(a.next=_),a=_,i.defineSkip(_.start),i.write(D),t.parser.lazy[_.start.line]){let C=i.events.length;for(;C--;)if(i.events[C][1].start.offset<o&&(!i.events[C][1].end||i.events[C][1].end.offset>o))return;const F=t.events.length;let R=F,N,O;for(;R--;)if(t.events[R][0]==="exit"&&t.events[R][1].type==="chunkFlow"){if(N){O=t.events[R][1].end;break}N=!0}for(g(r),C=F;C<t.events.length;)t.events[C][1].end={...O},C++;Fn(t.events,R+1,0,t.events.slice(F)),t.events.length=C}}function g(_){let T=n.length;for(;T-- >_;){const D=n[T];t.containerState=D[1],D[0].exit.call(t,e)}n.length=_}function y(){i.write([null]),a=void 0,i=void 0,t.containerState._closeFlow=void 0}}function jk(e,t,n){return xe(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Op(e){if(e===null||Mt(e)||Nk(e))return 1;if(Rk(e))return 2}function Wm(e,t,n){const r=[];let i=-1;for(;++i<e.length;){const a=e[i].resolveAll;a&&!r.includes(a)&&(t=a(t,n),r.push(a))}return t}const e0={name:"attention",resolveAll:Vk,tokenize:Wk};function Vk(e,t){let n=-1,r,i,a,o,s,l,u,h;for(;++n<e.length;)if(e[n][0]==="enter"&&e[n][1].type==="attentionSequence"&&e[n][1]._close){for(r=n;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&t.sliceSerialize(e[r][1]).charCodeAt(0)===t.sliceSerialize(e[n][1]).charCodeAt(0)){if((e[r][1]._close||e[n][1]._open)&&(e[n][1].end.offset-e[n][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[n][1].end.offset-e[n][1].start.offset)%3))continue;l=e[r][1].end.offset-e[r][1].start.offset>1&&e[n][1].end.offset-e[n][1].start.offset>1?2:1;const c={...e[r][1].end},m={...e[n][1].start};jp(c,-l),jp(m,l),o={type:l>1?"strongSequence":"emphasisSequence",start:c,end:{...e[r][1].end}},s={type:l>1?"strongSequence":"emphasisSequence",start:{...e[n][1].start},end:m},a={type:l>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[n][1].start}},i={type:l>1?"strong":"emphasis",start:{...o.start},end:{...s.end}},e[r][1].end={...o.start},e[n][1].start={...s.end},u=[],e[r][1].end.offset-e[r][1].start.offset&&(u=Yt(u,[["enter",e[r][1],t],["exit",e[r][1],t]])),u=Yt(u,[["enter",i,t],["enter",o,t],["exit",o,t],["enter",a,t]]),u=Yt(u,Wm(t.parser.constructs.insideSpan.null,e.slice(r+1,n),t)),u=Yt(u,[["exit",a,t],["enter",s,t],["exit",s,t],["exit",i,t]]),e[n][1].end.offset-e[n][1].start.offset?(h=2,u=Yt(u,[["enter",e[n][1],t],["exit",e[n][1],t]])):h=0,Fn(e,r-1,n-r+3,u),n=r+u.length-h-2;break}}for(n=-1;++n<e.length;)e[n][1].type==="attentionSequence"&&(e[n][1].type="data");return e}function Wk(e,t){const n=this.parser.constructs.attentionMarkers.null,r=this.previous,i=Op(r);let a;return o;function o(l){return a=l,e.enter("attentionSequence"),s(l)}function s(l){if(l===a)return e.consume(l),s;const u=e.exit("attentionSequence"),h=Op(l),c=!h||h===2&&i||n.includes(l),m=!i||i===2&&h||n.includes(r);return u._open=!!(a===42?c:c&&(i||!m)),u._close=!!(a===42?m:m&&(h||!c)),t(l)}}function jp(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const Xk={name:"autolink",tokenize:Uk};function Uk(e,t,n){let r=0;return i;function i(d){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(d),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),a}function a(d){return Pn(d)?(e.consume(d),o):d===64?n(d):u(d)}function o(d){return d===43||d===45||d===46||Lt(d)?(r=1,s(d)):u(d)}function s(d){return d===58?(e.consume(d),r=0,l):(d===43||d===45||d===46||Lt(d))&&r++<32?(e.consume(d),s):(r=0,u(d))}function l(d){return d===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(d),e.exit("autolinkMarker"),e.exit("autolink"),t):d===null||d===32||d===60||Qc(d)?n(d):(e.consume(d),l)}function u(d){return d===64?(e.consume(d),h):Mk(d)?(e.consume(d),u):n(d)}function h(d){return Lt(d)?c(d):n(d)}function c(d){return d===46?(e.consume(d),r=0,h):d===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(d),e.exit("autolinkMarker"),e.exit("autolink"),t):m(d)}function m(d){if((d===45||Lt(d))&&r++<63){const b=d===45?m:c;return e.consume(d),b}return n(d)}}const vu={partial:!0,tokenize:Hk};function Hk(e,t,n){return r;function r(a){return _e(a)?xe(e,i,"linePrefix")(a):i(a)}function i(a){return a===null||ee(a)?t(a):n(a)}}const G$={continuation:{tokenize:Kk},exit:Zk,name:"blockQuote",tokenize:Gk};function Gk(e,t,n){const r=this;return i;function i(o){if(o===62){const s=r.containerState;return s.open||(e.enter("blockQuote",{_container:!0}),s.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(o),e.exit("blockQuoteMarker"),a}return n(o)}function a(o){return _e(o)?(e.enter("blockQuotePrefixWhitespace"),e.consume(o),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(o))}}function Kk(e,t,n){const r=this;return i;function i(o){return _e(o)?xe(e,a,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o):a(o)}function a(o){return e.attempt(G$,t,n)(o)}}function Zk(e){e.exit("blockQuote")}const K$={name:"characterEscape",tokenize:Yk};function Yk(e,t,n){return r;function r(a){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(a),e.exit("escapeMarker"),i}function i(a){return qk(a)?(e.enter("characterEscapeValue"),e.consume(a),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(a)}}const Z$={name:"characterReference",tokenize:Qk};function Qk(e,t,n){const r=this;let i=0,a,o;return s;function s(c){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(c),e.exit("characterReferenceMarker"),l}function l(c){return c===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(c),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),a=31,o=Lt,h(c))}function u(c){return c===88||c===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(c),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),a=6,o=Fk,h):(e.enter("characterReferenceValue"),a=7,o=Jc,h(c))}function h(c){if(c===59&&i){const m=e.exit("characterReferenceValue");return o===Lt&&!Vm(r.sliceSerialize(m))?n(c):(e.enter("characterReferenceMarker"),e.consume(c),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return o(c)&&i++<a?(e.consume(c),h):n(c)}}const Vp={partial:!0,tokenize:e9},Wp={concrete:!0,name:"codeFenced",tokenize:Jk};function Jk(e,t,n){const r=this,i={partial:!0,tokenize:D};let a=0,o=0,s;return l;function l(C){return u(C)}function u(C){const F=r.events[r.events.length-1];return a=F&&F[1].type==="linePrefix"?F[2].sliceSerialize(F[1],!0).length:0,s=C,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),h(C)}function h(C){return C===s?(o++,e.consume(C),h):o<3?n(C):(e.exit("codeFencedFenceSequence"),_e(C)?xe(e,c,"whitespace")(C):c(C))}function c(C){return C===null||ee(C)?(e.exit("codeFencedFence"),r.interrupt?t(C):e.check(Vp,$,T)(C)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),m(C))}function m(C){return C===null||ee(C)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),c(C)):_e(C)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),xe(e,d,"whitespace")(C)):C===96&&C===s?n(C):(e.consume(C),m)}function d(C){return C===null||ee(C)?c(C):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),b(C))}function b(C){return C===null||ee(C)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),c(C)):C===96&&C===s?n(C):(e.consume(C),b)}function $(C){return e.attempt(i,T,w)(C)}function w(C){return e.enter("lineEnding"),e.consume(C),e.exit("lineEnding"),g}function g(C){return a>0&&_e(C)?xe(e,y,"linePrefix",a+1)(C):y(C)}function y(C){return C===null||ee(C)?e.check(Vp,$,T)(C):(e.enter("codeFlowValue"),_(C))}function _(C){return C===null||ee(C)?(e.exit("codeFlowValue"),y(C)):(e.consume(C),_)}function T(C){return e.exit("codeFenced"),t(C)}function D(C,F,R){let N=0;return O;function O(ae){return C.enter("lineEnding"),C.consume(ae),C.exit("lineEnding"),U}function U(ae){return C.enter("codeFencedFence"),_e(ae)?xe(C,B,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(ae):B(ae)}function B(ae){return ae===s?(C.enter("codeFencedFenceSequence"),he(ae)):R(ae)}function he(ae){return ae===s?(N++,C.consume(ae),he):N>=o?(C.exit("codeFencedFenceSequence"),_e(ae)?xe(C,ue,"whitespace")(ae):ue(ae)):R(ae)}function ue(ae){return ae===null||ee(ae)?(C.exit("codeFencedFence"),F(ae)):R(ae)}}}function e9(e,t,n){const r=this;return i;function i(o){return o===null?n(o):(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),a)}function a(o){return r.parser.lazy[r.now().line]?n(o):t(o)}}const ph={name:"codeIndented",tokenize:n9},t9={partial:!0,tokenize:r9};function n9(e,t,n){const r=this;return i;function i(u){return e.enter("codeIndented"),xe(e,a,"linePrefix",5)(u)}function a(u){const h=r.events[r.events.length-1];return h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?o(u):n(u)}function o(u){return u===null?l(u):ee(u)?e.attempt(t9,o,l)(u):(e.enter("codeFlowValue"),s(u))}function s(u){return u===null||ee(u)?(e.exit("codeFlowValue"),o(u)):(e.consume(u),s)}function l(u){return e.exit("codeIndented"),t(u)}}function r9(e,t,n){const r=this;return i;function i(o){return r.parser.lazy[r.now().line]?n(o):ee(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),i):xe(e,a,"linePrefix",5)(o)}function a(o){const s=r.events[r.events.length-1];return s&&s[1].type==="linePrefix"&&s[2].sliceSerialize(s[1],!0).length>=4?t(o):ee(o)?i(o):n(o)}}const i9={name:"codeText",previous:o9,resolve:a9,tokenize:s9};function a9(e){let t=e.length-4,n=3,r,i;if((e[n][1].type==="lineEnding"||e[n][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(r=n;++r<t;)if(e[r][1].type==="codeTextData"){e[n][1].type="codeTextPadding",e[t][1].type="codeTextPadding",n+=2,t-=2;break}}for(r=n-1,t++;++r<=t;)i===void 0?r!==t&&e[r][1].type!=="lineEnding"&&(i=r):(r===t||e[r][1].type==="lineEnding")&&(e[i][1].type="codeTextData",r!==i+2&&(e[i][1].end=e[r-1][1].end,e.splice(i+2,r-i-2),t-=r-i-2,r=i+2),i=void 0);return e}function o9(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function s9(e,t,n){let r=0,i,a;return o;function o(c){return e.enter("codeText"),e.enter("codeTextSequence"),s(c)}function s(c){return c===96?(e.consume(c),r++,s):(e.exit("codeTextSequence"),l(c))}function l(c){return c===null?n(c):c===32?(e.enter("space"),e.consume(c),e.exit("space"),l):c===96?(a=e.enter("codeTextSequence"),i=0,h(c)):ee(c)?(e.enter("lineEnding"),e.consume(c),e.exit("lineEnding"),l):(e.enter("codeTextData"),u(c))}function u(c){return c===null||c===32||c===96||ee(c)?(e.exit("codeTextData"),l(c)):(e.consume(c),u)}function h(c){return c===96?(e.consume(c),i++,h):i===r?(e.exit("codeTextSequence"),e.exit("codeText"),t(c)):(a.type="codeTextData",u(c))}}class l9{constructor(t){this.left=t?[...t]:[],this.right=[]}get(t){if(t<0||t>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+t+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return t<this.left.length?this.left[t]:this.right[this.right.length-t+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(t,n){const r=n??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(t,r):t>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-t+this.left.length).reverse():this.left.slice(t).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(t,n,r){const i=n||0;this.setCursor(Math.trunc(t));const a=this.right.splice(this.right.length-i,Number.POSITIVE_INFINITY);return r&&Xa(this.left,r),a.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(t){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(t)}pushMany(t){this.setCursor(Number.POSITIVE_INFINITY),Xa(this.left,t)}unshift(t){this.setCursor(0),this.right.push(t)}unshiftMany(t){this.setCursor(0),Xa(this.right,t.reverse())}setCursor(t){if(!(t===this.left.length||t>this.left.length&&this.right.length===0||t<0&&this.left.length===0))if(t<this.left.length){const n=this.left.splice(t,Number.POSITIVE_INFINITY);Xa(this.right,n.reverse())}else{const n=this.right.splice(this.left.length+this.right.length-t,Number.POSITIVE_INFINITY);Xa(this.left,n.reverse())}}}function Xa(e,t){let n=0;if(t.length<1e4)e.push(...t);else for(;n<t.length;)e.push(...t.slice(n,n+1e4)),n+=1e4}function Y$(e){const t={};let n=-1,r,i,a,o,s,l,u;const h=new l9(e);for(;++n<h.length;){for(;n in t;)n=t[n];if(r=h.get(n),n&&r[1].type==="chunkFlow"&&h.get(n-1)[1].type==="listItemPrefix"&&(l=r[1]._tokenizer.events,a=0,a<l.length&&l[a][1].type==="lineEndingBlank"&&(a+=2),a<l.length&&l[a][1].type==="content"))for(;++a<l.length&&l[a][1].type!=="content";)l[a][1].type==="chunkText"&&(l[a][1]._isInFirstContentOfListItem=!0,a++);if(r[0]==="enter")r[1].contentType&&(Object.assign(t,u9(h,n)),n=t[n],u=!0);else if(r[1]._container){for(a=n,i=void 0;a--&&(o=h.get(a),o[1].type==="lineEnding"||o[1].type==="lineEndingBlank");)o[0]==="enter"&&(i&&(h.get(i)[1].type="lineEndingBlank"),o[1].type="lineEnding",i=a);i&&(r[1].end={...h.get(i)[1].start},s=h.slice(i,n),s.unshift(r),h.splice(i,n-i+1,s))}}return Fn(e,0,Number.POSITIVE_INFINITY,h.slice(0)),!u}function u9(e,t){const n=e.get(t)[1],r=e.get(t)[2];let i=t-1;const a=[],o=n._tokenizer||r.parser[n.contentType](n.start),s=o.events,l=[],u={};let h,c,m=-1,d=n,b=0,$=0;const w=[$];for(;d;){for(;e.get(++i)[1]!==d;);a.push(i),d._tokenizer||(h=r.sliceStream(d),d.next||h.push(null),c&&o.defineSkip(d.start),d._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(h),d._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),c=d,d=d.next}for(d=n;++m<s.length;)s[m][0]==="exit"&&s[m-1][0]==="enter"&&s[m][1].type===s[m-1][1].type&&s[m][1].start.line!==s[m][1].end.line&&($=m+1,w.push($),d._tokenizer=void 0,d.previous=void 0,d=d.next);for(o.events=[],d?(d._tokenizer=void 0,d.previous=void 0):w.pop(),m=w.length;m--;){const g=s.slice(w[m],w[m+1]),y=a.pop();l.push([y,y+g.length-1]),e.splice(y,2,g)}for(l.reverse(),m=-1;++m<l.length;)u[b+l[m][0]]=b+l[m][1],b+=l[m][1]-l[m][0]-1;return u}const h9={resolve:m9,tokenize:d9},c9={partial:!0,tokenize:f9};function m9(e){return Y$(e),e}function d9(e,t){let n;return r;function r(s){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),i(s)}function i(s){return s===null?a(s):ee(s)?e.check(c9,o,a)(s):(e.consume(s),i)}function a(s){return e.exit("chunkContent"),e.exit("content"),t(s)}function o(s){return e.consume(s),e.exit("chunkContent"),n.next=e.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,i}}function f9(e,t,n){const r=this;return i;function i(o){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),xe(e,a,"linePrefix")}function a(o){if(o===null||ee(o))return n(o);const s=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&s&&s[1].type==="linePrefix"&&s[2].sliceSerialize(s[1],!0).length>=4?t(o):e.interrupt(r.parser.constructs.flow,n,t)(o)}}function Q$(e,t,n,r,i,a,o,s,l){const u=l||Number.POSITIVE_INFINITY;let h=0;return c;function c(g){return g===60?(e.enter(r),e.enter(i),e.enter(a),e.consume(g),e.exit(a),m):g===null||g===32||g===41||Qc(g)?n(g):(e.enter(r),e.enter(o),e.enter(s),e.enter("chunkString",{contentType:"string"}),$(g))}function m(g){return g===62?(e.enter(a),e.consume(g),e.exit(a),e.exit(i),e.exit(r),t):(e.enter(s),e.enter("chunkString",{contentType:"string"}),d(g))}function d(g){return g===62?(e.exit("chunkString"),e.exit(s),m(g)):g===null||g===60||ee(g)?n(g):(e.consume(g),g===92?b:d)}function b(g){return g===60||g===62||g===92?(e.consume(g),d):d(g)}function $(g){return!h&&(g===null||g===41||Mt(g))?(e.exit("chunkString"),e.exit(s),e.exit(o),e.exit(r),t(g)):h<u&&g===40?(e.consume(g),h++,$):g===41?(e.consume(g),h--,$):g===null||g===32||g===40||Qc(g)?n(g):(e.consume(g),g===92?w:$)}function w(g){return g===40||g===41||g===92?(e.consume(g),$):$(g)}}function J$(e,t,n,r,i,a){const o=this;let s=0,l;return u;function u(d){return e.enter(r),e.enter(i),e.consume(d),e.exit(i),e.enter(a),h}function h(d){return s>999||d===null||d===91||d===93&&!l||d===94&&!s&&"_hiddenFootnoteSupport"in o.parser.constructs?n(d):d===93?(e.exit(a),e.enter(i),e.consume(d),e.exit(i),e.exit(r),t):ee(d)?(e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),h):(e.enter("chunkString",{contentType:"string"}),c(d))}function c(d){return d===null||d===91||d===93||ee(d)||s++>999?(e.exit("chunkString"),h(d)):(e.consume(d),l||(l=!_e(d)),d===92?m:c)}function m(d){return d===91||d===92||d===93?(e.consume(d),s++,c):c(d)}}function e4(e,t,n,r,i,a){let o;return s;function s(m){return m===34||m===39||m===40?(e.enter(r),e.enter(i),e.consume(m),e.exit(i),o=m===40?41:m,l):n(m)}function l(m){return m===o?(e.enter(i),e.consume(m),e.exit(i),e.exit(r),t):(e.enter(a),u(m))}function u(m){return m===o?(e.exit(a),l(o)):m===null?n(m):ee(m)?(e.enter("lineEnding"),e.consume(m),e.exit("lineEnding"),xe(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),h(m))}function h(m){return m===o||m===null||ee(m)?(e.exit("chunkString"),u(m)):(e.consume(m),m===92?c:h)}function c(m){return m===o||m===92?(e.consume(m),h):h(m)}}function co(e,t){let n;return r;function r(i){return ee(i)?(e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),n=!0,r):_e(i)?xe(e,r,n?"linePrefix":"lineSuffix")(i):t(i)}}const p9={name:"definition",tokenize:b9},g9={partial:!0,tokenize:y9};function b9(e,t,n){const r=this;let i;return a;function a(d){return e.enter("definition"),o(d)}function o(d){return J$.call(r,e,s,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(d)}function s(d){return i=aa(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),d===58?(e.enter("definitionMarker"),e.consume(d),e.exit("definitionMarker"),l):n(d)}function l(d){return Mt(d)?co(e,u)(d):u(d)}function u(d){return Q$(e,h,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(d)}function h(d){return e.attempt(g9,c,c)(d)}function c(d){return _e(d)?xe(e,m,"whitespace")(d):m(d)}function m(d){return d===null||ee(d)?(e.exit("definition"),r.parser.defined.push(i),t(d)):n(d)}}function y9(e,t,n){return r;function r(s){return Mt(s)?co(e,i)(s):n(s)}function i(s){return e4(e,a,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(s)}function a(s){return _e(s)?xe(e,o,"whitespace")(s):o(s)}function o(s){return s===null||ee(s)?t(s):n(s)}}const $9={name:"hardBreakEscape",tokenize:v9};function v9(e,t,n){return r;function r(a){return e.enter("hardBreakEscape"),e.consume(a),i}function i(a){return ee(a)?(e.exit("hardBreakEscape"),t(a)):n(a)}}const _9={name:"headingAtx",resolve:x9,tokenize:w9};function x9(e,t){let n=e.length-2,r=3,i,a;return e[r][1].type==="whitespace"&&(r+=2),n-2>r&&e[n][1].type==="whitespace"&&(n-=2),e[n][1].type==="atxHeadingSequence"&&(r===n-1||n-4>r&&e[n-2][1].type==="whitespace")&&(n-=r+1===n?2:4),n>r&&(i={type:"atxHeadingText",start:e[r][1].start,end:e[n][1].end},a={type:"chunkText",start:e[r][1].start,end:e[n][1].end,contentType:"text"},Fn(e,r,n-r+1,[["enter",i,t],["enter",a,t],["exit",a,t],["exit",i,t]])),e}function w9(e,t,n){let r=0;return i;function i(h){return e.enter("atxHeading"),a(h)}function a(h){return e.enter("atxHeadingSequence"),o(h)}function o(h){return h===35&&r++<6?(e.consume(h),o):h===null||Mt(h)?(e.exit("atxHeadingSequence"),s(h)):n(h)}function s(h){return h===35?(e.enter("atxHeadingSequence"),l(h)):h===null||ee(h)?(e.exit("atxHeading"),t(h)):_e(h)?xe(e,s,"whitespace")(h):(e.enter("atxHeadingText"),u(h))}function l(h){return h===35?(e.consume(h),l):(e.exit("atxHeadingSequence"),s(h))}function u(h){return h===null||h===35||Mt(h)?(e.exit("atxHeadingText"),s(h)):(e.consume(h),u)}}const k9=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Xp=["pre","script","style","textarea"],S9={concrete:!0,name:"htmlFlow",resolveTo:P9,tokenize:D9},E9={partial:!0,tokenize:A9},C9={partial:!0,tokenize:T9};function P9(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function D9(e,t,n){const r=this;let i,a,o,s,l;return u;function u(A){return h(A)}function h(A){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(A),c}function c(A){return A===33?(e.consume(A),m):A===47?(e.consume(A),a=!0,$):A===63?(e.consume(A),i=3,r.interrupt?t:k):Pn(A)?(e.consume(A),o=String.fromCharCode(A),w):n(A)}function m(A){return A===45?(e.consume(A),i=2,d):A===91?(e.consume(A),i=5,s=0,b):Pn(A)?(e.consume(A),i=4,r.interrupt?t:k):n(A)}function d(A){return A===45?(e.consume(A),r.interrupt?t:k):n(A)}function b(A){const Re="CDATA[";return A===Re.charCodeAt(s++)?(e.consume(A),s===Re.length?r.interrupt?t:B:b):n(A)}function $(A){return Pn(A)?(e.consume(A),o=String.fromCharCode(A),w):n(A)}function w(A){if(A===null||A===47||A===62||Mt(A)){const Re=A===47,nt=o.toLowerCase();return!Re&&!a&&Xp.includes(nt)?(i=1,r.interrupt?t(A):B(A)):k9.includes(o.toLowerCase())?(i=6,Re?(e.consume(A),g):r.interrupt?t(A):B(A)):(i=7,r.interrupt&&!r.parser.lazy[r.now().line]?n(A):a?y(A):_(A))}return A===45||Lt(A)?(e.consume(A),o+=String.fromCharCode(A),w):n(A)}function g(A){return A===62?(e.consume(A),r.interrupt?t:B):n(A)}function y(A){return _e(A)?(e.consume(A),y):O(A)}function _(A){return A===47?(e.consume(A),O):A===58||A===95||Pn(A)?(e.consume(A),T):_e(A)?(e.consume(A),_):O(A)}function T(A){return A===45||A===46||A===58||A===95||Lt(A)?(e.consume(A),T):D(A)}function D(A){return A===61?(e.consume(A),C):_e(A)?(e.consume(A),D):_(A)}function C(A){return A===null||A===60||A===61||A===62||A===96?n(A):A===34||A===39?(e.consume(A),l=A,F):_e(A)?(e.consume(A),C):R(A)}function F(A){return A===l?(e.consume(A),l=null,N):A===null||ee(A)?n(A):(e.consume(A),F)}function R(A){return A===null||A===34||A===39||A===47||A===60||A===61||A===62||A===96||Mt(A)?D(A):(e.consume(A),R)}function N(A){return A===47||A===62||_e(A)?_(A):n(A)}function O(A){return A===62?(e.consume(A),U):n(A)}function U(A){return A===null||ee(A)?B(A):_e(A)?(e.consume(A),U):n(A)}function B(A){return A===45&&i===2?(e.consume(A),be):A===60&&i===1?(e.consume(A),le):A===62&&i===4?(e.consume(A),ne):A===63&&i===3?(e.consume(A),k):A===93&&i===5?(e.consume(A),J):ee(A)&&(i===6||i===7)?(e.exit("htmlFlowData"),e.check(E9,de,he)(A)):A===null||ee(A)?(e.exit("htmlFlowData"),he(A)):(e.consume(A),B)}function he(A){return e.check(C9,ue,de)(A)}function ue(A){return e.enter("lineEnding"),e.consume(A),e.exit("lineEnding"),ae}function ae(A){return A===null||ee(A)?he(A):(e.enter("htmlFlowData"),B(A))}function be(A){return A===45?(e.consume(A),k):B(A)}function le(A){return A===47?(e.consume(A),o="",j):B(A)}function j(A){if(A===62){const Re=o.toLowerCase();return Xp.includes(Re)?(e.consume(A),ne):B(A)}return Pn(A)&&o.length<8?(e.consume(A),o+=String.fromCharCode(A),j):B(A)}function J(A){return A===93?(e.consume(A),k):B(A)}function k(A){return A===62?(e.consume(A),ne):A===45&&i===2?(e.consume(A),k):B(A)}function ne(A){return A===null||ee(A)?(e.exit("htmlFlowData"),de(A)):(e.consume(A),ne)}function de(A){return e.exit("htmlFlow"),t(A)}}function T9(e,t,n){const r=this;return i;function i(o){return ee(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),a):n(o)}function a(o){return r.parser.lazy[r.now().line]?n(o):t(o)}}function A9(e,t,n){return r;function r(i){return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),e.attempt(vu,t,n)}}const z9={name:"htmlText",tokenize:M9};function M9(e,t,n){const r=this;let i,a,o;return s;function s(k){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(k),l}function l(k){return k===33?(e.consume(k),u):k===47?(e.consume(k),D):k===63?(e.consume(k),_):Pn(k)?(e.consume(k),R):n(k)}function u(k){return k===45?(e.consume(k),h):k===91?(e.consume(k),a=0,b):Pn(k)?(e.consume(k),y):n(k)}function h(k){return k===45?(e.consume(k),d):n(k)}function c(k){return k===null?n(k):k===45?(e.consume(k),m):ee(k)?(o=c,le(k)):(e.consume(k),c)}function m(k){return k===45?(e.consume(k),d):c(k)}function d(k){return k===62?be(k):k===45?m(k):c(k)}function b(k){const ne="CDATA[";return k===ne.charCodeAt(a++)?(e.consume(k),a===ne.length?$:b):n(k)}function $(k){return k===null?n(k):k===93?(e.consume(k),w):ee(k)?(o=$,le(k)):(e.consume(k),$)}function w(k){return k===93?(e.consume(k),g):$(k)}function g(k){return k===62?be(k):k===93?(e.consume(k),g):$(k)}function y(k){return k===null||k===62?be(k):ee(k)?(o=y,le(k)):(e.consume(k),y)}function _(k){return k===null?n(k):k===63?(e.consume(k),T):ee(k)?(o=_,le(k)):(e.consume(k),_)}function T(k){return k===62?be(k):_(k)}function D(k){return Pn(k)?(e.consume(k),C):n(k)}function C(k){return k===45||Lt(k)?(e.consume(k),C):F(k)}function F(k){return ee(k)?(o=F,le(k)):_e(k)?(e.consume(k),F):be(k)}function R(k){return k===45||Lt(k)?(e.consume(k),R):k===47||k===62||Mt(k)?N(k):n(k)}function N(k){return k===47?(e.consume(k),be):k===58||k===95||Pn(k)?(e.consume(k),O):ee(k)?(o=N,le(k)):_e(k)?(e.consume(k),N):be(k)}function O(k){return k===45||k===46||k===58||k===95||Lt(k)?(e.consume(k),O):U(k)}function U(k){return k===61?(e.consume(k),B):ee(k)?(o=U,le(k)):_e(k)?(e.consume(k),U):N(k)}function B(k){return k===null||k===60||k===61||k===62||k===96?n(k):k===34||k===39?(e.consume(k),i=k,he):ee(k)?(o=B,le(k)):_e(k)?(e.consume(k),B):(e.consume(k),ue)}function he(k){return k===i?(e.consume(k),i=void 0,ae):k===null?n(k):ee(k)?(o=he,le(k)):(e.consume(k),he)}function ue(k){return k===null||k===34||k===39||k===60||k===61||k===96?n(k):k===47||k===62||Mt(k)?N(k):(e.consume(k),ue)}function ae(k){return k===47||k===62||Mt(k)?N(k):n(k)}function be(k){return k===62?(e.consume(k),e.exit("htmlTextData"),e.exit("htmlText"),t):n(k)}function le(k){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(k),e.exit("lineEnding"),j}function j(k){return _e(k)?xe(e,J,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(k):J(k)}function J(k){return e.enter("htmlTextData"),o(k)}}const Xm={name:"labelEnd",resolveAll:N9,resolveTo:I9,tokenize:B9},F9={tokenize:L9},q9={tokenize:O9},R9={tokenize:j9};function N9(e){let t=-1;const n=[];for(;++t<e.length;){const r=e[t][1];if(n.push(e[t]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const i=r.type==="labelImage"?4:2;r.type="data",t+=i}}return e.length!==n.length&&Fn(e,0,e.length,n),e}function I9(e,t){let n=e.length,r=0,i,a,o,s;for(;n--;)if(i=e[n][1],a){if(i.type==="link"||i.type==="labelLink"&&i._inactive)break;e[n][0]==="enter"&&i.type==="labelLink"&&(i._inactive=!0)}else if(o){if(e[n][0]==="enter"&&(i.type==="labelImage"||i.type==="labelLink")&&!i._balanced&&(a=n,i.type!=="labelLink")){r=2;break}}else i.type==="labelEnd"&&(o=n);const l={type:e[a][1].type==="labelLink"?"link":"image",start:{...e[a][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[a][1].start},end:{...e[o][1].end}},h={type:"labelText",start:{...e[a+r+2][1].end},end:{...e[o-2][1].start}};return s=[["enter",l,t],["enter",u,t]],s=Yt(s,e.slice(a+1,a+r+3)),s=Yt(s,[["enter",h,t]]),s=Yt(s,Wm(t.parser.constructs.insideSpan.null,e.slice(a+r+4,o-3),t)),s=Yt(s,[["exit",h,t],e[o-2],e[o-1],["exit",u,t]]),s=Yt(s,e.slice(o+1)),s=Yt(s,[["exit",l,t]]),Fn(e,a,e.length,s),e}function B9(e,t,n){const r=this;let i=r.events.length,a,o;for(;i--;)if((r.events[i][1].type==="labelImage"||r.events[i][1].type==="labelLink")&&!r.events[i][1]._balanced){a=r.events[i][1];break}return s;function s(m){return a?a._inactive?c(m):(o=r.parser.defined.includes(aa(r.sliceSerialize({start:a.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(m),e.exit("labelMarker"),e.exit("labelEnd"),l):n(m)}function l(m){return m===40?e.attempt(F9,h,o?h:c)(m):m===91?e.attempt(q9,h,o?u:c)(m):o?h(m):c(m)}function u(m){return e.attempt(R9,h,c)(m)}function h(m){return t(m)}function c(m){return a._balanced=!0,n(m)}}function L9(e,t,n){return r;function r(c){return e.enter("resource"),e.enter("resourceMarker"),e.consume(c),e.exit("resourceMarker"),i}function i(c){return Mt(c)?co(e,a)(c):a(c)}function a(c){return c===41?h(c):Q$(e,o,s,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(c)}function o(c){return Mt(c)?co(e,l)(c):h(c)}function s(c){return n(c)}function l(c){return c===34||c===39||c===40?e4(e,u,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(c):h(c)}function u(c){return Mt(c)?co(e,h)(c):h(c)}function h(c){return c===41?(e.enter("resourceMarker"),e.consume(c),e.exit("resourceMarker"),e.exit("resource"),t):n(c)}}function O9(e,t,n){const r=this;return i;function i(s){return J$.call(r,e,a,o,"reference","referenceMarker","referenceString")(s)}function a(s){return r.parser.defined.includes(aa(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?t(s):n(s)}function o(s){return n(s)}}function j9(e,t,n){return r;function r(a){return e.enter("reference"),e.enter("referenceMarker"),e.consume(a),e.exit("referenceMarker"),i}function i(a){return a===93?(e.enter("referenceMarker"),e.consume(a),e.exit("referenceMarker"),e.exit("reference"),t):n(a)}}const V9={name:"labelStartImage",resolveAll:Xm.resolveAll,tokenize:W9};function W9(e,t,n){const r=this;return i;function i(s){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(s),e.exit("labelImageMarker"),a}function a(s){return s===91?(e.enter("labelMarker"),e.consume(s),e.exit("labelMarker"),e.exit("labelImage"),o):n(s)}function o(s){return s===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(s):t(s)}}const X9={name:"labelStartLink",resolveAll:Xm.resolveAll,tokenize:U9};function U9(e,t,n){const r=this;return i;function i(o){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(o),e.exit("labelMarker"),e.exit("labelLink"),a}function a(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(o):t(o)}}const gh={name:"lineEnding",tokenize:H9};function H9(e,t){return n;function n(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),xe(e,t,"linePrefix")}}const sl={name:"thematicBreak",tokenize:G9};function G9(e,t,n){let r=0,i;return a;function a(u){return e.enter("thematicBreak"),o(u)}function o(u){return i=u,s(u)}function s(u){return u===i?(e.enter("thematicBreakSequence"),l(u)):r>=3&&(u===null||ee(u))?(e.exit("thematicBreak"),t(u)):n(u)}function l(u){return u===i?(e.consume(u),r++,l):(e.exit("thematicBreakSequence"),_e(u)?xe(e,s,"whitespace")(u):s(u))}}const Et={continuation:{tokenize:Q9},exit:eS,name:"list",tokenize:Y9},K9={partial:!0,tokenize:tS},Z9={partial:!0,tokenize:J9};function Y9(e,t,n){const r=this,i=r.events[r.events.length-1];let a=i&&i[1].type==="linePrefix"?i[2].sliceSerialize(i[1],!0).length:0,o=0;return s;function s(d){const b=r.containerState.type||(d===42||d===43||d===45?"listUnordered":"listOrdered");if(b==="listUnordered"?!r.containerState.marker||d===r.containerState.marker:Jc(d)){if(r.containerState.type||(r.containerState.type=b,e.enter(b,{_container:!0})),b==="listUnordered")return e.enter("listItemPrefix"),d===42||d===45?e.check(sl,n,u)(d):u(d);if(!r.interrupt||d===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),l(d)}return n(d)}function l(d){return Jc(d)&&++o<10?(e.consume(d),l):(!r.interrupt||o<2)&&(r.containerState.marker?d===r.containerState.marker:d===41||d===46)?(e.exit("listItemValue"),u(d)):n(d)}function u(d){return e.enter("listItemMarker"),e.consume(d),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||d,e.check(vu,r.interrupt?n:h,e.attempt(K9,m,c))}function h(d){return r.containerState.initialBlankLine=!0,a++,m(d)}function c(d){return _e(d)?(e.enter("listItemPrefixWhitespace"),e.consume(d),e.exit("listItemPrefixWhitespace"),m):n(d)}function m(d){return r.containerState.size=a+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(d)}}function Q9(e,t,n){const r=this;return r.containerState._closeFlow=void 0,e.check(vu,i,a);function i(s){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,xe(e,t,"listItemIndent",r.containerState.size+1)(s)}function a(s){return r.containerState.furtherBlankLines||!_e(s)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,o(s)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(Z9,t,o)(s))}function o(s){return r.containerState._closeFlow=!0,r.interrupt=void 0,xe(e,e.attempt(Et,t,n),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(s)}}function J9(e,t,n){const r=this;return xe(e,i,"listItemIndent",r.containerState.size+1);function i(a){const o=r.events[r.events.length-1];return o&&o[1].type==="listItemIndent"&&o[2].sliceSerialize(o[1],!0).length===r.containerState.size?t(a):n(a)}}function eS(e){e.exit(this.containerState.type)}function tS(e,t,n){const r=this;return xe(e,i,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function i(a){const o=r.events[r.events.length-1];return!_e(a)&&o&&o[1].type==="listItemPrefixWhitespace"?t(a):n(a)}}const Up={name:"setextUnderline",resolveTo:nS,tokenize:rS};function nS(e,t){let n=e.length,r,i,a;for(;n--;)if(e[n][0]==="enter"){if(e[n][1].type==="content"){r=n;break}e[n][1].type==="paragraph"&&(i=n)}else e[n][1].type==="content"&&e.splice(n,1),!a&&e[n][1].type==="definition"&&(a=n);const o={type:"setextHeading",start:{...e[i][1].start},end:{...e[e.length-1][1].end}};return e[i][1].type="setextHeadingText",a?(e.splice(i,0,["enter",o,t]),e.splice(a+1,0,["exit",e[r][1],t]),e[r][1].end={...e[a][1].end}):e[r][1]=o,e.push(["exit",o,t]),e}function rS(e,t,n){const r=this;let i;return a;function a(u){let h=r.events.length,c;for(;h--;)if(r.events[h][1].type!=="lineEnding"&&r.events[h][1].type!=="linePrefix"&&r.events[h][1].type!=="content"){c=r.events[h][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||c)?(e.enter("setextHeadingLine"),i=u,o(u)):n(u)}function o(u){return e.enter("setextHeadingLineSequence"),s(u)}function s(u){return u===i?(e.consume(u),s):(e.exit("setextHeadingLineSequence"),_e(u)?xe(e,l,"lineSuffix")(u):l(u))}function l(u){return u===null||ee(u)?(e.exit("setextHeadingLine"),t(u)):n(u)}}const iS={tokenize:aS};function aS(e){const t=this,n=e.attempt(vu,r,e.attempt(this.parser.constructs.flowInitial,i,xe(e,e.attempt(this.parser.constructs.flow,i,e.attempt(h9,i)),"linePrefix")));return n;function r(a){if(a===null){e.consume(a);return}return e.enter("lineEndingBlank"),e.consume(a),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n}function i(a){if(a===null){e.consume(a);return}return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t.currentConstruct=void 0,n}}const oS={resolveAll:n4()},sS=t4("string"),lS=t4("text");function t4(e){return{resolveAll:n4(e==="text"?uS:void 0),tokenize:t};function t(n){const r=this,i=this.parser.constructs[e],a=n.attempt(i,o,s);return o;function o(h){return u(h)?a(h):s(h)}function s(h){if(h===null){n.consume(h);return}return n.enter("data"),n.consume(h),l}function l(h){return u(h)?(n.exit("data"),a(h)):(n.consume(h),l)}function u(h){if(h===null)return!0;const c=i[h];let m=-1;if(c)for(;++m<c.length;){const d=c[m];if(!d.previous||d.previous.call(r,r.previous))return!0}return!1}}}function n4(e){return t;function t(n,r){let i=-1,a;for(;++i<=n.length;)a===void 0?n[i]&&n[i][1].type==="data"&&(a=i,i++):(!n[i]||n[i][1].type!=="data")&&(i!==a+2&&(n[a][1].end=n[i-1][1].end,n.splice(a+2,i-a-2),i=a+2),a=void 0);return e?e(n,r):n}}function uS(e,t){let n=0;for(;++n<=e.length;)if((n===e.length||e[n][1].type==="lineEnding")&&e[n-1][1].type==="data"){const r=e[n-1][1],i=t.sliceStream(r);let a=i.length,o=-1,s=0,l;for(;a--;){const u=i[a];if(typeof u=="string"){for(o=u.length;u.charCodeAt(o-1)===32;)s++,o--;if(o)break;o=-1}else if(u===-2)l=!0,s++;else if(u!==-1){a++;break}}if(s){const u={type:n===e.length||l||s<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:a?o:r.start._bufferIndex+o,_index:r.start._index+a,line:r.end.line,column:r.end.column-s,offset:r.end.offset-s},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(e.splice(n,0,["enter",u,t],["exit",u,t]),n+=2)}n++}return e}const hS={42:Et,43:Et,45:Et,48:Et,49:Et,50:Et,51:Et,52:Et,53:Et,54:Et,55:Et,56:Et,57:Et,62:G$},cS={91:p9},mS={[-2]:ph,[-1]:ph,32:ph},dS={35:_9,42:sl,45:[Up,sl],60:S9,61:Up,95:sl,96:Wp,126:Wp},fS={38:Z$,92:K$},pS={[-5]:gh,[-4]:gh,[-3]:gh,33:V9,38:Z$,42:e0,60:[Xk,z9],91:X9,92:[$9,K$],93:Xm,95:e0,96:i9},gS={null:[e0,oS]},bS={null:[42,95]},yS={null:[]},$S=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:bS,contentInitial:cS,disable:yS,document:hS,flow:dS,flowInitial:mS,insideSpan:gS,string:fS,text:pS},Symbol.toStringTag,{value:"Module"}));function vS(e,t,n){let r={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0};const i={},a=[];let o=[],s=[];const l={attempt:F(D),check:F(C),consume:y,enter:_,exit:T,interrupt:F(C,{interrupt:!0})},u={code:null,containerState:{},defineSkip:$,events:[],now:b,parser:e,previous:null,sliceSerialize:m,sliceStream:d,write:c};let h=t.tokenize.call(u,l);return t.resolveAll&&a.push(t),u;function c(U){return o=Yt(o,U),w(),o[o.length-1]!==null?[]:(R(t,0),u.events=Wm(a,u.events,u),u.events)}function m(U,B){return xS(d(U),B)}function d(U){return _S(o,U)}function b(){const{_bufferIndex:U,_index:B,line:he,column:ue,offset:ae}=r;return{_bufferIndex:U,_index:B,line:he,column:ue,offset:ae}}function $(U){i[U.line]=U.column,O()}function w(){let U;for(;r._index<o.length;){const B=o[r._index];if(typeof B=="string")for(U=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===U&&r._bufferIndex<B.length;)g(B.charCodeAt(r._bufferIndex));else g(B)}}function g(U){h=h(U)}function y(U){ee(U)?(r.line++,r.column=1,r.offset+=U===-3?2:1,O()):U!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===o[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=U}function _(U,B){const he=B||{};return he.type=U,he.start=b(),u.events.push(["enter",he,u]),s.push(he),he}function T(U){const B=s.pop();return B.end=b(),u.events.push(["exit",B,u]),B}function D(U,B){R(U,B.from)}function C(U,B){B.restore()}function F(U,B){return he;function he(ue,ae,be){let le,j,J,k;return Array.isArray(ue)?de(ue):"tokenize"in ue?de([ue]):ne(ue);function ne(ke){return at;function at(bt){const un=bt!==null&&ke[bt],hn=bt!==null&&ke.null,Si=[...Array.isArray(un)?un:un?[un]:[],...Array.isArray(hn)?hn:hn?[hn]:[]];return de(Si)(bt)}}function de(ke){return le=ke,j=0,ke.length===0?be:A(ke[j])}function A(ke){return at;function at(bt){return k=N(),J=ke,ke.partial||(u.currentConstruct=ke),ke.name&&u.parser.constructs.disable.null.includes(ke.name)?nt():ke.tokenize.call(B?Object.assign(Object.create(u),B):u,l,Re,nt)(bt)}}function Re(ke){return U(J,k),ae}function nt(ke){return k.restore(),++j<le.length?A(le[j]):be}}}function R(U,B){U.resolveAll&&!a.includes(U)&&a.push(U),U.resolve&&Fn(u.events,B,u.events.length-B,U.resolve(u.events.slice(B),u)),U.resolveTo&&(u.events=U.resolveTo(u.events,u))}function N(){const U=b(),B=u.previous,he=u.currentConstruct,ue=u.events.length,ae=Array.from(s);return{from:ue,restore:be};function be(){r=U,u.previous=B,u.currentConstruct=he,u.events.length=ue,s=ae,O()}}function O(){r.line in i&&r.column<2&&(r.column=i[r.line],r.offset+=i[r.line]-1)}}function _S(e,t){const n=t.start._index,r=t.start._bufferIndex,i=t.end._index,a=t.end._bufferIndex;let o;if(n===i)o=[e[n].slice(r,a)];else{if(o=e.slice(n,i),r>-1){const s=o[0];typeof s=="string"?o[0]=s.slice(r):o.shift()}a>0&&o.push(e[i].slice(0,a))}return o}function xS(e,t){let n=-1;const r=[];let i;for(;++n<e.length;){const a=e[n];let o;if(typeof a=="string")o=a;else switch(a){case-5:{o="\r";break}case-4:{o=`
`;break}case-3:{o=`\r
`;break}case-2:{o=t?" ":"	";break}case-1:{if(!t&&i)continue;o=" ";break}default:o=String.fromCharCode(a)}i=a===-2,r.push(o)}return r.join("")}function wS(e){const r={constructs:Tk([$S,...(e||{}).extensions||[]]),content:i(Ik),defined:[],document:i(Lk),flow:i(iS),lazy:{},string:i(sS),text:i(lS)};return r;function i(a){return o;function o(s){return vS(r,a,s)}}}function kS(e){for(;!Y$(e););return e}const Hp=/[\0\t\n\r]/g;function SS(){let e=1,t="",n=!0,r;return i;function i(a,o,s){const l=[];let u,h,c,m,d;for(a=t+(typeof a=="string"?a.toString():new TextDecoder(o||void 0).decode(a)),c=0,t="",n&&(a.charCodeAt(0)===65279&&c++,n=void 0);c<a.length;){if(Hp.lastIndex=c,u=Hp.exec(a),m=u&&u.index!==void 0?u.index:a.length,d=a.charCodeAt(m),!u){t=a.slice(c);break}if(d===10&&c===m&&r)l.push(-3),r=void 0;else switch(r&&(l.push(-5),r=void 0),c<m&&(l.push(a.slice(c,m)),e+=m-c),d){case 0:{l.push(65533),e++;break}case 9:{for(h=Math.ceil(e/4)*4,l.push(-2);e++<h;)l.push(-1);break}case 10:{l.push(-4),e=1;break}default:r=!0,e=1}c=m+1}return s&&(r&&l.push(-5),t&&l.push(t),l.push(null)),l}}const ES=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function CS(e){return e.replace(ES,PS)}function PS(e,t,n){if(t)return t;if(n.charCodeAt(0)===35){const i=n.charCodeAt(1),a=i===120||i===88;return H$(n.slice(a?2:1),a?16:10)}return Vm(n)||e}const r4={}.hasOwnProperty;function DS(e,t,n){return typeof t!="string"&&(n=t,t=void 0),TS(n)(kS(wS(n).document().write(SS()(e,t,!0))))}function TS(e){const t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:a(Gr),autolinkProtocol:N,autolinkEmail:N,atxHeading:a(Ta),blockQuote:a(hn),characterEscape:N,characterReference:N,codeFenced:a(Si),codeFencedFenceInfo:o,codeFencedFenceMeta:o,codeIndented:a(Si,o),codeText:a(qu,o),codeTextData:N,data:N,codeFlowValue:N,definition:a(Ru),definitionDestinationString:o,definitionLabelString:o,definitionTitleString:o,emphasis:a(Da),hardBreakEscape:a(Aa),hardBreakTrailing:a(Aa),htmlFlow:a(Ei,o),htmlFlowData:N,htmlText:a(Ei,o),htmlTextData:N,image:a(Ci),label:o,link:a(Gr),listItem:a(H_),listItemValue:m,listOrdered:a(ef,c),listUnordered:a(ef),paragraph:a(G_),reference:A,referenceString:o,resourceDestinationString:o,resourceTitleString:o,setextHeading:a(Ta),strong:a(K_),thematicBreak:a(Y_)},exit:{atxHeading:l(),atxHeadingSequence:D,autolink:l(),autolinkEmail:un,autolinkProtocol:bt,blockQuote:l(),characterEscapeValue:O,characterReferenceMarkerHexadecimal:nt,characterReferenceMarkerNumeric:nt,characterReferenceValue:ke,characterReference:at,codeFenced:l(w),codeFencedFence:$,codeFencedFenceInfo:d,codeFencedFenceMeta:b,codeFlowValue:O,codeIndented:l(g),codeText:l(ae),codeTextData:O,data:O,definition:l(),definitionDestinationString:T,definitionLabelString:y,definitionTitleString:_,emphasis:l(),hardBreakEscape:l(B),hardBreakTrailing:l(B),htmlFlow:l(he),htmlFlowData:O,htmlText:l(ue),htmlTextData:O,image:l(le),label:J,labelText:j,lineEnding:U,link:l(be),listItem:l(),listOrdered:l(),listUnordered:l(),paragraph:l(),referenceString:Re,resourceDestinationString:k,resourceTitleString:ne,resource:de,setextHeading:l(R),setextHeadingLineSequence:F,setextHeadingText:C,strong:l(),thematicBreak:l()}};i4(t,(e||{}).mdastExtensions||[]);const n={};return r;function r(I){let K={type:"root",children:[]};const ce={stack:[K],tokenStack:[],config:t,enter:s,exit:u,buffer:o,resume:h,data:n},ye=[];let Se=-1;for(;++Se<I.length;)if(I[Se][1].type==="listOrdered"||I[Se][1].type==="listUnordered")if(I[Se][0]==="enter")ye.push(Se);else{const cn=ye.pop();Se=i(I,cn,Se)}for(Se=-1;++Se<I.length;){const cn=t[I[Se][0]];r4.call(cn,I[Se][1].type)&&cn[I[Se][1].type].call(Object.assign({sliceSerialize:I[Se][2].sliceSerialize},ce),I[Se][1])}if(ce.tokenStack.length>0){const cn=ce.tokenStack[ce.tokenStack.length-1];(cn[1]||Gp).call(ce,void 0,cn[0])}for(K.position={start:pr(I.length>0?I[0][1].start:{line:1,column:1,offset:0}),end:pr(I.length>0?I[I.length-2][1].end:{line:1,column:1,offset:0})},Se=-1;++Se<t.transforms.length;)K=t.transforms[Se](K)||K;return K}function i(I,K,ce){let ye=K-1,Se=-1,cn=!1,Kr,Ln,za,Ma;for(;++ye<=ce;){const qt=I[ye];switch(qt[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{qt[0]==="enter"?Se++:Se--,Ma=void 0;break}case"lineEndingBlank":{qt[0]==="enter"&&(Kr&&!Ma&&!Se&&!za&&(za=ye),Ma=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Ma=void 0}if(!Se&&qt[0]==="enter"&&qt[1].type==="listItemPrefix"||Se===-1&&qt[0]==="exit"&&(qt[1].type==="listUnordered"||qt[1].type==="listOrdered")){if(Kr){let Pi=ye;for(Ln=void 0;Pi--;){const On=I[Pi];if(On[1].type==="lineEnding"||On[1].type==="lineEndingBlank"){if(On[0]==="exit")continue;Ln&&(I[Ln][1].type="lineEndingBlank",cn=!0),On[1].type="lineEnding",Ln=Pi}else if(!(On[1].type==="linePrefix"||On[1].type==="blockQuotePrefix"||On[1].type==="blockQuotePrefixWhitespace"||On[1].type==="blockQuoteMarker"||On[1].type==="listItemIndent"))break}za&&(!Ln||za<Ln)&&(Kr._spread=!0),Kr.end=Object.assign({},Ln?I[Ln][1].start:qt[1].end),I.splice(Ln||ye,0,["exit",Kr,qt[2]]),ye++,ce++}if(qt[1].type==="listItemPrefix"){const Pi={type:"listItem",_spread:!1,start:Object.assign({},qt[1].start),end:void 0};Kr=Pi,I.splice(ye,0,["enter",Pi,qt[2]]),ye++,ce++,za=void 0,Ma=!0}}}return I[K][1]._spread=cn,ce}function a(I,K){return ce;function ce(ye){s.call(this,I(ye),ye),K&&K.call(this,ye)}}function o(){this.stack.push({type:"fragment",children:[]})}function s(I,K,ce){this.stack[this.stack.length-1].children.push(I),this.stack.push(I),this.tokenStack.push([K,ce||void 0]),I.position={start:pr(K.start),end:void 0}}function l(I){return K;function K(ce){I&&I.call(this,ce),u.call(this,ce)}}function u(I,K){const ce=this.stack.pop(),ye=this.tokenStack.pop();if(ye)ye[0].type!==I.type&&(K?K.call(this,I,ye[0]):(ye[1]||Gp).call(this,I,ye[0]));else throw new Error("Cannot close `"+I.type+"` ("+ho({start:I.start,end:I.end})+"): it’s not open");ce.position.end=pr(I.end)}function h(){return Pk(this.stack.pop())}function c(){this.data.expectingFirstListItemValue=!0}function m(I){if(this.data.expectingFirstListItemValue){const K=this.stack[this.stack.length-2];K.start=Number.parseInt(this.sliceSerialize(I),10),this.data.expectingFirstListItemValue=void 0}}function d(){const I=this.resume(),K=this.stack[this.stack.length-1];K.lang=I}function b(){const I=this.resume(),K=this.stack[this.stack.length-1];K.meta=I}function $(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function w(){const I=this.resume(),K=this.stack[this.stack.length-1];K.value=I.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function g(){const I=this.resume(),K=this.stack[this.stack.length-1];K.value=I.replace(/(\r?\n|\r)$/g,"")}function y(I){const K=this.resume(),ce=this.stack[this.stack.length-1];ce.label=K,ce.identifier=aa(this.sliceSerialize(I)).toLowerCase()}function _(){const I=this.resume(),K=this.stack[this.stack.length-1];K.title=I}function T(){const I=this.resume(),K=this.stack[this.stack.length-1];K.url=I}function D(I){const K=this.stack[this.stack.length-1];if(!K.depth){const ce=this.sliceSerialize(I).length;K.depth=ce}}function C(){this.data.setextHeadingSlurpLineEnding=!0}function F(I){const K=this.stack[this.stack.length-1];K.depth=this.sliceSerialize(I).codePointAt(0)===61?1:2}function R(){this.data.setextHeadingSlurpLineEnding=void 0}function N(I){const ce=this.stack[this.stack.length-1].children;let ye=ce[ce.length-1];(!ye||ye.type!=="text")&&(ye=Z_(),ye.position={start:pr(I.start),end:void 0},ce.push(ye)),this.stack.push(ye)}function O(I){const K=this.stack.pop();K.value+=this.sliceSerialize(I),K.position.end=pr(I.end)}function U(I){const K=this.stack[this.stack.length-1];if(this.data.atHardBreak){const ce=K.children[K.children.length-1];ce.position.end=pr(I.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(K.type)&&(N.call(this,I),O.call(this,I))}function B(){this.data.atHardBreak=!0}function he(){const I=this.resume(),K=this.stack[this.stack.length-1];K.value=I}function ue(){const I=this.resume(),K=this.stack[this.stack.length-1];K.value=I}function ae(){const I=this.resume(),K=this.stack[this.stack.length-1];K.value=I}function be(){const I=this.stack[this.stack.length-1];if(this.data.inReference){const K=this.data.referenceType||"shortcut";I.type+="Reference",I.referenceType=K,delete I.url,delete I.title}else delete I.identifier,delete I.label;this.data.referenceType=void 0}function le(){const I=this.stack[this.stack.length-1];if(this.data.inReference){const K=this.data.referenceType||"shortcut";I.type+="Reference",I.referenceType=K,delete I.url,delete I.title}else delete I.identifier,delete I.label;this.data.referenceType=void 0}function j(I){const K=this.sliceSerialize(I),ce=this.stack[this.stack.length-2];ce.label=CS(K),ce.identifier=aa(K).toLowerCase()}function J(){const I=this.stack[this.stack.length-1],K=this.resume(),ce=this.stack[this.stack.length-1];if(this.data.inReference=!0,ce.type==="link"){const ye=I.children;ce.children=ye}else ce.alt=K}function k(){const I=this.resume(),K=this.stack[this.stack.length-1];K.url=I}function ne(){const I=this.resume(),K=this.stack[this.stack.length-1];K.title=I}function de(){this.data.inReference=void 0}function A(){this.data.referenceType="collapsed"}function Re(I){const K=this.resume(),ce=this.stack[this.stack.length-1];ce.label=K,ce.identifier=aa(this.sliceSerialize(I)).toLowerCase(),this.data.referenceType="full"}function nt(I){this.data.characterReferenceType=I.type}function ke(I){const K=this.sliceSerialize(I),ce=this.data.characterReferenceType;let ye;ce?(ye=H$(K,ce==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):ye=Vm(K);const Se=this.stack[this.stack.length-1];Se.value+=ye}function at(I){const K=this.stack.pop();K.position.end=pr(I.end)}function bt(I){O.call(this,I);const K=this.stack[this.stack.length-1];K.url=this.sliceSerialize(I)}function un(I){O.call(this,I);const K=this.stack[this.stack.length-1];K.url="mailto:"+this.sliceSerialize(I)}function hn(){return{type:"blockquote",children:[]}}function Si(){return{type:"code",lang:null,meta:null,value:""}}function qu(){return{type:"inlineCode",value:""}}function Ru(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Da(){return{type:"emphasis",children:[]}}function Ta(){return{type:"heading",depth:0,children:[]}}function Aa(){return{type:"break"}}function Ei(){return{type:"html",value:""}}function Ci(){return{type:"image",title:null,url:"",alt:null}}function Gr(){return{type:"link",title:null,url:"",children:[]}}function ef(I){return{type:"list",ordered:I.type==="listOrdered",start:null,spread:I._spread,children:[]}}function H_(I){return{type:"listItem",spread:I._spread,checked:null,children:[]}}function G_(){return{type:"paragraph",children:[]}}function K_(){return{type:"strong",children:[]}}function Z_(){return{type:"text",value:""}}function Y_(){return{type:"thematicBreak"}}}function pr(e){return{line:e.line,column:e.column,offset:e.offset}}function i4(e,t){let n=-1;for(;++n<t.length;){const r=t[n];Array.isArray(r)?i4(e,r):AS(e,r)}}function AS(e,t){let n;for(n in t)if(r4.call(t,n))switch(n){case"canContainEols":{const r=t[n];r&&e[n].push(...r);break}case"transforms":{const r=t[n];r&&e[n].push(...r);break}case"enter":case"exit":{const r=t[n];r&&Object.assign(e[n],r);break}}}function Gp(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+ho({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+ho({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+ho({start:t.start,end:t.end})+") is still open")}function zS(e){const t=this;t.parser=n;function n(r){return DS(r,{...t.data("settings"),...e,extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]})}}function MS(e,t){const n={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,n),e.applyData(t,n)}function FS(e,t){const n={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,n),[e.applyData(t,n),{type:"text",value:`
`}]}function qS(e,t){const n=t.value?t.value+`
`:"",r={};t.lang&&(r.className=["language-"+t.lang]);let i={type:"element",tagName:"code",properties:r,children:[{type:"text",value:n}]};return t.meta&&(i.data={meta:t.meta}),e.patch(t,i),i=e.applyData(t,i),i={type:"element",tagName:"pre",properties:{},children:[i]},e.patch(t,i),i}function RS(e,t){const n={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function NS(e,t){const n={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function IS(e,t){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(t.identifier).toUpperCase(),i=ka(r.toLowerCase()),a=e.footnoteOrder.indexOf(r);let o,s=e.footnoteCounts.get(r);s===void 0?(s=0,e.footnoteOrder.push(r),o=e.footnoteOrder.length):o=a+1,s+=1,e.footnoteCounts.set(r,s);const l={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+i,id:n+"fnref-"+i+(s>1?"-"+s:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(o)}]};e.patch(t,l);const u={type:"element",tagName:"sup",properties:{},children:[l]};return e.patch(t,u),e.applyData(t,u)}function BS(e,t){const n={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function LS(e,t){if(e.options.allowDangerousHtml){const n={type:"raw",value:t.value};return e.patch(t,n),e.applyData(t,n)}}function a4(e,t){const n=t.referenceType;let r="]";if(n==="collapsed"?r+="[]":n==="full"&&(r+="["+(t.label||t.identifier)+"]"),t.type==="imageReference")return[{type:"text",value:"!["+t.alt+r}];const i=e.all(t),a=i[0];a&&a.type==="text"?a.value="["+a.value:i.unshift({type:"text",value:"["});const o=i[i.length-1];return o&&o.type==="text"?o.value+=r:i.push({type:"text",value:r}),i}function OS(e,t){const n=String(t.identifier).toUpperCase(),r=e.definitionById.get(n);if(!r)return a4(e,t);const i={src:ka(r.url||""),alt:t.alt};r.title!==null&&r.title!==void 0&&(i.title=r.title);const a={type:"element",tagName:"img",properties:i,children:[]};return e.patch(t,a),e.applyData(t,a)}function jS(e,t){const n={src:ka(t.url)};t.alt!==null&&t.alt!==void 0&&(n.alt=t.alt),t.title!==null&&t.title!==void 0&&(n.title=t.title);const r={type:"element",tagName:"img",properties:n,children:[]};return e.patch(t,r),e.applyData(t,r)}function VS(e,t){const n={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,n);const r={type:"element",tagName:"code",properties:{},children:[n]};return e.patch(t,r),e.applyData(t,r)}function WS(e,t){const n=String(t.identifier).toUpperCase(),r=e.definitionById.get(n);if(!r)return a4(e,t);const i={href:ka(r.url||"")};r.title!==null&&r.title!==void 0&&(i.title=r.title);const a={type:"element",tagName:"a",properties:i,children:e.all(t)};return e.patch(t,a),e.applyData(t,a)}function XS(e,t){const n={href:ka(t.url)};t.title!==null&&t.title!==void 0&&(n.title=t.title);const r={type:"element",tagName:"a",properties:n,children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function US(e,t,n){const r=e.all(t),i=n?HS(n):o4(t),a={},o=[];if(typeof t.checked=="boolean"){const h=r[0];let c;h&&h.type==="element"&&h.tagName==="p"?c=h:(c={type:"element",tagName:"p",properties:{},children:[]},r.unshift(c)),c.children.length>0&&c.children.unshift({type:"text",value:" "}),c.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),a.className=["task-list-item"]}let s=-1;for(;++s<r.length;){const h=r[s];(i||s!==0||h.type!=="element"||h.tagName!=="p")&&o.push({type:"text",value:`
`}),h.type==="element"&&h.tagName==="p"&&!i?o.push(...h.children):o.push(h)}const l=r[r.length-1];l&&(i||l.type!=="element"||l.tagName!=="p")&&o.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:a,children:o};return e.patch(t,u),e.applyData(t,u)}function HS(e){let t=!1;if(e.type==="list"){t=e.spread||!1;const n=e.children;let r=-1;for(;!t&&++r<n.length;)t=o4(n[r])}return t}function o4(e){const t=e.spread;return t??e.children.length>1}function GS(e,t){const n={},r=e.all(t);let i=-1;for(typeof t.start=="number"&&t.start!==1&&(n.start=t.start);++i<r.length;){const o=r[i];if(o.type==="element"&&o.tagName==="li"&&o.properties&&Array.isArray(o.properties.className)&&o.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const a={type:"element",tagName:t.ordered?"ol":"ul",properties:n,children:e.wrap(r,!0)};return e.patch(t,a),e.applyData(t,a)}function KS(e,t){const n={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function ZS(e,t){const n={type:"root",children:e.wrap(e.all(t))};return e.patch(t,n),e.applyData(t,n)}function YS(e,t){const n={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function QS(e,t){const n=e.all(t),r=n.shift(),i=[];if(r){const o={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(t.children[0],o),i.push(o)}if(n.length>0){const o={type:"element",tagName:"tbody",properties:{},children:e.wrap(n,!0)},s=Bm(t.children[1]),l=L$(t.children[t.children.length-1]);s&&l&&(o.position={start:s,end:l}),i.push(o)}const a={type:"element",tagName:"table",properties:{},children:e.wrap(i,!0)};return e.patch(t,a),e.applyData(t,a)}function JS(e,t,n){const r=n?n.children:void 0,a=(r?r.indexOf(t):1)===0?"th":"td",o=n&&n.type==="table"?n.align:void 0,s=o?o.length:t.children.length;let l=-1;const u=[];for(;++l<s;){const c=t.children[l],m={},d=o?o[l]:void 0;d&&(m.align=d);let b={type:"element",tagName:a,properties:m,children:[]};c&&(b.children=e.all(c),e.patch(c,b),b=e.applyData(c,b)),u.push(b)}const h={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(t,h),e.applyData(t,h)}function eE(e,t){const n={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}const Kp=9,Zp=32;function tE(e){const t=String(e),n=/\r?\n|\r/g;let r=n.exec(t),i=0;const a=[];for(;r;)a.push(Yp(t.slice(i,r.index),i>0,!0),r[0]),i=r.index+r[0].length,r=n.exec(t);return a.push(Yp(t.slice(i),i>0,!1)),a.join("")}function Yp(e,t,n){let r=0,i=e.length;if(t){let a=e.codePointAt(r);for(;a===Kp||a===Zp;)r++,a=e.codePointAt(r)}if(n){let a=e.codePointAt(i-1);for(;a===Kp||a===Zp;)i--,a=e.codePointAt(i-1)}return i>r?e.slice(r,i):""}function nE(e,t){const n={type:"text",value:tE(String(t.value))};return e.patch(t,n),e.applyData(t,n)}function rE(e,t){const n={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,n),e.applyData(t,n)}const iE={blockquote:MS,break:FS,code:qS,delete:RS,emphasis:NS,footnoteReference:IS,heading:BS,html:LS,imageReference:OS,image:jS,inlineCode:VS,linkReference:WS,link:XS,listItem:US,list:GS,paragraph:KS,root:ZS,strong:YS,table:QS,tableCell:eE,tableRow:JS,text:nE,thematicBreak:rE,toml:Ts,yaml:Ts,definition:Ts,footnoteDefinition:Ts};function Ts(){}const s4=-1,_u=0,Bl=1,Ll=2,Um=3,Hm=4,Gm=5,Km=6,l4=7,u4=8,Qp=typeof self=="object"?self:globalThis,aE=(e,t)=>{const n=(i,a)=>(e.set(a,i),i),r=i=>{if(e.has(i))return e.get(i);const[a,o]=t[i];switch(a){case _u:case s4:return n(o,i);case Bl:{const s=n([],i);for(const l of o)s.push(r(l));return s}case Ll:{const s=n({},i);for(const[l,u]of o)s[r(l)]=r(u);return s}case Um:return n(new Date(o),i);case Hm:{const{source:s,flags:l}=o;return n(new RegExp(s,l),i)}case Gm:{const s=n(new Map,i);for(const[l,u]of o)s.set(r(l),r(u));return s}case Km:{const s=n(new Set,i);for(const l of o)s.add(r(l));return s}case l4:{const{name:s,message:l}=o;return n(new Qp[s](l),i)}case u4:return n(BigInt(o),i);case"BigInt":return n(Object(BigInt(o)),i)}return n(new Qp[a](o),i)};return r},Jp=e=>aE(new Map,e)(0),Ti="",{toString:oE}={},{keys:sE}=Object,Ua=e=>{const t=typeof e;if(t!=="object"||!e)return[_u,t];const n=oE.call(e).slice(8,-1);switch(n){case"Array":return[Bl,Ti];case"Object":return[Ll,Ti];case"Date":return[Um,Ti];case"RegExp":return[Hm,Ti];case"Map":return[Gm,Ti];case"Set":return[Km,Ti]}return n.includes("Array")?[Bl,n]:n.includes("Error")?[l4,n]:[Ll,n]},As=([e,t])=>e===_u&&(t==="function"||t==="symbol"),lE=(e,t,n,r)=>{const i=(o,s)=>{const l=r.push(o)-1;return n.set(s,l),l},a=o=>{if(n.has(o))return n.get(o);let[s,l]=Ua(o);switch(s){case _u:{let h=o;switch(l){case"bigint":s=u4,h=o.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+l);h=null;break;case"undefined":return i([s4],o)}return i([s,h],o)}case Bl:{if(l)return i([l,[...o]],o);const h=[],c=i([s,h],o);for(const m of o)h.push(a(m));return c}case Ll:{if(l)switch(l){case"BigInt":return i([l,o.toString()],o);case"Boolean":case"Number":case"String":return i([l,o.valueOf()],o)}if(t&&"toJSON"in o)return a(o.toJSON());const h=[],c=i([s,h],o);for(const m of sE(o))(e||!As(Ua(o[m])))&&h.push([a(m),a(o[m])]);return c}case Um:return i([s,o.toISOString()],o);case Hm:{const{source:h,flags:c}=o;return i([s,{source:h,flags:c}],o)}case Gm:{const h=[],c=i([s,h],o);for(const[m,d]of o)(e||!(As(Ua(m))||As(Ua(d))))&&h.push([a(m),a(d)]);return c}case Km:{const h=[],c=i([s,h],o);for(const m of o)(e||!As(Ua(m)))&&h.push(a(m));return c}}const{message:u}=o;return i([s,{name:l,message:u}],o)};return a},e1=(e,{json:t,lossy:n}={})=>{const r=[];return lE(!(t||n),!!t,new Map,r)(e),r},Ol=typeof structuredClone=="function"?(e,t)=>t&&("json"in t||"lossy"in t)?Jp(e1(e,t)):structuredClone(e):(e,t)=>Jp(e1(e,t));function uE(e,t){const n=[{type:"text",value:"↩"}];return t>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),n}function hE(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function cE(e){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",n=e.options.footnoteBackContent||uE,r=e.options.footnoteBackLabel||hE,i=e.options.footnoteLabel||"Footnotes",a=e.options.footnoteLabelTagName||"h2",o=e.options.footnoteLabelProperties||{className:["sr-only"]},s=[];let l=-1;for(;++l<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[l]);if(!u)continue;const h=e.all(u),c=String(u.identifier).toUpperCase(),m=ka(c.toLowerCase());let d=0;const b=[],$=e.footnoteCounts.get(c);for(;$!==void 0&&++d<=$;){b.length>0&&b.push({type:"text",value:" "});let y=typeof n=="string"?n:n(l,d);typeof y=="string"&&(y={type:"text",value:y}),b.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+m+(d>1?"-"+d:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(l,d),className:["data-footnote-backref"]},children:Array.isArray(y)?y:[y]})}const w=h[h.length-1];if(w&&w.type==="element"&&w.tagName==="p"){const y=w.children[w.children.length-1];y&&y.type==="text"?y.value+=" ":w.children.push({type:"text",value:" "}),w.children.push(...b)}else h.push(...b);const g={type:"element",tagName:"li",properties:{id:t+"fn-"+m},children:e.wrap(h,!0)};e.patch(u,g),s.push(g)}if(s.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:a,properties:{...Ol(o),id:"footnote-label"},children:[{type:"text",value:i}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(s,!0)},{type:"text",value:`
`}]}}const Zm=function(e){if(e==null)return pE;if(typeof e=="function")return xu(e);if(typeof e=="object")return Array.isArray(e)?mE(e):dE(e);if(typeof e=="string")return fE(e);throw new Error("Expected function, string, or object as test")};function mE(e){const t=[];let n=-1;for(;++n<e.length;)t[n]=Zm(e[n]);return xu(r);function r(...i){let a=-1;for(;++a<t.length;)if(t[a].apply(this,i))return!0;return!1}}function dE(e){const t=e;return xu(n);function n(r){const i=r;let a;for(a in e)if(i[a]!==t[a])return!1;return!0}}function fE(e){return xu(t);function t(n){return n&&n.type===e}}function xu(e){return t;function t(n,r,i){return!!(gE(n)&&e.call(this,n,typeof r=="number"?r:void 0,i||void 0))}}function pE(){return!0}function gE(e){return e!==null&&typeof e=="object"&&"type"in e}const h4=[],bE=!0,t1=!1,c4="skip";function m4(e,t,n,r){let i;typeof t=="function"&&typeof n!="function"?(r=n,n=t):i=t;const a=Zm(i),o=r?-1:1;s(e,void 0,[])();function s(l,u,h){const c=l&&typeof l=="object"?l:{};if(typeof c.type=="string"){const d=typeof c.tagName=="string"?c.tagName:typeof c.name=="string"?c.name:void 0;Object.defineProperty(m,"name",{value:"node ("+(l.type+(d?"<"+d+">":""))+")"})}return m;function m(){let d=h4,b,$,w;if((!t||a(l,u,h[h.length-1]||void 0))&&(d=yE(n(l,h)),d[0]===t1))return d;if("children"in l&&l.children){const g=l;if(g.children&&d[0]!==c4)for($=(r?g.children.length:-1)+o,w=h.concat(g);$>-1&&$<g.children.length;){const y=g.children[$];if(b=s(y,$,w)(),b[0]===t1)return b;$=typeof b[1]=="number"?b[1]:$+o}}return d}}}function yE(e){return Array.isArray(e)?e:typeof e=="number"?[bE,e]:e==null?h4:[e]}function Ym(e,t,n,r){let i,a,o;typeof t=="function"&&typeof n!="function"?(a=void 0,o=t,i=n):(a=t,o=n,i=r),m4(e,a,s,i);function s(l,u){const h=u[u.length-1],c=h?h.children.indexOf(l):void 0;return o(l,c,h)}}const t0={}.hasOwnProperty,$E={};function vE(e,t){const n=t||$E,r=new Map,i=new Map,a=new Map,o={...iE,...n.handlers},s={all:u,applyData:xE,definitionById:r,footnoteById:i,footnoteCounts:a,footnoteOrder:[],handlers:o,one:l,options:n,patch:_E,wrap:kE};return Ym(e,function(h){if(h.type==="definition"||h.type==="footnoteDefinition"){const c=h.type==="definition"?r:i,m=String(h.identifier).toUpperCase();c.has(m)||c.set(m,h)}}),s;function l(h,c){const m=h.type,d=s.handlers[m];if(t0.call(s.handlers,m)&&d)return d(s,h,c);if(s.options.passThrough&&s.options.passThrough.includes(m)){if("children"in h){const{children:$,...w}=h,g=Ol(w);return g.children=s.all(h),g}return Ol(h)}return(s.options.unknownHandler||wE)(s,h,c)}function u(h){const c=[];if("children"in h){const m=h.children;let d=-1;for(;++d<m.length;){const b=s.one(m[d],h);if(b){if(d&&m[d-1].type==="break"&&(!Array.isArray(b)&&b.type==="text"&&(b.value=n1(b.value)),!Array.isArray(b)&&b.type==="element")){const $=b.children[0];$&&$.type==="text"&&($.value=n1($.value))}Array.isArray(b)?c.push(...b):c.push(b)}}}return c}}function _E(e,t){e.position&&(t.position=ik(e))}function xE(e,t){let n=t;if(e&&e.data){const r=e.data.hName,i=e.data.hChildren,a=e.data.hProperties;if(typeof r=="string")if(n.type==="element")n.tagName=r;else{const o="children"in n?n.children:[n];n={type:"element",tagName:r,properties:{},children:o}}n.type==="element"&&a&&Object.assign(n.properties,Ol(a)),"children"in n&&n.children&&i!==null&&i!==void 0&&(n.children=i)}return n}function wE(e,t){const n=t.data||{},r="value"in t&&!(t0.call(n,"hProperties")||t0.call(n,"hChildren"))?{type:"text",value:t.value}:{type:"element",tagName:"div",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function kE(e,t){const n=[];let r=-1;for(t&&n.push({type:"text",value:`
`});++r<e.length;)r&&n.push({type:"text",value:`
`}),n.push(e[r]);return t&&e.length>0&&n.push({type:"text",value:`
`}),n}function n1(e){let t=0,n=e.charCodeAt(t);for(;n===9||n===32;)t++,n=e.charCodeAt(t);return e.slice(t)}function r1(e,t){const n=vE(e,t),r=n.one(e,void 0),i=cE(n),a=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return i&&a.children.push({type:"text",value:`
`},i),a}function SE(e,t){return e&&"run"in e?async function(n,r){const i=r1(n,{file:r,...t});await e.run(i,r)}:function(n,r){return r1(n,{file:r,...e||t})}}function i1(e){if(e)throw e}var ll=Object.prototype.hasOwnProperty,d4=Object.prototype.toString,a1=Object.defineProperty,o1=Object.getOwnPropertyDescriptor,s1=function(t){return typeof Array.isArray=="function"?Array.isArray(t):d4.call(t)==="[object Array]"},l1=function(t){if(!t||d4.call(t)!=="[object Object]")return!1;var n=ll.call(t,"constructor"),r=t.constructor&&t.constructor.prototype&&ll.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!r)return!1;var i;for(i in t);return typeof i>"u"||ll.call(t,i)},u1=function(t,n){a1&&n.name==="__proto__"?a1(t,n.name,{enumerable:!0,configurable:!0,value:n.newValue,writable:!0}):t[n.name]=n.newValue},h1=function(t,n){if(n==="__proto__")if(ll.call(t,n)){if(o1)return o1(t,n).value}else return;return t[n]},EE=function e(){var t,n,r,i,a,o,s=arguments[0],l=1,u=arguments.length,h=!1;for(typeof s=="boolean"&&(h=s,s=arguments[1]||{},l=2),(s==null||typeof s!="object"&&typeof s!="function")&&(s={});l<u;++l)if(t=arguments[l],t!=null)for(n in t)r=h1(s,n),i=h1(t,n),s!==i&&(h&&i&&(l1(i)||(a=s1(i)))?(a?(a=!1,o=r&&s1(r)?r:[]):o=r&&l1(r)?r:{},u1(s,{name:n,newValue:e(h,o,i)})):typeof i<"u"&&u1(s,{name:n,newValue:i}));return s};const bh=Pb(EE);function n0(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function CE(){const e=[],t={run:n,use:r};return t;function n(...i){let a=-1;const o=i.pop();if(typeof o!="function")throw new TypeError("Expected function as last argument, not "+o);s(null,...i);function s(l,...u){const h=e[++a];let c=-1;if(l){o(l);return}for(;++c<i.length;)(u[c]===null||u[c]===void 0)&&(u[c]=i[c]);i=u,h?PE(h,s)(...u):o(null,...u)}}function r(i){if(typeof i!="function")throw new TypeError("Expected `middelware` to be a function, not "+i);return e.push(i),t}}function PE(e,t){let n;return r;function r(...o){const s=e.length>o.length;let l;s&&o.push(i);try{l=e.apply(this,o)}catch(u){const h=u;if(s&&n)throw h;return i(h)}s||(l&&l.then&&typeof l.then=="function"?l.then(a,i):l instanceof Error?i(l):a(l))}function i(o,...s){n||(n=!0,t(o,...s))}function a(o){i(null,o)}}const Sn={basename:DE,dirname:TE,extname:AE,join:zE,sep:"/"};function DE(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');is(e);let n=0,r=-1,i=e.length,a;if(t===void 0||t.length===0||t.length>e.length){for(;i--;)if(e.codePointAt(i)===47){if(a){n=i+1;break}}else r<0&&(a=!0,r=i+1);return r<0?"":e.slice(n,r)}if(t===e)return"";let o=-1,s=t.length-1;for(;i--;)if(e.codePointAt(i)===47){if(a){n=i+1;break}}else o<0&&(a=!0,o=i+1),s>-1&&(e.codePointAt(i)===t.codePointAt(s--)?s<0&&(r=i):(s=-1,r=o));return n===r?r=o:r<0&&(r=e.length),e.slice(n,r)}function TE(e){if(is(e),e.length===0)return".";let t=-1,n=e.length,r;for(;--n;)if(e.codePointAt(n)===47){if(r){t=n;break}}else r||(r=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function AE(e){is(e);let t=e.length,n=-1,r=0,i=-1,a=0,o;for(;t--;){const s=e.codePointAt(t);if(s===47){if(o){r=t+1;break}continue}n<0&&(o=!0,n=t+1),s===46?i<0?i=t:a!==1&&(a=1):i>-1&&(a=-1)}return i<0||n<0||a===0||a===1&&i===n-1&&i===r+1?"":e.slice(i,n)}function zE(...e){let t=-1,n;for(;++t<e.length;)is(e[t]),e[t]&&(n=n===void 0?e[t]:n+"/"+e[t]);return n===void 0?".":ME(n)}function ME(e){is(e);const t=e.codePointAt(0)===47;let n=FE(e,!t);return n.length===0&&!t&&(n="."),n.length>0&&e.codePointAt(e.length-1)===47&&(n+="/"),t?"/"+n:n}function FE(e,t){let n="",r=0,i=-1,a=0,o=-1,s,l;for(;++o<=e.length;){if(o<e.length)s=e.codePointAt(o);else{if(s===47)break;s=47}if(s===47){if(!(i===o-1||a===1))if(i!==o-1&&a===2){if(n.length<2||r!==2||n.codePointAt(n.length-1)!==46||n.codePointAt(n.length-2)!==46){if(n.length>2){if(l=n.lastIndexOf("/"),l!==n.length-1){l<0?(n="",r=0):(n=n.slice(0,l),r=n.length-1-n.lastIndexOf("/")),i=o,a=0;continue}}else if(n.length>0){n="",r=0,i=o,a=0;continue}}t&&(n=n.length>0?n+"/..":"..",r=2)}else n.length>0?n+="/"+e.slice(i+1,o):n=e.slice(i+1,o),r=o-i-1;i=o,a=0}else s===46&&a>-1?a++:a=-1}return n}function is(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const qE={cwd:RE};function RE(){return"/"}function r0(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function NE(e){if(typeof e=="string")e=new URL(e);else if(!r0(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){const t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return IE(e)}function IE(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const t=e.pathname;let n=-1;for(;++n<t.length;)if(t.codePointAt(n)===37&&t.codePointAt(n+1)===50){const r=t.codePointAt(n+2);if(r===70||r===102){const i=new TypeError("File URL path must not include encoded / characters");throw i.code="ERR_INVALID_FILE_URL_PATH",i}}return decodeURIComponent(t)}const yh=["history","path","basename","stem","extname","dirname"];class f4{constructor(t){let n;t?r0(t)?n={path:t}:typeof t=="string"||BE(t)?n={value:t}:n=t:n={},this.cwd="cwd"in n?"":qE.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<yh.length;){const a=yh[r];a in n&&n[a]!==void 0&&n[a]!==null&&(this[a]=a==="history"?[...n[a]]:n[a])}let i;for(i in n)yh.includes(i)||(this[i]=n[i])}get basename(){return typeof this.path=="string"?Sn.basename(this.path):void 0}set basename(t){vh(t,"basename"),$h(t,"basename"),this.path=Sn.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?Sn.dirname(this.path):void 0}set dirname(t){c1(this.basename,"dirname"),this.path=Sn.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?Sn.extname(this.path):void 0}set extname(t){if($h(t,"extname"),c1(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Sn.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){r0(t)&&(t=NE(t)),vh(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?Sn.basename(this.path,this.extname):void 0}set stem(t){vh(t,"stem"),$h(t,"stem"),this.path=Sn.join(this.dirname||"",t+(this.extname||""))}fail(t,n,r){const i=this.message(t,n,r);throw i.fatal=!0,i}info(t,n,r){const i=this.message(t,n,r);return i.fatal=void 0,i}message(t,n,r){const i=new gt(t,n,r);return this.path&&(i.name=this.path+":"+i.name,i.file=this.path),i.fatal=!1,this.messages.push(i),i}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}}function $h(e,t){if(e&&e.includes(Sn.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+Sn.sep+"`")}function vh(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function c1(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function BE(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const LE=function(e){const r=this.constructor.prototype,i=r[e],a=function(){return i.apply(a,arguments)};return Object.setPrototypeOf(a,r),a},OE={}.hasOwnProperty;class Qm extends LE{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=CE()}copy(){const t=new Qm;let n=-1;for(;++n<this.attachers.length;){const r=this.attachers[n];t.use(...r)}return t.data(bh(!0,{},this.namespace)),t}data(t,n){return typeof t=="string"?arguments.length===2?(wh("data",this.frozen),this.namespace[t]=n,this):OE.call(this.namespace,t)&&this.namespace[t]||void 0:t?(wh("data",this.frozen),this.namespace=t,this):this.namespace}freeze(){if(this.frozen)return this;const t=this;for(;++this.freezeIndex<this.attachers.length;){const[n,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const i=n.call(t,...r);typeof i=="function"&&this.transformers.use(i)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(t){this.freeze();const n=zs(t),r=this.parser||this.Parser;return _h("parse",r),r(String(n),n)}process(t,n){const r=this;return this.freeze(),_h("process",this.parser||this.Parser),xh("process",this.compiler||this.Compiler),n?i(void 0,n):new Promise(i);function i(a,o){const s=zs(t),l=r.parse(s);r.run(l,s,function(h,c,m){if(h||!c||!m)return u(h);const d=c,b=r.stringify(d,m);WE(b)?m.value=b:m.result=b,u(h,m)});function u(h,c){h||!c?o(h):a?a(c):n(void 0,c)}}}processSync(t){let n=!1,r;return this.freeze(),_h("processSync",this.parser||this.Parser),xh("processSync",this.compiler||this.Compiler),this.process(t,i),d1("processSync","process",n),r;function i(a,o){n=!0,i1(a),r=o}}run(t,n,r){m1(t),this.freeze();const i=this.transformers;return!r&&typeof n=="function"&&(r=n,n=void 0),r?a(void 0,r):new Promise(a);function a(o,s){const l=zs(n);i.run(t,l,u);function u(h,c,m){const d=c||t;h?s(h):o?o(d):r(void 0,d,m)}}}runSync(t,n){let r=!1,i;return this.run(t,n,a),d1("runSync","run",r),i;function a(o,s){i1(o),i=s,r=!0}}stringify(t,n){this.freeze();const r=zs(n),i=this.compiler||this.Compiler;return xh("stringify",i),m1(t),i(t,r)}use(t,...n){const r=this.attachers,i=this.namespace;if(wh("use",this.frozen),t!=null)if(typeof t=="function")l(t,n);else if(typeof t=="object")Array.isArray(t)?s(t):o(t);else throw new TypeError("Expected usable value, not `"+t+"`");return this;function a(u){if(typeof u=="function")l(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[h,...c]=u;l(h,c)}else o(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function o(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");s(u.plugins),u.settings&&(i.settings=bh(!0,i.settings,u.settings))}function s(u){let h=-1;if(u!=null)if(Array.isArray(u))for(;++h<u.length;){const c=u[h];a(c)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function l(u,h){let c=-1,m=-1;for(;++c<r.length;)if(r[c][0]===u){m=c;break}if(m===-1)r.push([u,...h]);else if(h.length>0){let[d,...b]=h;const $=r[m][1];n0($)&&n0(d)&&(d=bh(!0,$,d)),r[m]=[u,d,...b]}}}}const jE=new Qm().freeze();function _h(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function xh(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function wh(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function m1(e){if(!n0(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function d1(e,t,n){if(!n)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function zs(e){return VE(e)?e:new f4(e)}function VE(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function WE(e){return typeof e=="string"||XE(e)}function XE(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const UE="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",f1=[],p1={allowDangerousHtml:!0},HE=/^(https?|ircs?|mailto|xmpp)$/i,GE=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function KE(e){const t=e.allowedElements,n=e.allowElement,r=e.children||"",i=e.className,a=e.components,o=e.disallowedElements,s=e.rehypePlugins||f1,l=e.remarkPlugins||f1,u=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...p1}:p1,h=e.skipHtml,c=e.unwrapDisallowed,m=e.urlTransform||ZE,d=jE().use(zS).use(l).use(SE,u).use(s),b=new f4;typeof r=="string"&&(b.value=r);for(const y of GE)Object.hasOwn(e,y.from)&&(""+y.from+(y.to?"use `"+y.to+"` instead":"remove it")+UE+y.id,void 0);const $=d.parse(b);let w=d.runSync($,b);return i&&(w={type:"element",tagName:"div",properties:{className:i},children:w.type==="root"?w.children:[w]}),Ym(w,g),hk(w,{Fragment:M.Fragment,components:a,ignoreInvalidStyle:!0,jsx:M.jsx,jsxs:M.jsxs,passKeys:!0,passNode:!0});function g(y,_,T){if(y.type==="raw"&&T&&typeof _=="number")return h?T.children.splice(_,1):T.children[_]={type:"text",value:y.value},_;if(y.type==="element"){let D;for(D in fh)if(Object.hasOwn(fh,D)&&Object.hasOwn(y.properties,D)){const C=y.properties[D],F=fh[D];(F===null||F.includes(y.tagName))&&(y.properties[D]=m(String(C||""),D,y))}}if(y.type==="element"){let D=t?!t.includes(y.tagName):o?o.includes(y.tagName):!1;if(!D&&n&&typeof _=="number"&&(D=!n(y,_,T)),D&&T&&typeof _=="number")return c&&y.children?T.children.splice(_,1,...y.children):T.children.splice(_,1),_}}}function ZE(e){const t=e.indexOf(":"),n=e.indexOf("?"),r=e.indexOf("#"),i=e.indexOf("/");return t<0||i>-1&&t>i||n>-1&&t>n||r>-1&&t>r||HE.test(e.slice(0,t))?e:""}function YE(e,t){const n=String(e);let r=n.indexOf(t),i=r,a=0,o=0;for(;r!==-1;)r===i?++a>o&&(o=a):a=1,i=r+t.length,r=n.indexOf(t,i);return o}function QE(){return{enter:{mathFlow:e,mathFlowFenceMeta:t,mathText:a},exit:{mathFlow:i,mathFlowFence:r,mathFlowFenceMeta:n,mathFlowValue:s,mathText:o,mathTextData:s}};function e(l){const u={type:"element",tagName:"code",properties:{className:["language-math","math-display"]},children:[]};this.enter({type:"math",meta:null,value:"",data:{hName:"pre",hChildren:[u]}},l)}function t(){this.buffer()}function n(){const l=this.resume(),u=this.stack[this.stack.length-1];u.type,u.meta=l}function r(){this.data.mathFlowInside||(this.buffer(),this.data.mathFlowInside=!0)}function i(l){const u=this.resume().replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),h=this.stack[this.stack.length-1];h.type,this.exit(l),h.value=u;const c=h.data.hChildren[0];c.type,c.tagName,c.children.push({type:"text",value:u}),this.data.mathFlowInside=void 0}function a(l){this.enter({type:"inlineMath",value:"",data:{hName:"code",hProperties:{className:["language-math","math-inline"]},hChildren:[]}},l),this.buffer()}function o(l){const u=this.resume(),h=this.stack[this.stack.length-1];h.type,this.exit(l),h.value=u,h.data.hChildren.push({type:"text",value:u})}function s(l){this.config.enter.data.call(this,l),this.config.exit.data.call(this,l)}}function JE(e){let t=(e||{}).singleDollarTextMath;return t==null&&(t=!0),r.peek=i,{unsafe:[{character:"\r",inConstruct:"mathFlowMeta"},{character:`
`,inConstruct:"mathFlowMeta"},{character:"$",after:t?void 0:"\\$",inConstruct:"phrasing"},{character:"$",inConstruct:"mathFlowMeta"},{atBreak:!0,character:"$",after:"\\$"}],handlers:{math:n,inlineMath:r}};function n(a,o,s,l){const u=a.value||"",h=s.createTracker(l),c="$".repeat(Math.max(YE(u,"$")+1,2)),m=s.enter("mathFlow");let d=h.move(c);if(a.meta){const b=s.enter("mathFlowMeta");d+=h.move(s.safe(a.meta,{after:`
`,before:d,encode:["$"],...h.current()})),b()}return d+=h.move(`
`),u&&(d+=h.move(u+`
`)),d+=h.move(c),m(),d}function r(a,o,s){let l=a.value||"",u=1;for(t||u++;new RegExp("(^|[^$])"+"\\$".repeat(u)+"([^$]|$)").test(l);)u++;const h="$".repeat(u);/[^ \r\n]/.test(l)&&(/^[ \r\n]/.test(l)&&/[ \r\n]$/.test(l)||/^\$|\$$/.test(l))&&(l=" "+l+" ");let c=-1;for(;++c<s.unsafe.length;){const m=s.unsafe[c];if(!m.atBreak)continue;const d=s.compilePattern(m);let b;for(;b=d.exec(l);){let $=b.index;l.codePointAt($)===10&&l.codePointAt($-1)===13&&$--,l=l.slice(0,$)+" "+l.slice(b.index+1)}}return h+l+h}function i(){return"$"}}const eC={tokenize:tC,concrete:!0,name:"mathFlow"},g1={tokenize:nC,partial:!0};function tC(e,t,n){const r=this,i=r.events[r.events.length-1],a=i&&i[1].type==="linePrefix"?i[2].sliceSerialize(i[1],!0).length:0;let o=0;return s;function s(y){return e.enter("mathFlow"),e.enter("mathFlowFence"),e.enter("mathFlowFenceSequence"),l(y)}function l(y){return y===36?(e.consume(y),o++,l):o<2?n(y):(e.exit("mathFlowFenceSequence"),xe(e,u,"whitespace")(y))}function u(y){return y===null||ee(y)?c(y):(e.enter("mathFlowFenceMeta"),e.enter("chunkString",{contentType:"string"}),h(y))}function h(y){return y===null||ee(y)?(e.exit("chunkString"),e.exit("mathFlowFenceMeta"),c(y)):y===36?n(y):(e.consume(y),h)}function c(y){return e.exit("mathFlowFence"),r.interrupt?t(y):e.attempt(g1,m,w)(y)}function m(y){return e.attempt({tokenize:g,partial:!0},w,d)(y)}function d(y){return(a?xe(e,b,"linePrefix",a+1):b)(y)}function b(y){return y===null?w(y):ee(y)?e.attempt(g1,m,w)(y):(e.enter("mathFlowValue"),$(y))}function $(y){return y===null||ee(y)?(e.exit("mathFlowValue"),b(y)):(e.consume(y),$)}function w(y){return e.exit("mathFlow"),t(y)}function g(y,_,T){let D=0;return xe(y,C,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4);function C(N){return y.enter("mathFlowFence"),y.enter("mathFlowFenceSequence"),F(N)}function F(N){return N===36?(D++,y.consume(N),F):D<o?T(N):(y.exit("mathFlowFenceSequence"),xe(y,R,"whitespace")(N))}function R(N){return N===null||ee(N)?(y.exit("mathFlowFence"),_(N)):T(N)}}}function nC(e,t,n){const r=this;return i;function i(o){return o===null?t(o):(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),a)}function a(o){return r.parser.lazy[r.now().line]?n(o):t(o)}}function rC(e){let n=(e||{}).singleDollarTextMath;return n==null&&(n=!0),{tokenize:r,resolve:iC,previous:aC,name:"mathText"};function r(i,a,o){let s=0,l,u;return h;function h($){return i.enter("mathText"),i.enter("mathTextSequence"),c($)}function c($){return $===36?(i.consume($),s++,c):s<2&&!n?o($):(i.exit("mathTextSequence"),m($))}function m($){return $===null?o($):$===36?(u=i.enter("mathTextSequence"),l=0,b($)):$===32?(i.enter("space"),i.consume($),i.exit("space"),m):ee($)?(i.enter("lineEnding"),i.consume($),i.exit("lineEnding"),m):(i.enter("mathTextData"),d($))}function d($){return $===null||$===32||$===36||ee($)?(i.exit("mathTextData"),m($)):(i.consume($),d)}function b($){return $===36?(i.consume($),l++,b):l===s?(i.exit("mathTextSequence"),i.exit("mathText"),a($)):(u.type="mathTextData",d($))}}}function iC(e){let t=e.length-4,n=3,r,i;if((e[n][1].type==="lineEnding"||e[n][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(r=n;++r<t;)if(e[r][1].type==="mathTextData"){e[t][1].type="mathTextPadding",e[n][1].type="mathTextPadding",n+=2,t-=2;break}}for(r=n-1,t++;++r<=t;)i===void 0?r!==t&&e[r][1].type!=="lineEnding"&&(i=r):(r===t||e[r][1].type==="lineEnding")&&(e[i][1].type="mathTextData",r!==i+2&&(e[i][1].end=e[r-1][1].end,e.splice(i+2,r-i-2),t-=r-i-2,r=i+2),i=void 0);return e}function aC(e){return e!==36||this.events[this.events.length-1][1].type==="characterEscape"}function oC(e){return{flow:{36:eC},text:{36:rC(e)}}}class It{constructor(t,n,r){this.lexer=void 0,this.start=void 0,this.end=void 0,this.lexer=t,this.start=n,this.end=r}static range(t,n){return n?!t||!t.loc||!n.loc||t.loc.lexer!==n.loc.lexer?null:new It(t.loc.lexer,t.loc.start,n.loc.end):t&&t.loc}}class nn{constructor(t,n){this.text=void 0,this.loc=void 0,this.noexpand=void 0,this.treatAsRelax=void 0,this.text=t,this.loc=n}range(t,n){return new nn(n,It.range(this,t))}}class X{constructor(t,n){this.name=void 0,this.position=void 0,this.length=void 0,this.rawMessage=void 0;var r="KaTeX parse error: "+t,i,a,o=n&&n.loc;if(o&&o.start<=o.end){var s=o.lexer.input;i=o.start,a=o.end,i===s.length?r+=" at end of input: ":r+=" at position "+(i+1)+": ";var l=s.slice(i,a).replace(/[^]/g,"$&̲"),u;i>15?u="…"+s.slice(i-15,i):u=s.slice(0,i);var h;a+15<s.length?h=s.slice(a,a+15)+"…":h=s.slice(a),r+=u+l+h}var c=new Error(r);return c.name="ParseError",c.__proto__=X.prototype,c.position=i,i!=null&&a!=null&&(c.length=a-i),c.rawMessage=t,c}}X.prototype.__proto__=Error.prototype;var sC=function(t,n){return t.indexOf(n)!==-1},lC=function(t,n){return t===void 0?n:t},uC=/([A-Z])/g,hC=function(t){return t.replace(uC,"-$1").toLowerCase()},cC={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"},mC=/[&><"']/g;function dC(e){return String(e).replace(mC,t=>cC[t])}var p4=function e(t){return t.type==="ordgroup"||t.type==="color"?t.body.length===1?e(t.body[0]):t:t.type==="font"?e(t.body):t},fC=function(t){var n=p4(t);return n.type==="mathord"||n.type==="textord"||n.type==="atom"},pC=function(t){if(!t)throw new Error("Expected non-null, but got "+String(t));return t},gC=function(t){var n=/^[\x00-\x20]*([^\\/#?]*?)(:|&#0*58|&#x0*3a|&colon)/i.exec(t);return n?n[2]!==":"||!/^[a-zA-Z][a-zA-Z0-9+\-.]*$/.test(n[1])?null:n[1].toLowerCase():"_relative"},te={contains:sC,deflt:lC,escape:dC,hyphenate:hC,getBaseElem:p4,isCharacterBox:fC,protocolFromUrl:gC},ul={displayMode:{type:"boolean",description:"Render math in display mode, which puts the math in display style (so \\int and \\sum are large, for example), and centers the math on the page on its own line.",cli:"-d, --display-mode"},output:{type:{enum:["htmlAndMathml","html","mathml"]},description:"Determines the markup language of the output.",cli:"-F, --format <type>"},leqno:{type:"boolean",description:"Render display math in leqno style (left-justified tags)."},fleqn:{type:"boolean",description:"Render display math flush left."},throwOnError:{type:"boolean",default:!0,cli:"-t, --no-throw-on-error",cliDescription:"Render errors (in the color given by --error-color) instead of throwing a ParseError exception when encountering an error."},errorColor:{type:"string",default:"#cc0000",cli:"-c, --error-color <color>",cliDescription:"A color string given in the format 'rgb' or 'rrggbb' (no #). This option determines the color of errors rendered by the -t option.",cliProcessor:e=>"#"+e},macros:{type:"object",cli:"-m, --macro <def>",cliDescription:"Define custom macro of the form '\\foo:expansion' (use multiple -m arguments for multiple macros).",cliDefault:[],cliProcessor:(e,t)=>(t.push(e),t)},minRuleThickness:{type:"number",description:"Specifies a minimum thickness, in ems, for fraction lines, `\\sqrt` top lines, `{array}` vertical lines, `\\hline`, `\\hdashline`, `\\underline`, `\\overline`, and the borders of `\\fbox`, `\\boxed`, and `\\fcolorbox`.",processor:e=>Math.max(0,e),cli:"--min-rule-thickness <size>",cliProcessor:parseFloat},colorIsTextColor:{type:"boolean",description:"Makes \\color behave like LaTeX's 2-argument \\textcolor, instead of LaTeX's one-argument \\color mode change.",cli:"-b, --color-is-text-color"},strict:{type:[{enum:["warn","ignore","error"]},"boolean","function"],description:"Turn on strict / LaTeX faithfulness mode, which throws an error if the input uses features that are not supported by LaTeX.",cli:"-S, --strict",cliDefault:!1},trust:{type:["boolean","function"],description:"Trust the input, enabling all HTML features such as \\url.",cli:"-T, --trust"},maxSize:{type:"number",default:1/0,description:"If non-zero, all user-specified sizes, e.g. in \\rule{500em}{500em}, will be capped to maxSize ems. Otherwise, elements and spaces can be arbitrarily large",processor:e=>Math.max(0,e),cli:"-s, --max-size <n>",cliProcessor:parseInt},maxExpand:{type:"number",default:1e3,description:"Limit the number of macro expansions to the specified number, to prevent e.g. infinite macro loops. If set to Infinity, the macro expander will try to fully expand as in LaTeX.",processor:e=>Math.max(0,e),cli:"-e, --max-expand <n>",cliProcessor:e=>e==="Infinity"?1/0:parseInt(e)},globalGroup:{type:"boolean",cli:!1}};function bC(e){if(e.default)return e.default;var t=e.type,n=Array.isArray(t)?t[0]:t;if(typeof n!="string")return n.enum[0];switch(n){case"boolean":return!1;case"string":return"";case"number":return 0;case"object":return{}}}class Jm{constructor(t){this.displayMode=void 0,this.output=void 0,this.leqno=void 0,this.fleqn=void 0,this.throwOnError=void 0,this.errorColor=void 0,this.macros=void 0,this.minRuleThickness=void 0,this.colorIsTextColor=void 0,this.strict=void 0,this.trust=void 0,this.maxSize=void 0,this.maxExpand=void 0,this.globalGroup=void 0,t=t||{};for(var n in ul)if(ul.hasOwnProperty(n)){var r=ul[n];this[n]=t[n]!==void 0?r.processor?r.processor(t[n]):t[n]:bC(r)}}reportNonstrict(t,n,r){var i=this.strict;if(typeof i=="function"&&(i=i(t,n,r)),!(!i||i==="ignore")){if(i===!0||i==="error")throw new X("LaTeX-incompatible input and strict mode is set to 'error': "+(n+" ["+t+"]"),r);i==="warn"?typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to 'warn': "+(n+" ["+t+"]")):typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to "+("unrecognized '"+i+"': "+n+" ["+t+"]"))}}useStrictBehavior(t,n,r){var i=this.strict;if(typeof i=="function")try{i=i(t,n,r)}catch{i="error"}return!i||i==="ignore"?!1:i===!0||i==="error"?!0:i==="warn"?(typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to 'warn': "+(n+" ["+t+"]")),!1):(typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to "+("unrecognized '"+i+"': "+n+" ["+t+"]")),!1)}isTrusted(t){if(t.url&&!t.protocol){var n=te.protocolFromUrl(t.url);if(n==null)return!1;t.protocol=n}var r=typeof this.trust=="function"?this.trust(t):this.trust;return!!r}}class gr{constructor(t,n,r){this.id=void 0,this.size=void 0,this.cramped=void 0,this.id=t,this.size=n,this.cramped=r}sup(){return En[yC[this.id]]}sub(){return En[$C[this.id]]}fracNum(){return En[vC[this.id]]}fracDen(){return En[_C[this.id]]}cramp(){return En[xC[this.id]]}text(){return En[wC[this.id]]}isTight(){return this.size>=2}}var ed=0,jl=1,oa=2,Yn=3,Bo=4,en=5,fa=6,vt=7,En=[new gr(ed,0,!1),new gr(jl,0,!0),new gr(oa,1,!1),new gr(Yn,1,!0),new gr(Bo,2,!1),new gr(en,2,!0),new gr(fa,3,!1),new gr(vt,3,!0)],yC=[Bo,en,Bo,en,fa,vt,fa,vt],$C=[en,en,en,en,vt,vt,vt,vt],vC=[oa,Yn,Bo,en,fa,vt,fa,vt],_C=[Yn,Yn,en,en,vt,vt,vt,vt],xC=[jl,jl,Yn,Yn,en,en,vt,vt],wC=[ed,jl,oa,Yn,oa,Yn,oa,Yn],ie={DISPLAY:En[ed],TEXT:En[oa],SCRIPT:En[Bo],SCRIPTSCRIPT:En[fa]},i0=[{name:"latin",blocks:[[256,591],[768,879]]},{name:"cyrillic",blocks:[[1024,1279]]},{name:"armenian",blocks:[[1328,1423]]},{name:"brahmic",blocks:[[2304,4255]]},{name:"georgian",blocks:[[4256,4351]]},{name:"cjk",blocks:[[12288,12543],[19968,40879],[65280,65376]]},{name:"hangul",blocks:[[44032,55215]]}];function kC(e){for(var t=0;t<i0.length;t++)for(var n=i0[t],r=0;r<n.blocks.length;r++){var i=n.blocks[r];if(e>=i[0]&&e<=i[1])return n.name}return null}var hl=[];i0.forEach(e=>e.blocks.forEach(t=>hl.push(...t)));function g4(e){for(var t=0;t<hl.length;t+=2)if(e>=hl[t]&&e<=hl[t+1])return!0;return!1}var Ai=80,SC=function(t,n){return"M95,"+(622+t+n)+`
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l`+t/2.075+" -"+t+`
c5.3,-9.3,12,-14,20,-14
H400000v`+(40+t)+`H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M`+(834+t)+" "+n+"h400000v"+(40+t)+"h-400000z"},EC=function(t,n){return"M263,"+(601+t+n)+`c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l`+t/2.084+" -"+t+`
c4.7,-7.3,11,-11,19,-11
H40000v`+(40+t)+`H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M`+(1001+t)+" "+n+"h400000v"+(40+t)+"h-400000z"},CC=function(t,n){return"M983 "+(10+t+n)+`
l`+t/3.13+" -"+t+`
c4,-6.7,10,-10,18,-10 H400000v`+(40+t)+`
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M`+(1001+t)+" "+n+"h400000v"+(40+t)+"h-400000z"},PC=function(t,n){return"M424,"+(2398+t+n)+`
c-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514
c0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20
s-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121
s209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081
l`+t/4.223+" -"+t+`c4,-6.7,10,-10,18,-10 H400000
v`+(40+t)+`H1014.6
s-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185
c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2z M`+(1001+t)+" "+n+`
h400000v`+(40+t)+"h-400000z"},DC=function(t,n){return"M473,"+(2713+t+n)+`
c339.3,-1799.3,509.3,-2700,510,-2702 l`+t/5.298+" -"+t+`
c3.3,-7.3,9.3,-11,18,-11 H400000v`+(40+t)+`H1017.7
s-90.5,478,-276.2,1466c-185.7,988,-279.5,1483,-281.5,1485c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2c0,-1.3,-5.3,-32,-16,-92c-50.7,-293.3,-119.7,-693.3,-207,-1200
c0,-1.3,-5.3,8.7,-16,30c-10.7,21.3,-21.3,42.7,-32,64s-16,33,-16,33s-26,-26,-26,-26
s76,-153,76,-153s77,-151,77,-151c0.7,0.7,35.7,202,105,604c67.3,400.7,102,602.7,104,
606zM`+(1001+t)+" "+n+"h400000v"+(40+t)+"H1017.7z"},TC=function(t){var n=t/2;return"M400000 "+t+" H0 L"+n+" 0 l65 45 L145 "+(t-80)+" H400000z"},AC=function(t,n,r){var i=r-54-n-t;return"M702 "+(t+n)+"H400000"+(40+t)+`
H742v`+i+`l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1
h-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170
c-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667
219 661 l218 661zM702 `+n+"H400000v"+(40+t)+"H742z"},zC=function(t,n,r){n=1e3*n;var i="";switch(t){case"sqrtMain":i=SC(n,Ai);break;case"sqrtSize1":i=EC(n,Ai);break;case"sqrtSize2":i=CC(n,Ai);break;case"sqrtSize3":i=PC(n,Ai);break;case"sqrtSize4":i=DC(n,Ai);break;case"sqrtTall":i=AC(n,Ai,r)}return i},MC=function(t,n){switch(t){case"⎜":return"M291 0 H417 V"+n+" H291z M291 0 H417 V"+n+" H291z";case"∣":return"M145 0 H188 V"+n+" H145z M145 0 H188 V"+n+" H145z";case"∥":return"M145 0 H188 V"+n+" H145z M145 0 H188 V"+n+" H145z"+("M367 0 H410 V"+n+" H367z M367 0 H410 V"+n+" H367z");case"⎟":return"M457 0 H583 V"+n+" H457z M457 0 H583 V"+n+" H457z";case"⎢":return"M319 0 H403 V"+n+" H319z M319 0 H403 V"+n+" H319z";case"⎥":return"M263 0 H347 V"+n+" H263z M263 0 H347 V"+n+" H263z";case"⎪":return"M384 0 H504 V"+n+" H384z M384 0 H504 V"+n+" H384z";case"⏐":return"M312 0 H355 V"+n+" H312z M312 0 H355 V"+n+" H312z";case"‖":return"M257 0 H300 V"+n+" H257z M257 0 H300 V"+n+" H257z"+("M478 0 H521 V"+n+" H478z M478 0 H521 V"+n+" H478z");default:return""}},b1={doubleleftarrow:`M262 157
l10-10c34-36 62.7-77 86-123 3.3-8 5-13.3 5-16 0-5.3-6.7-8-20-8-7.3
 0-12.2.5-14.5 1.5-2.3 1-4.8 4.5-7.5 10.5-49.3 97.3-121.7 169.3-217 216-28
 14-57.3 25-88 33-6.7 2-11 3.8-13 5.5-2 1.7-3 4.2-3 7.5s1 5.8 3 7.5
c2 1.7 6.3 3.5 13 5.5 68 17.3 128.2 47.8 180.5 91.5 52.3 43.7 93.8 96.2 124.5
 157.5 9.3 8 15.3 12.3 18 13h6c12-.7 18-4 18-10 0-2-1.7-7-5-15-23.3-46-52-87
-86-123l-10-10h399738v-40H218c328 0 0 0 0 0l-10-8c-26.7-20-65.7-43-117-69 2.7
-2 6-3.7 10-5 36.7-16 72.3-37.3 107-64l10-8h399782v-40z
m8 0v40h399730v-40zm0 194v40h399730v-40z`,doublerightarrow:`M399738 392l
-10 10c-34 36-62.7 77-86 123-3.3 8-5 13.3-5 16 0 5.3 6.7 8 20 8 7.3 0 12.2-.5
 14.5-1.5 2.3-1 4.8-4.5 7.5-10.5 49.3-97.3 121.7-169.3 217-216 28-14 57.3-25 88
-33 6.7-2 11-3.8 13-5.5 2-1.7 3-4.2 3-7.5s-1-5.8-3-7.5c-2-1.7-6.3-3.5-13-5.5-68
-17.3-128.2-47.8-180.5-91.5-52.3-43.7-93.8-96.2-124.5-157.5-9.3-8-15.3-12.3-18
-13h-6c-12 .7-18 4-18 10 0 2 1.7 7 5 15 23.3 46 52 87 86 123l10 10H0v40h399782
c-328 0 0 0 0 0l10 8c26.7 20 65.7 43 117 69-2.7 2-6 3.7-10 5-36.7 16-72.3 37.3
-107 64l-10 8H0v40zM0 157v40h399730v-40zm0 194v40h399730v-40z`,leftarrow:`M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z`,leftbrace:`M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117
-45 179-50h399577v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7
 5-6 9-10 13-.7 1-7.3 1-20 1H6z`,leftbraceunder:`M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z`,leftgroup:`M400000 80
H435C64 80 168.3 229.4 21 260c-5.9 1.2-18 0-18 0-2 0-3-1-3-3v-38C76 61 257 0
 435 0h399565z`,leftgroupunder:`M400000 262
H435C64 262 168.3 112.6 21 82c-5.9-1.2-18 0-18 0-2 0-3 1-3 3v38c76 158 257 219
 435 219h399565z`,leftharpoon:`M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3
-3.3 10.2-9.5 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5
-18.3 3-21-1.3-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7
-196 228-6.7 4.7-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40z`,leftharpoonplus:`M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3-3.3 10.2-9.5
 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5-18.3 3-21-1.3
-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7-196 228-6.7 4.7
-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40zM0 435v40h400000v-40z
m0 0v40h400000v-40z`,leftharpoondown:`M7 241c-4 4-6.333 8.667-7 14 0 5.333.667 9 2 11s5.333
 5.333 12 10c90.667 54 156 130 196 228 3.333 10.667 6.333 16.333 9 17 2 .667 5
 1 9 1h5c10.667 0 16.667-2 18-6 2-2.667 1-9.667-3-21-32-87.333-82.667-157.667
-152-211l-3-3h399907v-40zM93 281 H400000 v-40L7 241z`,leftharpoondownplus:`M7 435c-4 4-6.3 8.7-7 14 0 5.3.7 9 2 11s5.3 5.3 12
 10c90.7 54 156 130 196 228 3.3 10.7 6.3 16.3 9 17 2 .7 5 1 9 1h5c10.7 0 16.7
-2 18-6 2-2.7 1-9.7-3-21-32-87.3-82.7-157.7-152-211l-3-3h399907v-40H7zm93 0
v40h399900v-40zM0 241v40h399900v-40zm0 0v40h399900v-40z`,lefthook:`M400000 281 H103s-33-11.2-61-33.5S0 197.3 0 164s14.2-61.2 42.5
-83.5C70.8 58.2 104 47 142 47 c16.7 0 25 6.7 25 20 0 12-8.7 18.7-26 20-40 3.3
-68.7 15.7-86 37-10 12-15 25.3-15 40 0 22.7 9.8 40.7 29.5 54 19.7 13.3 43.5 21
 71.5 23h399859zM103 281v-40h399897v40z`,leftlinesegment:`M40 281 V428 H0 V94 H40 V241 H400000 v40z
M40 281 V428 H0 V94 H40 V241 H400000 v40z`,leftmapsto:`M40 281 V448H0V74H40V241H400000v40z
M40 281 V448H0V74H40V241H400000v40z`,leftToFrom:`M0 147h400000v40H0zm0 214c68 40 115.7 95.7 143 167h22c15.3 0 23
-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69-70-101l-7-8h399905v-40H95l7-8
c28.7-32 52-65.7 70-101 10.7-23.3 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 265.3
 68 321 0 361zm0-174v-40h399900v40zm100 154v40h399900v-40z`,longequal:`M0 50 h400000 v40H0z m0 194h40000v40H0z
M0 50 h400000 v40H0z m0 194h40000v40H0z`,midbrace:`M200428 334
c-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14
-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7
 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3 0 5 4 11
 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60h199572v120z`,midbraceunder:`M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z`,oiintSize1:`M512.6 71.6c272.6 0 320.3 106.8 320.3 178.2 0 70.8-47.7 177.6
-320.3 177.6S193.1 320.6 193.1 249.8c0-71.4 46.9-178.2 319.5-178.2z
m368.1 178.2c0-86.4-60.9-215.4-368.1-215.4-306.4 0-367.3 129-367.3 215.4 0 85.8
60.9 214.8 367.3 214.8 307.2 0 368.1-129 368.1-214.8z`,oiintSize2:`M757.8 100.1c384.7 0 451.1 137.6 451.1 230 0 91.3-66.4 228.8
-451.1 228.8-386.3 0-452.7-137.5-452.7-228.8 0-92.4 66.4-230 452.7-230z
m502.4 230c0-111.2-82.4-277.2-502.4-277.2s-504 166-504 277.2
c0 110 84 276 504 276s502.4-166 502.4-276z`,oiiintSize1:`M681.4 71.6c408.9 0 480.5 106.8 480.5 178.2 0 70.8-71.6 177.6
-480.5 177.6S202.1 320.6 202.1 249.8c0-71.4 70.5-178.2 479.3-178.2z
m525.8 178.2c0-86.4-86.8-215.4-525.7-215.4-437.9 0-524.7 129-524.7 215.4 0
85.8 86.8 214.8 524.7 214.8 438.9 0 525.7-129 525.7-214.8z`,oiiintSize2:`M1021.2 53c603.6 0 707.8 165.8 707.8 277.2 0 110-104.2 275.8
-707.8 275.8-606 0-710.2-165.8-710.2-275.8C311 218.8 415.2 53 1021.2 53z
m770.4 277.1c0-131.2-126.4-327.6-770.5-327.6S248.4 198.9 248.4 330.1
c0 130 128.8 326.4 772.7 326.4s770.5-196.4 770.5-326.4z`,rightarrow:`M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z`,rightbrace:`M400000 542l
-6 6h-17c-12.7 0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5
s-117.2-55.8-184.5-66.5c-.7 0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1
c124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z`,rightbraceunder:`M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z`,rightgroup:`M0 80h399565c371 0 266.7 149.4 414 180 5.9 1.2 18 0 18 0 2 0
 3-1 3-3v-38c-76-158-257-219-435-219H0z`,rightgroupunder:`M0 262h399565c371 0 266.7-149.4 414-180 5.9-1.2 18 0 18
 0 2 0 3 1 3 3v38c-76 158-257 219-435 219H0z`,rightharpoon:`M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3
-3.7-15.3-11-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2
-10.7 0-16.7 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58
 69.2 92 94.5zm0 0v40h399900v-40z`,rightharpoonplus:`M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3-3.7-15.3-11
-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2-10.7 0-16.7
 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58 69.2 92 94.5z
m0 0v40h399900v-40z m100 194v40h399900v-40zm0 0v40h399900v-40z`,rightharpoondown:`M399747 511c0 7.3 6.7 11 20 11 8 0 13-.8 15-2.5s4.7-6.8
 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3 8.5-5.8 9.5
-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3-64.7 57-92 95
-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 241v40h399900v-40z`,rightharpoondownplus:`M399747 705c0 7.3 6.7 11 20 11 8 0 13-.8
 15-2.5s4.7-6.8 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3
 8.5-5.8 9.5-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3
-64.7 57-92 95-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 435v40h399900v-40z
m0-194v40h400000v-40zm0 0v40h400000v-40z`,righthook:`M399859 241c-764 0 0 0 0 0 40-3.3 68.7-15.7 86-37 10-12 15-25.3
 15-40 0-22.7-9.8-40.7-29.5-54-19.7-13.3-43.5-21-71.5-23-17.3-1.3-26-8-26-20 0
-13.3 8.7-20 26-20 38 0 71 11.2 99 33.5 0 0 7 5.6 21 16.7 14 11.2 21 33.5 21
 66.8s-14 61.2-42 83.5c-28 22.3-61 33.5-99 33.5L0 241z M0 281v-40h399859v40z`,rightlinesegment:`M399960 241 V94 h40 V428 h-40 V281 H0 v-40z
M399960 241 V94 h40 V428 h-40 V281 H0 v-40z`,rightToFrom:`M400000 167c-70.7-42-118-97.7-142-167h-23c-15.3 0-23 .3-23
 1 0 1.3 5.3 13.7 16 37 18 35.3 41.3 69 70 101l7 8H0v40h399905l-7 8c-28.7 32
-52 65.7-70 101-10.7 23.3-16 35.7-16 37 0 .7 7.7 1 23 1h23c24-69.3 71.3-125 142
-167z M100 147v40h399900v-40zM0 341v40h399900v-40z`,twoheadleftarrow:`M0 167c68 40
 115.7 95.7 143 167h22c15.3 0 23-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69
-70-101l-7-8h125l9 7c50.7 39.3 85 86 103 140h46c0-4.7-6.3-18.7-19-42-18-35.3
-40-67.3-66-96l-9-9h399716v-40H284l9-9c26-28.7 48-60.7 66-96 12.7-23.333 19
-37.333 19-42h-46c-18 54-52.3 100.7-103 140l-9 7H95l7-8c28.7-32 52-65.7 70-101
 10.7-23.333 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 71.3 68 127 0 167z`,twoheadrightarrow:`M400000 167
c-68-40-115.7-95.7-143-167h-22c-15.3 0-23 .3-23 1 0 1.3 5.3 13.7 16 37 18 35.3
 41.3 69 70 101l7 8h-125l-9-7c-50.7-39.3-85-86-103-140h-46c0 4.7 6.3 18.7 19 42
 18 35.3 40 67.3 66 96l9 9H0v40h399716l-9 9c-26 28.7-48 60.7-66 96-12.7 23.333
-19 37.333-19 42h46c18-54 52.3-100.7 103-140l9-7h125l-7 8c-28.7 32-52 65.7-70
 101-10.7 23.333-16 35.7-16 37 0 .7 7.7 1 23 1h22c27.3-71.3 75-127 143-167z`,tilde1:`M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z`,tilde2:`M344 55.266c-142 0-300.638 81.316-311.5 86.418
-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9
 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114
c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751
 181.476 676 181.476c-149 0-189-126.21-332-126.21z`,tilde3:`M786 59C457 59 32 175.242 13 175.242c-6 0-10-3.457
-11-10.37L.15 138c-1-7 3-12 10-13l19.2-6.4C378.4 40.7 634.3 0 804.3 0c337 0
 411.8 157 746.8 157 328 0 754-112 773-112 5 0 10 3 11 9l1 14.075c1 8.066-.697
 16.595-6.697 17.492l-21.052 7.31c-367.9 98.146-609.15 122.696-778.15 122.696
 -338 0-409-156.573-744-156.573z`,tilde4:`M786 58C457 58 32 177.487 13 177.487c-6 0-10-3.345
-11-10.035L.15 143c-1-7 3-12 10-13l22-6.7C381.2 35 637.15 0 807.15 0c337 0 409
 177 744 177 328 0 754-127 773-127 5 0 10 3 11 9l1 14.794c1 7.805-3 13.38-9
 14.495l-20.7 5.574c-366.85 99.79-607.3 139.372-776.3 139.372-338 0-409
 -175.236-744-175.236z`,vec:`M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z`,widehat1:`M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z`,widehat2:`M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widehat3:`M1181 0h2l1171 236c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 280h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widehat4:`M1181 0h2l1171 296c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 340h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widecheck1:`M529,159h5l519,-115c5,-1,9,-5,9,-10c0,-1,-1,-2,-1,-3l-4,-22c-1,
-5,-5,-9,-11,-9h-2l-512,92l-513,-92h-2c-5,0,-9,4,-11,9l-5,22c-1,6,2,12,8,13z`,widecheck2:`M1181,220h2l1171,-176c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,153l-1167,-153h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,widecheck3:`M1181,280h2l1171,-236c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,213l-1167,-213h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,widecheck4:`M1181,340h2l1171,-296c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,273l-1167,-273h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,baraboveleftarrow:`M400000 620h-399890l3 -3c68.7 -52.7 113.7 -120 135 -202
c4 -14.7 6 -23 6 -25c0 -7.3 -7 -11 -21 -11c-8 0 -13.2 0.8 -15.5 2.5
c-2.3 1.7 -4.2 5.8 -5.5 12.5c-1.3 4.7 -2.7 10.3 -4 17c-12 48.7 -34.8 92 -68.5 130
s-74.2 66.3 -121.5 85c-10 4 -16 7.7 -18 11c0 8.7 6 14.3 18 17c47.3 18.7 87.8 47
121.5 85s56.5 81.3 68.5 130c0.7 2 1.3 5 2 9s1.2 6.7 1.5 8c0.3 1.3 1 3.3 2 6
s2.2 4.5 3.5 5.5c1.3 1 3.3 1.8 6 2.5s6 1 10 1c14 0 21 -3.7 21 -11
c0 -2 -2 -10.3 -6 -25c-20 -79.3 -65 -146.7 -135 -202l-3 -3h399890z
M100 620v40h399900v-40z M0 241v40h399900v-40zM0 241v40h399900v-40z`,rightarrowabovebar:`M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32
-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0
13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39
-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5
-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
151.7 139 205zm96 379h399894v40H0zm0 0h399904v40H0z`,baraboveshortleftharpoon:`M507,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11
c1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17
c2,0.7,5,1,9,1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21
c-32,-87.3,-82.7,-157.7,-152,-211c0,0,-3,-3,-3,-3l399351,0l0,-40
c-398570,0,-399437,0,-399437,0z M593 435 v40 H399500 v-40z
M0 281 v-40 H399908 v40z M0 281 v-40 H399908 v40z`,rightharpoonaboveshortbar:`M0,241 l0,40c399126,0,399993,0,399993,0
c4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,
-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6
c-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z
M0 241 v40 H399908 v-40z M0 475 v-40 H399500 v40z M0 475 v-40 H399500 v40z`,shortbaraboveleftharpoon:`M7,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11
c1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17c2,0.7,5,1,9,
1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21c-32,-87.3,-82.7,-157.7,
-152,-211c0,0,-3,-3,-3,-3l399907,0l0,-40c-399126,0,-399993,0,-399993,0z
M93 435 v40 H400000 v-40z M500 241 v40 H400000 v-40z M500 241 v40 H400000 v-40z`,shortrightharpoonabovebar:`M53,241l0,40c398570,0,399437,0,399437,0
c4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,
-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6
c-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z
M500 241 v40 H399408 v-40z M500 435 v40 H400000 v-40z`},FC=function(t,n){switch(t){case"lbrack":return"M403 1759 V84 H666 V0 H319 V1759 v"+n+` v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v`+n+" v1759 h84z";case"rbrack":return"M347 1759 V0 H0 V84 H263 V1759 v"+n+` v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v`+n+" v1759 h84z";case"vert":return"M145 15 v585 v"+n+` v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v`+-n+` v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v`+n+" v585 h43z";case"doublevert":return"M145 15 v585 v"+n+` v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v`+-n+` v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v`+n+` v585 h43z
M367 15 v585 v`+n+` v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v`+-n+` v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v`+n+" v585 h43z";case"lfloor":return"M319 602 V0 H403 V602 v"+n+` v1715 h263 v84 H319z
MM319 602 V0 H403 V602 v`+n+" v1715 H319z";case"rfloor":return"M319 602 V0 H403 V602 v"+n+` v1799 H0 v-84 H319z
MM319 602 V0 H403 V602 v`+n+" v1715 H319z";case"lceil":return"M403 1759 V84 H666 V0 H319 V1759 v"+n+` v602 h84z
M403 1759 V0 H319 V1759 v`+n+" v602 h84z";case"rceil":return"M347 1759 V0 H0 V84 H263 V1759 v"+n+` v602 h84z
M347 1759 V0 h-84 V1759 v`+n+" v602 h84z";case"lparen":return`M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1
c-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,
-36,557 l0,`+(n+84)+`c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,
949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9
c0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,
-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189
l0,-`+(n+92)+`c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,
-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z`;case"rparen":return`M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,
63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5
c11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,`+(n+9)+`
c-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664
c-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11
c0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17
c242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558
l0,-`+(n+144)+`c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,
-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z`;default:throw new Error("Unknown stretchy delimiter.")}};class as{constructor(t){this.children=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.children=t,this.classes=[],this.height=0,this.depth=0,this.maxFontSize=0,this.style={}}hasClass(t){return te.contains(this.classes,t)}toNode(){for(var t=document.createDocumentFragment(),n=0;n<this.children.length;n++)t.appendChild(this.children[n].toNode());return t}toMarkup(){for(var t="",n=0;n<this.children.length;n++)t+=this.children[n].toMarkup();return t}toText(){var t=n=>n.toText();return this.children.map(t).join("")}}var Dn={"AMS-Regular":{32:[0,0,0,0,.25],65:[0,.68889,0,0,.72222],66:[0,.68889,0,0,.66667],67:[0,.68889,0,0,.72222],68:[0,.68889,0,0,.72222],69:[0,.68889,0,0,.66667],70:[0,.68889,0,0,.61111],71:[0,.68889,0,0,.77778],72:[0,.68889,0,0,.77778],73:[0,.68889,0,0,.38889],74:[.16667,.68889,0,0,.5],75:[0,.68889,0,0,.77778],76:[0,.68889,0,0,.66667],77:[0,.68889,0,0,.94445],78:[0,.68889,0,0,.72222],79:[.16667,.68889,0,0,.77778],80:[0,.68889,0,0,.61111],81:[.16667,.68889,0,0,.77778],82:[0,.68889,0,0,.72222],83:[0,.68889,0,0,.55556],84:[0,.68889,0,0,.66667],85:[0,.68889,0,0,.72222],86:[0,.68889,0,0,.72222],87:[0,.68889,0,0,1],88:[0,.68889,0,0,.72222],89:[0,.68889,0,0,.72222],90:[0,.68889,0,0,.66667],107:[0,.68889,0,0,.55556],160:[0,0,0,0,.25],165:[0,.675,.025,0,.75],174:[.15559,.69224,0,0,.94666],240:[0,.68889,0,0,.55556],295:[0,.68889,0,0,.54028],710:[0,.825,0,0,2.33334],732:[0,.9,0,0,2.33334],770:[0,.825,0,0,2.33334],771:[0,.9,0,0,2.33334],989:[.08167,.58167,0,0,.77778],1008:[0,.43056,.04028,0,.66667],8245:[0,.54986,0,0,.275],8463:[0,.68889,0,0,.54028],8487:[0,.68889,0,0,.72222],8498:[0,.68889,0,0,.55556],8502:[0,.68889,0,0,.66667],8503:[0,.68889,0,0,.44445],8504:[0,.68889,0,0,.66667],8513:[0,.68889,0,0,.63889],8592:[-.03598,.46402,0,0,.5],8594:[-.03598,.46402,0,0,.5],8602:[-.13313,.36687,0,0,1],8603:[-.13313,.36687,0,0,1],8606:[.01354,.52239,0,0,1],8608:[.01354,.52239,0,0,1],8610:[.01354,.52239,0,0,1.11111],8611:[.01354,.52239,0,0,1.11111],8619:[0,.54986,0,0,1],8620:[0,.54986,0,0,1],8621:[-.13313,.37788,0,0,1.38889],8622:[-.13313,.36687,0,0,1],8624:[0,.69224,0,0,.5],8625:[0,.69224,0,0,.5],8630:[0,.43056,0,0,1],8631:[0,.43056,0,0,1],8634:[.08198,.58198,0,0,.77778],8635:[.08198,.58198,0,0,.77778],8638:[.19444,.69224,0,0,.41667],8639:[.19444,.69224,0,0,.41667],8642:[.19444,.69224,0,0,.41667],8643:[.19444,.69224,0,0,.41667],8644:[.1808,.675,0,0,1],8646:[.1808,.675,0,0,1],8647:[.1808,.675,0,0,1],8648:[.19444,.69224,0,0,.83334],8649:[.1808,.675,0,0,1],8650:[.19444,.69224,0,0,.83334],8651:[.01354,.52239,0,0,1],8652:[.01354,.52239,0,0,1],8653:[-.13313,.36687,0,0,1],8654:[-.13313,.36687,0,0,1],8655:[-.13313,.36687,0,0,1],8666:[.13667,.63667,0,0,1],8667:[.13667,.63667,0,0,1],8669:[-.13313,.37788,0,0,1],8672:[-.064,.437,0,0,1.334],8674:[-.064,.437,0,0,1.334],8705:[0,.825,0,0,.5],8708:[0,.68889,0,0,.55556],8709:[.08167,.58167,0,0,.77778],8717:[0,.43056,0,0,.42917],8722:[-.03598,.46402,0,0,.5],8724:[.08198,.69224,0,0,.77778],8726:[.08167,.58167,0,0,.77778],8733:[0,.69224,0,0,.77778],8736:[0,.69224,0,0,.72222],8737:[0,.69224,0,0,.72222],8738:[.03517,.52239,0,0,.72222],8739:[.08167,.58167,0,0,.22222],8740:[.25142,.74111,0,0,.27778],8741:[.08167,.58167,0,0,.38889],8742:[.25142,.74111,0,0,.5],8756:[0,.69224,0,0,.66667],8757:[0,.69224,0,0,.66667],8764:[-.13313,.36687,0,0,.77778],8765:[-.13313,.37788,0,0,.77778],8769:[-.13313,.36687,0,0,.77778],8770:[-.03625,.46375,0,0,.77778],8774:[.30274,.79383,0,0,.77778],8776:[-.01688,.48312,0,0,.77778],8778:[.08167,.58167,0,0,.77778],8782:[.06062,.54986,0,0,.77778],8783:[.06062,.54986,0,0,.77778],8785:[.08198,.58198,0,0,.77778],8786:[.08198,.58198,0,0,.77778],8787:[.08198,.58198,0,0,.77778],8790:[0,.69224,0,0,.77778],8791:[.22958,.72958,0,0,.77778],8796:[.08198,.91667,0,0,.77778],8806:[.25583,.75583,0,0,.77778],8807:[.25583,.75583,0,0,.77778],8808:[.25142,.75726,0,0,.77778],8809:[.25142,.75726,0,0,.77778],8812:[.25583,.75583,0,0,.5],8814:[.20576,.70576,0,0,.77778],8815:[.20576,.70576,0,0,.77778],8816:[.30274,.79383,0,0,.77778],8817:[.30274,.79383,0,0,.77778],8818:[.22958,.72958,0,0,.77778],8819:[.22958,.72958,0,0,.77778],8822:[.1808,.675,0,0,.77778],8823:[.1808,.675,0,0,.77778],8828:[.13667,.63667,0,0,.77778],8829:[.13667,.63667,0,0,.77778],8830:[.22958,.72958,0,0,.77778],8831:[.22958,.72958,0,0,.77778],8832:[.20576,.70576,0,0,.77778],8833:[.20576,.70576,0,0,.77778],8840:[.30274,.79383,0,0,.77778],8841:[.30274,.79383,0,0,.77778],8842:[.13597,.63597,0,0,.77778],8843:[.13597,.63597,0,0,.77778],8847:[.03517,.54986,0,0,.77778],8848:[.03517,.54986,0,0,.77778],8858:[.08198,.58198,0,0,.77778],8859:[.08198,.58198,0,0,.77778],8861:[.08198,.58198,0,0,.77778],8862:[0,.675,0,0,.77778],8863:[0,.675,0,0,.77778],8864:[0,.675,0,0,.77778],8865:[0,.675,0,0,.77778],8872:[0,.69224,0,0,.61111],8873:[0,.69224,0,0,.72222],8874:[0,.69224,0,0,.88889],8876:[0,.68889,0,0,.61111],8877:[0,.68889,0,0,.61111],8878:[0,.68889,0,0,.72222],8879:[0,.68889,0,0,.72222],8882:[.03517,.54986,0,0,.77778],8883:[.03517,.54986,0,0,.77778],8884:[.13667,.63667,0,0,.77778],8885:[.13667,.63667,0,0,.77778],8888:[0,.54986,0,0,1.11111],8890:[.19444,.43056,0,0,.55556],8891:[.19444,.69224,0,0,.61111],8892:[.19444,.69224,0,0,.61111],8901:[0,.54986,0,0,.27778],8903:[.08167,.58167,0,0,.77778],8905:[.08167,.58167,0,0,.77778],8906:[.08167,.58167,0,0,.77778],8907:[0,.69224,0,0,.77778],8908:[0,.69224,0,0,.77778],8909:[-.03598,.46402,0,0,.77778],8910:[0,.54986,0,0,.76042],8911:[0,.54986,0,0,.76042],8912:[.03517,.54986,0,0,.77778],8913:[.03517,.54986,0,0,.77778],8914:[0,.54986,0,0,.66667],8915:[0,.54986,0,0,.66667],8916:[0,.69224,0,0,.66667],8918:[.0391,.5391,0,0,.77778],8919:[.0391,.5391,0,0,.77778],8920:[.03517,.54986,0,0,1.33334],8921:[.03517,.54986,0,0,1.33334],8922:[.38569,.88569,0,0,.77778],8923:[.38569,.88569,0,0,.77778],8926:[.13667,.63667,0,0,.77778],8927:[.13667,.63667,0,0,.77778],8928:[.30274,.79383,0,0,.77778],8929:[.30274,.79383,0,0,.77778],8934:[.23222,.74111,0,0,.77778],8935:[.23222,.74111,0,0,.77778],8936:[.23222,.74111,0,0,.77778],8937:[.23222,.74111,0,0,.77778],8938:[.20576,.70576,0,0,.77778],8939:[.20576,.70576,0,0,.77778],8940:[.30274,.79383,0,0,.77778],8941:[.30274,.79383,0,0,.77778],8994:[.19444,.69224,0,0,.77778],8995:[.19444,.69224,0,0,.77778],9416:[.15559,.69224,0,0,.90222],9484:[0,.69224,0,0,.5],9488:[0,.69224,0,0,.5],9492:[0,.37788,0,0,.5],9496:[0,.37788,0,0,.5],9585:[.19444,.68889,0,0,.88889],9586:[.19444,.74111,0,0,.88889],9632:[0,.675,0,0,.77778],9633:[0,.675,0,0,.77778],9650:[0,.54986,0,0,.72222],9651:[0,.54986,0,0,.72222],9654:[.03517,.54986,0,0,.77778],9660:[0,.54986,0,0,.72222],9661:[0,.54986,0,0,.72222],9664:[.03517,.54986,0,0,.77778],9674:[.11111,.69224,0,0,.66667],9733:[.19444,.69224,0,0,.94445],10003:[0,.69224,0,0,.83334],10016:[0,.69224,0,0,.83334],10731:[.11111,.69224,0,0,.66667],10846:[.19444,.75583,0,0,.61111],10877:[.13667,.63667,0,0,.77778],10878:[.13667,.63667,0,0,.77778],10885:[.25583,.75583,0,0,.77778],10886:[.25583,.75583,0,0,.77778],10887:[.13597,.63597,0,0,.77778],10888:[.13597,.63597,0,0,.77778],10889:[.26167,.75726,0,0,.77778],10890:[.26167,.75726,0,0,.77778],10891:[.48256,.98256,0,0,.77778],10892:[.48256,.98256,0,0,.77778],10901:[.13667,.63667,0,0,.77778],10902:[.13667,.63667,0,0,.77778],10933:[.25142,.75726,0,0,.77778],10934:[.25142,.75726,0,0,.77778],10935:[.26167,.75726,0,0,.77778],10936:[.26167,.75726,0,0,.77778],10937:[.26167,.75726,0,0,.77778],10938:[.26167,.75726,0,0,.77778],10949:[.25583,.75583,0,0,.77778],10950:[.25583,.75583,0,0,.77778],10955:[.28481,.79383,0,0,.77778],10956:[.28481,.79383,0,0,.77778],57350:[.08167,.58167,0,0,.22222],57351:[.08167,.58167,0,0,.38889],57352:[.08167,.58167,0,0,.77778],57353:[0,.43056,.04028,0,.66667],57356:[.25142,.75726,0,0,.77778],57357:[.25142,.75726,0,0,.77778],57358:[.41951,.91951,0,0,.77778],57359:[.30274,.79383,0,0,.77778],57360:[.30274,.79383,0,0,.77778],57361:[.41951,.91951,0,0,.77778],57366:[.25142,.75726,0,0,.77778],57367:[.25142,.75726,0,0,.77778],57368:[.25142,.75726,0,0,.77778],57369:[.25142,.75726,0,0,.77778],57370:[.13597,.63597,0,0,.77778],57371:[.13597,.63597,0,0,.77778]},"Caligraphic-Regular":{32:[0,0,0,0,.25],65:[0,.68333,0,.19445,.79847],66:[0,.68333,.03041,.13889,.65681],67:[0,.68333,.05834,.13889,.52653],68:[0,.68333,.02778,.08334,.77139],69:[0,.68333,.08944,.11111,.52778],70:[0,.68333,.09931,.11111,.71875],71:[.09722,.68333,.0593,.11111,.59487],72:[0,.68333,.00965,.11111,.84452],73:[0,.68333,.07382,0,.54452],74:[.09722,.68333,.18472,.16667,.67778],75:[0,.68333,.01445,.05556,.76195],76:[0,.68333,0,.13889,.68972],77:[0,.68333,0,.13889,1.2009],78:[0,.68333,.14736,.08334,.82049],79:[0,.68333,.02778,.11111,.79611],80:[0,.68333,.08222,.08334,.69556],81:[.09722,.68333,0,.11111,.81667],82:[0,.68333,0,.08334,.8475],83:[0,.68333,.075,.13889,.60556],84:[0,.68333,.25417,0,.54464],85:[0,.68333,.09931,.08334,.62583],86:[0,.68333,.08222,0,.61278],87:[0,.68333,.08222,.08334,.98778],88:[0,.68333,.14643,.13889,.7133],89:[.09722,.68333,.08222,.08334,.66834],90:[0,.68333,.07944,.13889,.72473],160:[0,0,0,0,.25]},"Fraktur-Regular":{32:[0,0,0,0,.25],33:[0,.69141,0,0,.29574],34:[0,.69141,0,0,.21471],38:[0,.69141,0,0,.73786],39:[0,.69141,0,0,.21201],40:[.24982,.74947,0,0,.38865],41:[.24982,.74947,0,0,.38865],42:[0,.62119,0,0,.27764],43:[.08319,.58283,0,0,.75623],44:[0,.10803,0,0,.27764],45:[.08319,.58283,0,0,.75623],46:[0,.10803,0,0,.27764],47:[.24982,.74947,0,0,.50181],48:[0,.47534,0,0,.50181],49:[0,.47534,0,0,.50181],50:[0,.47534,0,0,.50181],51:[.18906,.47534,0,0,.50181],52:[.18906,.47534,0,0,.50181],53:[.18906,.47534,0,0,.50181],54:[0,.69141,0,0,.50181],55:[.18906,.47534,0,0,.50181],56:[0,.69141,0,0,.50181],57:[.18906,.47534,0,0,.50181],58:[0,.47534,0,0,.21606],59:[.12604,.47534,0,0,.21606],61:[-.13099,.36866,0,0,.75623],63:[0,.69141,0,0,.36245],65:[0,.69141,0,0,.7176],66:[0,.69141,0,0,.88397],67:[0,.69141,0,0,.61254],68:[0,.69141,0,0,.83158],69:[0,.69141,0,0,.66278],70:[.12604,.69141,0,0,.61119],71:[0,.69141,0,0,.78539],72:[.06302,.69141,0,0,.7203],73:[0,.69141,0,0,.55448],74:[.12604,.69141,0,0,.55231],75:[0,.69141,0,0,.66845],76:[0,.69141,0,0,.66602],77:[0,.69141,0,0,1.04953],78:[0,.69141,0,0,.83212],79:[0,.69141,0,0,.82699],80:[.18906,.69141,0,0,.82753],81:[.03781,.69141,0,0,.82699],82:[0,.69141,0,0,.82807],83:[0,.69141,0,0,.82861],84:[0,.69141,0,0,.66899],85:[0,.69141,0,0,.64576],86:[0,.69141,0,0,.83131],87:[0,.69141,0,0,1.04602],88:[0,.69141,0,0,.71922],89:[.18906,.69141,0,0,.83293],90:[.12604,.69141,0,0,.60201],91:[.24982,.74947,0,0,.27764],93:[.24982,.74947,0,0,.27764],94:[0,.69141,0,0,.49965],97:[0,.47534,0,0,.50046],98:[0,.69141,0,0,.51315],99:[0,.47534,0,0,.38946],100:[0,.62119,0,0,.49857],101:[0,.47534,0,0,.40053],102:[.18906,.69141,0,0,.32626],103:[.18906,.47534,0,0,.5037],104:[.18906,.69141,0,0,.52126],105:[0,.69141,0,0,.27899],106:[0,.69141,0,0,.28088],107:[0,.69141,0,0,.38946],108:[0,.69141,0,0,.27953],109:[0,.47534,0,0,.76676],110:[0,.47534,0,0,.52666],111:[0,.47534,0,0,.48885],112:[.18906,.52396,0,0,.50046],113:[.18906,.47534,0,0,.48912],114:[0,.47534,0,0,.38919],115:[0,.47534,0,0,.44266],116:[0,.62119,0,0,.33301],117:[0,.47534,0,0,.5172],118:[0,.52396,0,0,.5118],119:[0,.52396,0,0,.77351],120:[.18906,.47534,0,0,.38865],121:[.18906,.47534,0,0,.49884],122:[.18906,.47534,0,0,.39054],160:[0,0,0,0,.25],8216:[0,.69141,0,0,.21471],8217:[0,.69141,0,0,.21471],58112:[0,.62119,0,0,.49749],58113:[0,.62119,0,0,.4983],58114:[.18906,.69141,0,0,.33328],58115:[.18906,.69141,0,0,.32923],58116:[.18906,.47534,0,0,.50343],58117:[0,.69141,0,0,.33301],58118:[0,.62119,0,0,.33409],58119:[0,.47534,0,0,.50073]},"Main-Bold":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.35],34:[0,.69444,0,0,.60278],35:[.19444,.69444,0,0,.95833],36:[.05556,.75,0,0,.575],37:[.05556,.75,0,0,.95833],38:[0,.69444,0,0,.89444],39:[0,.69444,0,0,.31944],40:[.25,.75,0,0,.44722],41:[.25,.75,0,0,.44722],42:[0,.75,0,0,.575],43:[.13333,.63333,0,0,.89444],44:[.19444,.15556,0,0,.31944],45:[0,.44444,0,0,.38333],46:[0,.15556,0,0,.31944],47:[.25,.75,0,0,.575],48:[0,.64444,0,0,.575],49:[0,.64444,0,0,.575],50:[0,.64444,0,0,.575],51:[0,.64444,0,0,.575],52:[0,.64444,0,0,.575],53:[0,.64444,0,0,.575],54:[0,.64444,0,0,.575],55:[0,.64444,0,0,.575],56:[0,.64444,0,0,.575],57:[0,.64444,0,0,.575],58:[0,.44444,0,0,.31944],59:[.19444,.44444,0,0,.31944],60:[.08556,.58556,0,0,.89444],61:[-.10889,.39111,0,0,.89444],62:[.08556,.58556,0,0,.89444],63:[0,.69444,0,0,.54305],64:[0,.69444,0,0,.89444],65:[0,.68611,0,0,.86944],66:[0,.68611,0,0,.81805],67:[0,.68611,0,0,.83055],68:[0,.68611,0,0,.88194],69:[0,.68611,0,0,.75555],70:[0,.68611,0,0,.72361],71:[0,.68611,0,0,.90416],72:[0,.68611,0,0,.9],73:[0,.68611,0,0,.43611],74:[0,.68611,0,0,.59444],75:[0,.68611,0,0,.90138],76:[0,.68611,0,0,.69166],77:[0,.68611,0,0,1.09166],78:[0,.68611,0,0,.9],79:[0,.68611,0,0,.86388],80:[0,.68611,0,0,.78611],81:[.19444,.68611,0,0,.86388],82:[0,.68611,0,0,.8625],83:[0,.68611,0,0,.63889],84:[0,.68611,0,0,.8],85:[0,.68611,0,0,.88472],86:[0,.68611,.01597,0,.86944],87:[0,.68611,.01597,0,1.18888],88:[0,.68611,0,0,.86944],89:[0,.68611,.02875,0,.86944],90:[0,.68611,0,0,.70277],91:[.25,.75,0,0,.31944],92:[.25,.75,0,0,.575],93:[.25,.75,0,0,.31944],94:[0,.69444,0,0,.575],95:[.31,.13444,.03194,0,.575],97:[0,.44444,0,0,.55902],98:[0,.69444,0,0,.63889],99:[0,.44444,0,0,.51111],100:[0,.69444,0,0,.63889],101:[0,.44444,0,0,.52708],102:[0,.69444,.10903,0,.35139],103:[.19444,.44444,.01597,0,.575],104:[0,.69444,0,0,.63889],105:[0,.69444,0,0,.31944],106:[.19444,.69444,0,0,.35139],107:[0,.69444,0,0,.60694],108:[0,.69444,0,0,.31944],109:[0,.44444,0,0,.95833],110:[0,.44444,0,0,.63889],111:[0,.44444,0,0,.575],112:[.19444,.44444,0,0,.63889],113:[.19444,.44444,0,0,.60694],114:[0,.44444,0,0,.47361],115:[0,.44444,0,0,.45361],116:[0,.63492,0,0,.44722],117:[0,.44444,0,0,.63889],118:[0,.44444,.01597,0,.60694],119:[0,.44444,.01597,0,.83055],120:[0,.44444,0,0,.60694],121:[.19444,.44444,.01597,0,.60694],122:[0,.44444,0,0,.51111],123:[.25,.75,0,0,.575],124:[.25,.75,0,0,.31944],125:[.25,.75,0,0,.575],126:[.35,.34444,0,0,.575],160:[0,0,0,0,.25],163:[0,.69444,0,0,.86853],168:[0,.69444,0,0,.575],172:[0,.44444,0,0,.76666],176:[0,.69444,0,0,.86944],177:[.13333,.63333,0,0,.89444],184:[.17014,0,0,0,.51111],198:[0,.68611,0,0,1.04166],215:[.13333,.63333,0,0,.89444],216:[.04861,.73472,0,0,.89444],223:[0,.69444,0,0,.59722],230:[0,.44444,0,0,.83055],247:[.13333,.63333,0,0,.89444],248:[.09722,.54167,0,0,.575],305:[0,.44444,0,0,.31944],338:[0,.68611,0,0,1.16944],339:[0,.44444,0,0,.89444],567:[.19444,.44444,0,0,.35139],710:[0,.69444,0,0,.575],711:[0,.63194,0,0,.575],713:[0,.59611,0,0,.575],714:[0,.69444,0,0,.575],715:[0,.69444,0,0,.575],728:[0,.69444,0,0,.575],729:[0,.69444,0,0,.31944],730:[0,.69444,0,0,.86944],732:[0,.69444,0,0,.575],733:[0,.69444,0,0,.575],915:[0,.68611,0,0,.69166],916:[0,.68611,0,0,.95833],920:[0,.68611,0,0,.89444],923:[0,.68611,0,0,.80555],926:[0,.68611,0,0,.76666],928:[0,.68611,0,0,.9],931:[0,.68611,0,0,.83055],933:[0,.68611,0,0,.89444],934:[0,.68611,0,0,.83055],936:[0,.68611,0,0,.89444],937:[0,.68611,0,0,.83055],8211:[0,.44444,.03194,0,.575],8212:[0,.44444,.03194,0,1.14999],8216:[0,.69444,0,0,.31944],8217:[0,.69444,0,0,.31944],8220:[0,.69444,0,0,.60278],8221:[0,.69444,0,0,.60278],8224:[.19444,.69444,0,0,.51111],8225:[.19444,.69444,0,0,.51111],8242:[0,.55556,0,0,.34444],8407:[0,.72444,.15486,0,.575],8463:[0,.69444,0,0,.66759],8465:[0,.69444,0,0,.83055],8467:[0,.69444,0,0,.47361],8472:[.19444,.44444,0,0,.74027],8476:[0,.69444,0,0,.83055],8501:[0,.69444,0,0,.70277],8592:[-.10889,.39111,0,0,1.14999],8593:[.19444,.69444,0,0,.575],8594:[-.10889,.39111,0,0,1.14999],8595:[.19444,.69444,0,0,.575],8596:[-.10889,.39111,0,0,1.14999],8597:[.25,.75,0,0,.575],8598:[.19444,.69444,0,0,1.14999],8599:[.19444,.69444,0,0,1.14999],8600:[.19444,.69444,0,0,1.14999],8601:[.19444,.69444,0,0,1.14999],8636:[-.10889,.39111,0,0,1.14999],8637:[-.10889,.39111,0,0,1.14999],8640:[-.10889,.39111,0,0,1.14999],8641:[-.10889,.39111,0,0,1.14999],8656:[-.10889,.39111,0,0,1.14999],8657:[.19444,.69444,0,0,.70277],8658:[-.10889,.39111,0,0,1.14999],8659:[.19444,.69444,0,0,.70277],8660:[-.10889,.39111,0,0,1.14999],8661:[.25,.75,0,0,.70277],8704:[0,.69444,0,0,.63889],8706:[0,.69444,.06389,0,.62847],8707:[0,.69444,0,0,.63889],8709:[.05556,.75,0,0,.575],8711:[0,.68611,0,0,.95833],8712:[.08556,.58556,0,0,.76666],8715:[.08556,.58556,0,0,.76666],8722:[.13333,.63333,0,0,.89444],8723:[.13333,.63333,0,0,.89444],8725:[.25,.75,0,0,.575],8726:[.25,.75,0,0,.575],8727:[-.02778,.47222,0,0,.575],8728:[-.02639,.47361,0,0,.575],8729:[-.02639,.47361,0,0,.575],8730:[.18,.82,0,0,.95833],8733:[0,.44444,0,0,.89444],8734:[0,.44444,0,0,1.14999],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.31944],8741:[.25,.75,0,0,.575],8743:[0,.55556,0,0,.76666],8744:[0,.55556,0,0,.76666],8745:[0,.55556,0,0,.76666],8746:[0,.55556,0,0,.76666],8747:[.19444,.69444,.12778,0,.56875],8764:[-.10889,.39111,0,0,.89444],8768:[.19444,.69444,0,0,.31944],8771:[.00222,.50222,0,0,.89444],8773:[.027,.638,0,0,.894],8776:[.02444,.52444,0,0,.89444],8781:[.00222,.50222,0,0,.89444],8801:[.00222,.50222,0,0,.89444],8804:[.19667,.69667,0,0,.89444],8805:[.19667,.69667,0,0,.89444],8810:[.08556,.58556,0,0,1.14999],8811:[.08556,.58556,0,0,1.14999],8826:[.08556,.58556,0,0,.89444],8827:[.08556,.58556,0,0,.89444],8834:[.08556,.58556,0,0,.89444],8835:[.08556,.58556,0,0,.89444],8838:[.19667,.69667,0,0,.89444],8839:[.19667,.69667,0,0,.89444],8846:[0,.55556,0,0,.76666],8849:[.19667,.69667,0,0,.89444],8850:[.19667,.69667,0,0,.89444],8851:[0,.55556,0,0,.76666],8852:[0,.55556,0,0,.76666],8853:[.13333,.63333,0,0,.89444],8854:[.13333,.63333,0,0,.89444],8855:[.13333,.63333,0,0,.89444],8856:[.13333,.63333,0,0,.89444],8857:[.13333,.63333,0,0,.89444],8866:[0,.69444,0,0,.70277],8867:[0,.69444,0,0,.70277],8868:[0,.69444,0,0,.89444],8869:[0,.69444,0,0,.89444],8900:[-.02639,.47361,0,0,.575],8901:[-.02639,.47361,0,0,.31944],8902:[-.02778,.47222,0,0,.575],8968:[.25,.75,0,0,.51111],8969:[.25,.75,0,0,.51111],8970:[.25,.75,0,0,.51111],8971:[.25,.75,0,0,.51111],8994:[-.13889,.36111,0,0,1.14999],8995:[-.13889,.36111,0,0,1.14999],9651:[.19444,.69444,0,0,1.02222],9657:[-.02778,.47222,0,0,.575],9661:[.19444,.69444,0,0,1.02222],9667:[-.02778,.47222,0,0,.575],9711:[.19444,.69444,0,0,1.14999],9824:[.12963,.69444,0,0,.89444],9825:[.12963,.69444,0,0,.89444],9826:[.12963,.69444,0,0,.89444],9827:[.12963,.69444,0,0,.89444],9837:[0,.75,0,0,.44722],9838:[.19444,.69444,0,0,.44722],9839:[.19444,.69444,0,0,.44722],10216:[.25,.75,0,0,.44722],10217:[.25,.75,0,0,.44722],10815:[0,.68611,0,0,.9],10927:[.19667,.69667,0,0,.89444],10928:[.19667,.69667,0,0,.89444],57376:[.19444,.69444,0,0,0]},"Main-BoldItalic":{32:[0,0,0,0,.25],33:[0,.69444,.11417,0,.38611],34:[0,.69444,.07939,0,.62055],35:[.19444,.69444,.06833,0,.94444],37:[.05556,.75,.12861,0,.94444],38:[0,.69444,.08528,0,.88555],39:[0,.69444,.12945,0,.35555],40:[.25,.75,.15806,0,.47333],41:[.25,.75,.03306,0,.47333],42:[0,.75,.14333,0,.59111],43:[.10333,.60333,.03306,0,.88555],44:[.19444,.14722,0,0,.35555],45:[0,.44444,.02611,0,.41444],46:[0,.14722,0,0,.35555],47:[.25,.75,.15806,0,.59111],48:[0,.64444,.13167,0,.59111],49:[0,.64444,.13167,0,.59111],50:[0,.64444,.13167,0,.59111],51:[0,.64444,.13167,0,.59111],52:[.19444,.64444,.13167,0,.59111],53:[0,.64444,.13167,0,.59111],54:[0,.64444,.13167,0,.59111],55:[.19444,.64444,.13167,0,.59111],56:[0,.64444,.13167,0,.59111],57:[0,.64444,.13167,0,.59111],58:[0,.44444,.06695,0,.35555],59:[.19444,.44444,.06695,0,.35555],61:[-.10889,.39111,.06833,0,.88555],63:[0,.69444,.11472,0,.59111],64:[0,.69444,.09208,0,.88555],65:[0,.68611,0,0,.86555],66:[0,.68611,.0992,0,.81666],67:[0,.68611,.14208,0,.82666],68:[0,.68611,.09062,0,.87555],69:[0,.68611,.11431,0,.75666],70:[0,.68611,.12903,0,.72722],71:[0,.68611,.07347,0,.89527],72:[0,.68611,.17208,0,.8961],73:[0,.68611,.15681,0,.47166],74:[0,.68611,.145,0,.61055],75:[0,.68611,.14208,0,.89499],76:[0,.68611,0,0,.69777],77:[0,.68611,.17208,0,1.07277],78:[0,.68611,.17208,0,.8961],79:[0,.68611,.09062,0,.85499],80:[0,.68611,.0992,0,.78721],81:[.19444,.68611,.09062,0,.85499],82:[0,.68611,.02559,0,.85944],83:[0,.68611,.11264,0,.64999],84:[0,.68611,.12903,0,.7961],85:[0,.68611,.17208,0,.88083],86:[0,.68611,.18625,0,.86555],87:[0,.68611,.18625,0,1.15999],88:[0,.68611,.15681,0,.86555],89:[0,.68611,.19803,0,.86555],90:[0,.68611,.14208,0,.70888],91:[.25,.75,.1875,0,.35611],93:[.25,.75,.09972,0,.35611],94:[0,.69444,.06709,0,.59111],95:[.31,.13444,.09811,0,.59111],97:[0,.44444,.09426,0,.59111],98:[0,.69444,.07861,0,.53222],99:[0,.44444,.05222,0,.53222],100:[0,.69444,.10861,0,.59111],101:[0,.44444,.085,0,.53222],102:[.19444,.69444,.21778,0,.4],103:[.19444,.44444,.105,0,.53222],104:[0,.69444,.09426,0,.59111],105:[0,.69326,.11387,0,.35555],106:[.19444,.69326,.1672,0,.35555],107:[0,.69444,.11111,0,.53222],108:[0,.69444,.10861,0,.29666],109:[0,.44444,.09426,0,.94444],110:[0,.44444,.09426,0,.64999],111:[0,.44444,.07861,0,.59111],112:[.19444,.44444,.07861,0,.59111],113:[.19444,.44444,.105,0,.53222],114:[0,.44444,.11111,0,.50167],115:[0,.44444,.08167,0,.48694],116:[0,.63492,.09639,0,.385],117:[0,.44444,.09426,0,.62055],118:[0,.44444,.11111,0,.53222],119:[0,.44444,.11111,0,.76777],120:[0,.44444,.12583,0,.56055],121:[.19444,.44444,.105,0,.56166],122:[0,.44444,.13889,0,.49055],126:[.35,.34444,.11472,0,.59111],160:[0,0,0,0,.25],168:[0,.69444,.11473,0,.59111],176:[0,.69444,0,0,.94888],184:[.17014,0,0,0,.53222],198:[0,.68611,.11431,0,1.02277],216:[.04861,.73472,.09062,0,.88555],223:[.19444,.69444,.09736,0,.665],230:[0,.44444,.085,0,.82666],248:[.09722,.54167,.09458,0,.59111],305:[0,.44444,.09426,0,.35555],338:[0,.68611,.11431,0,1.14054],339:[0,.44444,.085,0,.82666],567:[.19444,.44444,.04611,0,.385],710:[0,.69444,.06709,0,.59111],711:[0,.63194,.08271,0,.59111],713:[0,.59444,.10444,0,.59111],714:[0,.69444,.08528,0,.59111],715:[0,.69444,0,0,.59111],728:[0,.69444,.10333,0,.59111],729:[0,.69444,.12945,0,.35555],730:[0,.69444,0,0,.94888],732:[0,.69444,.11472,0,.59111],733:[0,.69444,.11472,0,.59111],915:[0,.68611,.12903,0,.69777],916:[0,.68611,0,0,.94444],920:[0,.68611,.09062,0,.88555],923:[0,.68611,0,0,.80666],926:[0,.68611,.15092,0,.76777],928:[0,.68611,.17208,0,.8961],931:[0,.68611,.11431,0,.82666],933:[0,.68611,.10778,0,.88555],934:[0,.68611,.05632,0,.82666],936:[0,.68611,.10778,0,.88555],937:[0,.68611,.0992,0,.82666],8211:[0,.44444,.09811,0,.59111],8212:[0,.44444,.09811,0,1.18221],8216:[0,.69444,.12945,0,.35555],8217:[0,.69444,.12945,0,.35555],8220:[0,.69444,.16772,0,.62055],8221:[0,.69444,.07939,0,.62055]},"Main-Italic":{32:[0,0,0,0,.25],33:[0,.69444,.12417,0,.30667],34:[0,.69444,.06961,0,.51444],35:[.19444,.69444,.06616,0,.81777],37:[.05556,.75,.13639,0,.81777],38:[0,.69444,.09694,0,.76666],39:[0,.69444,.12417,0,.30667],40:[.25,.75,.16194,0,.40889],41:[.25,.75,.03694,0,.40889],42:[0,.75,.14917,0,.51111],43:[.05667,.56167,.03694,0,.76666],44:[.19444,.10556,0,0,.30667],45:[0,.43056,.02826,0,.35778],46:[0,.10556,0,0,.30667],47:[.25,.75,.16194,0,.51111],48:[0,.64444,.13556,0,.51111],49:[0,.64444,.13556,0,.51111],50:[0,.64444,.13556,0,.51111],51:[0,.64444,.13556,0,.51111],52:[.19444,.64444,.13556,0,.51111],53:[0,.64444,.13556,0,.51111],54:[0,.64444,.13556,0,.51111],55:[.19444,.64444,.13556,0,.51111],56:[0,.64444,.13556,0,.51111],57:[0,.64444,.13556,0,.51111],58:[0,.43056,.0582,0,.30667],59:[.19444,.43056,.0582,0,.30667],61:[-.13313,.36687,.06616,0,.76666],63:[0,.69444,.1225,0,.51111],64:[0,.69444,.09597,0,.76666],65:[0,.68333,0,0,.74333],66:[0,.68333,.10257,0,.70389],67:[0,.68333,.14528,0,.71555],68:[0,.68333,.09403,0,.755],69:[0,.68333,.12028,0,.67833],70:[0,.68333,.13305,0,.65277],71:[0,.68333,.08722,0,.77361],72:[0,.68333,.16389,0,.74333],73:[0,.68333,.15806,0,.38555],74:[0,.68333,.14028,0,.525],75:[0,.68333,.14528,0,.76888],76:[0,.68333,0,0,.62722],77:[0,.68333,.16389,0,.89666],78:[0,.68333,.16389,0,.74333],79:[0,.68333,.09403,0,.76666],80:[0,.68333,.10257,0,.67833],81:[.19444,.68333,.09403,0,.76666],82:[0,.68333,.03868,0,.72944],83:[0,.68333,.11972,0,.56222],84:[0,.68333,.13305,0,.71555],85:[0,.68333,.16389,0,.74333],86:[0,.68333,.18361,0,.74333],87:[0,.68333,.18361,0,.99888],88:[0,.68333,.15806,0,.74333],89:[0,.68333,.19383,0,.74333],90:[0,.68333,.14528,0,.61333],91:[.25,.75,.1875,0,.30667],93:[.25,.75,.10528,0,.30667],94:[0,.69444,.06646,0,.51111],95:[.31,.12056,.09208,0,.51111],97:[0,.43056,.07671,0,.51111],98:[0,.69444,.06312,0,.46],99:[0,.43056,.05653,0,.46],100:[0,.69444,.10333,0,.51111],101:[0,.43056,.07514,0,.46],102:[.19444,.69444,.21194,0,.30667],103:[.19444,.43056,.08847,0,.46],104:[0,.69444,.07671,0,.51111],105:[0,.65536,.1019,0,.30667],106:[.19444,.65536,.14467,0,.30667],107:[0,.69444,.10764,0,.46],108:[0,.69444,.10333,0,.25555],109:[0,.43056,.07671,0,.81777],110:[0,.43056,.07671,0,.56222],111:[0,.43056,.06312,0,.51111],112:[.19444,.43056,.06312,0,.51111],113:[.19444,.43056,.08847,0,.46],114:[0,.43056,.10764,0,.42166],115:[0,.43056,.08208,0,.40889],116:[0,.61508,.09486,0,.33222],117:[0,.43056,.07671,0,.53666],118:[0,.43056,.10764,0,.46],119:[0,.43056,.10764,0,.66444],120:[0,.43056,.12042,0,.46389],121:[.19444,.43056,.08847,0,.48555],122:[0,.43056,.12292,0,.40889],126:[.35,.31786,.11585,0,.51111],160:[0,0,0,0,.25],168:[0,.66786,.10474,0,.51111],176:[0,.69444,0,0,.83129],184:[.17014,0,0,0,.46],198:[0,.68333,.12028,0,.88277],216:[.04861,.73194,.09403,0,.76666],223:[.19444,.69444,.10514,0,.53666],230:[0,.43056,.07514,0,.71555],248:[.09722,.52778,.09194,0,.51111],338:[0,.68333,.12028,0,.98499],339:[0,.43056,.07514,0,.71555],710:[0,.69444,.06646,0,.51111],711:[0,.62847,.08295,0,.51111],713:[0,.56167,.10333,0,.51111],714:[0,.69444,.09694,0,.51111],715:[0,.69444,0,0,.51111],728:[0,.69444,.10806,0,.51111],729:[0,.66786,.11752,0,.30667],730:[0,.69444,0,0,.83129],732:[0,.66786,.11585,0,.51111],733:[0,.69444,.1225,0,.51111],915:[0,.68333,.13305,0,.62722],916:[0,.68333,0,0,.81777],920:[0,.68333,.09403,0,.76666],923:[0,.68333,0,0,.69222],926:[0,.68333,.15294,0,.66444],928:[0,.68333,.16389,0,.74333],931:[0,.68333,.12028,0,.71555],933:[0,.68333,.11111,0,.76666],934:[0,.68333,.05986,0,.71555],936:[0,.68333,.11111,0,.76666],937:[0,.68333,.10257,0,.71555],8211:[0,.43056,.09208,0,.51111],8212:[0,.43056,.09208,0,1.02222],8216:[0,.69444,.12417,0,.30667],8217:[0,.69444,.12417,0,.30667],8220:[0,.69444,.1685,0,.51444],8221:[0,.69444,.06961,0,.51444],8463:[0,.68889,0,0,.54028]},"Main-Regular":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.27778],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.77778],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.19444,.10556,0,0,.27778],45:[0,.43056,0,0,.33333],46:[0,.10556,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.64444,0,0,.5],49:[0,.64444,0,0,.5],50:[0,.64444,0,0,.5],51:[0,.64444,0,0,.5],52:[0,.64444,0,0,.5],53:[0,.64444,0,0,.5],54:[0,.64444,0,0,.5],55:[0,.64444,0,0,.5],56:[0,.64444,0,0,.5],57:[0,.64444,0,0,.5],58:[0,.43056,0,0,.27778],59:[.19444,.43056,0,0,.27778],60:[.0391,.5391,0,0,.77778],61:[-.13313,.36687,0,0,.77778],62:[.0391,.5391,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.77778],65:[0,.68333,0,0,.75],66:[0,.68333,0,0,.70834],67:[0,.68333,0,0,.72222],68:[0,.68333,0,0,.76389],69:[0,.68333,0,0,.68056],70:[0,.68333,0,0,.65278],71:[0,.68333,0,0,.78472],72:[0,.68333,0,0,.75],73:[0,.68333,0,0,.36111],74:[0,.68333,0,0,.51389],75:[0,.68333,0,0,.77778],76:[0,.68333,0,0,.625],77:[0,.68333,0,0,.91667],78:[0,.68333,0,0,.75],79:[0,.68333,0,0,.77778],80:[0,.68333,0,0,.68056],81:[.19444,.68333,0,0,.77778],82:[0,.68333,0,0,.73611],83:[0,.68333,0,0,.55556],84:[0,.68333,0,0,.72222],85:[0,.68333,0,0,.75],86:[0,.68333,.01389,0,.75],87:[0,.68333,.01389,0,1.02778],88:[0,.68333,0,0,.75],89:[0,.68333,.025,0,.75],90:[0,.68333,0,0,.61111],91:[.25,.75,0,0,.27778],92:[.25,.75,0,0,.5],93:[.25,.75,0,0,.27778],94:[0,.69444,0,0,.5],95:[.31,.12056,.02778,0,.5],97:[0,.43056,0,0,.5],98:[0,.69444,0,0,.55556],99:[0,.43056,0,0,.44445],100:[0,.69444,0,0,.55556],101:[0,.43056,0,0,.44445],102:[0,.69444,.07778,0,.30556],103:[.19444,.43056,.01389,0,.5],104:[0,.69444,0,0,.55556],105:[0,.66786,0,0,.27778],106:[.19444,.66786,0,0,.30556],107:[0,.69444,0,0,.52778],108:[0,.69444,0,0,.27778],109:[0,.43056,0,0,.83334],110:[0,.43056,0,0,.55556],111:[0,.43056,0,0,.5],112:[.19444,.43056,0,0,.55556],113:[.19444,.43056,0,0,.52778],114:[0,.43056,0,0,.39167],115:[0,.43056,0,0,.39445],116:[0,.61508,0,0,.38889],117:[0,.43056,0,0,.55556],118:[0,.43056,.01389,0,.52778],119:[0,.43056,.01389,0,.72222],120:[0,.43056,0,0,.52778],121:[.19444,.43056,.01389,0,.52778],122:[0,.43056,0,0,.44445],123:[.25,.75,0,0,.5],124:[.25,.75,0,0,.27778],125:[.25,.75,0,0,.5],126:[.35,.31786,0,0,.5],160:[0,0,0,0,.25],163:[0,.69444,0,0,.76909],167:[.19444,.69444,0,0,.44445],168:[0,.66786,0,0,.5],172:[0,.43056,0,0,.66667],176:[0,.69444,0,0,.75],177:[.08333,.58333,0,0,.77778],182:[.19444,.69444,0,0,.61111],184:[.17014,0,0,0,.44445],198:[0,.68333,0,0,.90278],215:[.08333,.58333,0,0,.77778],216:[.04861,.73194,0,0,.77778],223:[0,.69444,0,0,.5],230:[0,.43056,0,0,.72222],247:[.08333,.58333,0,0,.77778],248:[.09722,.52778,0,0,.5],305:[0,.43056,0,0,.27778],338:[0,.68333,0,0,1.01389],339:[0,.43056,0,0,.77778],567:[.19444,.43056,0,0,.30556],710:[0,.69444,0,0,.5],711:[0,.62847,0,0,.5],713:[0,.56778,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.66786,0,0,.27778],730:[0,.69444,0,0,.75],732:[0,.66786,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.68333,0,0,.625],916:[0,.68333,0,0,.83334],920:[0,.68333,0,0,.77778],923:[0,.68333,0,0,.69445],926:[0,.68333,0,0,.66667],928:[0,.68333,0,0,.75],931:[0,.68333,0,0,.72222],933:[0,.68333,0,0,.77778],934:[0,.68333,0,0,.72222],936:[0,.68333,0,0,.77778],937:[0,.68333,0,0,.72222],8211:[0,.43056,.02778,0,.5],8212:[0,.43056,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5],8224:[.19444,.69444,0,0,.44445],8225:[.19444,.69444,0,0,.44445],8230:[0,.123,0,0,1.172],8242:[0,.55556,0,0,.275],8407:[0,.71444,.15382,0,.5],8463:[0,.68889,0,0,.54028],8465:[0,.69444,0,0,.72222],8467:[0,.69444,0,.11111,.41667],8472:[.19444,.43056,0,.11111,.63646],8476:[0,.69444,0,0,.72222],8501:[0,.69444,0,0,.61111],8592:[-.13313,.36687,0,0,1],8593:[.19444,.69444,0,0,.5],8594:[-.13313,.36687,0,0,1],8595:[.19444,.69444,0,0,.5],8596:[-.13313,.36687,0,0,1],8597:[.25,.75,0,0,.5],8598:[.19444,.69444,0,0,1],8599:[.19444,.69444,0,0,1],8600:[.19444,.69444,0,0,1],8601:[.19444,.69444,0,0,1],8614:[.011,.511,0,0,1],8617:[.011,.511,0,0,1.126],8618:[.011,.511,0,0,1.126],8636:[-.13313,.36687,0,0,1],8637:[-.13313,.36687,0,0,1],8640:[-.13313,.36687,0,0,1],8641:[-.13313,.36687,0,0,1],8652:[.011,.671,0,0,1],8656:[-.13313,.36687,0,0,1],8657:[.19444,.69444,0,0,.61111],8658:[-.13313,.36687,0,0,1],8659:[.19444,.69444,0,0,.61111],8660:[-.13313,.36687,0,0,1],8661:[.25,.75,0,0,.61111],8704:[0,.69444,0,0,.55556],8706:[0,.69444,.05556,.08334,.5309],8707:[0,.69444,0,0,.55556],8709:[.05556,.75,0,0,.5],8711:[0,.68333,0,0,.83334],8712:[.0391,.5391,0,0,.66667],8715:[.0391,.5391,0,0,.66667],8722:[.08333,.58333,0,0,.77778],8723:[.08333,.58333,0,0,.77778],8725:[.25,.75,0,0,.5],8726:[.25,.75,0,0,.5],8727:[-.03472,.46528,0,0,.5],8728:[-.05555,.44445,0,0,.5],8729:[-.05555,.44445,0,0,.5],8730:[.2,.8,0,0,.83334],8733:[0,.43056,0,0,.77778],8734:[0,.43056,0,0,1],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.27778],8741:[.25,.75,0,0,.5],8743:[0,.55556,0,0,.66667],8744:[0,.55556,0,0,.66667],8745:[0,.55556,0,0,.66667],8746:[0,.55556,0,0,.66667],8747:[.19444,.69444,.11111,0,.41667],8764:[-.13313,.36687,0,0,.77778],8768:[.19444,.69444,0,0,.27778],8771:[-.03625,.46375,0,0,.77778],8773:[-.022,.589,0,0,.778],8776:[-.01688,.48312,0,0,.77778],8781:[-.03625,.46375,0,0,.77778],8784:[-.133,.673,0,0,.778],8801:[-.03625,.46375,0,0,.77778],8804:[.13597,.63597,0,0,.77778],8805:[.13597,.63597,0,0,.77778],8810:[.0391,.5391,0,0,1],8811:[.0391,.5391,0,0,1],8826:[.0391,.5391,0,0,.77778],8827:[.0391,.5391,0,0,.77778],8834:[.0391,.5391,0,0,.77778],8835:[.0391,.5391,0,0,.77778],8838:[.13597,.63597,0,0,.77778],8839:[.13597,.63597,0,0,.77778],8846:[0,.55556,0,0,.66667],8849:[.13597,.63597,0,0,.77778],8850:[.13597,.63597,0,0,.77778],8851:[0,.55556,0,0,.66667],8852:[0,.55556,0,0,.66667],8853:[.08333,.58333,0,0,.77778],8854:[.08333,.58333,0,0,.77778],8855:[.08333,.58333,0,0,.77778],8856:[.08333,.58333,0,0,.77778],8857:[.08333,.58333,0,0,.77778],8866:[0,.69444,0,0,.61111],8867:[0,.69444,0,0,.61111],8868:[0,.69444,0,0,.77778],8869:[0,.69444,0,0,.77778],8872:[.249,.75,0,0,.867],8900:[-.05555,.44445,0,0,.5],8901:[-.05555,.44445,0,0,.27778],8902:[-.03472,.46528,0,0,.5],8904:[.005,.505,0,0,.9],8942:[.03,.903,0,0,.278],8943:[-.19,.313,0,0,1.172],8945:[-.1,.823,0,0,1.282],8968:[.25,.75,0,0,.44445],8969:[.25,.75,0,0,.44445],8970:[.25,.75,0,0,.44445],8971:[.25,.75,0,0,.44445],8994:[-.14236,.35764,0,0,1],8995:[-.14236,.35764,0,0,1],9136:[.244,.744,0,0,.412],9137:[.244,.745,0,0,.412],9651:[.19444,.69444,0,0,.88889],9657:[-.03472,.46528,0,0,.5],9661:[.19444,.69444,0,0,.88889],9667:[-.03472,.46528,0,0,.5],9711:[.19444,.69444,0,0,1],9824:[.12963,.69444,0,0,.77778],9825:[.12963,.69444,0,0,.77778],9826:[.12963,.69444,0,0,.77778],9827:[.12963,.69444,0,0,.77778],9837:[0,.75,0,0,.38889],9838:[.19444,.69444,0,0,.38889],9839:[.19444,.69444,0,0,.38889],10216:[.25,.75,0,0,.38889],10217:[.25,.75,0,0,.38889],10222:[.244,.744,0,0,.412],10223:[.244,.745,0,0,.412],10229:[.011,.511,0,0,1.609],10230:[.011,.511,0,0,1.638],10231:[.011,.511,0,0,1.859],10232:[.024,.525,0,0,1.609],10233:[.024,.525,0,0,1.638],10234:[.024,.525,0,0,1.858],10236:[.011,.511,0,0,1.638],10815:[0,.68333,0,0,.75],10927:[.13597,.63597,0,0,.77778],10928:[.13597,.63597,0,0,.77778],57376:[.19444,.69444,0,0,0]},"Math-BoldItalic":{32:[0,0,0,0,.25],48:[0,.44444,0,0,.575],49:[0,.44444,0,0,.575],50:[0,.44444,0,0,.575],51:[.19444,.44444,0,0,.575],52:[.19444,.44444,0,0,.575],53:[.19444,.44444,0,0,.575],54:[0,.64444,0,0,.575],55:[.19444,.44444,0,0,.575],56:[0,.64444,0,0,.575],57:[.19444,.44444,0,0,.575],65:[0,.68611,0,0,.86944],66:[0,.68611,.04835,0,.8664],67:[0,.68611,.06979,0,.81694],68:[0,.68611,.03194,0,.93812],69:[0,.68611,.05451,0,.81007],70:[0,.68611,.15972,0,.68889],71:[0,.68611,0,0,.88673],72:[0,.68611,.08229,0,.98229],73:[0,.68611,.07778,0,.51111],74:[0,.68611,.10069,0,.63125],75:[0,.68611,.06979,0,.97118],76:[0,.68611,0,0,.75555],77:[0,.68611,.11424,0,1.14201],78:[0,.68611,.11424,0,.95034],79:[0,.68611,.03194,0,.83666],80:[0,.68611,.15972,0,.72309],81:[.19444,.68611,0,0,.86861],82:[0,.68611,.00421,0,.87235],83:[0,.68611,.05382,0,.69271],84:[0,.68611,.15972,0,.63663],85:[0,.68611,.11424,0,.80027],86:[0,.68611,.25555,0,.67778],87:[0,.68611,.15972,0,1.09305],88:[0,.68611,.07778,0,.94722],89:[0,.68611,.25555,0,.67458],90:[0,.68611,.06979,0,.77257],97:[0,.44444,0,0,.63287],98:[0,.69444,0,0,.52083],99:[0,.44444,0,0,.51342],100:[0,.69444,0,0,.60972],101:[0,.44444,0,0,.55361],102:[.19444,.69444,.11042,0,.56806],103:[.19444,.44444,.03704,0,.5449],104:[0,.69444,0,0,.66759],105:[0,.69326,0,0,.4048],106:[.19444,.69326,.0622,0,.47083],107:[0,.69444,.01852,0,.6037],108:[0,.69444,.0088,0,.34815],109:[0,.44444,0,0,1.0324],110:[0,.44444,0,0,.71296],111:[0,.44444,0,0,.58472],112:[.19444,.44444,0,0,.60092],113:[.19444,.44444,.03704,0,.54213],114:[0,.44444,.03194,0,.5287],115:[0,.44444,0,0,.53125],116:[0,.63492,0,0,.41528],117:[0,.44444,0,0,.68102],118:[0,.44444,.03704,0,.56666],119:[0,.44444,.02778,0,.83148],120:[0,.44444,0,0,.65903],121:[.19444,.44444,.03704,0,.59028],122:[0,.44444,.04213,0,.55509],160:[0,0,0,0,.25],915:[0,.68611,.15972,0,.65694],916:[0,.68611,0,0,.95833],920:[0,.68611,.03194,0,.86722],923:[0,.68611,0,0,.80555],926:[0,.68611,.07458,0,.84125],928:[0,.68611,.08229,0,.98229],931:[0,.68611,.05451,0,.88507],933:[0,.68611,.15972,0,.67083],934:[0,.68611,0,0,.76666],936:[0,.68611,.11653,0,.71402],937:[0,.68611,.04835,0,.8789],945:[0,.44444,0,0,.76064],946:[.19444,.69444,.03403,0,.65972],947:[.19444,.44444,.06389,0,.59003],948:[0,.69444,.03819,0,.52222],949:[0,.44444,0,0,.52882],950:[.19444,.69444,.06215,0,.50833],951:[.19444,.44444,.03704,0,.6],952:[0,.69444,.03194,0,.5618],953:[0,.44444,0,0,.41204],954:[0,.44444,0,0,.66759],955:[0,.69444,0,0,.67083],956:[.19444,.44444,0,0,.70787],957:[0,.44444,.06898,0,.57685],958:[.19444,.69444,.03021,0,.50833],959:[0,.44444,0,0,.58472],960:[0,.44444,.03704,0,.68241],961:[.19444,.44444,0,0,.6118],962:[.09722,.44444,.07917,0,.42361],963:[0,.44444,.03704,0,.68588],964:[0,.44444,.13472,0,.52083],965:[0,.44444,.03704,0,.63055],966:[.19444,.44444,0,0,.74722],967:[.19444,.44444,0,0,.71805],968:[.19444,.69444,.03704,0,.75833],969:[0,.44444,.03704,0,.71782],977:[0,.69444,0,0,.69155],981:[.19444,.69444,0,0,.7125],982:[0,.44444,.03194,0,.975],1009:[.19444,.44444,0,0,.6118],1013:[0,.44444,0,0,.48333],57649:[0,.44444,0,0,.39352],57911:[.19444,.44444,0,0,.43889]},"Math-Italic":{32:[0,0,0,0,.25],48:[0,.43056,0,0,.5],49:[0,.43056,0,0,.5],50:[0,.43056,0,0,.5],51:[.19444,.43056,0,0,.5],52:[.19444,.43056,0,0,.5],53:[.19444,.43056,0,0,.5],54:[0,.64444,0,0,.5],55:[.19444,.43056,0,0,.5],56:[0,.64444,0,0,.5],57:[.19444,.43056,0,0,.5],65:[0,.68333,0,.13889,.75],66:[0,.68333,.05017,.08334,.75851],67:[0,.68333,.07153,.08334,.71472],68:[0,.68333,.02778,.05556,.82792],69:[0,.68333,.05764,.08334,.7382],70:[0,.68333,.13889,.08334,.64306],71:[0,.68333,0,.08334,.78625],72:[0,.68333,.08125,.05556,.83125],73:[0,.68333,.07847,.11111,.43958],74:[0,.68333,.09618,.16667,.55451],75:[0,.68333,.07153,.05556,.84931],76:[0,.68333,0,.02778,.68056],77:[0,.68333,.10903,.08334,.97014],78:[0,.68333,.10903,.08334,.80347],79:[0,.68333,.02778,.08334,.76278],80:[0,.68333,.13889,.08334,.64201],81:[.19444,.68333,0,.08334,.79056],82:[0,.68333,.00773,.08334,.75929],83:[0,.68333,.05764,.08334,.6132],84:[0,.68333,.13889,.08334,.58438],85:[0,.68333,.10903,.02778,.68278],86:[0,.68333,.22222,0,.58333],87:[0,.68333,.13889,0,.94445],88:[0,.68333,.07847,.08334,.82847],89:[0,.68333,.22222,0,.58056],90:[0,.68333,.07153,.08334,.68264],97:[0,.43056,0,0,.52859],98:[0,.69444,0,0,.42917],99:[0,.43056,0,.05556,.43276],100:[0,.69444,0,.16667,.52049],101:[0,.43056,0,.05556,.46563],102:[.19444,.69444,.10764,.16667,.48959],103:[.19444,.43056,.03588,.02778,.47697],104:[0,.69444,0,0,.57616],105:[0,.65952,0,0,.34451],106:[.19444,.65952,.05724,0,.41181],107:[0,.69444,.03148,0,.5206],108:[0,.69444,.01968,.08334,.29838],109:[0,.43056,0,0,.87801],110:[0,.43056,0,0,.60023],111:[0,.43056,0,.05556,.48472],112:[.19444,.43056,0,.08334,.50313],113:[.19444,.43056,.03588,.08334,.44641],114:[0,.43056,.02778,.05556,.45116],115:[0,.43056,0,.05556,.46875],116:[0,.61508,0,.08334,.36111],117:[0,.43056,0,.02778,.57246],118:[0,.43056,.03588,.02778,.48472],119:[0,.43056,.02691,.08334,.71592],120:[0,.43056,0,.02778,.57153],121:[.19444,.43056,.03588,.05556,.49028],122:[0,.43056,.04398,.05556,.46505],160:[0,0,0,0,.25],915:[0,.68333,.13889,.08334,.61528],916:[0,.68333,0,.16667,.83334],920:[0,.68333,.02778,.08334,.76278],923:[0,.68333,0,.16667,.69445],926:[0,.68333,.07569,.08334,.74236],928:[0,.68333,.08125,.05556,.83125],931:[0,.68333,.05764,.08334,.77986],933:[0,.68333,.13889,.05556,.58333],934:[0,.68333,0,.08334,.66667],936:[0,.68333,.11,.05556,.61222],937:[0,.68333,.05017,.08334,.7724],945:[0,.43056,.0037,.02778,.6397],946:[.19444,.69444,.05278,.08334,.56563],947:[.19444,.43056,.05556,0,.51773],948:[0,.69444,.03785,.05556,.44444],949:[0,.43056,0,.08334,.46632],950:[.19444,.69444,.07378,.08334,.4375],951:[.19444,.43056,.03588,.05556,.49653],952:[0,.69444,.02778,.08334,.46944],953:[0,.43056,0,.05556,.35394],954:[0,.43056,0,0,.57616],955:[0,.69444,0,0,.58334],956:[.19444,.43056,0,.02778,.60255],957:[0,.43056,.06366,.02778,.49398],958:[.19444,.69444,.04601,.11111,.4375],959:[0,.43056,0,.05556,.48472],960:[0,.43056,.03588,0,.57003],961:[.19444,.43056,0,.08334,.51702],962:[.09722,.43056,.07986,.08334,.36285],963:[0,.43056,.03588,0,.57141],964:[0,.43056,.1132,.02778,.43715],965:[0,.43056,.03588,.02778,.54028],966:[.19444,.43056,0,.08334,.65417],967:[.19444,.43056,0,.05556,.62569],968:[.19444,.69444,.03588,.11111,.65139],969:[0,.43056,.03588,0,.62245],977:[0,.69444,0,.08334,.59144],981:[.19444,.69444,0,.08334,.59583],982:[0,.43056,.02778,0,.82813],1009:[.19444,.43056,0,.08334,.51702],1013:[0,.43056,0,.05556,.4059],57649:[0,.43056,0,.02778,.32246],57911:[.19444,.43056,0,.08334,.38403]},"SansSerif-Bold":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.36667],34:[0,.69444,0,0,.55834],35:[.19444,.69444,0,0,.91667],36:[.05556,.75,0,0,.55],37:[.05556,.75,0,0,1.02912],38:[0,.69444,0,0,.83056],39:[0,.69444,0,0,.30556],40:[.25,.75,0,0,.42778],41:[.25,.75,0,0,.42778],42:[0,.75,0,0,.55],43:[.11667,.61667,0,0,.85556],44:[.10556,.13056,0,0,.30556],45:[0,.45833,0,0,.36667],46:[0,.13056,0,0,.30556],47:[.25,.75,0,0,.55],48:[0,.69444,0,0,.55],49:[0,.69444,0,0,.55],50:[0,.69444,0,0,.55],51:[0,.69444,0,0,.55],52:[0,.69444,0,0,.55],53:[0,.69444,0,0,.55],54:[0,.69444,0,0,.55],55:[0,.69444,0,0,.55],56:[0,.69444,0,0,.55],57:[0,.69444,0,0,.55],58:[0,.45833,0,0,.30556],59:[.10556,.45833,0,0,.30556],61:[-.09375,.40625,0,0,.85556],63:[0,.69444,0,0,.51945],64:[0,.69444,0,0,.73334],65:[0,.69444,0,0,.73334],66:[0,.69444,0,0,.73334],67:[0,.69444,0,0,.70278],68:[0,.69444,0,0,.79445],69:[0,.69444,0,0,.64167],70:[0,.69444,0,0,.61111],71:[0,.69444,0,0,.73334],72:[0,.69444,0,0,.79445],73:[0,.69444,0,0,.33056],74:[0,.69444,0,0,.51945],75:[0,.69444,0,0,.76389],76:[0,.69444,0,0,.58056],77:[0,.69444,0,0,.97778],78:[0,.69444,0,0,.79445],79:[0,.69444,0,0,.79445],80:[0,.69444,0,0,.70278],81:[.10556,.69444,0,0,.79445],82:[0,.69444,0,0,.70278],83:[0,.69444,0,0,.61111],84:[0,.69444,0,0,.73334],85:[0,.69444,0,0,.76389],86:[0,.69444,.01528,0,.73334],87:[0,.69444,.01528,0,1.03889],88:[0,.69444,0,0,.73334],89:[0,.69444,.0275,0,.73334],90:[0,.69444,0,0,.67223],91:[.25,.75,0,0,.34306],93:[.25,.75,0,0,.34306],94:[0,.69444,0,0,.55],95:[.35,.10833,.03056,0,.55],97:[0,.45833,0,0,.525],98:[0,.69444,0,0,.56111],99:[0,.45833,0,0,.48889],100:[0,.69444,0,0,.56111],101:[0,.45833,0,0,.51111],102:[0,.69444,.07639,0,.33611],103:[.19444,.45833,.01528,0,.55],104:[0,.69444,0,0,.56111],105:[0,.69444,0,0,.25556],106:[.19444,.69444,0,0,.28611],107:[0,.69444,0,0,.53056],108:[0,.69444,0,0,.25556],109:[0,.45833,0,0,.86667],110:[0,.45833,0,0,.56111],111:[0,.45833,0,0,.55],112:[.19444,.45833,0,0,.56111],113:[.19444,.45833,0,0,.56111],114:[0,.45833,.01528,0,.37222],115:[0,.45833,0,0,.42167],116:[0,.58929,0,0,.40417],117:[0,.45833,0,0,.56111],118:[0,.45833,.01528,0,.5],119:[0,.45833,.01528,0,.74445],120:[0,.45833,0,0,.5],121:[.19444,.45833,.01528,0,.5],122:[0,.45833,0,0,.47639],126:[.35,.34444,0,0,.55],160:[0,0,0,0,.25],168:[0,.69444,0,0,.55],176:[0,.69444,0,0,.73334],180:[0,.69444,0,0,.55],184:[.17014,0,0,0,.48889],305:[0,.45833,0,0,.25556],567:[.19444,.45833,0,0,.28611],710:[0,.69444,0,0,.55],711:[0,.63542,0,0,.55],713:[0,.63778,0,0,.55],728:[0,.69444,0,0,.55],729:[0,.69444,0,0,.30556],730:[0,.69444,0,0,.73334],732:[0,.69444,0,0,.55],733:[0,.69444,0,0,.55],915:[0,.69444,0,0,.58056],916:[0,.69444,0,0,.91667],920:[0,.69444,0,0,.85556],923:[0,.69444,0,0,.67223],926:[0,.69444,0,0,.73334],928:[0,.69444,0,0,.79445],931:[0,.69444,0,0,.79445],933:[0,.69444,0,0,.85556],934:[0,.69444,0,0,.79445],936:[0,.69444,0,0,.85556],937:[0,.69444,0,0,.79445],8211:[0,.45833,.03056,0,.55],8212:[0,.45833,.03056,0,1.10001],8216:[0,.69444,0,0,.30556],8217:[0,.69444,0,0,.30556],8220:[0,.69444,0,0,.55834],8221:[0,.69444,0,0,.55834]},"SansSerif-Italic":{32:[0,0,0,0,.25],33:[0,.69444,.05733,0,.31945],34:[0,.69444,.00316,0,.5],35:[.19444,.69444,.05087,0,.83334],36:[.05556,.75,.11156,0,.5],37:[.05556,.75,.03126,0,.83334],38:[0,.69444,.03058,0,.75834],39:[0,.69444,.07816,0,.27778],40:[.25,.75,.13164,0,.38889],41:[.25,.75,.02536,0,.38889],42:[0,.75,.11775,0,.5],43:[.08333,.58333,.02536,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,.01946,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,.13164,0,.5],48:[0,.65556,.11156,0,.5],49:[0,.65556,.11156,0,.5],50:[0,.65556,.11156,0,.5],51:[0,.65556,.11156,0,.5],52:[0,.65556,.11156,0,.5],53:[0,.65556,.11156,0,.5],54:[0,.65556,.11156,0,.5],55:[0,.65556,.11156,0,.5],56:[0,.65556,.11156,0,.5],57:[0,.65556,.11156,0,.5],58:[0,.44444,.02502,0,.27778],59:[.125,.44444,.02502,0,.27778],61:[-.13,.37,.05087,0,.77778],63:[0,.69444,.11809,0,.47222],64:[0,.69444,.07555,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,.08293,0,.66667],67:[0,.69444,.11983,0,.63889],68:[0,.69444,.07555,0,.72223],69:[0,.69444,.11983,0,.59722],70:[0,.69444,.13372,0,.56945],71:[0,.69444,.11983,0,.66667],72:[0,.69444,.08094,0,.70834],73:[0,.69444,.13372,0,.27778],74:[0,.69444,.08094,0,.47222],75:[0,.69444,.11983,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,.08094,0,.875],78:[0,.69444,.08094,0,.70834],79:[0,.69444,.07555,0,.73611],80:[0,.69444,.08293,0,.63889],81:[.125,.69444,.07555,0,.73611],82:[0,.69444,.08293,0,.64584],83:[0,.69444,.09205,0,.55556],84:[0,.69444,.13372,0,.68056],85:[0,.69444,.08094,0,.6875],86:[0,.69444,.1615,0,.66667],87:[0,.69444,.1615,0,.94445],88:[0,.69444,.13372,0,.66667],89:[0,.69444,.17261,0,.66667],90:[0,.69444,.11983,0,.61111],91:[.25,.75,.15942,0,.28889],93:[.25,.75,.08719,0,.28889],94:[0,.69444,.0799,0,.5],95:[.35,.09444,.08616,0,.5],97:[0,.44444,.00981,0,.48056],98:[0,.69444,.03057,0,.51667],99:[0,.44444,.08336,0,.44445],100:[0,.69444,.09483,0,.51667],101:[0,.44444,.06778,0,.44445],102:[0,.69444,.21705,0,.30556],103:[.19444,.44444,.10836,0,.5],104:[0,.69444,.01778,0,.51667],105:[0,.67937,.09718,0,.23889],106:[.19444,.67937,.09162,0,.26667],107:[0,.69444,.08336,0,.48889],108:[0,.69444,.09483,0,.23889],109:[0,.44444,.01778,0,.79445],110:[0,.44444,.01778,0,.51667],111:[0,.44444,.06613,0,.5],112:[.19444,.44444,.0389,0,.51667],113:[.19444,.44444,.04169,0,.51667],114:[0,.44444,.10836,0,.34167],115:[0,.44444,.0778,0,.38333],116:[0,.57143,.07225,0,.36111],117:[0,.44444,.04169,0,.51667],118:[0,.44444,.10836,0,.46111],119:[0,.44444,.10836,0,.68334],120:[0,.44444,.09169,0,.46111],121:[.19444,.44444,.10836,0,.46111],122:[0,.44444,.08752,0,.43472],126:[.35,.32659,.08826,0,.5],160:[0,0,0,0,.25],168:[0,.67937,.06385,0,.5],176:[0,.69444,0,0,.73752],184:[.17014,0,0,0,.44445],305:[0,.44444,.04169,0,.23889],567:[.19444,.44444,.04169,0,.26667],710:[0,.69444,.0799,0,.5],711:[0,.63194,.08432,0,.5],713:[0,.60889,.08776,0,.5],714:[0,.69444,.09205,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,.09483,0,.5],729:[0,.67937,.07774,0,.27778],730:[0,.69444,0,0,.73752],732:[0,.67659,.08826,0,.5],733:[0,.69444,.09205,0,.5],915:[0,.69444,.13372,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,.07555,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,.12816,0,.66667],928:[0,.69444,.08094,0,.70834],931:[0,.69444,.11983,0,.72222],933:[0,.69444,.09031,0,.77778],934:[0,.69444,.04603,0,.72222],936:[0,.69444,.09031,0,.77778],937:[0,.69444,.08293,0,.72222],8211:[0,.44444,.08616,0,.5],8212:[0,.44444,.08616,0,1],8216:[0,.69444,.07816,0,.27778],8217:[0,.69444,.07816,0,.27778],8220:[0,.69444,.14205,0,.5],8221:[0,.69444,.00316,0,.5]},"SansSerif-Regular":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.31945],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.75834],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,0,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.65556,0,0,.5],49:[0,.65556,0,0,.5],50:[0,.65556,0,0,.5],51:[0,.65556,0,0,.5],52:[0,.65556,0,0,.5],53:[0,.65556,0,0,.5],54:[0,.65556,0,0,.5],55:[0,.65556,0,0,.5],56:[0,.65556,0,0,.5],57:[0,.65556,0,0,.5],58:[0,.44444,0,0,.27778],59:[.125,.44444,0,0,.27778],61:[-.13,.37,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,0,0,.66667],67:[0,.69444,0,0,.63889],68:[0,.69444,0,0,.72223],69:[0,.69444,0,0,.59722],70:[0,.69444,0,0,.56945],71:[0,.69444,0,0,.66667],72:[0,.69444,0,0,.70834],73:[0,.69444,0,0,.27778],74:[0,.69444,0,0,.47222],75:[0,.69444,0,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,0,0,.875],78:[0,.69444,0,0,.70834],79:[0,.69444,0,0,.73611],80:[0,.69444,0,0,.63889],81:[.125,.69444,0,0,.73611],82:[0,.69444,0,0,.64584],83:[0,.69444,0,0,.55556],84:[0,.69444,0,0,.68056],85:[0,.69444,0,0,.6875],86:[0,.69444,.01389,0,.66667],87:[0,.69444,.01389,0,.94445],88:[0,.69444,0,0,.66667],89:[0,.69444,.025,0,.66667],90:[0,.69444,0,0,.61111],91:[.25,.75,0,0,.28889],93:[.25,.75,0,0,.28889],94:[0,.69444,0,0,.5],95:[.35,.09444,.02778,0,.5],97:[0,.44444,0,0,.48056],98:[0,.69444,0,0,.51667],99:[0,.44444,0,0,.44445],100:[0,.69444,0,0,.51667],101:[0,.44444,0,0,.44445],102:[0,.69444,.06944,0,.30556],103:[.19444,.44444,.01389,0,.5],104:[0,.69444,0,0,.51667],105:[0,.67937,0,0,.23889],106:[.19444,.67937,0,0,.26667],107:[0,.69444,0,0,.48889],108:[0,.69444,0,0,.23889],109:[0,.44444,0,0,.79445],110:[0,.44444,0,0,.51667],111:[0,.44444,0,0,.5],112:[.19444,.44444,0,0,.51667],113:[.19444,.44444,0,0,.51667],114:[0,.44444,.01389,0,.34167],115:[0,.44444,0,0,.38333],116:[0,.57143,0,0,.36111],117:[0,.44444,0,0,.51667],118:[0,.44444,.01389,0,.46111],119:[0,.44444,.01389,0,.68334],120:[0,.44444,0,0,.46111],121:[.19444,.44444,.01389,0,.46111],122:[0,.44444,0,0,.43472],126:[.35,.32659,0,0,.5],160:[0,0,0,0,.25],168:[0,.67937,0,0,.5],176:[0,.69444,0,0,.66667],184:[.17014,0,0,0,.44445],305:[0,.44444,0,0,.23889],567:[.19444,.44444,0,0,.26667],710:[0,.69444,0,0,.5],711:[0,.63194,0,0,.5],713:[0,.60889,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.67937,0,0,.27778],730:[0,.69444,0,0,.66667],732:[0,.67659,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.69444,0,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,0,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,0,0,.66667],928:[0,.69444,0,0,.70834],931:[0,.69444,0,0,.72222],933:[0,.69444,0,0,.77778],934:[0,.69444,0,0,.72222],936:[0,.69444,0,0,.77778],937:[0,.69444,0,0,.72222],8211:[0,.44444,.02778,0,.5],8212:[0,.44444,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5]},"Script-Regular":{32:[0,0,0,0,.25],65:[0,.7,.22925,0,.80253],66:[0,.7,.04087,0,.90757],67:[0,.7,.1689,0,.66619],68:[0,.7,.09371,0,.77443],69:[0,.7,.18583,0,.56162],70:[0,.7,.13634,0,.89544],71:[0,.7,.17322,0,.60961],72:[0,.7,.29694,0,.96919],73:[0,.7,.19189,0,.80907],74:[.27778,.7,.19189,0,1.05159],75:[0,.7,.31259,0,.91364],76:[0,.7,.19189,0,.87373],77:[0,.7,.15981,0,1.08031],78:[0,.7,.3525,0,.9015],79:[0,.7,.08078,0,.73787],80:[0,.7,.08078,0,1.01262],81:[0,.7,.03305,0,.88282],82:[0,.7,.06259,0,.85],83:[0,.7,.19189,0,.86767],84:[0,.7,.29087,0,.74697],85:[0,.7,.25815,0,.79996],86:[0,.7,.27523,0,.62204],87:[0,.7,.27523,0,.80532],88:[0,.7,.26006,0,.94445],89:[0,.7,.2939,0,.70961],90:[0,.7,.24037,0,.8212],160:[0,0,0,0,.25]},"Size1-Regular":{32:[0,0,0,0,.25],40:[.35001,.85,0,0,.45834],41:[.35001,.85,0,0,.45834],47:[.35001,.85,0,0,.57778],91:[.35001,.85,0,0,.41667],92:[.35001,.85,0,0,.57778],93:[.35001,.85,0,0,.41667],123:[.35001,.85,0,0,.58334],125:[.35001,.85,0,0,.58334],160:[0,0,0,0,.25],710:[0,.72222,0,0,.55556],732:[0,.72222,0,0,.55556],770:[0,.72222,0,0,.55556],771:[0,.72222,0,0,.55556],8214:[-99e-5,.601,0,0,.77778],8593:[1e-5,.6,0,0,.66667],8595:[1e-5,.6,0,0,.66667],8657:[1e-5,.6,0,0,.77778],8659:[1e-5,.6,0,0,.77778],8719:[.25001,.75,0,0,.94445],8720:[.25001,.75,0,0,.94445],8721:[.25001,.75,0,0,1.05556],8730:[.35001,.85,0,0,1],8739:[-.00599,.606,0,0,.33333],8741:[-.00599,.606,0,0,.55556],8747:[.30612,.805,.19445,0,.47222],8748:[.306,.805,.19445,0,.47222],8749:[.306,.805,.19445,0,.47222],8750:[.30612,.805,.19445,0,.47222],8896:[.25001,.75,0,0,.83334],8897:[.25001,.75,0,0,.83334],8898:[.25001,.75,0,0,.83334],8899:[.25001,.75,0,0,.83334],8968:[.35001,.85,0,0,.47222],8969:[.35001,.85,0,0,.47222],8970:[.35001,.85,0,0,.47222],8971:[.35001,.85,0,0,.47222],9168:[-99e-5,.601,0,0,.66667],10216:[.35001,.85,0,0,.47222],10217:[.35001,.85,0,0,.47222],10752:[.25001,.75,0,0,1.11111],10753:[.25001,.75,0,0,1.11111],10754:[.25001,.75,0,0,1.11111],10756:[.25001,.75,0,0,.83334],10758:[.25001,.75,0,0,.83334]},"Size2-Regular":{32:[0,0,0,0,.25],40:[.65002,1.15,0,0,.59722],41:[.65002,1.15,0,0,.59722],47:[.65002,1.15,0,0,.81111],91:[.65002,1.15,0,0,.47222],92:[.65002,1.15,0,0,.81111],93:[.65002,1.15,0,0,.47222],123:[.65002,1.15,0,0,.66667],125:[.65002,1.15,0,0,.66667],160:[0,0,0,0,.25],710:[0,.75,0,0,1],732:[0,.75,0,0,1],770:[0,.75,0,0,1],771:[0,.75,0,0,1],8719:[.55001,1.05,0,0,1.27778],8720:[.55001,1.05,0,0,1.27778],8721:[.55001,1.05,0,0,1.44445],8730:[.65002,1.15,0,0,1],8747:[.86225,1.36,.44445,0,.55556],8748:[.862,1.36,.44445,0,.55556],8749:[.862,1.36,.44445,0,.55556],8750:[.86225,1.36,.44445,0,.55556],8896:[.55001,1.05,0,0,1.11111],8897:[.55001,1.05,0,0,1.11111],8898:[.55001,1.05,0,0,1.11111],8899:[.55001,1.05,0,0,1.11111],8968:[.65002,1.15,0,0,.52778],8969:[.65002,1.15,0,0,.52778],8970:[.65002,1.15,0,0,.52778],8971:[.65002,1.15,0,0,.52778],10216:[.65002,1.15,0,0,.61111],10217:[.65002,1.15,0,0,.61111],10752:[.55001,1.05,0,0,1.51112],10753:[.55001,1.05,0,0,1.51112],10754:[.55001,1.05,0,0,1.51112],10756:[.55001,1.05,0,0,1.11111],10758:[.55001,1.05,0,0,1.11111]},"Size3-Regular":{32:[0,0,0,0,.25],40:[.95003,1.45,0,0,.73611],41:[.95003,1.45,0,0,.73611],47:[.95003,1.45,0,0,1.04445],91:[.95003,1.45,0,0,.52778],92:[.95003,1.45,0,0,1.04445],93:[.95003,1.45,0,0,.52778],123:[.95003,1.45,0,0,.75],125:[.95003,1.45,0,0,.75],160:[0,0,0,0,.25],710:[0,.75,0,0,1.44445],732:[0,.75,0,0,1.44445],770:[0,.75,0,0,1.44445],771:[0,.75,0,0,1.44445],8730:[.95003,1.45,0,0,1],8968:[.95003,1.45,0,0,.58334],8969:[.95003,1.45,0,0,.58334],8970:[.95003,1.45,0,0,.58334],8971:[.95003,1.45,0,0,.58334],10216:[.95003,1.45,0,0,.75],10217:[.95003,1.45,0,0,.75]},"Size4-Regular":{32:[0,0,0,0,.25],40:[1.25003,1.75,0,0,.79167],41:[1.25003,1.75,0,0,.79167],47:[1.25003,1.75,0,0,1.27778],91:[1.25003,1.75,0,0,.58334],92:[1.25003,1.75,0,0,1.27778],93:[1.25003,1.75,0,0,.58334],123:[1.25003,1.75,0,0,.80556],125:[1.25003,1.75,0,0,.80556],160:[0,0,0,0,.25],710:[0,.825,0,0,1.8889],732:[0,.825,0,0,1.8889],770:[0,.825,0,0,1.8889],771:[0,.825,0,0,1.8889],8730:[1.25003,1.75,0,0,1],8968:[1.25003,1.75,0,0,.63889],8969:[1.25003,1.75,0,0,.63889],8970:[1.25003,1.75,0,0,.63889],8971:[1.25003,1.75,0,0,.63889],9115:[.64502,1.155,0,0,.875],9116:[1e-5,.6,0,0,.875],9117:[.64502,1.155,0,0,.875],9118:[.64502,1.155,0,0,.875],9119:[1e-5,.6,0,0,.875],9120:[.64502,1.155,0,0,.875],9121:[.64502,1.155,0,0,.66667],9122:[-99e-5,.601,0,0,.66667],9123:[.64502,1.155,0,0,.66667],9124:[.64502,1.155,0,0,.66667],9125:[-99e-5,.601,0,0,.66667],9126:[.64502,1.155,0,0,.66667],9127:[1e-5,.9,0,0,.88889],9128:[.65002,1.15,0,0,.88889],9129:[.90001,0,0,0,.88889],9130:[0,.3,0,0,.88889],9131:[1e-5,.9,0,0,.88889],9132:[.65002,1.15,0,0,.88889],9133:[.90001,0,0,0,.88889],9143:[.88502,.915,0,0,1.05556],10216:[1.25003,1.75,0,0,.80556],10217:[1.25003,1.75,0,0,.80556],57344:[-.00499,.605,0,0,1.05556],57345:[-.00499,.605,0,0,1.05556],57680:[0,.12,0,0,.45],57681:[0,.12,0,0,.45],57682:[0,.12,0,0,.45],57683:[0,.12,0,0,.45]},"Typewriter-Regular":{32:[0,0,0,0,.525],33:[0,.61111,0,0,.525],34:[0,.61111,0,0,.525],35:[0,.61111,0,0,.525],36:[.08333,.69444,0,0,.525],37:[.08333,.69444,0,0,.525],38:[0,.61111,0,0,.525],39:[0,.61111,0,0,.525],40:[.08333,.69444,0,0,.525],41:[.08333,.69444,0,0,.525],42:[0,.52083,0,0,.525],43:[-.08056,.53055,0,0,.525],44:[.13889,.125,0,0,.525],45:[-.08056,.53055,0,0,.525],46:[0,.125,0,0,.525],47:[.08333,.69444,0,0,.525],48:[0,.61111,0,0,.525],49:[0,.61111,0,0,.525],50:[0,.61111,0,0,.525],51:[0,.61111,0,0,.525],52:[0,.61111,0,0,.525],53:[0,.61111,0,0,.525],54:[0,.61111,0,0,.525],55:[0,.61111,0,0,.525],56:[0,.61111,0,0,.525],57:[0,.61111,0,0,.525],58:[0,.43056,0,0,.525],59:[.13889,.43056,0,0,.525],60:[-.05556,.55556,0,0,.525],61:[-.19549,.41562,0,0,.525],62:[-.05556,.55556,0,0,.525],63:[0,.61111,0,0,.525],64:[0,.61111,0,0,.525],65:[0,.61111,0,0,.525],66:[0,.61111,0,0,.525],67:[0,.61111,0,0,.525],68:[0,.61111,0,0,.525],69:[0,.61111,0,0,.525],70:[0,.61111,0,0,.525],71:[0,.61111,0,0,.525],72:[0,.61111,0,0,.525],73:[0,.61111,0,0,.525],74:[0,.61111,0,0,.525],75:[0,.61111,0,0,.525],76:[0,.61111,0,0,.525],77:[0,.61111,0,0,.525],78:[0,.61111,0,0,.525],79:[0,.61111,0,0,.525],80:[0,.61111,0,0,.525],81:[.13889,.61111,0,0,.525],82:[0,.61111,0,0,.525],83:[0,.61111,0,0,.525],84:[0,.61111,0,0,.525],85:[0,.61111,0,0,.525],86:[0,.61111,0,0,.525],87:[0,.61111,0,0,.525],88:[0,.61111,0,0,.525],89:[0,.61111,0,0,.525],90:[0,.61111,0,0,.525],91:[.08333,.69444,0,0,.525],92:[.08333,.69444,0,0,.525],93:[.08333,.69444,0,0,.525],94:[0,.61111,0,0,.525],95:[.09514,0,0,0,.525],96:[0,.61111,0,0,.525],97:[0,.43056,0,0,.525],98:[0,.61111,0,0,.525],99:[0,.43056,0,0,.525],100:[0,.61111,0,0,.525],101:[0,.43056,0,0,.525],102:[0,.61111,0,0,.525],103:[.22222,.43056,0,0,.525],104:[0,.61111,0,0,.525],105:[0,.61111,0,0,.525],106:[.22222,.61111,0,0,.525],107:[0,.61111,0,0,.525],108:[0,.61111,0,0,.525],109:[0,.43056,0,0,.525],110:[0,.43056,0,0,.525],111:[0,.43056,0,0,.525],112:[.22222,.43056,0,0,.525],113:[.22222,.43056,0,0,.525],114:[0,.43056,0,0,.525],115:[0,.43056,0,0,.525],116:[0,.55358,0,0,.525],117:[0,.43056,0,0,.525],118:[0,.43056,0,0,.525],119:[0,.43056,0,0,.525],120:[0,.43056,0,0,.525],121:[.22222,.43056,0,0,.525],122:[0,.43056,0,0,.525],123:[.08333,.69444,0,0,.525],124:[.08333,.69444,0,0,.525],125:[.08333,.69444,0,0,.525],126:[0,.61111,0,0,.525],127:[0,.61111,0,0,.525],160:[0,0,0,0,.525],176:[0,.61111,0,0,.525],184:[.19445,0,0,0,.525],305:[0,.43056,0,0,.525],567:[.22222,.43056,0,0,.525],711:[0,.56597,0,0,.525],713:[0,.56555,0,0,.525],714:[0,.61111,0,0,.525],715:[0,.61111,0,0,.525],728:[0,.61111,0,0,.525],730:[0,.61111,0,0,.525],770:[0,.61111,0,0,.525],771:[0,.61111,0,0,.525],776:[0,.61111,0,0,.525],915:[0,.61111,0,0,.525],916:[0,.61111,0,0,.525],920:[0,.61111,0,0,.525],923:[0,.61111,0,0,.525],926:[0,.61111,0,0,.525],928:[0,.61111,0,0,.525],931:[0,.61111,0,0,.525],933:[0,.61111,0,0,.525],934:[0,.61111,0,0,.525],936:[0,.61111,0,0,.525],937:[0,.61111,0,0,.525],8216:[0,.61111,0,0,.525],8217:[0,.61111,0,0,.525],8242:[0,.61111,0,0,.525],9251:[.11111,.21944,0,0,.525]}},Ms={slant:[.25,.25,.25],space:[0,0,0],stretch:[0,0,0],shrink:[0,0,0],xHeight:[.431,.431,.431],quad:[1,1.171,1.472],extraSpace:[0,0,0],num1:[.677,.732,.925],num2:[.394,.384,.387],num3:[.444,.471,.504],denom1:[.686,.752,1.025],denom2:[.345,.344,.532],sup1:[.413,.503,.504],sup2:[.363,.431,.404],sup3:[.289,.286,.294],sub1:[.15,.143,.2],sub2:[.247,.286,.4],supDrop:[.386,.353,.494],subDrop:[.05,.071,.1],delim1:[2.39,1.7,1.98],delim2:[1.01,1.157,1.42],axisHeight:[.25,.25,.25],defaultRuleThickness:[.04,.049,.049],bigOpSpacing1:[.111,.111,.111],bigOpSpacing2:[.166,.166,.166],bigOpSpacing3:[.2,.2,.2],bigOpSpacing4:[.6,.611,.611],bigOpSpacing5:[.1,.143,.143],sqrtRuleThickness:[.04,.04,.04],ptPerEm:[10,10,10],doubleRuleSep:[.2,.2,.2],arrayRuleWidth:[.04,.04,.04],fboxsep:[.3,.3,.3],fboxrule:[.04,.04,.04]},y1={Å:"A",Ð:"D",Þ:"o",å:"a",ð:"d",þ:"o",А:"A",Б:"B",В:"B",Г:"F",Д:"A",Е:"E",Ж:"K",З:"3",И:"N",Й:"N",К:"K",Л:"N",М:"M",Н:"H",О:"O",П:"N",Р:"P",С:"C",Т:"T",У:"y",Ф:"O",Х:"X",Ц:"U",Ч:"h",Ш:"W",Щ:"W",Ъ:"B",Ы:"X",Ь:"B",Э:"3",Ю:"X",Я:"R",а:"a",б:"b",в:"a",г:"r",д:"y",е:"e",ж:"m",з:"e",и:"n",й:"n",к:"n",л:"n",м:"m",н:"n",о:"o",п:"n",р:"p",с:"c",т:"o",у:"y",ф:"b",х:"x",ц:"n",ч:"n",ш:"w",щ:"w",ъ:"a",ы:"m",ь:"a",э:"e",ю:"m",я:"r"};function qC(e,t){Dn[e]=t}function td(e,t,n){if(!Dn[t])throw new Error("Font metrics not found for font: "+t+".");var r=e.charCodeAt(0),i=Dn[t][r];if(!i&&e[0]in y1&&(r=y1[e[0]].charCodeAt(0),i=Dn[t][r]),!i&&n==="text"&&g4(r)&&(i=Dn[t][77]),i)return{depth:i[0],height:i[1],italic:i[2],skew:i[3],width:i[4]}}var kh={};function RC(e){var t;if(e>=5?t=0:e>=3?t=1:t=2,!kh[t]){var n=kh[t]={cssEmPerMu:Ms.quad[t]/18};for(var r in Ms)Ms.hasOwnProperty(r)&&(n[r]=Ms[r][t])}return kh[t]}var NC=[[1,1,1],[2,1,1],[3,1,1],[4,2,1],[5,2,1],[6,3,1],[7,4,2],[8,6,3],[9,7,6],[10,8,7],[11,10,9]],$1=[.5,.6,.7,.8,.9,1,1.2,1.44,1.728,2.074,2.488],v1=function(t,n){return n.size<2?t:NC[t-1][n.size-1]};class Un{constructor(t){this.style=void 0,this.color=void 0,this.size=void 0,this.textSize=void 0,this.phantom=void 0,this.font=void 0,this.fontFamily=void 0,this.fontWeight=void 0,this.fontShape=void 0,this.sizeMultiplier=void 0,this.maxSize=void 0,this.minRuleThickness=void 0,this._fontMetrics=void 0,this.style=t.style,this.color=t.color,this.size=t.size||Un.BASESIZE,this.textSize=t.textSize||this.size,this.phantom=!!t.phantom,this.font=t.font||"",this.fontFamily=t.fontFamily||"",this.fontWeight=t.fontWeight||"",this.fontShape=t.fontShape||"",this.sizeMultiplier=$1[this.size-1],this.maxSize=t.maxSize,this.minRuleThickness=t.minRuleThickness,this._fontMetrics=void 0}extend(t){var n={style:this.style,size:this.size,textSize:this.textSize,color:this.color,phantom:this.phantom,font:this.font,fontFamily:this.fontFamily,fontWeight:this.fontWeight,fontShape:this.fontShape,maxSize:this.maxSize,minRuleThickness:this.minRuleThickness};for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);return new Un(n)}havingStyle(t){return this.style===t?this:this.extend({style:t,size:v1(this.textSize,t)})}havingCrampedStyle(){return this.havingStyle(this.style.cramp())}havingSize(t){return this.size===t&&this.textSize===t?this:this.extend({style:this.style.text(),size:t,textSize:t,sizeMultiplier:$1[t-1]})}havingBaseStyle(t){t=t||this.style.text();var n=v1(Un.BASESIZE,t);return this.size===n&&this.textSize===Un.BASESIZE&&this.style===t?this:this.extend({style:t,size:n})}havingBaseSizing(){var t;switch(this.style.id){case 4:case 5:t=3;break;case 6:case 7:t=1;break;default:t=6}return this.extend({style:this.style.text(),size:t})}withColor(t){return this.extend({color:t})}withPhantom(){return this.extend({phantom:!0})}withFont(t){return this.extend({font:t})}withTextFontFamily(t){return this.extend({fontFamily:t,font:""})}withTextFontWeight(t){return this.extend({fontWeight:t,font:""})}withTextFontShape(t){return this.extend({fontShape:t,font:""})}sizingClasses(t){return t.size!==this.size?["sizing","reset-size"+t.size,"size"+this.size]:[]}baseSizingClasses(){return this.size!==Un.BASESIZE?["sizing","reset-size"+this.size,"size"+Un.BASESIZE]:[]}fontMetrics(){return this._fontMetrics||(this._fontMetrics=RC(this.size)),this._fontMetrics}getColor(){return this.phantom?"transparent":this.color}}Un.BASESIZE=6;var a0={pt:1,mm:7227/2540,cm:7227/254,in:72.27,bp:803/800,pc:12,dd:1238/1157,cc:14856/1157,nd:685/642,nc:1370/107,sp:1/65536,px:803/800},IC={ex:!0,em:!0,mu:!0},b4=function(t){return typeof t!="string"&&(t=t.unit),t in a0||t in IC||t==="ex"},Be=function(t,n){var r;if(t.unit in a0)r=a0[t.unit]/n.fontMetrics().ptPerEm/n.sizeMultiplier;else if(t.unit==="mu")r=n.fontMetrics().cssEmPerMu;else{var i;if(n.style.isTight()?i=n.havingStyle(n.style.text()):i=n,t.unit==="ex")r=i.fontMetrics().xHeight;else if(t.unit==="em")r=i.fontMetrics().quad;else throw new X("Invalid unit: '"+t.unit+"'");i!==n&&(r*=i.sizeMultiplier/n.sizeMultiplier)}return Math.min(t.number*r,n.maxSize)},G=function(t){return+t.toFixed(4)+"em"},Nr=function(t){return t.filter(n=>n).join(" ")},y4=function(t,n,r){if(this.classes=t||[],this.attributes={},this.height=0,this.depth=0,this.maxFontSize=0,this.style=r||{},n){n.style.isTight()&&this.classes.push("mtight");var i=n.getColor();i&&(this.style.color=i)}},$4=function(t){var n=document.createElement(t);n.className=Nr(this.classes);for(var r in this.style)this.style.hasOwnProperty(r)&&(n.style[r]=this.style[r]);for(var i in this.attributes)this.attributes.hasOwnProperty(i)&&n.setAttribute(i,this.attributes[i]);for(var a=0;a<this.children.length;a++)n.appendChild(this.children[a].toNode());return n},v4=function(t){var n="<"+t;this.classes.length&&(n+=' class="'+te.escape(Nr(this.classes))+'"');var r="";for(var i in this.style)this.style.hasOwnProperty(i)&&(r+=te.hyphenate(i)+":"+this.style[i]+";");r&&(n+=' style="'+te.escape(r)+'"');for(var a in this.attributes)this.attributes.hasOwnProperty(a)&&(n+=" "+a+'="'+te.escape(this.attributes[a])+'"');n+=">";for(var o=0;o<this.children.length;o++)n+=this.children[o].toMarkup();return n+="</"+t+">",n};class os{constructor(t,n,r,i){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.width=void 0,this.maxFontSize=void 0,this.style=void 0,y4.call(this,t,r,i),this.children=n||[]}setAttribute(t,n){this.attributes[t]=n}hasClass(t){return te.contains(this.classes,t)}toNode(){return $4.call(this,"span")}toMarkup(){return v4.call(this,"span")}}class nd{constructor(t,n,r,i){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,y4.call(this,n,i),this.children=r||[],this.setAttribute("href",t)}setAttribute(t,n){this.attributes[t]=n}hasClass(t){return te.contains(this.classes,t)}toNode(){return $4.call(this,"a")}toMarkup(){return v4.call(this,"a")}}class BC{constructor(t,n,r){this.src=void 0,this.alt=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.alt=n,this.src=t,this.classes=["mord"],this.style=r}hasClass(t){return te.contains(this.classes,t)}toNode(){var t=document.createElement("img");t.src=this.src,t.alt=this.alt,t.className="mord";for(var n in this.style)this.style.hasOwnProperty(n)&&(t.style[n]=this.style[n]);return t}toMarkup(){var t='<img src="'+te.escape(this.src)+'"'+(' alt="'+te.escape(this.alt)+'"'),n="";for(var r in this.style)this.style.hasOwnProperty(r)&&(n+=te.hyphenate(r)+":"+this.style[r]+";");return n&&(t+=' style="'+te.escape(n)+'"'),t+="'/>",t}}var LC={î:"ı̂",ï:"ı̈",í:"ı́",ì:"ı̀"};class on{constructor(t,n,r,i,a,o,s,l){this.text=void 0,this.height=void 0,this.depth=void 0,this.italic=void 0,this.skew=void 0,this.width=void 0,this.maxFontSize=void 0,this.classes=void 0,this.style=void 0,this.text=t,this.height=n||0,this.depth=r||0,this.italic=i||0,this.skew=a||0,this.width=o||0,this.classes=s||[],this.style=l||{},this.maxFontSize=0;var u=kC(this.text.charCodeAt(0));u&&this.classes.push(u+"_fallback"),/[îïíì]/.test(this.text)&&(this.text=LC[this.text])}hasClass(t){return te.contains(this.classes,t)}toNode(){var t=document.createTextNode(this.text),n=null;this.italic>0&&(n=document.createElement("span"),n.style.marginRight=G(this.italic)),this.classes.length>0&&(n=n||document.createElement("span"),n.className=Nr(this.classes));for(var r in this.style)this.style.hasOwnProperty(r)&&(n=n||document.createElement("span"),n.style[r]=this.style[r]);return n?(n.appendChild(t),n):t}toMarkup(){var t=!1,n="<span";this.classes.length&&(t=!0,n+=' class="',n+=te.escape(Nr(this.classes)),n+='"');var r="";this.italic>0&&(r+="margin-right:"+this.italic+"em;");for(var i in this.style)this.style.hasOwnProperty(i)&&(r+=te.hyphenate(i)+":"+this.style[i]+";");r&&(t=!0,n+=' style="'+te.escape(r)+'"');var a=te.escape(this.text);return t?(n+=">",n+=a,n+="</span>",n):a}}class ar{constructor(t,n){this.children=void 0,this.attributes=void 0,this.children=t||[],this.attributes=n||{}}toNode(){var t="http://www.w3.org/2000/svg",n=document.createElementNS(t,"svg");for(var r in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,r)&&n.setAttribute(r,this.attributes[r]);for(var i=0;i<this.children.length;i++)n.appendChild(this.children[i].toNode());return n}toMarkup(){var t='<svg xmlns="http://www.w3.org/2000/svg"';for(var n in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,n)&&(t+=" "+n+'="'+te.escape(this.attributes[n])+'"');t+=">";for(var r=0;r<this.children.length;r++)t+=this.children[r].toMarkup();return t+="</svg>",t}}class Ir{constructor(t,n){this.pathName=void 0,this.alternate=void 0,this.pathName=t,this.alternate=n}toNode(){var t="http://www.w3.org/2000/svg",n=document.createElementNS(t,"path");return this.alternate?n.setAttribute("d",this.alternate):n.setAttribute("d",b1[this.pathName]),n}toMarkup(){return this.alternate?'<path d="'+te.escape(this.alternate)+'"/>':'<path d="'+te.escape(b1[this.pathName])+'"/>'}}class o0{constructor(t){this.attributes=void 0,this.attributes=t||{}}toNode(){var t="http://www.w3.org/2000/svg",n=document.createElementNS(t,"line");for(var r in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,r)&&n.setAttribute(r,this.attributes[r]);return n}toMarkup(){var t="<line";for(var n in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,n)&&(t+=" "+n+'="'+te.escape(this.attributes[n])+'"');return t+="/>",t}}function _1(e){if(e instanceof on)return e;throw new Error("Expected symbolNode but got "+String(e)+".")}function OC(e){if(e instanceof os)return e;throw new Error("Expected span<HtmlDomNode> but got "+String(e)+".")}var jC={bin:1,close:1,inner:1,open:1,punct:1,rel:1},VC={"accent-token":1,mathord:1,"op-token":1,spacing:1,textord:1},De={math:{},text:{}};function f(e,t,n,r,i,a){De[e][i]={font:t,group:n,replace:r},a&&r&&(De[e][r]=De[e][i])}var p="math",L="text",v="main",E="ams",qe="accent-token",Y="bin",St="close",Sa="inner",re="mathord",Qe="op-token",Ut="open",wu="punct",P="rel",cr="spacing",z="textord";f(p,v,P,"≡","\\equiv",!0);f(p,v,P,"≺","\\prec",!0);f(p,v,P,"≻","\\succ",!0);f(p,v,P,"∼","\\sim",!0);f(p,v,P,"⊥","\\perp");f(p,v,P,"⪯","\\preceq",!0);f(p,v,P,"⪰","\\succeq",!0);f(p,v,P,"≃","\\simeq",!0);f(p,v,P,"∣","\\mid",!0);f(p,v,P,"≪","\\ll",!0);f(p,v,P,"≫","\\gg",!0);f(p,v,P,"≍","\\asymp",!0);f(p,v,P,"∥","\\parallel");f(p,v,P,"⋈","\\bowtie",!0);f(p,v,P,"⌣","\\smile",!0);f(p,v,P,"⊑","\\sqsubseteq",!0);f(p,v,P,"⊒","\\sqsupseteq",!0);f(p,v,P,"≐","\\doteq",!0);f(p,v,P,"⌢","\\frown",!0);f(p,v,P,"∋","\\ni",!0);f(p,v,P,"∝","\\propto",!0);f(p,v,P,"⊢","\\vdash",!0);f(p,v,P,"⊣","\\dashv",!0);f(p,v,P,"∋","\\owns");f(p,v,wu,".","\\ldotp");f(p,v,wu,"⋅","\\cdotp");f(p,v,z,"#","\\#");f(L,v,z,"#","\\#");f(p,v,z,"&","\\&");f(L,v,z,"&","\\&");f(p,v,z,"ℵ","\\aleph",!0);f(p,v,z,"∀","\\forall",!0);f(p,v,z,"ℏ","\\hbar",!0);f(p,v,z,"∃","\\exists",!0);f(p,v,z,"∇","\\nabla",!0);f(p,v,z,"♭","\\flat",!0);f(p,v,z,"ℓ","\\ell",!0);f(p,v,z,"♮","\\natural",!0);f(p,v,z,"♣","\\clubsuit",!0);f(p,v,z,"℘","\\wp",!0);f(p,v,z,"♯","\\sharp",!0);f(p,v,z,"♢","\\diamondsuit",!0);f(p,v,z,"ℜ","\\Re",!0);f(p,v,z,"♡","\\heartsuit",!0);f(p,v,z,"ℑ","\\Im",!0);f(p,v,z,"♠","\\spadesuit",!0);f(p,v,z,"§","\\S",!0);f(L,v,z,"§","\\S");f(p,v,z,"¶","\\P",!0);f(L,v,z,"¶","\\P");f(p,v,z,"†","\\dag");f(L,v,z,"†","\\dag");f(L,v,z,"†","\\textdagger");f(p,v,z,"‡","\\ddag");f(L,v,z,"‡","\\ddag");f(L,v,z,"‡","\\textdaggerdbl");f(p,v,St,"⎱","\\rmoustache",!0);f(p,v,Ut,"⎰","\\lmoustache",!0);f(p,v,St,"⟯","\\rgroup",!0);f(p,v,Ut,"⟮","\\lgroup",!0);f(p,v,Y,"∓","\\mp",!0);f(p,v,Y,"⊖","\\ominus",!0);f(p,v,Y,"⊎","\\uplus",!0);f(p,v,Y,"⊓","\\sqcap",!0);f(p,v,Y,"∗","\\ast");f(p,v,Y,"⊔","\\sqcup",!0);f(p,v,Y,"◯","\\bigcirc",!0);f(p,v,Y,"∙","\\bullet",!0);f(p,v,Y,"‡","\\ddagger");f(p,v,Y,"≀","\\wr",!0);f(p,v,Y,"⨿","\\amalg");f(p,v,Y,"&","\\And");f(p,v,P,"⟵","\\longleftarrow",!0);f(p,v,P,"⇐","\\Leftarrow",!0);f(p,v,P,"⟸","\\Longleftarrow",!0);f(p,v,P,"⟶","\\longrightarrow",!0);f(p,v,P,"⇒","\\Rightarrow",!0);f(p,v,P,"⟹","\\Longrightarrow",!0);f(p,v,P,"↔","\\leftrightarrow",!0);f(p,v,P,"⟷","\\longleftrightarrow",!0);f(p,v,P,"⇔","\\Leftrightarrow",!0);f(p,v,P,"⟺","\\Longleftrightarrow",!0);f(p,v,P,"↦","\\mapsto",!0);f(p,v,P,"⟼","\\longmapsto",!0);f(p,v,P,"↗","\\nearrow",!0);f(p,v,P,"↩","\\hookleftarrow",!0);f(p,v,P,"↪","\\hookrightarrow",!0);f(p,v,P,"↘","\\searrow",!0);f(p,v,P,"↼","\\leftharpoonup",!0);f(p,v,P,"⇀","\\rightharpoonup",!0);f(p,v,P,"↙","\\swarrow",!0);f(p,v,P,"↽","\\leftharpoondown",!0);f(p,v,P,"⇁","\\rightharpoondown",!0);f(p,v,P,"↖","\\nwarrow",!0);f(p,v,P,"⇌","\\rightleftharpoons",!0);f(p,E,P,"≮","\\nless",!0);f(p,E,P,"","\\@nleqslant");f(p,E,P,"","\\@nleqq");f(p,E,P,"⪇","\\lneq",!0);f(p,E,P,"≨","\\lneqq",!0);f(p,E,P,"","\\@lvertneqq");f(p,E,P,"⋦","\\lnsim",!0);f(p,E,P,"⪉","\\lnapprox",!0);f(p,E,P,"⊀","\\nprec",!0);f(p,E,P,"⋠","\\npreceq",!0);f(p,E,P,"⋨","\\precnsim",!0);f(p,E,P,"⪹","\\precnapprox",!0);f(p,E,P,"≁","\\nsim",!0);f(p,E,P,"","\\@nshortmid");f(p,E,P,"∤","\\nmid",!0);f(p,E,P,"⊬","\\nvdash",!0);f(p,E,P,"⊭","\\nvDash",!0);f(p,E,P,"⋪","\\ntriangleleft");f(p,E,P,"⋬","\\ntrianglelefteq",!0);f(p,E,P,"⊊","\\subsetneq",!0);f(p,E,P,"","\\@varsubsetneq");f(p,E,P,"⫋","\\subsetneqq",!0);f(p,E,P,"","\\@varsubsetneqq");f(p,E,P,"≯","\\ngtr",!0);f(p,E,P,"","\\@ngeqslant");f(p,E,P,"","\\@ngeqq");f(p,E,P,"⪈","\\gneq",!0);f(p,E,P,"≩","\\gneqq",!0);f(p,E,P,"","\\@gvertneqq");f(p,E,P,"⋧","\\gnsim",!0);f(p,E,P,"⪊","\\gnapprox",!0);f(p,E,P,"⊁","\\nsucc",!0);f(p,E,P,"⋡","\\nsucceq",!0);f(p,E,P,"⋩","\\succnsim",!0);f(p,E,P,"⪺","\\succnapprox",!0);f(p,E,P,"≆","\\ncong",!0);f(p,E,P,"","\\@nshortparallel");f(p,E,P,"∦","\\nparallel",!0);f(p,E,P,"⊯","\\nVDash",!0);f(p,E,P,"⋫","\\ntriangleright");f(p,E,P,"⋭","\\ntrianglerighteq",!0);f(p,E,P,"","\\@nsupseteqq");f(p,E,P,"⊋","\\supsetneq",!0);f(p,E,P,"","\\@varsupsetneq");f(p,E,P,"⫌","\\supsetneqq",!0);f(p,E,P,"","\\@varsupsetneqq");f(p,E,P,"⊮","\\nVdash",!0);f(p,E,P,"⪵","\\precneqq",!0);f(p,E,P,"⪶","\\succneqq",!0);f(p,E,P,"","\\@nsubseteqq");f(p,E,Y,"⊴","\\unlhd");f(p,E,Y,"⊵","\\unrhd");f(p,E,P,"↚","\\nleftarrow",!0);f(p,E,P,"↛","\\nrightarrow",!0);f(p,E,P,"⇍","\\nLeftarrow",!0);f(p,E,P,"⇏","\\nRightarrow",!0);f(p,E,P,"↮","\\nleftrightarrow",!0);f(p,E,P,"⇎","\\nLeftrightarrow",!0);f(p,E,P,"△","\\vartriangle");f(p,E,z,"ℏ","\\hslash");f(p,E,z,"▽","\\triangledown");f(p,E,z,"◊","\\lozenge");f(p,E,z,"Ⓢ","\\circledS");f(p,E,z,"®","\\circledR");f(L,E,z,"®","\\circledR");f(p,E,z,"∡","\\measuredangle",!0);f(p,E,z,"∄","\\nexists");f(p,E,z,"℧","\\mho");f(p,E,z,"Ⅎ","\\Finv",!0);f(p,E,z,"⅁","\\Game",!0);f(p,E,z,"‵","\\backprime");f(p,E,z,"▲","\\blacktriangle");f(p,E,z,"▼","\\blacktriangledown");f(p,E,z,"■","\\blacksquare");f(p,E,z,"⧫","\\blacklozenge");f(p,E,z,"★","\\bigstar");f(p,E,z,"∢","\\sphericalangle",!0);f(p,E,z,"∁","\\complement",!0);f(p,E,z,"ð","\\eth",!0);f(L,v,z,"ð","ð");f(p,E,z,"╱","\\diagup");f(p,E,z,"╲","\\diagdown");f(p,E,z,"□","\\square");f(p,E,z,"□","\\Box");f(p,E,z,"◊","\\Diamond");f(p,E,z,"¥","\\yen",!0);f(L,E,z,"¥","\\yen",!0);f(p,E,z,"✓","\\checkmark",!0);f(L,E,z,"✓","\\checkmark");f(p,E,z,"ℶ","\\beth",!0);f(p,E,z,"ℸ","\\daleth",!0);f(p,E,z,"ℷ","\\gimel",!0);f(p,E,z,"ϝ","\\digamma",!0);f(p,E,z,"ϰ","\\varkappa");f(p,E,Ut,"┌","\\@ulcorner",!0);f(p,E,St,"┐","\\@urcorner",!0);f(p,E,Ut,"└","\\@llcorner",!0);f(p,E,St,"┘","\\@lrcorner",!0);f(p,E,P,"≦","\\leqq",!0);f(p,E,P,"⩽","\\leqslant",!0);f(p,E,P,"⪕","\\eqslantless",!0);f(p,E,P,"≲","\\lesssim",!0);f(p,E,P,"⪅","\\lessapprox",!0);f(p,E,P,"≊","\\approxeq",!0);f(p,E,Y,"⋖","\\lessdot");f(p,E,P,"⋘","\\lll",!0);f(p,E,P,"≶","\\lessgtr",!0);f(p,E,P,"⋚","\\lesseqgtr",!0);f(p,E,P,"⪋","\\lesseqqgtr",!0);f(p,E,P,"≑","\\doteqdot");f(p,E,P,"≓","\\risingdotseq",!0);f(p,E,P,"≒","\\fallingdotseq",!0);f(p,E,P,"∽","\\backsim",!0);f(p,E,P,"⋍","\\backsimeq",!0);f(p,E,P,"⫅","\\subseteqq",!0);f(p,E,P,"⋐","\\Subset",!0);f(p,E,P,"⊏","\\sqsubset",!0);f(p,E,P,"≼","\\preccurlyeq",!0);f(p,E,P,"⋞","\\curlyeqprec",!0);f(p,E,P,"≾","\\precsim",!0);f(p,E,P,"⪷","\\precapprox",!0);f(p,E,P,"⊲","\\vartriangleleft");f(p,E,P,"⊴","\\trianglelefteq");f(p,E,P,"⊨","\\vDash",!0);f(p,E,P,"⊪","\\Vvdash",!0);f(p,E,P,"⌣","\\smallsmile");f(p,E,P,"⌢","\\smallfrown");f(p,E,P,"≏","\\bumpeq",!0);f(p,E,P,"≎","\\Bumpeq",!0);f(p,E,P,"≧","\\geqq",!0);f(p,E,P,"⩾","\\geqslant",!0);f(p,E,P,"⪖","\\eqslantgtr",!0);f(p,E,P,"≳","\\gtrsim",!0);f(p,E,P,"⪆","\\gtrapprox",!0);f(p,E,Y,"⋗","\\gtrdot");f(p,E,P,"⋙","\\ggg",!0);f(p,E,P,"≷","\\gtrless",!0);f(p,E,P,"⋛","\\gtreqless",!0);f(p,E,P,"⪌","\\gtreqqless",!0);f(p,E,P,"≖","\\eqcirc",!0);f(p,E,P,"≗","\\circeq",!0);f(p,E,P,"≜","\\triangleq",!0);f(p,E,P,"∼","\\thicksim");f(p,E,P,"≈","\\thickapprox");f(p,E,P,"⫆","\\supseteqq",!0);f(p,E,P,"⋑","\\Supset",!0);f(p,E,P,"⊐","\\sqsupset",!0);f(p,E,P,"≽","\\succcurlyeq",!0);f(p,E,P,"⋟","\\curlyeqsucc",!0);f(p,E,P,"≿","\\succsim",!0);f(p,E,P,"⪸","\\succapprox",!0);f(p,E,P,"⊳","\\vartriangleright");f(p,E,P,"⊵","\\trianglerighteq");f(p,E,P,"⊩","\\Vdash",!0);f(p,E,P,"∣","\\shortmid");f(p,E,P,"∥","\\shortparallel");f(p,E,P,"≬","\\between",!0);f(p,E,P,"⋔","\\pitchfork",!0);f(p,E,P,"∝","\\varpropto");f(p,E,P,"◀","\\blacktriangleleft");f(p,E,P,"∴","\\therefore",!0);f(p,E,P,"∍","\\backepsilon");f(p,E,P,"▶","\\blacktriangleright");f(p,E,P,"∵","\\because",!0);f(p,E,P,"⋘","\\llless");f(p,E,P,"⋙","\\gggtr");f(p,E,Y,"⊲","\\lhd");f(p,E,Y,"⊳","\\rhd");f(p,E,P,"≂","\\eqsim",!0);f(p,v,P,"⋈","\\Join");f(p,E,P,"≑","\\Doteq",!0);f(p,E,Y,"∔","\\dotplus",!0);f(p,E,Y,"∖","\\smallsetminus");f(p,E,Y,"⋒","\\Cap",!0);f(p,E,Y,"⋓","\\Cup",!0);f(p,E,Y,"⩞","\\doublebarwedge",!0);f(p,E,Y,"⊟","\\boxminus",!0);f(p,E,Y,"⊞","\\boxplus",!0);f(p,E,Y,"⋇","\\divideontimes",!0);f(p,E,Y,"⋉","\\ltimes",!0);f(p,E,Y,"⋊","\\rtimes",!0);f(p,E,Y,"⋋","\\leftthreetimes",!0);f(p,E,Y,"⋌","\\rightthreetimes",!0);f(p,E,Y,"⋏","\\curlywedge",!0);f(p,E,Y,"⋎","\\curlyvee",!0);f(p,E,Y,"⊝","\\circleddash",!0);f(p,E,Y,"⊛","\\circledast",!0);f(p,E,Y,"⋅","\\centerdot");f(p,E,Y,"⊺","\\intercal",!0);f(p,E,Y,"⋒","\\doublecap");f(p,E,Y,"⋓","\\doublecup");f(p,E,Y,"⊠","\\boxtimes",!0);f(p,E,P,"⇢","\\dashrightarrow",!0);f(p,E,P,"⇠","\\dashleftarrow",!0);f(p,E,P,"⇇","\\leftleftarrows",!0);f(p,E,P,"⇆","\\leftrightarrows",!0);f(p,E,P,"⇚","\\Lleftarrow",!0);f(p,E,P,"↞","\\twoheadleftarrow",!0);f(p,E,P,"↢","\\leftarrowtail",!0);f(p,E,P,"↫","\\looparrowleft",!0);f(p,E,P,"⇋","\\leftrightharpoons",!0);f(p,E,P,"↶","\\curvearrowleft",!0);f(p,E,P,"↺","\\circlearrowleft",!0);f(p,E,P,"↰","\\Lsh",!0);f(p,E,P,"⇈","\\upuparrows",!0);f(p,E,P,"↿","\\upharpoonleft",!0);f(p,E,P,"⇃","\\downharpoonleft",!0);f(p,v,P,"⊶","\\origof",!0);f(p,v,P,"⊷","\\imageof",!0);f(p,E,P,"⊸","\\multimap",!0);f(p,E,P,"↭","\\leftrightsquigarrow",!0);f(p,E,P,"⇉","\\rightrightarrows",!0);f(p,E,P,"⇄","\\rightleftarrows",!0);f(p,E,P,"↠","\\twoheadrightarrow",!0);f(p,E,P,"↣","\\rightarrowtail",!0);f(p,E,P,"↬","\\looparrowright",!0);f(p,E,P,"↷","\\curvearrowright",!0);f(p,E,P,"↻","\\circlearrowright",!0);f(p,E,P,"↱","\\Rsh",!0);f(p,E,P,"⇊","\\downdownarrows",!0);f(p,E,P,"↾","\\upharpoonright",!0);f(p,E,P,"⇂","\\downharpoonright",!0);f(p,E,P,"⇝","\\rightsquigarrow",!0);f(p,E,P,"⇝","\\leadsto");f(p,E,P,"⇛","\\Rrightarrow",!0);f(p,E,P,"↾","\\restriction");f(p,v,z,"‘","`");f(p,v,z,"$","\\$");f(L,v,z,"$","\\$");f(L,v,z,"$","\\textdollar");f(p,v,z,"%","\\%");f(L,v,z,"%","\\%");f(p,v,z,"_","\\_");f(L,v,z,"_","\\_");f(L,v,z,"_","\\textunderscore");f(p,v,z,"∠","\\angle",!0);f(p,v,z,"∞","\\infty",!0);f(p,v,z,"′","\\prime");f(p,v,z,"△","\\triangle");f(p,v,z,"Γ","\\Gamma",!0);f(p,v,z,"Δ","\\Delta",!0);f(p,v,z,"Θ","\\Theta",!0);f(p,v,z,"Λ","\\Lambda",!0);f(p,v,z,"Ξ","\\Xi",!0);f(p,v,z,"Π","\\Pi",!0);f(p,v,z,"Σ","\\Sigma",!0);f(p,v,z,"Υ","\\Upsilon",!0);f(p,v,z,"Φ","\\Phi",!0);f(p,v,z,"Ψ","\\Psi",!0);f(p,v,z,"Ω","\\Omega",!0);f(p,v,z,"A","Α");f(p,v,z,"B","Β");f(p,v,z,"E","Ε");f(p,v,z,"Z","Ζ");f(p,v,z,"H","Η");f(p,v,z,"I","Ι");f(p,v,z,"K","Κ");f(p,v,z,"M","Μ");f(p,v,z,"N","Ν");f(p,v,z,"O","Ο");f(p,v,z,"P","Ρ");f(p,v,z,"T","Τ");f(p,v,z,"X","Χ");f(p,v,z,"¬","\\neg",!0);f(p,v,z,"¬","\\lnot");f(p,v,z,"⊤","\\top");f(p,v,z,"⊥","\\bot");f(p,v,z,"∅","\\emptyset");f(p,E,z,"∅","\\varnothing");f(p,v,re,"α","\\alpha",!0);f(p,v,re,"β","\\beta",!0);f(p,v,re,"γ","\\gamma",!0);f(p,v,re,"δ","\\delta",!0);f(p,v,re,"ϵ","\\epsilon",!0);f(p,v,re,"ζ","\\zeta",!0);f(p,v,re,"η","\\eta",!0);f(p,v,re,"θ","\\theta",!0);f(p,v,re,"ι","\\iota",!0);f(p,v,re,"κ","\\kappa",!0);f(p,v,re,"λ","\\lambda",!0);f(p,v,re,"μ","\\mu",!0);f(p,v,re,"ν","\\nu",!0);f(p,v,re,"ξ","\\xi",!0);f(p,v,re,"ο","\\omicron",!0);f(p,v,re,"π","\\pi",!0);f(p,v,re,"ρ","\\rho",!0);f(p,v,re,"σ","\\sigma",!0);f(p,v,re,"τ","\\tau",!0);f(p,v,re,"υ","\\upsilon",!0);f(p,v,re,"ϕ","\\phi",!0);f(p,v,re,"χ","\\chi",!0);f(p,v,re,"ψ","\\psi",!0);f(p,v,re,"ω","\\omega",!0);f(p,v,re,"ε","\\varepsilon",!0);f(p,v,re,"ϑ","\\vartheta",!0);f(p,v,re,"ϖ","\\varpi",!0);f(p,v,re,"ϱ","\\varrho",!0);f(p,v,re,"ς","\\varsigma",!0);f(p,v,re,"φ","\\varphi",!0);f(p,v,Y,"∗","*",!0);f(p,v,Y,"+","+");f(p,v,Y,"−","-",!0);f(p,v,Y,"⋅","\\cdot",!0);f(p,v,Y,"∘","\\circ",!0);f(p,v,Y,"÷","\\div",!0);f(p,v,Y,"±","\\pm",!0);f(p,v,Y,"×","\\times",!0);f(p,v,Y,"∩","\\cap",!0);f(p,v,Y,"∪","\\cup",!0);f(p,v,Y,"∖","\\setminus",!0);f(p,v,Y,"∧","\\land");f(p,v,Y,"∨","\\lor");f(p,v,Y,"∧","\\wedge",!0);f(p,v,Y,"∨","\\vee",!0);f(p,v,z,"√","\\surd");f(p,v,Ut,"⟨","\\langle",!0);f(p,v,Ut,"∣","\\lvert");f(p,v,Ut,"∥","\\lVert");f(p,v,St,"?","?");f(p,v,St,"!","!");f(p,v,St,"⟩","\\rangle",!0);f(p,v,St,"∣","\\rvert");f(p,v,St,"∥","\\rVert");f(p,v,P,"=","=");f(p,v,P,":",":");f(p,v,P,"≈","\\approx",!0);f(p,v,P,"≅","\\cong",!0);f(p,v,P,"≥","\\ge");f(p,v,P,"≥","\\geq",!0);f(p,v,P,"←","\\gets");f(p,v,P,">","\\gt",!0);f(p,v,P,"∈","\\in",!0);f(p,v,P,"","\\@not");f(p,v,P,"⊂","\\subset",!0);f(p,v,P,"⊃","\\supset",!0);f(p,v,P,"⊆","\\subseteq",!0);f(p,v,P,"⊇","\\supseteq",!0);f(p,E,P,"⊈","\\nsubseteq",!0);f(p,E,P,"⊉","\\nsupseteq",!0);f(p,v,P,"⊨","\\models");f(p,v,P,"←","\\leftarrow",!0);f(p,v,P,"≤","\\le");f(p,v,P,"≤","\\leq",!0);f(p,v,P,"<","\\lt",!0);f(p,v,P,"→","\\rightarrow",!0);f(p,v,P,"→","\\to");f(p,E,P,"≱","\\ngeq",!0);f(p,E,P,"≰","\\nleq",!0);f(p,v,cr," ","\\ ");f(p,v,cr," ","\\space");f(p,v,cr," ","\\nobreakspace");f(L,v,cr," ","\\ ");f(L,v,cr," "," ");f(L,v,cr," ","\\space");f(L,v,cr," ","\\nobreakspace");f(p,v,cr,null,"\\nobreak");f(p,v,cr,null,"\\allowbreak");f(p,v,wu,",",",");f(p,v,wu,";",";");f(p,E,Y,"⊼","\\barwedge",!0);f(p,E,Y,"⊻","\\veebar",!0);f(p,v,Y,"⊙","\\odot",!0);f(p,v,Y,"⊕","\\oplus",!0);f(p,v,Y,"⊗","\\otimes",!0);f(p,v,z,"∂","\\partial",!0);f(p,v,Y,"⊘","\\oslash",!0);f(p,E,Y,"⊚","\\circledcirc",!0);f(p,E,Y,"⊡","\\boxdot",!0);f(p,v,Y,"△","\\bigtriangleup");f(p,v,Y,"▽","\\bigtriangledown");f(p,v,Y,"†","\\dagger");f(p,v,Y,"⋄","\\diamond");f(p,v,Y,"⋆","\\star");f(p,v,Y,"◃","\\triangleleft");f(p,v,Y,"▹","\\triangleright");f(p,v,Ut,"{","\\{");f(L,v,z,"{","\\{");f(L,v,z,"{","\\textbraceleft");f(p,v,St,"}","\\}");f(L,v,z,"}","\\}");f(L,v,z,"}","\\textbraceright");f(p,v,Ut,"{","\\lbrace");f(p,v,St,"}","\\rbrace");f(p,v,Ut,"[","\\lbrack",!0);f(L,v,z,"[","\\lbrack",!0);f(p,v,St,"]","\\rbrack",!0);f(L,v,z,"]","\\rbrack",!0);f(p,v,Ut,"(","\\lparen",!0);f(p,v,St,")","\\rparen",!0);f(L,v,z,"<","\\textless",!0);f(L,v,z,">","\\textgreater",!0);f(p,v,Ut,"⌊","\\lfloor",!0);f(p,v,St,"⌋","\\rfloor",!0);f(p,v,Ut,"⌈","\\lceil",!0);f(p,v,St,"⌉","\\rceil",!0);f(p,v,z,"\\","\\backslash");f(p,v,z,"∣","|");f(p,v,z,"∣","\\vert");f(L,v,z,"|","\\textbar",!0);f(p,v,z,"∥","\\|");f(p,v,z,"∥","\\Vert");f(L,v,z,"∥","\\textbardbl");f(L,v,z,"~","\\textasciitilde");f(L,v,z,"\\","\\textbackslash");f(L,v,z,"^","\\textasciicircum");f(p,v,P,"↑","\\uparrow",!0);f(p,v,P,"⇑","\\Uparrow",!0);f(p,v,P,"↓","\\downarrow",!0);f(p,v,P,"⇓","\\Downarrow",!0);f(p,v,P,"↕","\\updownarrow",!0);f(p,v,P,"⇕","\\Updownarrow",!0);f(p,v,Qe,"∐","\\coprod");f(p,v,Qe,"⋁","\\bigvee");f(p,v,Qe,"⋀","\\bigwedge");f(p,v,Qe,"⨄","\\biguplus");f(p,v,Qe,"⋂","\\bigcap");f(p,v,Qe,"⋃","\\bigcup");f(p,v,Qe,"∫","\\int");f(p,v,Qe,"∫","\\intop");f(p,v,Qe,"∬","\\iint");f(p,v,Qe,"∭","\\iiint");f(p,v,Qe,"∏","\\prod");f(p,v,Qe,"∑","\\sum");f(p,v,Qe,"⨂","\\bigotimes");f(p,v,Qe,"⨁","\\bigoplus");f(p,v,Qe,"⨀","\\bigodot");f(p,v,Qe,"∮","\\oint");f(p,v,Qe,"∯","\\oiint");f(p,v,Qe,"∰","\\oiiint");f(p,v,Qe,"⨆","\\bigsqcup");f(p,v,Qe,"∫","\\smallint");f(L,v,Sa,"…","\\textellipsis");f(p,v,Sa,"…","\\mathellipsis");f(L,v,Sa,"…","\\ldots",!0);f(p,v,Sa,"…","\\ldots",!0);f(p,v,Sa,"⋯","\\@cdots",!0);f(p,v,Sa,"⋱","\\ddots",!0);f(p,v,z,"⋮","\\varvdots");f(L,v,z,"⋮","\\varvdots");f(p,v,qe,"ˊ","\\acute");f(p,v,qe,"ˋ","\\grave");f(p,v,qe,"¨","\\ddot");f(p,v,qe,"~","\\tilde");f(p,v,qe,"ˉ","\\bar");f(p,v,qe,"˘","\\breve");f(p,v,qe,"ˇ","\\check");f(p,v,qe,"^","\\hat");f(p,v,qe,"⃗","\\vec");f(p,v,qe,"˙","\\dot");f(p,v,qe,"˚","\\mathring");f(p,v,re,"","\\@imath");f(p,v,re,"","\\@jmath");f(p,v,z,"ı","ı");f(p,v,z,"ȷ","ȷ");f(L,v,z,"ı","\\i",!0);f(L,v,z,"ȷ","\\j",!0);f(L,v,z,"ß","\\ss",!0);f(L,v,z,"æ","\\ae",!0);f(L,v,z,"œ","\\oe",!0);f(L,v,z,"ø","\\o",!0);f(L,v,z,"Æ","\\AE",!0);f(L,v,z,"Œ","\\OE",!0);f(L,v,z,"Ø","\\O",!0);f(L,v,qe,"ˊ","\\'");f(L,v,qe,"ˋ","\\`");f(L,v,qe,"ˆ","\\^");f(L,v,qe,"˜","\\~");f(L,v,qe,"ˉ","\\=");f(L,v,qe,"˘","\\u");f(L,v,qe,"˙","\\.");f(L,v,qe,"¸","\\c");f(L,v,qe,"˚","\\r");f(L,v,qe,"ˇ","\\v");f(L,v,qe,"¨",'\\"');f(L,v,qe,"˝","\\H");f(L,v,qe,"◯","\\textcircled");var _4={"--":!0,"---":!0,"``":!0,"''":!0};f(L,v,z,"–","--",!0);f(L,v,z,"–","\\textendash");f(L,v,z,"—","---",!0);f(L,v,z,"—","\\textemdash");f(L,v,z,"‘","`",!0);f(L,v,z,"‘","\\textquoteleft");f(L,v,z,"’","'",!0);f(L,v,z,"’","\\textquoteright");f(L,v,z,"“","``",!0);f(L,v,z,"“","\\textquotedblleft");f(L,v,z,"”","''",!0);f(L,v,z,"”","\\textquotedblright");f(p,v,z,"°","\\degree",!0);f(L,v,z,"°","\\degree");f(L,v,z,"°","\\textdegree",!0);f(p,v,z,"£","\\pounds");f(p,v,z,"£","\\mathsterling",!0);f(L,v,z,"£","\\pounds");f(L,v,z,"£","\\textsterling",!0);f(p,E,z,"✠","\\maltese");f(L,E,z,"✠","\\maltese");var x1='0123456789/@."';for(var Sh=0;Sh<x1.length;Sh++){var w1=x1.charAt(Sh);f(p,v,z,w1,w1)}var k1='0123456789!@*()-=+";:?/.,';for(var Eh=0;Eh<k1.length;Eh++){var S1=k1.charAt(Eh);f(L,v,z,S1,S1)}var Vl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";for(var Ch=0;Ch<Vl.length;Ch++){var Fs=Vl.charAt(Ch);f(p,v,re,Fs,Fs),f(L,v,z,Fs,Fs)}f(p,E,z,"C","ℂ");f(L,E,z,"C","ℂ");f(p,E,z,"H","ℍ");f(L,E,z,"H","ℍ");f(p,E,z,"N","ℕ");f(L,E,z,"N","ℕ");f(p,E,z,"P","ℙ");f(L,E,z,"P","ℙ");f(p,E,z,"Q","ℚ");f(L,E,z,"Q","ℚ");f(p,E,z,"R","ℝ");f(L,E,z,"R","ℝ");f(p,E,z,"Z","ℤ");f(L,E,z,"Z","ℤ");f(p,v,re,"h","ℎ");f(L,v,re,"h","ℎ");var se="";for(var yt=0;yt<Vl.length;yt++){var We=Vl.charAt(yt);se=String.fromCharCode(55349,56320+yt),f(p,v,re,We,se),f(L,v,z,We,se),se=String.fromCharCode(55349,56372+yt),f(p,v,re,We,se),f(L,v,z,We,se),se=String.fromCharCode(55349,56424+yt),f(p,v,re,We,se),f(L,v,z,We,se),se=String.fromCharCode(55349,56580+yt),f(p,v,re,We,se),f(L,v,z,We,se),se=String.fromCharCode(55349,56684+yt),f(p,v,re,We,se),f(L,v,z,We,se),se=String.fromCharCode(55349,56736+yt),f(p,v,re,We,se),f(L,v,z,We,se),se=String.fromCharCode(55349,56788+yt),f(p,v,re,We,se),f(L,v,z,We,se),se=String.fromCharCode(55349,56840+yt),f(p,v,re,We,se),f(L,v,z,We,se),se=String.fromCharCode(55349,56944+yt),f(p,v,re,We,se),f(L,v,z,We,se),yt<26&&(se=String.fromCharCode(55349,56632+yt),f(p,v,re,We,se),f(L,v,z,We,se),se=String.fromCharCode(55349,56476+yt),f(p,v,re,We,se),f(L,v,z,We,se))}se="𝕜";f(p,v,re,"k",se);f(L,v,z,"k",se);for(var Zr=0;Zr<10;Zr++){var br=Zr.toString();se=String.fromCharCode(55349,57294+Zr),f(p,v,re,br,se),f(L,v,z,br,se),se=String.fromCharCode(55349,57314+Zr),f(p,v,re,br,se),f(L,v,z,br,se),se=String.fromCharCode(55349,57324+Zr),f(p,v,re,br,se),f(L,v,z,br,se),se=String.fromCharCode(55349,57334+Zr),f(p,v,re,br,se),f(L,v,z,br,se)}var s0="ÐÞþ";for(var Ph=0;Ph<s0.length;Ph++){var qs=s0.charAt(Ph);f(p,v,re,qs,qs),f(L,v,z,qs,qs)}var Rs=[["mathbf","textbf","Main-Bold"],["mathbf","textbf","Main-Bold"],["mathnormal","textit","Math-Italic"],["mathnormal","textit","Math-Italic"],["boldsymbol","boldsymbol","Main-BoldItalic"],["boldsymbol","boldsymbol","Main-BoldItalic"],["mathscr","textscr","Script-Regular"],["","",""],["","",""],["","",""],["mathfrak","textfrak","Fraktur-Regular"],["mathfrak","textfrak","Fraktur-Regular"],["mathbb","textbb","AMS-Regular"],["mathbb","textbb","AMS-Regular"],["mathboldfrak","textboldfrak","Fraktur-Regular"],["mathboldfrak","textboldfrak","Fraktur-Regular"],["mathsf","textsf","SansSerif-Regular"],["mathsf","textsf","SansSerif-Regular"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathitsf","textitsf","SansSerif-Italic"],["mathitsf","textitsf","SansSerif-Italic"],["","",""],["","",""],["mathtt","texttt","Typewriter-Regular"],["mathtt","texttt","Typewriter-Regular"]],E1=[["mathbf","textbf","Main-Bold"],["","",""],["mathsf","textsf","SansSerif-Regular"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathtt","texttt","Typewriter-Regular"]],WC=function(t,n){var r=t.charCodeAt(0),i=t.charCodeAt(1),a=(r-55296)*1024+(i-56320)+65536,o=n==="math"?0:1;if(119808<=a&&a<120484){var s=Math.floor((a-119808)/26);return[Rs[s][2],Rs[s][o]]}else if(120782<=a&&a<=120831){var l=Math.floor((a-120782)/10);return[E1[l][2],E1[l][o]]}else{if(a===120485||a===120486)return[Rs[0][2],Rs[0][o]];if(120486<a&&a<120782)return["",""];throw new X("Unsupported character: "+t)}},ku=function(t,n,r){return De[r][t]&&De[r][t].replace&&(t=De[r][t].replace),{value:t,metrics:td(t,n,r)}},gn=function(t,n,r,i,a){var o=ku(t,n,r),s=o.metrics;t=o.value;var l;if(s){var u=s.italic;(r==="text"||i&&i.font==="mathit")&&(u=0),l=new on(t,s.height,s.depth,u,s.skew,s.width,a)}else typeof console<"u"&&console.warn("No character metrics "+("for '"+t+"' in style '"+n+"' and mode '"+r+"'")),l=new on(t,0,0,0,0,0,a);if(i){l.maxFontSize=i.sizeMultiplier,i.style.isTight()&&l.classes.push("mtight");var h=i.getColor();h&&(l.style.color=h)}return l},XC=function(t,n,r,i){return i===void 0&&(i=[]),r.font==="boldsymbol"&&ku(t,"Main-Bold",n).metrics?gn(t,"Main-Bold",n,r,i.concat(["mathbf"])):t==="\\"||De[n][t].font==="main"?gn(t,"Main-Regular",n,r,i):gn(t,"AMS-Regular",n,r,i.concat(["amsrm"]))},UC=function(t,n,r,i,a){return a!=="textord"&&ku(t,"Math-BoldItalic",n).metrics?{fontName:"Math-BoldItalic",fontClass:"boldsymbol"}:{fontName:"Main-Bold",fontClass:"mathbf"}},HC=function(t,n,r){var i=t.mode,a=t.text,o=["mord"],s=i==="math"||i==="text"&&n.font,l=s?n.font:n.fontFamily,u="",h="";if(a.charCodeAt(0)===55349&&([u,h]=WC(a,i)),u.length>0)return gn(a,u,i,n,o.concat(h));if(l){var c,m;if(l==="boldsymbol"){var d=UC(a,i,n,o,r);c=d.fontName,m=[d.fontClass]}else s?(c=k4[l].fontName,m=[l]):(c=Ns(l,n.fontWeight,n.fontShape),m=[l,n.fontWeight,n.fontShape]);if(ku(a,c,i).metrics)return gn(a,c,i,n,o.concat(m));if(_4.hasOwnProperty(a)&&c.slice(0,10)==="Typewriter"){for(var b=[],$=0;$<a.length;$++)b.push(gn(a[$],c,i,n,o.concat(m)));return w4(b)}}if(r==="mathord")return gn(a,"Math-Italic",i,n,o.concat(["mathnormal"]));if(r==="textord"){var w=De[i][a]&&De[i][a].font;if(w==="ams"){var g=Ns("amsrm",n.fontWeight,n.fontShape);return gn(a,g,i,n,o.concat("amsrm",n.fontWeight,n.fontShape))}else if(w==="main"||!w){var y=Ns("textrm",n.fontWeight,n.fontShape);return gn(a,y,i,n,o.concat(n.fontWeight,n.fontShape))}else{var _=Ns(w,n.fontWeight,n.fontShape);return gn(a,_,i,n,o.concat(_,n.fontWeight,n.fontShape))}}else throw new Error("unexpected type: "+r+" in makeOrd")},GC=(e,t)=>{if(Nr(e.classes)!==Nr(t.classes)||e.skew!==t.skew||e.maxFontSize!==t.maxFontSize)return!1;if(e.classes.length===1){var n=e.classes[0];if(n==="mbin"||n==="mord")return!1}for(var r in e.style)if(e.style.hasOwnProperty(r)&&e.style[r]!==t.style[r])return!1;for(var i in t.style)if(t.style.hasOwnProperty(i)&&e.style[i]!==t.style[i])return!1;return!0},KC=e=>{for(var t=0;t<e.length-1;t++){var n=e[t],r=e[t+1];n instanceof on&&r instanceof on&&GC(n,r)&&(n.text+=r.text,n.height=Math.max(n.height,r.height),n.depth=Math.max(n.depth,r.depth),n.italic=r.italic,e.splice(t+1,1),t--)}return e},rd=function(t){for(var n=0,r=0,i=0,a=0;a<t.children.length;a++){var o=t.children[a];o.height>n&&(n=o.height),o.depth>r&&(r=o.depth),o.maxFontSize>i&&(i=o.maxFontSize)}t.height=n,t.depth=r,t.maxFontSize=i},Ct=function(t,n,r,i){var a=new os(t,n,r,i);return rd(a),a},x4=(e,t,n,r)=>new os(e,t,n,r),ZC=function(t,n,r){var i=Ct([t],[],n);return i.height=Math.max(r||n.fontMetrics().defaultRuleThickness,n.minRuleThickness),i.style.borderBottomWidth=G(i.height),i.maxFontSize=1,i},YC=function(t,n,r,i){var a=new nd(t,n,r,i);return rd(a),a},w4=function(t){var n=new as(t);return rd(n),n},QC=function(t,n){return t instanceof as?Ct([],[t],n):t},JC=function(t){if(t.positionType==="individualShift"){for(var n=t.children,r=[n[0]],i=-n[0].shift-n[0].elem.depth,a=i,o=1;o<n.length;o++){var s=-n[o].shift-a-n[o].elem.depth,l=s-(n[o-1].elem.height+n[o-1].elem.depth);a=a+s,r.push({type:"kern",size:l}),r.push(n[o])}return{children:r,depth:i}}var u;if(t.positionType==="top"){for(var h=t.positionData,c=0;c<t.children.length;c++){var m=t.children[c];h-=m.type==="kern"?m.size:m.elem.height+m.elem.depth}u=h}else if(t.positionType==="bottom")u=-t.positionData;else{var d=t.children[0];if(d.type!=="elem")throw new Error('First child must have type "elem".');if(t.positionType==="shift")u=-d.elem.depth-t.positionData;else if(t.positionType==="firstBaseline")u=-d.elem.depth;else throw new Error("Invalid positionType "+t.positionType+".")}return{children:t.children,depth:u}},eP=function(t,n){for(var{children:r,depth:i}=JC(t),a=0,o=0;o<r.length;o++){var s=r[o];if(s.type==="elem"){var l=s.elem;a=Math.max(a,l.maxFontSize,l.height)}}a+=2;var u=Ct(["pstrut"],[]);u.style.height=G(a);for(var h=[],c=i,m=i,d=i,b=0;b<r.length;b++){var $=r[b];if($.type==="kern")d+=$.size;else{var w=$.elem,g=$.wrapperClasses||[],y=$.wrapperStyle||{},_=Ct(g,[u,w],void 0,y);_.style.top=G(-a-d-w.depth),$.marginLeft&&(_.style.marginLeft=$.marginLeft),$.marginRight&&(_.style.marginRight=$.marginRight),h.push(_),d+=w.height+w.depth}c=Math.min(c,d),m=Math.max(m,d)}var T=Ct(["vlist"],h);T.style.height=G(m);var D;if(c<0){var C=Ct([],[]),F=Ct(["vlist"],[C]);F.style.height=G(-c);var R=Ct(["vlist-s"],[new on("​")]);D=[Ct(["vlist-r"],[T,R]),Ct(["vlist-r"],[F])]}else D=[Ct(["vlist-r"],[T])];var N=Ct(["vlist-t"],D);return D.length===2&&N.classes.push("vlist-t2"),N.height=m,N.depth=-c,N},tP=(e,t)=>{var n=Ct(["mspace"],[],t),r=Be(e,t);return n.style.marginRight=G(r),n},Ns=function(t,n,r){var i="";switch(t){case"amsrm":i="AMS";break;case"textrm":i="Main";break;case"textsf":i="SansSerif";break;case"texttt":i="Typewriter";break;default:i=t}var a;return n==="textbf"&&r==="textit"?a="BoldItalic":n==="textbf"?a="Bold":n==="textit"?a="Italic":a="Regular",i+"-"+a},k4={mathbf:{variant:"bold",fontName:"Main-Bold"},mathrm:{variant:"normal",fontName:"Main-Regular"},textit:{variant:"italic",fontName:"Main-Italic"},mathit:{variant:"italic",fontName:"Main-Italic"},mathnormal:{variant:"italic",fontName:"Math-Italic"},mathsfit:{variant:"sans-serif-italic",fontName:"SansSerif-Italic"},mathbb:{variant:"double-struck",fontName:"AMS-Regular"},mathcal:{variant:"script",fontName:"Caligraphic-Regular"},mathfrak:{variant:"fraktur",fontName:"Fraktur-Regular"},mathscr:{variant:"script",fontName:"Script-Regular"},mathsf:{variant:"sans-serif",fontName:"SansSerif-Regular"},mathtt:{variant:"monospace",fontName:"Typewriter-Regular"}},S4={vec:["vec",.471,.714],oiintSize1:["oiintSize1",.957,.499],oiintSize2:["oiintSize2",1.472,.659],oiiintSize1:["oiiintSize1",1.304,.499],oiiintSize2:["oiiintSize2",1.98,.659]},nP=function(t,n){var[r,i,a]=S4[t],o=new Ir(r),s=new ar([o],{width:G(i),height:G(a),style:"width:"+G(i),viewBox:"0 0 "+1e3*i+" "+1e3*a,preserveAspectRatio:"xMinYMin"}),l=x4(["overlay"],[s],n);return l.height=a,l.style.height=G(a),l.style.width=G(i),l},q={fontMap:k4,makeSymbol:gn,mathsym:XC,makeSpan:Ct,makeSvgSpan:x4,makeLineSpan:ZC,makeAnchor:YC,makeFragment:w4,wrapFragment:QC,makeVList:eP,makeOrd:HC,makeGlue:tP,staticSvg:nP,svgData:S4,tryCombineChars:KC},Ne={number:3,unit:"mu"},Yr={number:4,unit:"mu"},Vn={number:5,unit:"mu"},rP={mord:{mop:Ne,mbin:Yr,mrel:Vn,minner:Ne},mop:{mord:Ne,mop:Ne,mrel:Vn,minner:Ne},mbin:{mord:Yr,mop:Yr,mopen:Yr,minner:Yr},mrel:{mord:Vn,mop:Vn,mopen:Vn,minner:Vn},mopen:{},mclose:{mop:Ne,mbin:Yr,mrel:Vn,minner:Ne},mpunct:{mord:Ne,mop:Ne,mrel:Vn,mopen:Ne,mclose:Ne,mpunct:Ne,minner:Ne},minner:{mord:Ne,mop:Ne,mbin:Yr,mrel:Vn,mopen:Ne,mpunct:Ne,minner:Ne}},iP={mord:{mop:Ne},mop:{mord:Ne,mop:Ne},mbin:{},mrel:{},mopen:{},mclose:{mop:Ne},mpunct:{},minner:{mop:Ne}},E4={},Wl={},Xl={};function Z(e){for(var{type:t,names:n,props:r,handler:i,htmlBuilder:a,mathmlBuilder:o}=e,s={type:t,numArgs:r.numArgs,argTypes:r.argTypes,allowedInArgument:!!r.allowedInArgument,allowedInText:!!r.allowedInText,allowedInMath:r.allowedInMath===void 0?!0:r.allowedInMath,numOptionalArgs:r.numOptionalArgs||0,infix:!!r.infix,primitive:!!r.primitive,handler:i},l=0;l<n.length;++l)E4[n[l]]=s;t&&(a&&(Wl[t]=a),o&&(Xl[t]=o))}function xi(e){var{type:t,htmlBuilder:n,mathmlBuilder:r}=e;Z({type:t,names:[],props:{numArgs:0},handler(){throw new Error("Should never be called.")},htmlBuilder:n,mathmlBuilder:r})}var Ul=function(t){return t.type==="ordgroup"&&t.body.length===1?t.body[0]:t},Ke=function(t){return t.type==="ordgroup"?t.body:[t]},or=q.makeSpan,aP=["leftmost","mbin","mopen","mrel","mop","mpunct"],oP=["rightmost","mrel","mclose","mpunct"],sP={display:ie.DISPLAY,text:ie.TEXT,script:ie.SCRIPT,scriptscript:ie.SCRIPTSCRIPT},lP={mord:"mord",mop:"mop",mbin:"mbin",mrel:"mrel",mopen:"mopen",mclose:"mclose",mpunct:"mpunct",minner:"minner"},tt=function(t,n,r,i){i===void 0&&(i=[null,null]);for(var a=[],o=0;o<t.length;o++){var s=ve(t[o],n);if(s instanceof as){var l=s.children;a.push(...l)}else a.push(s)}if(q.tryCombineChars(a),!r)return a;var u=n;if(t.length===1){var h=t[0];h.type==="sizing"?u=n.havingSize(h.size):h.type==="styling"&&(u=n.havingStyle(sP[h.style]))}var c=or([i[0]||"leftmost"],[],n),m=or([i[1]||"rightmost"],[],n),d=r==="root";return C1(a,(b,$)=>{var w=$.classes[0],g=b.classes[0];w==="mbin"&&te.contains(oP,g)?$.classes[0]="mord":g==="mbin"&&te.contains(aP,w)&&(b.classes[0]="mord")},{node:c},m,d),C1(a,(b,$)=>{var w=l0($),g=l0(b),y=w&&g?b.hasClass("mtight")?iP[w][g]:rP[w][g]:null;if(y)return q.makeGlue(y,u)},{node:c},m,d),a},C1=function e(t,n,r,i,a){i&&t.push(i);for(var o=0;o<t.length;o++){var s=t[o],l=C4(s);if(l){e(l.children,n,r,null,a);continue}var u=!s.hasClass("mspace");if(u){var h=n(s,r.node);h&&(r.insertAfter?r.insertAfter(h):(t.unshift(h),o++))}u?r.node=s:a&&s.hasClass("newline")&&(r.node=or(["leftmost"])),r.insertAfter=(c=>m=>{t.splice(c+1,0,m),o++})(o)}i&&t.pop()},C4=function(t){return t instanceof as||t instanceof nd||t instanceof os&&t.hasClass("enclosing")?t:null},uP=function e(t,n){var r=C4(t);if(r){var i=r.children;if(i.length){if(n==="right")return e(i[i.length-1],"right");if(n==="left")return e(i[0],"left")}}return t},l0=function(t,n){return t?(n&&(t=uP(t,n)),lP[t.classes[0]]||null):null},Lo=function(t,n){var r=["nulldelimiter"].concat(t.baseSizingClasses());return or(n.concat(r))},ve=function(t,n,r){if(!t)return or();if(Wl[t.type]){var i=Wl[t.type](t,n);if(r&&n.size!==r.size){i=or(n.sizingClasses(r),[i],n);var a=n.sizeMultiplier/r.sizeMultiplier;i.height*=a,i.depth*=a}return i}else throw new X("Got group of unknown type: '"+t.type+"'")};function Is(e,t){var n=or(["base"],e,t),r=or(["strut"]);return r.style.height=G(n.height+n.depth),n.depth&&(r.style.verticalAlign=G(-n.depth)),n.children.unshift(r),n}function u0(e,t){var n=null;e.length===1&&e[0].type==="tag"&&(n=e[0].tag,e=e[0].body);var r=tt(e,t,"root"),i;r.length===2&&r[1].hasClass("tag")&&(i=r.pop());for(var a=[],o=[],s=0;s<r.length;s++)if(o.push(r[s]),r[s].hasClass("mbin")||r[s].hasClass("mrel")||r[s].hasClass("allowbreak")){for(var l=!1;s<r.length-1&&r[s+1].hasClass("mspace")&&!r[s+1].hasClass("newline");)s++,o.push(r[s]),r[s].hasClass("nobreak")&&(l=!0);l||(a.push(Is(o,t)),o=[])}else r[s].hasClass("newline")&&(o.pop(),o.length>0&&(a.push(Is(o,t)),o=[]),a.push(r[s]));o.length>0&&a.push(Is(o,t));var u;n?(u=Is(tt(n,t,!0)),u.classes=["tag"],a.push(u)):i&&a.push(i);var h=or(["katex-html"],a);if(h.setAttribute("aria-hidden","true"),u){var c=u.children[0];c.style.height=G(h.height+h.depth),h.depth&&(c.style.verticalAlign=G(-h.depth))}return h}function P4(e){return new as(e)}class Qt{constructor(t,n,r){this.type=void 0,this.attributes=void 0,this.children=void 0,this.classes=void 0,this.type=t,this.attributes={},this.children=n||[],this.classes=r||[]}setAttribute(t,n){this.attributes[t]=n}getAttribute(t){return this.attributes[t]}toNode(){var t=document.createElementNS("http://www.w3.org/1998/Math/MathML",this.type);for(var n in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,n)&&t.setAttribute(n,this.attributes[n]);this.classes.length>0&&(t.className=Nr(this.classes));for(var r=0;r<this.children.length;r++)t.appendChild(this.children[r].toNode());return t}toMarkup(){var t="<"+this.type;for(var n in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,n)&&(t+=" "+n+'="',t+=te.escape(this.attributes[n]),t+='"');this.classes.length>0&&(t+=' class ="'+te.escape(Nr(this.classes))+'"'),t+=">";for(var r=0;r<this.children.length;r++)t+=this.children[r].toMarkup();return t+="</"+this.type+">",t}toText(){return this.children.map(t=>t.toText()).join("")}}class mo{constructor(t){this.text=void 0,this.text=t}toNode(){return document.createTextNode(this.text)}toMarkup(){return te.escape(this.toText())}toText(){return this.text}}class hP{constructor(t){this.width=void 0,this.character=void 0,this.width=t,t>=.05555&&t<=.05556?this.character=" ":t>=.1666&&t<=.1667?this.character=" ":t>=.2222&&t<=.2223?this.character=" ":t>=.2777&&t<=.2778?this.character="  ":t>=-.05556&&t<=-.05555?this.character=" ⁣":t>=-.1667&&t<=-.1666?this.character=" ⁣":t>=-.2223&&t<=-.2222?this.character=" ⁣":t>=-.2778&&t<=-.2777?this.character=" ⁣":this.character=null}toNode(){if(this.character)return document.createTextNode(this.character);var t=document.createElementNS("http://www.w3.org/1998/Math/MathML","mspace");return t.setAttribute("width",G(this.width)),t}toMarkup(){return this.character?"<mtext>"+this.character+"</mtext>":'<mspace width="'+G(this.width)+'"/>'}toText(){return this.character?this.character:" "}}var V={MathNode:Qt,TextNode:mo,SpaceNode:hP,newDocumentFragment:P4},sn=function(t,n,r){return De[n][t]&&De[n][t].replace&&t.charCodeAt(0)!==55349&&!(_4.hasOwnProperty(t)&&r&&(r.fontFamily&&r.fontFamily.slice(4,6)==="tt"||r.font&&r.font.slice(4,6)==="tt"))&&(t=De[n][t].replace),new V.TextNode(t)},id=function(t){return t.length===1?t[0]:new V.MathNode("mrow",t)},ad=function(t,n){if(n.fontFamily==="texttt")return"monospace";if(n.fontFamily==="textsf")return n.fontShape==="textit"&&n.fontWeight==="textbf"?"sans-serif-bold-italic":n.fontShape==="textit"?"sans-serif-italic":n.fontWeight==="textbf"?"bold-sans-serif":"sans-serif";if(n.fontShape==="textit"&&n.fontWeight==="textbf")return"bold-italic";if(n.fontShape==="textit")return"italic";if(n.fontWeight==="textbf")return"bold";var r=n.font;if(!r||r==="mathnormal")return null;var i=t.mode;if(r==="mathit")return"italic";if(r==="boldsymbol")return t.type==="textord"?"bold":"bold-italic";if(r==="mathbf")return"bold";if(r==="mathbb")return"double-struck";if(r==="mathsfit")return"sans-serif-italic";if(r==="mathfrak")return"fraktur";if(r==="mathscr"||r==="mathcal")return"script";if(r==="mathsf")return"sans-serif";if(r==="mathtt")return"monospace";var a=t.text;if(te.contains(["\\imath","\\jmath"],a))return null;De[i][a]&&De[i][a].replace&&(a=De[i][a].replace);var o=q.fontMap[r].fontName;return td(a,o,i)?q.fontMap[r].variant:null},Ft=function(t,n,r){if(t.length===1){var i=Ee(t[0],n);return r&&i instanceof Qt&&i.type==="mo"&&(i.setAttribute("lspace","0em"),i.setAttribute("rspace","0em")),[i]}for(var a=[],o,s=0;s<t.length;s++){var l=Ee(t[s],n);if(l instanceof Qt&&o instanceof Qt){if(l.type==="mtext"&&o.type==="mtext"&&l.getAttribute("mathvariant")===o.getAttribute("mathvariant")){o.children.push(...l.children);continue}else if(l.type==="mn"&&o.type==="mn"){o.children.push(...l.children);continue}else if(l.type==="mi"&&l.children.length===1&&o.type==="mn"){var u=l.children[0];if(u instanceof mo&&u.text==="."){o.children.push(...l.children);continue}}else if(o.type==="mi"&&o.children.length===1){var h=o.children[0];if(h instanceof mo&&h.text==="̸"&&(l.type==="mo"||l.type==="mi"||l.type==="mn")){var c=l.children[0];c instanceof mo&&c.text.length>0&&(c.text=c.text.slice(0,1)+"̸"+c.text.slice(1),a.pop())}}}a.push(l),o=l}return a},Br=function(t,n,r){return id(Ft(t,n,r))},Ee=function(t,n){if(!t)return new V.MathNode("mrow");if(Xl[t.type]){var r=Xl[t.type](t,n);return r}else throw new X("Got group of unknown type: '"+t.type+"'")};function P1(e,t,n,r,i){var a=Ft(e,n),o;a.length===1&&a[0]instanceof Qt&&te.contains(["mrow","mtable"],a[0].type)?o=a[0]:o=new V.MathNode("mrow",a);var s=new V.MathNode("annotation",[new V.TextNode(t)]);s.setAttribute("encoding","application/x-tex");var l=new V.MathNode("semantics",[o,s]),u=new V.MathNode("math",[l]);u.setAttribute("xmlns","http://www.w3.org/1998/Math/MathML"),r&&u.setAttribute("display","block");var h=i?"katex":"katex-mathml";return q.makeSpan([h],[u])}var D4=function(t){return new Un({style:t.displayMode?ie.DISPLAY:ie.TEXT,maxSize:t.maxSize,minRuleThickness:t.minRuleThickness})},T4=function(t,n){if(n.displayMode){var r=["katex-display"];n.leqno&&r.push("leqno"),n.fleqn&&r.push("fleqn"),t=q.makeSpan(r,[t])}return t},cP=function(t,n,r){var i=D4(r),a;if(r.output==="mathml")return P1(t,n,i,r.displayMode,!0);if(r.output==="html"){var o=u0(t,i);a=q.makeSpan(["katex"],[o])}else{var s=P1(t,n,i,r.displayMode,!1),l=u0(t,i);a=q.makeSpan(["katex"],[s,l])}return T4(a,r)},mP=function(t,n,r){var i=D4(r),a=u0(t,i),o=q.makeSpan(["katex"],[a]);return T4(o,r)},dP={widehat:"^",widecheck:"ˇ",widetilde:"~",utilde:"~",overleftarrow:"←",underleftarrow:"←",xleftarrow:"←",overrightarrow:"→",underrightarrow:"→",xrightarrow:"→",underbrace:"⏟",overbrace:"⏞",overgroup:"⏠",undergroup:"⏡",overleftrightarrow:"↔",underleftrightarrow:"↔",xleftrightarrow:"↔",Overrightarrow:"⇒",xRightarrow:"⇒",overleftharpoon:"↼",xleftharpoonup:"↼",overrightharpoon:"⇀",xrightharpoonup:"⇀",xLeftarrow:"⇐",xLeftrightarrow:"⇔",xhookleftarrow:"↩",xhookrightarrow:"↪",xmapsto:"↦",xrightharpoondown:"⇁",xleftharpoondown:"↽",xrightleftharpoons:"⇌",xleftrightharpoons:"⇋",xtwoheadleftarrow:"↞",xtwoheadrightarrow:"↠",xlongequal:"=",xtofrom:"⇄",xrightleftarrows:"⇄",xrightequilibrium:"⇌",xleftequilibrium:"⇋","\\cdrightarrow":"→","\\cdleftarrow":"←","\\cdlongequal":"="},fP=function(t){var n=new V.MathNode("mo",[new V.TextNode(dP[t.replace(/^\\/,"")])]);return n.setAttribute("stretchy","true"),n},pP={overrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],overleftarrow:[["leftarrow"],.888,522,"xMinYMin"],underrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],underleftarrow:[["leftarrow"],.888,522,"xMinYMin"],xrightarrow:[["rightarrow"],1.469,522,"xMaxYMin"],"\\cdrightarrow":[["rightarrow"],3,522,"xMaxYMin"],xleftarrow:[["leftarrow"],1.469,522,"xMinYMin"],"\\cdleftarrow":[["leftarrow"],3,522,"xMinYMin"],Overrightarrow:[["doublerightarrow"],.888,560,"xMaxYMin"],xRightarrow:[["doublerightarrow"],1.526,560,"xMaxYMin"],xLeftarrow:[["doubleleftarrow"],1.526,560,"xMinYMin"],overleftharpoon:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoonup:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoondown:[["leftharpoondown"],.888,522,"xMinYMin"],overrightharpoon:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoonup:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoondown:[["rightharpoondown"],.888,522,"xMaxYMin"],xlongequal:[["longequal"],.888,334,"xMinYMin"],"\\cdlongequal":[["longequal"],3,334,"xMinYMin"],xtwoheadleftarrow:[["twoheadleftarrow"],.888,334,"xMinYMin"],xtwoheadrightarrow:[["twoheadrightarrow"],.888,334,"xMaxYMin"],overleftrightarrow:[["leftarrow","rightarrow"],.888,522],overbrace:[["leftbrace","midbrace","rightbrace"],1.6,548],underbrace:[["leftbraceunder","midbraceunder","rightbraceunder"],1.6,548],underleftrightarrow:[["leftarrow","rightarrow"],.888,522],xleftrightarrow:[["leftarrow","rightarrow"],1.75,522],xLeftrightarrow:[["doubleleftarrow","doublerightarrow"],1.75,560],xrightleftharpoons:[["leftharpoondownplus","rightharpoonplus"],1.75,716],xleftrightharpoons:[["leftharpoonplus","rightharpoondownplus"],1.75,716],xhookleftarrow:[["leftarrow","righthook"],1.08,522],xhookrightarrow:[["lefthook","rightarrow"],1.08,522],overlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],underlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],overgroup:[["leftgroup","rightgroup"],.888,342],undergroup:[["leftgroupunder","rightgroupunder"],.888,342],xmapsto:[["leftmapsto","rightarrow"],1.5,522],xtofrom:[["leftToFrom","rightToFrom"],1.75,528],xrightleftarrows:[["baraboveleftarrow","rightarrowabovebar"],1.75,901],xrightequilibrium:[["baraboveshortleftharpoon","rightharpoonaboveshortbar"],1.75,716],xleftequilibrium:[["shortbaraboveleftharpoon","shortrightharpoonabovebar"],1.75,716]},gP=function(t){return t.type==="ordgroup"?t.body.length:1},bP=function(t,n){function r(){var s=4e5,l=t.label.slice(1);if(te.contains(["widehat","widecheck","widetilde","utilde"],l)){var u=t,h=gP(u.base),c,m,d;if(h>5)l==="widehat"||l==="widecheck"?(c=420,s=2364,d=.42,m=l+"4"):(c=312,s=2340,d=.34,m="tilde4");else{var b=[1,1,2,2,3,3][h];l==="widehat"||l==="widecheck"?(s=[0,1062,2364,2364,2364][b],c=[0,239,300,360,420][b],d=[0,.24,.3,.3,.36,.42][b],m=l+b):(s=[0,600,1033,2339,2340][b],c=[0,260,286,306,312][b],d=[0,.26,.286,.3,.306,.34][b],m="tilde"+b)}var $=new Ir(m),w=new ar([$],{width:"100%",height:G(d),viewBox:"0 0 "+s+" "+c,preserveAspectRatio:"none"});return{span:q.makeSvgSpan([],[w],n),minWidth:0,height:d}}else{var g=[],y=pP[l],[_,T,D]=y,C=D/1e3,F=_.length,R,N;if(F===1){var O=y[3];R=["hide-tail"],N=[O]}else if(F===2)R=["halfarrow-left","halfarrow-right"],N=["xMinYMin","xMaxYMin"];else if(F===3)R=["brace-left","brace-center","brace-right"],N=["xMinYMin","xMidYMin","xMaxYMin"];else throw new Error(`Correct katexImagesData or update code here to support
                    `+F+" children.");for(var U=0;U<F;U++){var B=new Ir(_[U]),he=new ar([B],{width:"400em",height:G(C),viewBox:"0 0 "+s+" "+D,preserveAspectRatio:N[U]+" slice"}),ue=q.makeSvgSpan([R[U]],[he],n);if(F===1)return{span:ue,minWidth:T,height:C};ue.style.height=G(C),g.push(ue)}return{span:q.makeSpan(["stretchy"],g,n),minWidth:T,height:C}}}var{span:i,minWidth:a,height:o}=r();return i.height=o,i.style.height=G(o),a>0&&(i.style.minWidth=G(a)),i},yP=function(t,n,r,i,a){var o,s=t.height+t.depth+r+i;if(/fbox|color|angl/.test(n)){if(o=q.makeSpan(["stretchy",n],[],a),n==="fbox"){var l=a.color&&a.getColor();l&&(o.style.borderColor=l)}}else{var u=[];/^[bx]cancel$/.test(n)&&u.push(new o0({x1:"0",y1:"0",x2:"100%",y2:"100%","stroke-width":"0.046em"})),/^x?cancel$/.test(n)&&u.push(new o0({x1:"0",y1:"100%",x2:"100%",y2:"0","stroke-width":"0.046em"}));var h=new ar(u,{width:"100%",height:G(s)});o=q.makeSvgSpan([],[h],a)}return o.height=s,o.style.height=G(s),o},sr={encloseSpan:yP,mathMLnode:fP,svgSpan:bP};function pe(e,t){if(!e||e.type!==t)throw new Error("Expected node of type "+t+", but got "+(e?"node of type "+e.type:String(e)));return e}function od(e){var t=Su(e);if(!t)throw new Error("Expected node of symbol group type, but got "+(e?"node of type "+e.type:String(e)));return t}function Su(e){return e&&(e.type==="atom"||VC.hasOwnProperty(e.type))?e:null}var sd=(e,t)=>{var n,r,i;e&&e.type==="supsub"?(r=pe(e.base,"accent"),n=r.base,e.base=n,i=OC(ve(e,t)),e.base=r):(r=pe(e,"accent"),n=r.base);var a=ve(n,t.havingCrampedStyle()),o=r.isShifty&&te.isCharacterBox(n),s=0;if(o){var l=te.getBaseElem(n),u=ve(l,t.havingCrampedStyle());s=_1(u).skew}var h=r.label==="\\c",c=h?a.height+a.depth:Math.min(a.height,t.fontMetrics().xHeight),m;if(r.isStretchy)m=sr.svgSpan(r,t),m=q.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:a},{type:"elem",elem:m,wrapperClasses:["svg-align"],wrapperStyle:s>0?{width:"calc(100% - "+G(2*s)+")",marginLeft:G(2*s)}:void 0}]},t);else{var d,b;r.label==="\\vec"?(d=q.staticSvg("vec",t),b=q.svgData.vec[1]):(d=q.makeOrd({mode:r.mode,text:r.label},t,"textord"),d=_1(d),d.italic=0,b=d.width,h&&(c+=d.depth)),m=q.makeSpan(["accent-body"],[d]);var $=r.label==="\\textcircled";$&&(m.classes.push("accent-full"),c=a.height);var w=s;$||(w-=b/2),m.style.left=G(w),r.label==="\\textcircled"&&(m.style.top=".2em"),m=q.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:a},{type:"kern",size:-c},{type:"elem",elem:m}]},t)}var g=q.makeSpan(["mord","accent"],[m],t);return i?(i.children[0]=g,i.height=Math.max(g.height,i.height),i.classes[0]="mord",i):g},A4=(e,t)=>{var n=e.isStretchy?sr.mathMLnode(e.label):new V.MathNode("mo",[sn(e.label,e.mode)]),r=new V.MathNode("mover",[Ee(e.base,t),n]);return r.setAttribute("accent","true"),r},$P=new RegExp(["\\acute","\\grave","\\ddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring"].map(e=>"\\"+e).join("|"));Z({type:"accent",names:["\\acute","\\grave","\\ddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring","\\widecheck","\\widehat","\\widetilde","\\overrightarrow","\\overleftarrow","\\Overrightarrow","\\overleftrightarrow","\\overgroup","\\overlinesegment","\\overleftharpoon","\\overrightharpoon"],props:{numArgs:1},handler:(e,t)=>{var n=Ul(t[0]),r=!$P.test(e.funcName),i=!r||e.funcName==="\\widehat"||e.funcName==="\\widetilde"||e.funcName==="\\widecheck";return{type:"accent",mode:e.parser.mode,label:e.funcName,isStretchy:r,isShifty:i,base:n}},htmlBuilder:sd,mathmlBuilder:A4});Z({type:"accent",names:["\\'","\\`","\\^","\\~","\\=","\\u","\\.",'\\"',"\\c","\\r","\\H","\\v","\\textcircled"],props:{numArgs:1,allowedInText:!0,allowedInMath:!0,argTypes:["primitive"]},handler:(e,t)=>{var n=t[0],r=e.parser.mode;return r==="math"&&(e.parser.settings.reportNonstrict("mathVsTextAccents","LaTeX's accent "+e.funcName+" works only in text mode"),r="text"),{type:"accent",mode:r,label:e.funcName,isStretchy:!1,isShifty:!0,base:n}},htmlBuilder:sd,mathmlBuilder:A4});Z({type:"accentUnder",names:["\\underleftarrow","\\underrightarrow","\\underleftrightarrow","\\undergroup","\\underlinesegment","\\utilde"],props:{numArgs:1},handler:(e,t)=>{var{parser:n,funcName:r}=e,i=t[0];return{type:"accentUnder",mode:n.mode,label:r,base:i}},htmlBuilder:(e,t)=>{var n=ve(e.base,t),r=sr.svgSpan(e,t),i=e.label==="\\utilde"?.12:0,a=q.makeVList({positionType:"top",positionData:n.height,children:[{type:"elem",elem:r,wrapperClasses:["svg-align"]},{type:"kern",size:i},{type:"elem",elem:n}]},t);return q.makeSpan(["mord","accentunder"],[a],t)},mathmlBuilder:(e,t)=>{var n=sr.mathMLnode(e.label),r=new V.MathNode("munder",[Ee(e.base,t),n]);return r.setAttribute("accentunder","true"),r}});var Bs=e=>{var t=new V.MathNode("mpadded",e?[e]:[]);return t.setAttribute("width","+0.6em"),t.setAttribute("lspace","0.3em"),t};Z({type:"xArrow",names:["\\xleftarrow","\\xrightarrow","\\xLeftarrow","\\xRightarrow","\\xleftrightarrow","\\xLeftrightarrow","\\xhookleftarrow","\\xhookrightarrow","\\xmapsto","\\xrightharpoondown","\\xrightharpoonup","\\xleftharpoondown","\\xleftharpoonup","\\xrightleftharpoons","\\xleftrightharpoons","\\xlongequal","\\xtwoheadrightarrow","\\xtwoheadleftarrow","\\xtofrom","\\xrightleftarrows","\\xrightequilibrium","\\xleftequilibrium","\\\\cdrightarrow","\\\\cdleftarrow","\\\\cdlongequal"],props:{numArgs:1,numOptionalArgs:1},handler(e,t,n){var{parser:r,funcName:i}=e;return{type:"xArrow",mode:r.mode,label:i,body:t[0],below:n[0]}},htmlBuilder(e,t){var n=t.style,r=t.havingStyle(n.sup()),i=q.wrapFragment(ve(e.body,r,t),t),a=e.label.slice(0,2)==="\\x"?"x":"cd";i.classes.push(a+"-arrow-pad");var o;e.below&&(r=t.havingStyle(n.sub()),o=q.wrapFragment(ve(e.below,r,t),t),o.classes.push(a+"-arrow-pad"));var s=sr.svgSpan(e,t),l=-t.fontMetrics().axisHeight+.5*s.height,u=-t.fontMetrics().axisHeight-.5*s.height-.111;(i.depth>.25||e.label==="\\xleftequilibrium")&&(u-=i.depth);var h;if(o){var c=-t.fontMetrics().axisHeight+o.height+.5*s.height+.111;h=q.makeVList({positionType:"individualShift",children:[{type:"elem",elem:i,shift:u},{type:"elem",elem:s,shift:l},{type:"elem",elem:o,shift:c}]},t)}else h=q.makeVList({positionType:"individualShift",children:[{type:"elem",elem:i,shift:u},{type:"elem",elem:s,shift:l}]},t);return h.children[0].children[0].children[1].classes.push("svg-align"),q.makeSpan(["mrel","x-arrow"],[h],t)},mathmlBuilder(e,t){var n=sr.mathMLnode(e.label);n.setAttribute("minsize",e.label.charAt(0)==="x"?"1.75em":"3.0em");var r;if(e.body){var i=Bs(Ee(e.body,t));if(e.below){var a=Bs(Ee(e.below,t));r=new V.MathNode("munderover",[n,a,i])}else r=new V.MathNode("mover",[n,i])}else if(e.below){var o=Bs(Ee(e.below,t));r=new V.MathNode("munder",[n,o])}else r=Bs(),r=new V.MathNode("mover",[n,r]);return r}});var vP=q.makeSpan;function z4(e,t){var n=tt(e.body,t,!0);return vP([e.mclass],n,t)}function M4(e,t){var n,r=Ft(e.body,t);return e.mclass==="minner"?n=new V.MathNode("mpadded",r):e.mclass==="mord"?e.isCharacterBox?(n=r[0],n.type="mi"):n=new V.MathNode("mi",r):(e.isCharacterBox?(n=r[0],n.type="mo"):n=new V.MathNode("mo",r),e.mclass==="mbin"?(n.attributes.lspace="0.22em",n.attributes.rspace="0.22em"):e.mclass==="mpunct"?(n.attributes.lspace="0em",n.attributes.rspace="0.17em"):e.mclass==="mopen"||e.mclass==="mclose"?(n.attributes.lspace="0em",n.attributes.rspace="0em"):e.mclass==="minner"&&(n.attributes.lspace="0.0556em",n.attributes.width="+0.1111em")),n}Z({type:"mclass",names:["\\mathord","\\mathbin","\\mathrel","\\mathopen","\\mathclose","\\mathpunct","\\mathinner"],props:{numArgs:1,primitive:!0},handler(e,t){var{parser:n,funcName:r}=e,i=t[0];return{type:"mclass",mode:n.mode,mclass:"m"+r.slice(5),body:Ke(i),isCharacterBox:te.isCharacterBox(i)}},htmlBuilder:z4,mathmlBuilder:M4});var Eu=e=>{var t=e.type==="ordgroup"&&e.body.length?e.body[0]:e;return t.type==="atom"&&(t.family==="bin"||t.family==="rel")?"m"+t.family:"mord"};Z({type:"mclass",names:["\\@binrel"],props:{numArgs:2},handler(e,t){var{parser:n}=e;return{type:"mclass",mode:n.mode,mclass:Eu(t[0]),body:Ke(t[1]),isCharacterBox:te.isCharacterBox(t[1])}}});Z({type:"mclass",names:["\\stackrel","\\overset","\\underset"],props:{numArgs:2},handler(e,t){var{parser:n,funcName:r}=e,i=t[1],a=t[0],o;r!=="\\stackrel"?o=Eu(i):o="mrel";var s={type:"op",mode:i.mode,limits:!0,alwaysHandleSupSub:!0,parentIsSupSub:!1,symbol:!1,suppressBaseShift:r!=="\\stackrel",body:Ke(i)},l={type:"supsub",mode:a.mode,base:s,sup:r==="\\underset"?null:a,sub:r==="\\underset"?a:null};return{type:"mclass",mode:n.mode,mclass:o,body:[l],isCharacterBox:te.isCharacterBox(l)}},htmlBuilder:z4,mathmlBuilder:M4});Z({type:"pmb",names:["\\pmb"],props:{numArgs:1,allowedInText:!0},handler(e,t){var{parser:n}=e;return{type:"pmb",mode:n.mode,mclass:Eu(t[0]),body:Ke(t[0])}},htmlBuilder(e,t){var n=tt(e.body,t,!0),r=q.makeSpan([e.mclass],n,t);return r.style.textShadow="0.02em 0.01em 0.04px",r},mathmlBuilder(e,t){var n=Ft(e.body,t),r=new V.MathNode("mstyle",n);return r.setAttribute("style","text-shadow: 0.02em 0.01em 0.04px"),r}});var _P={">":"\\\\cdrightarrow","<":"\\\\cdleftarrow","=":"\\\\cdlongequal",A:"\\uparrow",V:"\\downarrow","|":"\\Vert",".":"no arrow"},D1=()=>({type:"styling",body:[],mode:"math",style:"display"}),T1=e=>e.type==="textord"&&e.text==="@",xP=(e,t)=>(e.type==="mathord"||e.type==="atom")&&e.text===t;function wP(e,t,n){var r=_P[e];switch(r){case"\\\\cdrightarrow":case"\\\\cdleftarrow":return n.callFunction(r,[t[0]],[t[1]]);case"\\uparrow":case"\\downarrow":{var i=n.callFunction("\\\\cdleft",[t[0]],[]),a={type:"atom",text:r,mode:"math",family:"rel"},o=n.callFunction("\\Big",[a],[]),s=n.callFunction("\\\\cdright",[t[1]],[]),l={type:"ordgroup",mode:"math",body:[i,o,s]};return n.callFunction("\\\\cdparent",[l],[])}case"\\\\cdlongequal":return n.callFunction("\\\\cdlongequal",[],[]);case"\\Vert":{var u={type:"textord",text:"\\Vert",mode:"math"};return n.callFunction("\\Big",[u],[])}default:return{type:"textord",text:" ",mode:"math"}}}function kP(e){var t=[];for(e.gullet.beginGroup(),e.gullet.macros.set("\\cr","\\\\\\relax"),e.gullet.beginGroup();;){t.push(e.parseExpression(!1,"\\\\")),e.gullet.endGroup(),e.gullet.beginGroup();var n=e.fetch().text;if(n==="&"||n==="\\\\")e.consume();else if(n==="\\end"){t[t.length-1].length===0&&t.pop();break}else throw new X("Expected \\\\ or \\cr or \\end",e.nextToken)}for(var r=[],i=[r],a=0;a<t.length;a++){for(var o=t[a],s=D1(),l=0;l<o.length;l++)if(!T1(o[l]))s.body.push(o[l]);else{r.push(s),l+=1;var u=od(o[l]).text,h=new Array(2);if(h[0]={type:"ordgroup",mode:"math",body:[]},h[1]={type:"ordgroup",mode:"math",body:[]},!("=|.".indexOf(u)>-1))if("<>AV".indexOf(u)>-1)for(var c=0;c<2;c++){for(var m=!0,d=l+1;d<o.length;d++){if(xP(o[d],u)){m=!1,l=d;break}if(T1(o[d]))throw new X("Missing a "+u+" character to complete a CD arrow.",o[d]);h[c].body.push(o[d])}if(m)throw new X("Missing a "+u+" character to complete a CD arrow.",o[l])}else throw new X('Expected one of "<>AV=|." after @',o[l]);var b=wP(u,h,e),$={type:"styling",body:[b],mode:"math",style:"display"};r.push($),s=D1()}a%2===0?r.push(s):r.shift(),r=[],i.push(r)}e.gullet.endGroup(),e.gullet.endGroup();var w=new Array(i[0].length).fill({type:"align",align:"c",pregap:.25,postgap:.25});return{type:"array",mode:"math",body:i,arraystretch:1,addJot:!0,rowGaps:[null],cols:w,colSeparationType:"CD",hLinesBeforeRow:new Array(i.length+1).fill([])}}Z({type:"cdlabel",names:["\\\\cdleft","\\\\cdright"],props:{numArgs:1},handler(e,t){var{parser:n,funcName:r}=e;return{type:"cdlabel",mode:n.mode,side:r.slice(4),label:t[0]}},htmlBuilder(e,t){var n=t.havingStyle(t.style.sup()),r=q.wrapFragment(ve(e.label,n,t),t);return r.classes.push("cd-label-"+e.side),r.style.bottom=G(.8-r.depth),r.height=0,r.depth=0,r},mathmlBuilder(e,t){var n=new V.MathNode("mrow",[Ee(e.label,t)]);return n=new V.MathNode("mpadded",[n]),n.setAttribute("width","0"),e.side==="left"&&n.setAttribute("lspace","-1width"),n.setAttribute("voffset","0.7em"),n=new V.MathNode("mstyle",[n]),n.setAttribute("displaystyle","false"),n.setAttribute("scriptlevel","1"),n}});Z({type:"cdlabelparent",names:["\\\\cdparent"],props:{numArgs:1},handler(e,t){var{parser:n}=e;return{type:"cdlabelparent",mode:n.mode,fragment:t[0]}},htmlBuilder(e,t){var n=q.wrapFragment(ve(e.fragment,t),t);return n.classes.push("cd-vert-arrow"),n},mathmlBuilder(e,t){return new V.MathNode("mrow",[Ee(e.fragment,t)])}});Z({type:"textord",names:["\\@char"],props:{numArgs:1,allowedInText:!0},handler(e,t){for(var{parser:n}=e,r=pe(t[0],"ordgroup"),i=r.body,a="",o=0;o<i.length;o++){var s=pe(i[o],"textord");a+=s.text}var l=parseInt(a),u;if(isNaN(l))throw new X("\\@char has non-numeric argument "+a);if(l<0||l>=1114111)throw new X("\\@char with invalid code point "+a);return l<=65535?u=String.fromCharCode(l):(l-=65536,u=String.fromCharCode((l>>10)+55296,(l&1023)+56320)),{type:"textord",mode:n.mode,text:u}}});var F4=(e,t)=>{var n=tt(e.body,t.withColor(e.color),!1);return q.makeFragment(n)},q4=(e,t)=>{var n=Ft(e.body,t.withColor(e.color)),r=new V.MathNode("mstyle",n);return r.setAttribute("mathcolor",e.color),r};Z({type:"color",names:["\\textcolor"],props:{numArgs:2,allowedInText:!0,argTypes:["color","original"]},handler(e,t){var{parser:n}=e,r=pe(t[0],"color-token").color,i=t[1];return{type:"color",mode:n.mode,color:r,body:Ke(i)}},htmlBuilder:F4,mathmlBuilder:q4});Z({type:"color",names:["\\color"],props:{numArgs:1,allowedInText:!0,argTypes:["color"]},handler(e,t){var{parser:n,breakOnTokenText:r}=e,i=pe(t[0],"color-token").color;n.gullet.macros.set("\\current@color",i);var a=n.parseExpression(!0,r);return{type:"color",mode:n.mode,color:i,body:a}},htmlBuilder:F4,mathmlBuilder:q4});Z({type:"cr",names:["\\\\"],props:{numArgs:0,numOptionalArgs:0,allowedInText:!0},handler(e,t,n){var{parser:r}=e,i=r.gullet.future().text==="["?r.parseSizeGroup(!0):null,a=!r.settings.displayMode||!r.settings.useStrictBehavior("newLineInDisplayMode","In LaTeX, \\\\ or \\newline does nothing in display mode");return{type:"cr",mode:r.mode,newLine:a,size:i&&pe(i,"size").value}},htmlBuilder(e,t){var n=q.makeSpan(["mspace"],[],t);return e.newLine&&(n.classes.push("newline"),e.size&&(n.style.marginTop=G(Be(e.size,t)))),n},mathmlBuilder(e,t){var n=new V.MathNode("mspace");return e.newLine&&(n.setAttribute("linebreak","newline"),e.size&&n.setAttribute("height",G(Be(e.size,t)))),n}});var h0={"\\global":"\\global","\\long":"\\\\globallong","\\\\globallong":"\\\\globallong","\\def":"\\gdef","\\gdef":"\\gdef","\\edef":"\\xdef","\\xdef":"\\xdef","\\let":"\\\\globallet","\\futurelet":"\\\\globalfuture"},R4=e=>{var t=e.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(t))throw new X("Expected a control sequence",e);return t},SP=e=>{var t=e.gullet.popToken();return t.text==="="&&(t=e.gullet.popToken(),t.text===" "&&(t=e.gullet.popToken())),t},N4=(e,t,n,r)=>{var i=e.gullet.macros.get(n.text);i==null&&(n.noexpand=!0,i={tokens:[n],numArgs:0,unexpandable:!e.gullet.isExpandable(n.text)}),e.gullet.macros.set(t,i,r)};Z({type:"internal",names:["\\global","\\long","\\\\globallong"],props:{numArgs:0,allowedInText:!0},handler(e){var{parser:t,funcName:n}=e;t.consumeSpaces();var r=t.fetch();if(h0[r.text])return(n==="\\global"||n==="\\\\globallong")&&(r.text=h0[r.text]),pe(t.parseFunction(),"internal");throw new X("Invalid token after macro prefix",r)}});Z({type:"internal",names:["\\def","\\gdef","\\edef","\\xdef"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(e){var{parser:t,funcName:n}=e,r=t.gullet.popToken(),i=r.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(i))throw new X("Expected a control sequence",r);for(var a=0,o,s=[[]];t.gullet.future().text!=="{";)if(r=t.gullet.popToken(),r.text==="#"){if(t.gullet.future().text==="{"){o=t.gullet.future(),s[a].push("{");break}if(r=t.gullet.popToken(),!/^[1-9]$/.test(r.text))throw new X('Invalid argument number "'+r.text+'"');if(parseInt(r.text)!==a+1)throw new X('Argument number "'+r.text+'" out of order');a++,s.push([])}else{if(r.text==="EOF")throw new X("Expected a macro definition");s[a].push(r.text)}var{tokens:l}=t.gullet.consumeArg();return o&&l.unshift(o),(n==="\\edef"||n==="\\xdef")&&(l=t.gullet.expandTokens(l),l.reverse()),t.gullet.macros.set(i,{tokens:l,numArgs:a,delimiters:s},n===h0[n]),{type:"internal",mode:t.mode}}});Z({type:"internal",names:["\\let","\\\\globallet"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(e){var{parser:t,funcName:n}=e,r=R4(t.gullet.popToken());t.gullet.consumeSpaces();var i=SP(t);return N4(t,r,i,n==="\\\\globallet"),{type:"internal",mode:t.mode}}});Z({type:"internal",names:["\\futurelet","\\\\globalfuture"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(e){var{parser:t,funcName:n}=e,r=R4(t.gullet.popToken()),i=t.gullet.popToken(),a=t.gullet.popToken();return N4(t,r,a,n==="\\\\globalfuture"),t.gullet.pushToken(a),t.gullet.pushToken(i),{type:"internal",mode:t.mode}}});var Qa=function(t,n,r){var i=De.math[t]&&De.math[t].replace,a=td(i||t,n,r);if(!a)throw new Error("Unsupported symbol "+t+" and font size "+n+".");return a},ld=function(t,n,r,i){var a=r.havingBaseStyle(n),o=q.makeSpan(i.concat(a.sizingClasses(r)),[t],r),s=a.sizeMultiplier/r.sizeMultiplier;return o.height*=s,o.depth*=s,o.maxFontSize=a.sizeMultiplier,o},I4=function(t,n,r){var i=n.havingBaseStyle(r),a=(1-n.sizeMultiplier/i.sizeMultiplier)*n.fontMetrics().axisHeight;t.classes.push("delimcenter"),t.style.top=G(a),t.height-=a,t.depth+=a},EP=function(t,n,r,i,a,o){var s=q.makeSymbol(t,"Main-Regular",a,i),l=ld(s,n,i,o);return r&&I4(l,i,n),l},CP=function(t,n,r,i){return q.makeSymbol(t,"Size"+n+"-Regular",r,i)},B4=function(t,n,r,i,a,o){var s=CP(t,n,a,i),l=ld(q.makeSpan(["delimsizing","size"+n],[s],i),ie.TEXT,i,o);return r&&I4(l,i,ie.TEXT),l},Dh=function(t,n,r){var i;n==="Size1-Regular"?i="delim-size1":i="delim-size4";var a=q.makeSpan(["delimsizinginner",i],[q.makeSpan([],[q.makeSymbol(t,n,r)])]);return{type:"elem",elem:a}},Th=function(t,n,r){var i=Dn["Size4-Regular"][t.charCodeAt(0)]?Dn["Size4-Regular"][t.charCodeAt(0)][4]:Dn["Size1-Regular"][t.charCodeAt(0)][4],a=new Ir("inner",MC(t,Math.round(1e3*n))),o=new ar([a],{width:G(i),height:G(n),style:"width:"+G(i),viewBox:"0 0 "+1e3*i+" "+Math.round(1e3*n),preserveAspectRatio:"xMinYMin"}),s=q.makeSvgSpan([],[o],r);return s.height=n,s.style.height=G(n),s.style.width=G(i),{type:"elem",elem:s}},c0=.008,Ls={type:"kern",size:-1*c0},PP=["|","\\lvert","\\rvert","\\vert"],DP=["\\|","\\lVert","\\rVert","\\Vert"],L4=function(t,n,r,i,a,o){var s,l,u,h,c="",m=0;s=u=h=t,l=null;var d="Size1-Regular";t==="\\uparrow"?u=h="⏐":t==="\\Uparrow"?u=h="‖":t==="\\downarrow"?s=u="⏐":t==="\\Downarrow"?s=u="‖":t==="\\updownarrow"?(s="\\uparrow",u="⏐",h="\\downarrow"):t==="\\Updownarrow"?(s="\\Uparrow",u="‖",h="\\Downarrow"):te.contains(PP,t)?(u="∣",c="vert",m=333):te.contains(DP,t)?(u="∥",c="doublevert",m=556):t==="["||t==="\\lbrack"?(s="⎡",u="⎢",h="⎣",d="Size4-Regular",c="lbrack",m=667):t==="]"||t==="\\rbrack"?(s="⎤",u="⎥",h="⎦",d="Size4-Regular",c="rbrack",m=667):t==="\\lfloor"||t==="⌊"?(u=s="⎢",h="⎣",d="Size4-Regular",c="lfloor",m=667):t==="\\lceil"||t==="⌈"?(s="⎡",u=h="⎢",d="Size4-Regular",c="lceil",m=667):t==="\\rfloor"||t==="⌋"?(u=s="⎥",h="⎦",d="Size4-Regular",c="rfloor",m=667):t==="\\rceil"||t==="⌉"?(s="⎤",u=h="⎥",d="Size4-Regular",c="rceil",m=667):t==="("||t==="\\lparen"?(s="⎛",u="⎜",h="⎝",d="Size4-Regular",c="lparen",m=875):t===")"||t==="\\rparen"?(s="⎞",u="⎟",h="⎠",d="Size4-Regular",c="rparen",m=875):t==="\\{"||t==="\\lbrace"?(s="⎧",l="⎨",h="⎩",u="⎪",d="Size4-Regular"):t==="\\}"||t==="\\rbrace"?(s="⎫",l="⎬",h="⎭",u="⎪",d="Size4-Regular"):t==="\\lgroup"||t==="⟮"?(s="⎧",h="⎩",u="⎪",d="Size4-Regular"):t==="\\rgroup"||t==="⟯"?(s="⎫",h="⎭",u="⎪",d="Size4-Regular"):t==="\\lmoustache"||t==="⎰"?(s="⎧",h="⎭",u="⎪",d="Size4-Regular"):(t==="\\rmoustache"||t==="⎱")&&(s="⎫",h="⎩",u="⎪",d="Size4-Regular");var b=Qa(s,d,a),$=b.height+b.depth,w=Qa(u,d,a),g=w.height+w.depth,y=Qa(h,d,a),_=y.height+y.depth,T=0,D=1;if(l!==null){var C=Qa(l,d,a);T=C.height+C.depth,D=2}var F=$+_+T,R=Math.max(0,Math.ceil((n-F)/(D*g))),N=F+R*D*g,O=i.fontMetrics().axisHeight;r&&(O*=i.sizeMultiplier);var U=N/2-O,B=[];if(c.length>0){var he=N-$-_,ue=Math.round(N*1e3),ae=FC(c,Math.round(he*1e3)),be=new Ir(c,ae),le=(m/1e3).toFixed(3)+"em",j=(ue/1e3).toFixed(3)+"em",J=new ar([be],{width:le,height:j,viewBox:"0 0 "+m+" "+ue}),k=q.makeSvgSpan([],[J],i);k.height=ue/1e3,k.style.width=le,k.style.height=j,B.push({type:"elem",elem:k})}else{if(B.push(Dh(h,d,a)),B.push(Ls),l===null){var ne=N-$-_+2*c0;B.push(Th(u,ne,i))}else{var de=(N-$-_-T)/2+2*c0;B.push(Th(u,de,i)),B.push(Ls),B.push(Dh(l,d,a)),B.push(Ls),B.push(Th(u,de,i))}B.push(Ls),B.push(Dh(s,d,a))}var A=i.havingBaseStyle(ie.TEXT),Re=q.makeVList({positionType:"bottom",positionData:U,children:B},A);return ld(q.makeSpan(["delimsizing","mult"],[Re],A),ie.TEXT,i,o)},Ah=80,zh=.08,Mh=function(t,n,r,i,a){var o=zC(t,i,r),s=new Ir(t,o),l=new ar([s],{width:"400em",height:G(n),viewBox:"0 0 400000 "+r,preserveAspectRatio:"xMinYMin slice"});return q.makeSvgSpan(["hide-tail"],[l],a)},TP=function(t,n){var r=n.havingBaseSizing(),i=W4("\\surd",t*r.sizeMultiplier,V4,r),a=r.sizeMultiplier,o=Math.max(0,n.minRuleThickness-n.fontMetrics().sqrtRuleThickness),s,l=0,u=0,h=0,c;return i.type==="small"?(h=1e3+1e3*o+Ah,t<1?a=1:t<1.4&&(a=.7),l=(1+o+zh)/a,u=(1+o)/a,s=Mh("sqrtMain",l,h,o,n),s.style.minWidth="0.853em",c=.833/a):i.type==="large"?(h=(1e3+Ah)*fo[i.size],u=(fo[i.size]+o)/a,l=(fo[i.size]+o+zh)/a,s=Mh("sqrtSize"+i.size,l,h,o,n),s.style.minWidth="1.02em",c=1/a):(l=t+o+zh,u=t+o,h=Math.floor(1e3*t+o)+Ah,s=Mh("sqrtTall",l,h,o,n),s.style.minWidth="0.742em",c=1.056),s.height=u,s.style.height=G(l),{span:s,advanceWidth:c,ruleWidth:(n.fontMetrics().sqrtRuleThickness+o)*a}},O4=["(","\\lparen",")","\\rparen","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","\\lfloor","\\rfloor","⌊","⌋","\\lceil","\\rceil","⌈","⌉","\\surd"],AP=["\\uparrow","\\downarrow","\\updownarrow","\\Uparrow","\\Downarrow","\\Updownarrow","|","\\|","\\vert","\\Vert","\\lvert","\\rvert","\\lVert","\\rVert","\\lgroup","\\rgroup","⟮","⟯","\\lmoustache","\\rmoustache","⎰","⎱"],j4=["<",">","\\langle","\\rangle","/","\\backslash","\\lt","\\gt"],fo=[0,1.2,1.8,2.4,3],zP=function(t,n,r,i,a){if(t==="<"||t==="\\lt"||t==="⟨"?t="\\langle":(t===">"||t==="\\gt"||t==="⟩")&&(t="\\rangle"),te.contains(O4,t)||te.contains(j4,t))return B4(t,n,!1,r,i,a);if(te.contains(AP,t))return L4(t,fo[n],!1,r,i,a);throw new X("Illegal delimiter: '"+t+"'")},MP=[{type:"small",style:ie.SCRIPTSCRIPT},{type:"small",style:ie.SCRIPT},{type:"small",style:ie.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4}],FP=[{type:"small",style:ie.SCRIPTSCRIPT},{type:"small",style:ie.SCRIPT},{type:"small",style:ie.TEXT},{type:"stack"}],V4=[{type:"small",style:ie.SCRIPTSCRIPT},{type:"small",style:ie.SCRIPT},{type:"small",style:ie.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4},{type:"stack"}],qP=function(t){if(t.type==="small")return"Main-Regular";if(t.type==="large")return"Size"+t.size+"-Regular";if(t.type==="stack")return"Size4-Regular";throw new Error("Add support for delim type '"+t.type+"' here.")},W4=function(t,n,r,i){for(var a=Math.min(2,3-i.style.size),o=a;o<r.length&&r[o].type!=="stack";o++){var s=Qa(t,qP(r[o]),"math"),l=s.height+s.depth;if(r[o].type==="small"){var u=i.havingBaseStyle(r[o].style);l*=u.sizeMultiplier}if(l>n)return r[o]}return r[r.length-1]},X4=function(t,n,r,i,a,o){t==="<"||t==="\\lt"||t==="⟨"?t="\\langle":(t===">"||t==="\\gt"||t==="⟩")&&(t="\\rangle");var s;te.contains(j4,t)?s=MP:te.contains(O4,t)?s=V4:s=FP;var l=W4(t,n,s,i);return l.type==="small"?EP(t,l.style,r,i,a,o):l.type==="large"?B4(t,l.size,r,i,a,o):L4(t,n,r,i,a,o)},RP=function(t,n,r,i,a,o){var s=i.fontMetrics().axisHeight*i.sizeMultiplier,l=901,u=5/i.fontMetrics().ptPerEm,h=Math.max(n-s,r+s),c=Math.max(h/500*l,2*h-u);return X4(t,c,!0,i,a,o)},Qn={sqrtImage:TP,sizedDelim:zP,sizeToMaxHeight:fo,customSizedDelim:X4,leftRightDelim:RP},A1={"\\bigl":{mclass:"mopen",size:1},"\\Bigl":{mclass:"mopen",size:2},"\\biggl":{mclass:"mopen",size:3},"\\Biggl":{mclass:"mopen",size:4},"\\bigr":{mclass:"mclose",size:1},"\\Bigr":{mclass:"mclose",size:2},"\\biggr":{mclass:"mclose",size:3},"\\Biggr":{mclass:"mclose",size:4},"\\bigm":{mclass:"mrel",size:1},"\\Bigm":{mclass:"mrel",size:2},"\\biggm":{mclass:"mrel",size:3},"\\Biggm":{mclass:"mrel",size:4},"\\big":{mclass:"mord",size:1},"\\Big":{mclass:"mord",size:2},"\\bigg":{mclass:"mord",size:3},"\\Bigg":{mclass:"mord",size:4}},NP=["(","\\lparen",")","\\rparen","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","\\lfloor","\\rfloor","⌊","⌋","\\lceil","\\rceil","⌈","⌉","<",">","\\langle","⟨","\\rangle","⟩","\\lt","\\gt","\\lvert","\\rvert","\\lVert","\\rVert","\\lgroup","\\rgroup","⟮","⟯","\\lmoustache","\\rmoustache","⎰","⎱","/","\\backslash","|","\\vert","\\|","\\Vert","\\uparrow","\\Uparrow","\\downarrow","\\Downarrow","\\updownarrow","\\Updownarrow","."];function Cu(e,t){var n=Su(e);if(n&&te.contains(NP,n.text))return n;throw n?new X("Invalid delimiter '"+n.text+"' after '"+t.funcName+"'",e):new X("Invalid delimiter type '"+e.type+"'",e)}Z({type:"delimsizing",names:["\\bigl","\\Bigl","\\biggl","\\Biggl","\\bigr","\\Bigr","\\biggr","\\Biggr","\\bigm","\\Bigm","\\biggm","\\Biggm","\\big","\\Big","\\bigg","\\Bigg"],props:{numArgs:1,argTypes:["primitive"]},handler:(e,t)=>{var n=Cu(t[0],e);return{type:"delimsizing",mode:e.parser.mode,size:A1[e.funcName].size,mclass:A1[e.funcName].mclass,delim:n.text}},htmlBuilder:(e,t)=>e.delim==="."?q.makeSpan([e.mclass]):Qn.sizedDelim(e.delim,e.size,t,e.mode,[e.mclass]),mathmlBuilder:e=>{var t=[];e.delim!=="."&&t.push(sn(e.delim,e.mode));var n=new V.MathNode("mo",t);e.mclass==="mopen"||e.mclass==="mclose"?n.setAttribute("fence","true"):n.setAttribute("fence","false"),n.setAttribute("stretchy","true");var r=G(Qn.sizeToMaxHeight[e.size]);return n.setAttribute("minsize",r),n.setAttribute("maxsize",r),n}});function z1(e){if(!e.body)throw new Error("Bug: The leftright ParseNode wasn't fully parsed.")}Z({type:"leftright-right",names:["\\right"],props:{numArgs:1,primitive:!0},handler:(e,t)=>{var n=e.parser.gullet.macros.get("\\current@color");if(n&&typeof n!="string")throw new X("\\current@color set to non-string in \\right");return{type:"leftright-right",mode:e.parser.mode,delim:Cu(t[0],e).text,color:n}}});Z({type:"leftright",names:["\\left"],props:{numArgs:1,primitive:!0},handler:(e,t)=>{var n=Cu(t[0],e),r=e.parser;++r.leftrightDepth;var i=r.parseExpression(!1);--r.leftrightDepth,r.expect("\\right",!1);var a=pe(r.parseFunction(),"leftright-right");return{type:"leftright",mode:r.mode,body:i,left:n.text,right:a.delim,rightColor:a.color}},htmlBuilder:(e,t)=>{z1(e);for(var n=tt(e.body,t,!0,["mopen","mclose"]),r=0,i=0,a=!1,o=0;o<n.length;o++)n[o].isMiddle?a=!0:(r=Math.max(n[o].height,r),i=Math.max(n[o].depth,i));r*=t.sizeMultiplier,i*=t.sizeMultiplier;var s;if(e.left==="."?s=Lo(t,["mopen"]):s=Qn.leftRightDelim(e.left,r,i,t,e.mode,["mopen"]),n.unshift(s),a)for(var l=1;l<n.length;l++){var u=n[l],h=u.isMiddle;h&&(n[l]=Qn.leftRightDelim(h.delim,r,i,h.options,e.mode,[]))}var c;if(e.right===".")c=Lo(t,["mclose"]);else{var m=e.rightColor?t.withColor(e.rightColor):t;c=Qn.leftRightDelim(e.right,r,i,m,e.mode,["mclose"])}return n.push(c),q.makeSpan(["minner"],n,t)},mathmlBuilder:(e,t)=>{z1(e);var n=Ft(e.body,t);if(e.left!=="."){var r=new V.MathNode("mo",[sn(e.left,e.mode)]);r.setAttribute("fence","true"),n.unshift(r)}if(e.right!=="."){var i=new V.MathNode("mo",[sn(e.right,e.mode)]);i.setAttribute("fence","true"),e.rightColor&&i.setAttribute("mathcolor",e.rightColor),n.push(i)}return id(n)}});Z({type:"middle",names:["\\middle"],props:{numArgs:1,primitive:!0},handler:(e,t)=>{var n=Cu(t[0],e);if(!e.parser.leftrightDepth)throw new X("\\middle without preceding \\left",n);return{type:"middle",mode:e.parser.mode,delim:n.text}},htmlBuilder:(e,t)=>{var n;if(e.delim===".")n=Lo(t,[]);else{n=Qn.sizedDelim(e.delim,1,t,e.mode,[]);var r={delim:e.delim,options:t};n.isMiddle=r}return n},mathmlBuilder:(e,t)=>{var n=e.delim==="\\vert"||e.delim==="|"?sn("|","text"):sn(e.delim,e.mode),r=new V.MathNode("mo",[n]);return r.setAttribute("fence","true"),r.setAttribute("lspace","0.05em"),r.setAttribute("rspace","0.05em"),r}});var ud=(e,t)=>{var n=q.wrapFragment(ve(e.body,t),t),r=e.label.slice(1),i=t.sizeMultiplier,a,o=0,s=te.isCharacterBox(e.body);if(r==="sout")a=q.makeSpan(["stretchy","sout"]),a.height=t.fontMetrics().defaultRuleThickness/i,o=-.5*t.fontMetrics().xHeight;else if(r==="phase"){var l=Be({number:.6,unit:"pt"},t),u=Be({number:.35,unit:"ex"},t),h=t.havingBaseSizing();i=i/h.sizeMultiplier;var c=n.height+n.depth+l+u;n.style.paddingLeft=G(c/2+l);var m=Math.floor(1e3*c*i),d=TC(m),b=new ar([new Ir("phase",d)],{width:"400em",height:G(m/1e3),viewBox:"0 0 400000 "+m,preserveAspectRatio:"xMinYMin slice"});a=q.makeSvgSpan(["hide-tail"],[b],t),a.style.height=G(c),o=n.depth+l+u}else{/cancel/.test(r)?s||n.classes.push("cancel-pad"):r==="angl"?n.classes.push("anglpad"):n.classes.push("boxpad");var $=0,w=0,g=0;/box/.test(r)?(g=Math.max(t.fontMetrics().fboxrule,t.minRuleThickness),$=t.fontMetrics().fboxsep+(r==="colorbox"?0:g),w=$):r==="angl"?(g=Math.max(t.fontMetrics().defaultRuleThickness,t.minRuleThickness),$=4*g,w=Math.max(0,.25-n.depth)):($=s?.2:0,w=$),a=sr.encloseSpan(n,r,$,w,t),/fbox|boxed|fcolorbox/.test(r)?(a.style.borderStyle="solid",a.style.borderWidth=G(g)):r==="angl"&&g!==.049&&(a.style.borderTopWidth=G(g),a.style.borderRightWidth=G(g)),o=n.depth+w,e.backgroundColor&&(a.style.backgroundColor=e.backgroundColor,e.borderColor&&(a.style.borderColor=e.borderColor))}var y;if(e.backgroundColor)y=q.makeVList({positionType:"individualShift",children:[{type:"elem",elem:a,shift:o},{type:"elem",elem:n,shift:0}]},t);else{var _=/cancel|phase/.test(r)?["svg-align"]:[];y=q.makeVList({positionType:"individualShift",children:[{type:"elem",elem:n,shift:0},{type:"elem",elem:a,shift:o,wrapperClasses:_}]},t)}return/cancel/.test(r)&&(y.height=n.height,y.depth=n.depth),/cancel/.test(r)&&!s?q.makeSpan(["mord","cancel-lap"],[y],t):q.makeSpan(["mord"],[y],t)},hd=(e,t)=>{var n=0,r=new V.MathNode(e.label.indexOf("colorbox")>-1?"mpadded":"menclose",[Ee(e.body,t)]);switch(e.label){case"\\cancel":r.setAttribute("notation","updiagonalstrike");break;case"\\bcancel":r.setAttribute("notation","downdiagonalstrike");break;case"\\phase":r.setAttribute("notation","phasorangle");break;case"\\sout":r.setAttribute("notation","horizontalstrike");break;case"\\fbox":r.setAttribute("notation","box");break;case"\\angl":r.setAttribute("notation","actuarial");break;case"\\fcolorbox":case"\\colorbox":if(n=t.fontMetrics().fboxsep*t.fontMetrics().ptPerEm,r.setAttribute("width","+"+2*n+"pt"),r.setAttribute("height","+"+2*n+"pt"),r.setAttribute("lspace",n+"pt"),r.setAttribute("voffset",n+"pt"),e.label==="\\fcolorbox"){var i=Math.max(t.fontMetrics().fboxrule,t.minRuleThickness);r.setAttribute("style","border: "+i+"em solid "+String(e.borderColor))}break;case"\\xcancel":r.setAttribute("notation","updiagonalstrike downdiagonalstrike");break}return e.backgroundColor&&r.setAttribute("mathbackground",e.backgroundColor),r};Z({type:"enclose",names:["\\colorbox"],props:{numArgs:2,allowedInText:!0,argTypes:["color","text"]},handler(e,t,n){var{parser:r,funcName:i}=e,a=pe(t[0],"color-token").color,o=t[1];return{type:"enclose",mode:r.mode,label:i,backgroundColor:a,body:o}},htmlBuilder:ud,mathmlBuilder:hd});Z({type:"enclose",names:["\\fcolorbox"],props:{numArgs:3,allowedInText:!0,argTypes:["color","color","text"]},handler(e,t,n){var{parser:r,funcName:i}=e,a=pe(t[0],"color-token").color,o=pe(t[1],"color-token").color,s=t[2];return{type:"enclose",mode:r.mode,label:i,backgroundColor:o,borderColor:a,body:s}},htmlBuilder:ud,mathmlBuilder:hd});Z({type:"enclose",names:["\\fbox"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!0},handler(e,t){var{parser:n}=e;return{type:"enclose",mode:n.mode,label:"\\fbox",body:t[0]}}});Z({type:"enclose",names:["\\cancel","\\bcancel","\\xcancel","\\sout","\\phase"],props:{numArgs:1},handler(e,t){var{parser:n,funcName:r}=e,i=t[0];return{type:"enclose",mode:n.mode,label:r,body:i}},htmlBuilder:ud,mathmlBuilder:hd});Z({type:"enclose",names:["\\angl"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!1},handler(e,t){var{parser:n}=e;return{type:"enclose",mode:n.mode,label:"\\angl",body:t[0]}}});var U4={};function Nn(e){for(var{type:t,names:n,props:r,handler:i,htmlBuilder:a,mathmlBuilder:o}=e,s={type:t,numArgs:r.numArgs||0,allowedInText:!1,numOptionalArgs:0,handler:i},l=0;l<n.length;++l)U4[n[l]]=s;a&&(Wl[t]=a),o&&(Xl[t]=o)}var H4={};function x(e,t){H4[e]=t}function M1(e){var t=[];e.consumeSpaces();var n=e.fetch().text;for(n==="\\relax"&&(e.consume(),e.consumeSpaces(),n=e.fetch().text);n==="\\hline"||n==="\\hdashline";)e.consume(),t.push(n==="\\hdashline"),e.consumeSpaces(),n=e.fetch().text;return t}var Pu=e=>{var t=e.parser.settings;if(!t.displayMode)throw new X("{"+e.envName+"} can be used only in display mode.")};function cd(e){if(e.indexOf("ed")===-1)return e.indexOf("*")===-1}function Ur(e,t,n){var{hskipBeforeAndAfter:r,addJot:i,cols:a,arraystretch:o,colSeparationType:s,autoTag:l,singleRow:u,emptySingleRow:h,maxNumCols:c,leqno:m}=t;if(e.gullet.beginGroup(),u||e.gullet.macros.set("\\cr","\\\\\\relax"),!o){var d=e.gullet.expandMacroAsText("\\arraystretch");if(d==null)o=1;else if(o=parseFloat(d),!o||o<0)throw new X("Invalid \\arraystretch: "+d)}e.gullet.beginGroup();var b=[],$=[b],w=[],g=[],y=l!=null?[]:void 0;function _(){l&&e.gullet.macros.set("\\@eqnsw","1",!0)}function T(){y&&(e.gullet.macros.get("\\df@tag")?(y.push(e.subparse([new nn("\\df@tag")])),e.gullet.macros.set("\\df@tag",void 0,!0)):y.push(!!l&&e.gullet.macros.get("\\@eqnsw")==="1"))}for(_(),g.push(M1(e));;){var D=e.parseExpression(!1,u?"\\end":"\\\\");e.gullet.endGroup(),e.gullet.beginGroup(),D={type:"ordgroup",mode:e.mode,body:D},n&&(D={type:"styling",mode:e.mode,style:n,body:[D]}),b.push(D);var C=e.fetch().text;if(C==="&"){if(c&&b.length===c){if(u||s)throw new X("Too many tab characters: &",e.nextToken);e.settings.reportNonstrict("textEnv","Too few columns specified in the {array} column argument.")}e.consume()}else if(C==="\\end"){T(),b.length===1&&D.type==="styling"&&D.body[0].body.length===0&&($.length>1||!h)&&$.pop(),g.length<$.length+1&&g.push([]);break}else if(C==="\\\\"){e.consume();var F=void 0;e.gullet.future().text!==" "&&(F=e.parseSizeGroup(!0)),w.push(F?F.value:null),T(),g.push(M1(e)),b=[],$.push(b),_()}else throw new X("Expected & or \\\\ or \\cr or \\end",e.nextToken)}return e.gullet.endGroup(),e.gullet.endGroup(),{type:"array",mode:e.mode,addJot:i,arraystretch:o,body:$,cols:a,rowGaps:w,hskipBeforeAndAfter:r,hLinesBeforeRow:g,colSeparationType:s,tags:y,leqno:m}}function md(e){return e.slice(0,1)==="d"?"display":"text"}var In=function(t,n){var r,i,a=t.body.length,o=t.hLinesBeforeRow,s=0,l=new Array(a),u=[],h=Math.max(n.fontMetrics().arrayRuleWidth,n.minRuleThickness),c=1/n.fontMetrics().ptPerEm,m=5*c;if(t.colSeparationType&&t.colSeparationType==="small"){var d=n.havingStyle(ie.SCRIPT).sizeMultiplier;m=.2778*(d/n.sizeMultiplier)}var b=t.colSeparationType==="CD"?Be({number:3,unit:"ex"},n):12*c,$=3*c,w=t.arraystretch*b,g=.7*w,y=.3*w,_=0;function T(Ci){for(var Gr=0;Gr<Ci.length;++Gr)Gr>0&&(_+=.25),u.push({pos:_,isDashed:Ci[Gr]})}for(T(o[0]),r=0;r<t.body.length;++r){var D=t.body[r],C=g,F=y;s<D.length&&(s=D.length);var R=new Array(D.length);for(i=0;i<D.length;++i){var N=ve(D[i],n);F<N.depth&&(F=N.depth),C<N.height&&(C=N.height),R[i]=N}var O=t.rowGaps[r],U=0;O&&(U=Be(O,n),U>0&&(U+=y,F<U&&(F=U),U=0)),t.addJot&&(F+=$),R.height=C,R.depth=F,_+=C,R.pos=_,_+=F+U,l[r]=R,T(o[r+1])}var B=_/2+n.fontMetrics().axisHeight,he=t.cols||[],ue=[],ae,be,le=[];if(t.tags&&t.tags.some(Ci=>Ci))for(r=0;r<a;++r){var j=l[r],J=j.pos-B,k=t.tags[r],ne=void 0;k===!0?ne=q.makeSpan(["eqn-num"],[],n):k===!1?ne=q.makeSpan([],[],n):ne=q.makeSpan([],tt(k,n,!0),n),ne.depth=j.depth,ne.height=j.height,le.push({type:"elem",elem:ne,shift:J})}for(i=0,be=0;i<s||be<he.length;++i,++be){for(var de=he[be]||{},A=!0;de.type==="separator";){if(A||(ae=q.makeSpan(["arraycolsep"],[]),ae.style.width=G(n.fontMetrics().doubleRuleSep),ue.push(ae)),de.separator==="|"||de.separator===":"){var Re=de.separator==="|"?"solid":"dashed",nt=q.makeSpan(["vertical-separator"],[],n);nt.style.height=G(_),nt.style.borderRightWidth=G(h),nt.style.borderRightStyle=Re,nt.style.margin="0 "+G(-h/2);var ke=_-B;ke&&(nt.style.verticalAlign=G(-ke)),ue.push(nt)}else throw new X("Invalid separator type: "+de.separator);be++,de=he[be]||{},A=!1}if(!(i>=s)){var at=void 0;(i>0||t.hskipBeforeAndAfter)&&(at=te.deflt(de.pregap,m),at!==0&&(ae=q.makeSpan(["arraycolsep"],[]),ae.style.width=G(at),ue.push(ae)));var bt=[];for(r=0;r<a;++r){var un=l[r],hn=un[i];if(hn){var Si=un.pos-B;hn.depth=un.depth,hn.height=un.height,bt.push({type:"elem",elem:hn,shift:Si})}}bt=q.makeVList({positionType:"individualShift",children:bt},n),bt=q.makeSpan(["col-align-"+(de.align||"c")],[bt]),ue.push(bt),(i<s-1||t.hskipBeforeAndAfter)&&(at=te.deflt(de.postgap,m),at!==0&&(ae=q.makeSpan(["arraycolsep"],[]),ae.style.width=G(at),ue.push(ae)))}}if(l=q.makeSpan(["mtable"],ue),u.length>0){for(var qu=q.makeLineSpan("hline",n,h),Ru=q.makeLineSpan("hdashline",n,h),Da=[{type:"elem",elem:l,shift:0}];u.length>0;){var Ta=u.pop(),Aa=Ta.pos-B;Ta.isDashed?Da.push({type:"elem",elem:Ru,shift:Aa}):Da.push({type:"elem",elem:qu,shift:Aa})}l=q.makeVList({positionType:"individualShift",children:Da},n)}if(le.length===0)return q.makeSpan(["mord"],[l],n);var Ei=q.makeVList({positionType:"individualShift",children:le},n);return Ei=q.makeSpan(["tag"],[Ei],n),q.makeFragment([l,Ei])},IP={c:"center ",l:"left ",r:"right "},Bn=function(t,n){for(var r=[],i=new V.MathNode("mtd",[],["mtr-glue"]),a=new V.MathNode("mtd",[],["mml-eqn-num"]),o=0;o<t.body.length;o++){for(var s=t.body[o],l=[],u=0;u<s.length;u++)l.push(new V.MathNode("mtd",[Ee(s[u],n)]));t.tags&&t.tags[o]&&(l.unshift(i),l.push(i),t.leqno?l.unshift(a):l.push(a)),r.push(new V.MathNode("mtr",l))}var h=new V.MathNode("mtable",r),c=t.arraystretch===.5?.1:.16+t.arraystretch-1+(t.addJot?.09:0);h.setAttribute("rowspacing",G(c));var m="",d="";if(t.cols&&t.cols.length>0){var b=t.cols,$="",w=!1,g=0,y=b.length;b[0].type==="separator"&&(m+="top ",g=1),b[b.length-1].type==="separator"&&(m+="bottom ",y-=1);for(var _=g;_<y;_++)b[_].type==="align"?(d+=IP[b[_].align],w&&($+="none "),w=!0):b[_].type==="separator"&&w&&($+=b[_].separator==="|"?"solid ":"dashed ",w=!1);h.setAttribute("columnalign",d.trim()),/[sd]/.test($)&&h.setAttribute("columnlines",$.trim())}if(t.colSeparationType==="align"){for(var T=t.cols||[],D="",C=1;C<T.length;C++)D+=C%2?"0em ":"1em ";h.setAttribute("columnspacing",D.trim())}else t.colSeparationType==="alignat"||t.colSeparationType==="gather"?h.setAttribute("columnspacing","0em"):t.colSeparationType==="small"?h.setAttribute("columnspacing","0.2778em"):t.colSeparationType==="CD"?h.setAttribute("columnspacing","0.5em"):h.setAttribute("columnspacing","1em");var F="",R=t.hLinesBeforeRow;m+=R[0].length>0?"left ":"",m+=R[R.length-1].length>0?"right ":"";for(var N=1;N<R.length-1;N++)F+=R[N].length===0?"none ":R[N][0]?"dashed ":"solid ";return/[sd]/.test(F)&&h.setAttribute("rowlines",F.trim()),m!==""&&(h=new V.MathNode("menclose",[h]),h.setAttribute("notation",m.trim())),t.arraystretch&&t.arraystretch<1&&(h=new V.MathNode("mstyle",[h]),h.setAttribute("scriptlevel","1")),h},G4=function(t,n){t.envName.indexOf("ed")===-1&&Pu(t);var r=[],i=t.envName.indexOf("at")>-1?"alignat":"align",a=t.envName==="split",o=Ur(t.parser,{cols:r,addJot:!0,autoTag:a?void 0:cd(t.envName),emptySingleRow:!0,colSeparationType:i,maxNumCols:a?2:void 0,leqno:t.parser.settings.leqno},"display"),s,l=0,u={type:"ordgroup",mode:t.mode,body:[]};if(n[0]&&n[0].type==="ordgroup"){for(var h="",c=0;c<n[0].body.length;c++){var m=pe(n[0].body[c],"textord");h+=m.text}s=Number(h),l=s*2}var d=!l;o.body.forEach(function(g){for(var y=1;y<g.length;y+=2){var _=pe(g[y],"styling"),T=pe(_.body[0],"ordgroup");T.body.unshift(u)}if(d)l<g.length&&(l=g.length);else{var D=g.length/2;if(s<D)throw new X("Too many math in a row: "+("expected "+s+", but got "+D),g[0])}});for(var b=0;b<l;++b){var $="r",w=0;b%2===1?$="l":b>0&&d&&(w=1),r[b]={type:"align",align:$,pregap:w,postgap:0}}return o.colSeparationType=d?"align":"alignat",o};Nn({type:"array",names:["array","darray"],props:{numArgs:1},handler(e,t){var n=Su(t[0]),r=n?[t[0]]:pe(t[0],"ordgroup").body,i=r.map(function(o){var s=od(o),l=s.text;if("lcr".indexOf(l)!==-1)return{type:"align",align:l};if(l==="|")return{type:"separator",separator:"|"};if(l===":")return{type:"separator",separator:":"};throw new X("Unknown column alignment: "+l,o)}),a={cols:i,hskipBeforeAndAfter:!0,maxNumCols:i.length};return Ur(e.parser,a,md(e.envName))},htmlBuilder:In,mathmlBuilder:Bn});Nn({type:"array",names:["matrix","pmatrix","bmatrix","Bmatrix","vmatrix","Vmatrix","matrix*","pmatrix*","bmatrix*","Bmatrix*","vmatrix*","Vmatrix*"],props:{numArgs:0},handler(e){var t={matrix:null,pmatrix:["(",")"],bmatrix:["[","]"],Bmatrix:["\\{","\\}"],vmatrix:["|","|"],Vmatrix:["\\Vert","\\Vert"]}[e.envName.replace("*","")],n="c",r={hskipBeforeAndAfter:!1,cols:[{type:"align",align:n}]};if(e.envName.charAt(e.envName.length-1)==="*"){var i=e.parser;if(i.consumeSpaces(),i.fetch().text==="["){if(i.consume(),i.consumeSpaces(),n=i.fetch().text,"lcr".indexOf(n)===-1)throw new X("Expected l or c or r",i.nextToken);i.consume(),i.consumeSpaces(),i.expect("]"),i.consume(),r.cols=[{type:"align",align:n}]}}var a=Ur(e.parser,r,md(e.envName)),o=Math.max(0,...a.body.map(s=>s.length));return a.cols=new Array(o).fill({type:"align",align:n}),t?{type:"leftright",mode:e.mode,body:[a],left:t[0],right:t[1],rightColor:void 0}:a},htmlBuilder:In,mathmlBuilder:Bn});Nn({type:"array",names:["smallmatrix"],props:{numArgs:0},handler(e){var t={arraystretch:.5},n=Ur(e.parser,t,"script");return n.colSeparationType="small",n},htmlBuilder:In,mathmlBuilder:Bn});Nn({type:"array",names:["subarray"],props:{numArgs:1},handler(e,t){var n=Su(t[0]),r=n?[t[0]]:pe(t[0],"ordgroup").body,i=r.map(function(o){var s=od(o),l=s.text;if("lc".indexOf(l)!==-1)return{type:"align",align:l};throw new X("Unknown column alignment: "+l,o)});if(i.length>1)throw new X("{subarray} can contain only one column");var a={cols:i,hskipBeforeAndAfter:!1,arraystretch:.5};if(a=Ur(e.parser,a,"script"),a.body.length>0&&a.body[0].length>1)throw new X("{subarray} can contain only one column");return a},htmlBuilder:In,mathmlBuilder:Bn});Nn({type:"array",names:["cases","dcases","rcases","drcases"],props:{numArgs:0},handler(e){var t={arraystretch:1.2,cols:[{type:"align",align:"l",pregap:0,postgap:1},{type:"align",align:"l",pregap:0,postgap:0}]},n=Ur(e.parser,t,md(e.envName));return{type:"leftright",mode:e.mode,body:[n],left:e.envName.indexOf("r")>-1?".":"\\{",right:e.envName.indexOf("r")>-1?"\\}":".",rightColor:void 0}},htmlBuilder:In,mathmlBuilder:Bn});Nn({type:"array",names:["align","align*","aligned","split"],props:{numArgs:0},handler:G4,htmlBuilder:In,mathmlBuilder:Bn});Nn({type:"array",names:["gathered","gather","gather*"],props:{numArgs:0},handler(e){te.contains(["gather","gather*"],e.envName)&&Pu(e);var t={cols:[{type:"align",align:"c"}],addJot:!0,colSeparationType:"gather",autoTag:cd(e.envName),emptySingleRow:!0,leqno:e.parser.settings.leqno};return Ur(e.parser,t,"display")},htmlBuilder:In,mathmlBuilder:Bn});Nn({type:"array",names:["alignat","alignat*","alignedat"],props:{numArgs:1},handler:G4,htmlBuilder:In,mathmlBuilder:Bn});Nn({type:"array",names:["equation","equation*"],props:{numArgs:0},handler(e){Pu(e);var t={autoTag:cd(e.envName),emptySingleRow:!0,singleRow:!0,maxNumCols:1,leqno:e.parser.settings.leqno};return Ur(e.parser,t,"display")},htmlBuilder:In,mathmlBuilder:Bn});Nn({type:"array",names:["CD"],props:{numArgs:0},handler(e){return Pu(e),kP(e.parser)},htmlBuilder:In,mathmlBuilder:Bn});x("\\nonumber","\\gdef\\@eqnsw{0}");x("\\notag","\\nonumber");Z({type:"text",names:["\\hline","\\hdashline"],props:{numArgs:0,allowedInText:!0,allowedInMath:!0},handler(e,t){throw new X(e.funcName+" valid only within array environment")}});var F1=U4;Z({type:"environment",names:["\\begin","\\end"],props:{numArgs:1,argTypes:["text"]},handler(e,t){var{parser:n,funcName:r}=e,i=t[0];if(i.type!=="ordgroup")throw new X("Invalid environment name",i);for(var a="",o=0;o<i.body.length;++o)a+=pe(i.body[o],"textord").text;if(r==="\\begin"){if(!F1.hasOwnProperty(a))throw new X("No such environment: "+a,i);var s=F1[a],{args:l,optArgs:u}=n.parseArguments("\\begin{"+a+"}",s),h={mode:n.mode,envName:a,parser:n},c=s.handler(h,l,u);n.expect("\\end",!1);var m=n.nextToken,d=pe(n.parseFunction(),"environment");if(d.name!==a)throw new X("Mismatch: \\begin{"+a+"} matched by \\end{"+d.name+"}",m);return c}return{type:"environment",mode:n.mode,name:a,nameGroup:i}}});var K4=(e,t)=>{var n=e.font,r=t.withFont(n);return ve(e.body,r)},Z4=(e,t)=>{var n=e.font,r=t.withFont(n);return Ee(e.body,r)},q1={"\\Bbb":"\\mathbb","\\bold":"\\mathbf","\\frak":"\\mathfrak","\\bm":"\\boldsymbol"};Z({type:"font",names:["\\mathrm","\\mathit","\\mathbf","\\mathnormal","\\mathsfit","\\mathbb","\\mathcal","\\mathfrak","\\mathscr","\\mathsf","\\mathtt","\\Bbb","\\bold","\\frak"],props:{numArgs:1,allowedInArgument:!0},handler:(e,t)=>{var{parser:n,funcName:r}=e,i=Ul(t[0]),a=r;return a in q1&&(a=q1[a]),{type:"font",mode:n.mode,font:a.slice(1),body:i}},htmlBuilder:K4,mathmlBuilder:Z4});Z({type:"mclass",names:["\\boldsymbol","\\bm"],props:{numArgs:1},handler:(e,t)=>{var{parser:n}=e,r=t[0],i=te.isCharacterBox(r);return{type:"mclass",mode:n.mode,mclass:Eu(r),body:[{type:"font",mode:n.mode,font:"boldsymbol",body:r}],isCharacterBox:i}}});Z({type:"font",names:["\\rm","\\sf","\\tt","\\bf","\\it","\\cal"],props:{numArgs:0,allowedInText:!0},handler:(e,t)=>{var{parser:n,funcName:r,breakOnTokenText:i}=e,{mode:a}=n,o=n.parseExpression(!0,i),s="math"+r.slice(1);return{type:"font",mode:a,font:s,body:{type:"ordgroup",mode:n.mode,body:o}}},htmlBuilder:K4,mathmlBuilder:Z4});var Y4=(e,t)=>{var n=t;return e==="display"?n=n.id>=ie.SCRIPT.id?n.text():ie.DISPLAY:e==="text"&&n.size===ie.DISPLAY.size?n=ie.TEXT:e==="script"?n=ie.SCRIPT:e==="scriptscript"&&(n=ie.SCRIPTSCRIPT),n},dd=(e,t)=>{var n=Y4(e.size,t.style),r=n.fracNum(),i=n.fracDen(),a;a=t.havingStyle(r);var o=ve(e.numer,a,t);if(e.continued){var s=8.5/t.fontMetrics().ptPerEm,l=3.5/t.fontMetrics().ptPerEm;o.height=o.height<s?s:o.height,o.depth=o.depth<l?l:o.depth}a=t.havingStyle(i);var u=ve(e.denom,a,t),h,c,m;e.hasBarLine?(e.barSize?(c=Be(e.barSize,t),h=q.makeLineSpan("frac-line",t,c)):h=q.makeLineSpan("frac-line",t),c=h.height,m=h.height):(h=null,c=0,m=t.fontMetrics().defaultRuleThickness);var d,b,$;n.size===ie.DISPLAY.size||e.size==="display"?(d=t.fontMetrics().num1,c>0?b=3*m:b=7*m,$=t.fontMetrics().denom1):(c>0?(d=t.fontMetrics().num2,b=m):(d=t.fontMetrics().num3,b=3*m),$=t.fontMetrics().denom2);var w;if(h){var y=t.fontMetrics().axisHeight;d-o.depth-(y+.5*c)<b&&(d+=b-(d-o.depth-(y+.5*c))),y-.5*c-(u.height-$)<b&&($+=b-(y-.5*c-(u.height-$)));var _=-(y-.5*c);w=q.makeVList({positionType:"individualShift",children:[{type:"elem",elem:u,shift:$},{type:"elem",elem:h,shift:_},{type:"elem",elem:o,shift:-d}]},t)}else{var g=d-o.depth-(u.height-$);g<b&&(d+=.5*(b-g),$+=.5*(b-g)),w=q.makeVList({positionType:"individualShift",children:[{type:"elem",elem:u,shift:$},{type:"elem",elem:o,shift:-d}]},t)}a=t.havingStyle(n),w.height*=a.sizeMultiplier/t.sizeMultiplier,w.depth*=a.sizeMultiplier/t.sizeMultiplier;var T;n.size===ie.DISPLAY.size?T=t.fontMetrics().delim1:n.size===ie.SCRIPTSCRIPT.size?T=t.havingStyle(ie.SCRIPT).fontMetrics().delim2:T=t.fontMetrics().delim2;var D,C;return e.leftDelim==null?D=Lo(t,["mopen"]):D=Qn.customSizedDelim(e.leftDelim,T,!0,t.havingStyle(n),e.mode,["mopen"]),e.continued?C=q.makeSpan([]):e.rightDelim==null?C=Lo(t,["mclose"]):C=Qn.customSizedDelim(e.rightDelim,T,!0,t.havingStyle(n),e.mode,["mclose"]),q.makeSpan(["mord"].concat(a.sizingClasses(t)),[D,q.makeSpan(["mfrac"],[w]),C],t)},fd=(e,t)=>{var n=new V.MathNode("mfrac",[Ee(e.numer,t),Ee(e.denom,t)]);if(!e.hasBarLine)n.setAttribute("linethickness","0px");else if(e.barSize){var r=Be(e.barSize,t);n.setAttribute("linethickness",G(r))}var i=Y4(e.size,t.style);if(i.size!==t.style.size){n=new V.MathNode("mstyle",[n]);var a=i.size===ie.DISPLAY.size?"true":"false";n.setAttribute("displaystyle",a),n.setAttribute("scriptlevel","0")}if(e.leftDelim!=null||e.rightDelim!=null){var o=[];if(e.leftDelim!=null){var s=new V.MathNode("mo",[new V.TextNode(e.leftDelim.replace("\\",""))]);s.setAttribute("fence","true"),o.push(s)}if(o.push(n),e.rightDelim!=null){var l=new V.MathNode("mo",[new V.TextNode(e.rightDelim.replace("\\",""))]);l.setAttribute("fence","true"),o.push(l)}return id(o)}return n};Z({type:"genfrac",names:["\\dfrac","\\frac","\\tfrac","\\dbinom","\\binom","\\tbinom","\\\\atopfrac","\\\\bracefrac","\\\\brackfrac"],props:{numArgs:2,allowedInArgument:!0},handler:(e,t)=>{var{parser:n,funcName:r}=e,i=t[0],a=t[1],o,s=null,l=null,u="auto";switch(r){case"\\dfrac":case"\\frac":case"\\tfrac":o=!0;break;case"\\\\atopfrac":o=!1;break;case"\\dbinom":case"\\binom":case"\\tbinom":o=!1,s="(",l=")";break;case"\\\\bracefrac":o=!1,s="\\{",l="\\}";break;case"\\\\brackfrac":o=!1,s="[",l="]";break;default:throw new Error("Unrecognized genfrac command")}switch(r){case"\\dfrac":case"\\dbinom":u="display";break;case"\\tfrac":case"\\tbinom":u="text";break}return{type:"genfrac",mode:n.mode,continued:!1,numer:i,denom:a,hasBarLine:o,leftDelim:s,rightDelim:l,size:u,barSize:null}},htmlBuilder:dd,mathmlBuilder:fd});Z({type:"genfrac",names:["\\cfrac"],props:{numArgs:2},handler:(e,t)=>{var{parser:n,funcName:r}=e,i=t[0],a=t[1];return{type:"genfrac",mode:n.mode,continued:!0,numer:i,denom:a,hasBarLine:!0,leftDelim:null,rightDelim:null,size:"display",barSize:null}}});Z({type:"infix",names:["\\over","\\choose","\\atop","\\brace","\\brack"],props:{numArgs:0,infix:!0},handler(e){var{parser:t,funcName:n,token:r}=e,i;switch(n){case"\\over":i="\\frac";break;case"\\choose":i="\\binom";break;case"\\atop":i="\\\\atopfrac";break;case"\\brace":i="\\\\bracefrac";break;case"\\brack":i="\\\\brackfrac";break;default:throw new Error("Unrecognized infix genfrac command")}return{type:"infix",mode:t.mode,replaceWith:i,token:r}}});var R1=["display","text","script","scriptscript"],N1=function(t){var n=null;return t.length>0&&(n=t,n=n==="."?null:n),n};Z({type:"genfrac",names:["\\genfrac"],props:{numArgs:6,allowedInArgument:!0,argTypes:["math","math","size","text","math","math"]},handler(e,t){var{parser:n}=e,r=t[4],i=t[5],a=Ul(t[0]),o=a.type==="atom"&&a.family==="open"?N1(a.text):null,s=Ul(t[1]),l=s.type==="atom"&&s.family==="close"?N1(s.text):null,u=pe(t[2],"size"),h,c=null;u.isBlank?h=!0:(c=u.value,h=c.number>0);var m="auto",d=t[3];if(d.type==="ordgroup"){if(d.body.length>0){var b=pe(d.body[0],"textord");m=R1[Number(b.text)]}}else d=pe(d,"textord"),m=R1[Number(d.text)];return{type:"genfrac",mode:n.mode,numer:r,denom:i,continued:!1,hasBarLine:h,barSize:c,leftDelim:o,rightDelim:l,size:m}},htmlBuilder:dd,mathmlBuilder:fd});Z({type:"infix",names:["\\above"],props:{numArgs:1,argTypes:["size"],infix:!0},handler(e,t){var{parser:n,funcName:r,token:i}=e;return{type:"infix",mode:n.mode,replaceWith:"\\\\abovefrac",size:pe(t[0],"size").value,token:i}}});Z({type:"genfrac",names:["\\\\abovefrac"],props:{numArgs:3,argTypes:["math","size","math"]},handler:(e,t)=>{var{parser:n,funcName:r}=e,i=t[0],a=pC(pe(t[1],"infix").size),o=t[2],s=a.number>0;return{type:"genfrac",mode:n.mode,numer:i,denom:o,continued:!1,hasBarLine:s,barSize:a,leftDelim:null,rightDelim:null,size:"auto"}},htmlBuilder:dd,mathmlBuilder:fd});var Q4=(e,t)=>{var n=t.style,r,i;e.type==="supsub"?(r=e.sup?ve(e.sup,t.havingStyle(n.sup()),t):ve(e.sub,t.havingStyle(n.sub()),t),i=pe(e.base,"horizBrace")):i=pe(e,"horizBrace");var a=ve(i.base,t.havingBaseStyle(ie.DISPLAY)),o=sr.svgSpan(i,t),s;if(i.isOver?(s=q.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:a},{type:"kern",size:.1},{type:"elem",elem:o}]},t),s.children[0].children[0].children[1].classes.push("svg-align")):(s=q.makeVList({positionType:"bottom",positionData:a.depth+.1+o.height,children:[{type:"elem",elem:o},{type:"kern",size:.1},{type:"elem",elem:a}]},t),s.children[0].children[0].children[0].classes.push("svg-align")),r){var l=q.makeSpan(["mord",i.isOver?"mover":"munder"],[s],t);i.isOver?s=q.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:l},{type:"kern",size:.2},{type:"elem",elem:r}]},t):s=q.makeVList({positionType:"bottom",positionData:l.depth+.2+r.height+r.depth,children:[{type:"elem",elem:r},{type:"kern",size:.2},{type:"elem",elem:l}]},t)}return q.makeSpan(["mord",i.isOver?"mover":"munder"],[s],t)},BP=(e,t)=>{var n=sr.mathMLnode(e.label);return new V.MathNode(e.isOver?"mover":"munder",[Ee(e.base,t),n])};Z({type:"horizBrace",names:["\\overbrace","\\underbrace"],props:{numArgs:1},handler(e,t){var{parser:n,funcName:r}=e;return{type:"horizBrace",mode:n.mode,label:r,isOver:/^\\over/.test(r),base:t[0]}},htmlBuilder:Q4,mathmlBuilder:BP});Z({type:"href",names:["\\href"],props:{numArgs:2,argTypes:["url","original"],allowedInText:!0},handler:(e,t)=>{var{parser:n}=e,r=t[1],i=pe(t[0],"url").url;return n.settings.isTrusted({command:"\\href",url:i})?{type:"href",mode:n.mode,href:i,body:Ke(r)}:n.formatUnsupportedCmd("\\href")},htmlBuilder:(e,t)=>{var n=tt(e.body,t,!1);return q.makeAnchor(e.href,[],n,t)},mathmlBuilder:(e,t)=>{var n=Br(e.body,t);return n instanceof Qt||(n=new Qt("mrow",[n])),n.setAttribute("href",e.href),n}});Z({type:"href",names:["\\url"],props:{numArgs:1,argTypes:["url"],allowedInText:!0},handler:(e,t)=>{var{parser:n}=e,r=pe(t[0],"url").url;if(!n.settings.isTrusted({command:"\\url",url:r}))return n.formatUnsupportedCmd("\\url");for(var i=[],a=0;a<r.length;a++){var o=r[a];o==="~"&&(o="\\textasciitilde"),i.push({type:"textord",mode:"text",text:o})}var s={type:"text",mode:n.mode,font:"\\texttt",body:i};return{type:"href",mode:n.mode,href:r,body:Ke(s)}}});Z({type:"hbox",names:["\\hbox"],props:{numArgs:1,argTypes:["text"],allowedInText:!0,primitive:!0},handler(e,t){var{parser:n}=e;return{type:"hbox",mode:n.mode,body:Ke(t[0])}},htmlBuilder(e,t){var n=tt(e.body,t,!1);return q.makeFragment(n)},mathmlBuilder(e,t){return new V.MathNode("mrow",Ft(e.body,t))}});Z({type:"html",names:["\\htmlClass","\\htmlId","\\htmlStyle","\\htmlData"],props:{numArgs:2,argTypes:["raw","original"],allowedInText:!0},handler:(e,t)=>{var{parser:n,funcName:r,token:i}=e,a=pe(t[0],"raw").string,o=t[1];n.settings.strict&&n.settings.reportNonstrict("htmlExtension","HTML extension is disabled on strict mode");var s,l={};switch(r){case"\\htmlClass":l.class=a,s={command:"\\htmlClass",class:a};break;case"\\htmlId":l.id=a,s={command:"\\htmlId",id:a};break;case"\\htmlStyle":l.style=a,s={command:"\\htmlStyle",style:a};break;case"\\htmlData":{for(var u=a.split(","),h=0;h<u.length;h++){var c=u[h].split("=");if(c.length!==2)throw new X("Error parsing key-value for \\htmlData");l["data-"+c[0].trim()]=c[1].trim()}s={command:"\\htmlData",attributes:l};break}default:throw new Error("Unrecognized html command")}return n.settings.isTrusted(s)?{type:"html",mode:n.mode,attributes:l,body:Ke(o)}:n.formatUnsupportedCmd(r)},htmlBuilder:(e,t)=>{var n=tt(e.body,t,!1),r=["enclosing"];e.attributes.class&&r.push(...e.attributes.class.trim().split(/\s+/));var i=q.makeSpan(r,n,t);for(var a in e.attributes)a!=="class"&&e.attributes.hasOwnProperty(a)&&i.setAttribute(a,e.attributes[a]);return i},mathmlBuilder:(e,t)=>Br(e.body,t)});Z({type:"htmlmathml",names:["\\html@mathml"],props:{numArgs:2,allowedInText:!0},handler:(e,t)=>{var{parser:n}=e;return{type:"htmlmathml",mode:n.mode,html:Ke(t[0]),mathml:Ke(t[1])}},htmlBuilder:(e,t)=>{var n=tt(e.html,t,!1);return q.makeFragment(n)},mathmlBuilder:(e,t)=>Br(e.mathml,t)});var Fh=function(t){if(/^[-+]? *(\d+(\.\d*)?|\.\d+)$/.test(t))return{number:+t,unit:"bp"};var n=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(t);if(!n)throw new X("Invalid size: '"+t+"' in \\includegraphics");var r={number:+(n[1]+n[2]),unit:n[3]};if(!b4(r))throw new X("Invalid unit: '"+r.unit+"' in \\includegraphics.");return r};Z({type:"includegraphics",names:["\\includegraphics"],props:{numArgs:1,numOptionalArgs:1,argTypes:["raw","url"],allowedInText:!1},handler:(e,t,n)=>{var{parser:r}=e,i={number:0,unit:"em"},a={number:.9,unit:"em"},o={number:0,unit:"em"},s="";if(n[0])for(var l=pe(n[0],"raw").string,u=l.split(","),h=0;h<u.length;h++){var c=u[h].split("=");if(c.length===2){var m=c[1].trim();switch(c[0].trim()){case"alt":s=m;break;case"width":i=Fh(m);break;case"height":a=Fh(m);break;case"totalheight":o=Fh(m);break;default:throw new X("Invalid key: '"+c[0]+"' in \\includegraphics.")}}}var d=pe(t[0],"url").url;return s===""&&(s=d,s=s.replace(/^.*[\\/]/,""),s=s.substring(0,s.lastIndexOf("."))),r.settings.isTrusted({command:"\\includegraphics",url:d})?{type:"includegraphics",mode:r.mode,alt:s,width:i,height:a,totalheight:o,src:d}:r.formatUnsupportedCmd("\\includegraphics")},htmlBuilder:(e,t)=>{var n=Be(e.height,t),r=0;e.totalheight.number>0&&(r=Be(e.totalheight,t)-n);var i=0;e.width.number>0&&(i=Be(e.width,t));var a={height:G(n+r)};i>0&&(a.width=G(i)),r>0&&(a.verticalAlign=G(-r));var o=new BC(e.src,e.alt,a);return o.height=n,o.depth=r,o},mathmlBuilder:(e,t)=>{var n=new V.MathNode("mglyph",[]);n.setAttribute("alt",e.alt);var r=Be(e.height,t),i=0;if(e.totalheight.number>0&&(i=Be(e.totalheight,t)-r,n.setAttribute("valign",G(-i))),n.setAttribute("height",G(r+i)),e.width.number>0){var a=Be(e.width,t);n.setAttribute("width",G(a))}return n.setAttribute("src",e.src),n}});Z({type:"kern",names:["\\kern","\\mkern","\\hskip","\\mskip"],props:{numArgs:1,argTypes:["size"],primitive:!0,allowedInText:!0},handler(e,t){var{parser:n,funcName:r}=e,i=pe(t[0],"size");if(n.settings.strict){var a=r[1]==="m",o=i.value.unit==="mu";a?(o||n.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+r+" supports only mu units, "+("not "+i.value.unit+" units")),n.mode!=="math"&&n.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+r+" works only in math mode")):o&&n.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+r+" doesn't support mu units")}return{type:"kern",mode:n.mode,dimension:i.value}},htmlBuilder(e,t){return q.makeGlue(e.dimension,t)},mathmlBuilder(e,t){var n=Be(e.dimension,t);return new V.SpaceNode(n)}});Z({type:"lap",names:["\\mathllap","\\mathrlap","\\mathclap"],props:{numArgs:1,allowedInText:!0},handler:(e,t)=>{var{parser:n,funcName:r}=e,i=t[0];return{type:"lap",mode:n.mode,alignment:r.slice(5),body:i}},htmlBuilder:(e,t)=>{var n;e.alignment==="clap"?(n=q.makeSpan([],[ve(e.body,t)]),n=q.makeSpan(["inner"],[n],t)):n=q.makeSpan(["inner"],[ve(e.body,t)]);var r=q.makeSpan(["fix"],[]),i=q.makeSpan([e.alignment],[n,r],t),a=q.makeSpan(["strut"]);return a.style.height=G(i.height+i.depth),i.depth&&(a.style.verticalAlign=G(-i.depth)),i.children.unshift(a),i=q.makeSpan(["thinbox"],[i],t),q.makeSpan(["mord","vbox"],[i],t)},mathmlBuilder:(e,t)=>{var n=new V.MathNode("mpadded",[Ee(e.body,t)]);if(e.alignment!=="rlap"){var r=e.alignment==="llap"?"-1":"-0.5";n.setAttribute("lspace",r+"width")}return n.setAttribute("width","0px"),n}});Z({type:"styling",names:["\\(","$"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler(e,t){var{funcName:n,parser:r}=e,i=r.mode;r.switchMode("math");var a=n==="\\("?"\\)":"$",o=r.parseExpression(!1,a);return r.expect(a),r.switchMode(i),{type:"styling",mode:r.mode,style:"text",body:o}}});Z({type:"text",names:["\\)","\\]"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler(e,t){throw new X("Mismatched "+e.funcName)}});var I1=(e,t)=>{switch(t.style.size){case ie.DISPLAY.size:return e.display;case ie.TEXT.size:return e.text;case ie.SCRIPT.size:return e.script;case ie.SCRIPTSCRIPT.size:return e.scriptscript;default:return e.text}};Z({type:"mathchoice",names:["\\mathchoice"],props:{numArgs:4,primitive:!0},handler:(e,t)=>{var{parser:n}=e;return{type:"mathchoice",mode:n.mode,display:Ke(t[0]),text:Ke(t[1]),script:Ke(t[2]),scriptscript:Ke(t[3])}},htmlBuilder:(e,t)=>{var n=I1(e,t),r=tt(n,t,!1);return q.makeFragment(r)},mathmlBuilder:(e,t)=>{var n=I1(e,t);return Br(n,t)}});var J4=(e,t,n,r,i,a,o)=>{e=q.makeSpan([],[e]);var s=n&&te.isCharacterBox(n),l,u;if(t){var h=ve(t,r.havingStyle(i.sup()),r);u={elem:h,kern:Math.max(r.fontMetrics().bigOpSpacing1,r.fontMetrics().bigOpSpacing3-h.depth)}}if(n){var c=ve(n,r.havingStyle(i.sub()),r);l={elem:c,kern:Math.max(r.fontMetrics().bigOpSpacing2,r.fontMetrics().bigOpSpacing4-c.height)}}var m;if(u&&l){var d=r.fontMetrics().bigOpSpacing5+l.elem.height+l.elem.depth+l.kern+e.depth+o;m=q.makeVList({positionType:"bottom",positionData:d,children:[{type:"kern",size:r.fontMetrics().bigOpSpacing5},{type:"elem",elem:l.elem,marginLeft:G(-a)},{type:"kern",size:l.kern},{type:"elem",elem:e},{type:"kern",size:u.kern},{type:"elem",elem:u.elem,marginLeft:G(a)},{type:"kern",size:r.fontMetrics().bigOpSpacing5}]},r)}else if(l){var b=e.height-o;m=q.makeVList({positionType:"top",positionData:b,children:[{type:"kern",size:r.fontMetrics().bigOpSpacing5},{type:"elem",elem:l.elem,marginLeft:G(-a)},{type:"kern",size:l.kern},{type:"elem",elem:e}]},r)}else if(u){var $=e.depth+o;m=q.makeVList({positionType:"bottom",positionData:$,children:[{type:"elem",elem:e},{type:"kern",size:u.kern},{type:"elem",elem:u.elem,marginLeft:G(a)},{type:"kern",size:r.fontMetrics().bigOpSpacing5}]},r)}else return e;var w=[m];if(l&&a!==0&&!s){var g=q.makeSpan(["mspace"],[],r);g.style.marginRight=G(a),w.unshift(g)}return q.makeSpan(["mop","op-limits"],w,r)},ev=["\\smallint"],Ea=(e,t)=>{var n,r,i=!1,a;e.type==="supsub"?(n=e.sup,r=e.sub,a=pe(e.base,"op"),i=!0):a=pe(e,"op");var o=t.style,s=!1;o.size===ie.DISPLAY.size&&a.symbol&&!te.contains(ev,a.name)&&(s=!0);var l;if(a.symbol){var u=s?"Size2-Regular":"Size1-Regular",h="";if((a.name==="\\oiint"||a.name==="\\oiiint")&&(h=a.name.slice(1),a.name=h==="oiint"?"\\iint":"\\iiint"),l=q.makeSymbol(a.name,u,"math",t,["mop","op-symbol",s?"large-op":"small-op"]),h.length>0){var c=l.italic,m=q.staticSvg(h+"Size"+(s?"2":"1"),t);l=q.makeVList({positionType:"individualShift",children:[{type:"elem",elem:l,shift:0},{type:"elem",elem:m,shift:s?.08:0}]},t),a.name="\\"+h,l.classes.unshift("mop"),l.italic=c}}else if(a.body){var d=tt(a.body,t,!0);d.length===1&&d[0]instanceof on?(l=d[0],l.classes[0]="mop"):l=q.makeSpan(["mop"],d,t)}else{for(var b=[],$=1;$<a.name.length;$++)b.push(q.mathsym(a.name[$],a.mode,t));l=q.makeSpan(["mop"],b,t)}var w=0,g=0;return(l instanceof on||a.name==="\\oiint"||a.name==="\\oiiint")&&!a.suppressBaseShift&&(w=(l.height-l.depth)/2-t.fontMetrics().axisHeight,g=l.italic),i?J4(l,n,r,t,o,g,w):(w&&(l.style.position="relative",l.style.top=G(w)),l)},ss=(e,t)=>{var n;if(e.symbol)n=new Qt("mo",[sn(e.name,e.mode)]),te.contains(ev,e.name)&&n.setAttribute("largeop","false");else if(e.body)n=new Qt("mo",Ft(e.body,t));else{n=new Qt("mi",[new mo(e.name.slice(1))]);var r=new Qt("mo",[sn("⁡","text")]);e.parentIsSupSub?n=new Qt("mrow",[n,r]):n=P4([n,r])}return n},LP={"∏":"\\prod","∐":"\\coprod","∑":"\\sum","⋀":"\\bigwedge","⋁":"\\bigvee","⋂":"\\bigcap","⋃":"\\bigcup","⨀":"\\bigodot","⨁":"\\bigoplus","⨂":"\\bigotimes","⨄":"\\biguplus","⨆":"\\bigsqcup"};Z({type:"op",names:["\\coprod","\\bigvee","\\bigwedge","\\biguplus","\\bigcap","\\bigcup","\\intop","\\prod","\\sum","\\bigotimes","\\bigoplus","\\bigodot","\\bigsqcup","\\smallint","∏","∐","∑","⋀","⋁","⋂","⋃","⨀","⨁","⨂","⨄","⨆"],props:{numArgs:0},handler:(e,t)=>{var{parser:n,funcName:r}=e,i=r;return i.length===1&&(i=LP[i]),{type:"op",mode:n.mode,limits:!0,parentIsSupSub:!1,symbol:!0,name:i}},htmlBuilder:Ea,mathmlBuilder:ss});Z({type:"op",names:["\\mathop"],props:{numArgs:1,primitive:!0},handler:(e,t)=>{var{parser:n}=e,r=t[0];return{type:"op",mode:n.mode,limits:!1,parentIsSupSub:!1,symbol:!1,body:Ke(r)}},htmlBuilder:Ea,mathmlBuilder:ss});var OP={"∫":"\\int","∬":"\\iint","∭":"\\iiint","∮":"\\oint","∯":"\\oiint","∰":"\\oiiint"};Z({type:"op",names:["\\arcsin","\\arccos","\\arctan","\\arctg","\\arcctg","\\arg","\\ch","\\cos","\\cosec","\\cosh","\\cot","\\cotg","\\coth","\\csc","\\ctg","\\cth","\\deg","\\dim","\\exp","\\hom","\\ker","\\lg","\\ln","\\log","\\sec","\\sin","\\sinh","\\sh","\\tan","\\tanh","\\tg","\\th"],props:{numArgs:0},handler(e){var{parser:t,funcName:n}=e;return{type:"op",mode:t.mode,limits:!1,parentIsSupSub:!1,symbol:!1,name:n}},htmlBuilder:Ea,mathmlBuilder:ss});Z({type:"op",names:["\\det","\\gcd","\\inf","\\lim","\\max","\\min","\\Pr","\\sup"],props:{numArgs:0},handler(e){var{parser:t,funcName:n}=e;return{type:"op",mode:t.mode,limits:!0,parentIsSupSub:!1,symbol:!1,name:n}},htmlBuilder:Ea,mathmlBuilder:ss});Z({type:"op",names:["\\int","\\iint","\\iiint","\\oint","\\oiint","\\oiiint","∫","∬","∭","∮","∯","∰"],props:{numArgs:0},handler(e){var{parser:t,funcName:n}=e,r=n;return r.length===1&&(r=OP[r]),{type:"op",mode:t.mode,limits:!1,parentIsSupSub:!1,symbol:!0,name:r}},htmlBuilder:Ea,mathmlBuilder:ss});var tv=(e,t)=>{var n,r,i=!1,a;e.type==="supsub"?(n=e.sup,r=e.sub,a=pe(e.base,"operatorname"),i=!0):a=pe(e,"operatorname");var o;if(a.body.length>0){for(var s=a.body.map(c=>{var m=c.text;return typeof m=="string"?{type:"textord",mode:c.mode,text:m}:c}),l=tt(s,t.withFont("mathrm"),!0),u=0;u<l.length;u++){var h=l[u];h instanceof on&&(h.text=h.text.replace(/\u2212/,"-").replace(/\u2217/,"*"))}o=q.makeSpan(["mop"],l,t)}else o=q.makeSpan(["mop"],[],t);return i?J4(o,n,r,t,t.style,0,0):o},jP=(e,t)=>{for(var n=Ft(e.body,t.withFont("mathrm")),r=!0,i=0;i<n.length;i++){var a=n[i];if(!(a instanceof V.SpaceNode))if(a instanceof V.MathNode)switch(a.type){case"mi":case"mn":case"ms":case"mspace":case"mtext":break;case"mo":{var o=a.children[0];a.children.length===1&&o instanceof V.TextNode?o.text=o.text.replace(/\u2212/,"-").replace(/\u2217/,"*"):r=!1;break}default:r=!1}else r=!1}if(r){var s=n.map(h=>h.toText()).join("");n=[new V.TextNode(s)]}var l=new V.MathNode("mi",n);l.setAttribute("mathvariant","normal");var u=new V.MathNode("mo",[sn("⁡","text")]);return e.parentIsSupSub?new V.MathNode("mrow",[l,u]):V.newDocumentFragment([l,u])};Z({type:"operatorname",names:["\\operatorname@","\\operatornamewithlimits"],props:{numArgs:1},handler:(e,t)=>{var{parser:n,funcName:r}=e,i=t[0];return{type:"operatorname",mode:n.mode,body:Ke(i),alwaysHandleSupSub:r==="\\operatornamewithlimits",limits:!1,parentIsSupSub:!1}},htmlBuilder:tv,mathmlBuilder:jP});x("\\operatorname","\\@ifstar\\operatornamewithlimits\\operatorname@");xi({type:"ordgroup",htmlBuilder(e,t){return e.semisimple?q.makeFragment(tt(e.body,t,!1)):q.makeSpan(["mord"],tt(e.body,t,!0),t)},mathmlBuilder(e,t){return Br(e.body,t,!0)}});Z({type:"overline",names:["\\overline"],props:{numArgs:1},handler(e,t){var{parser:n}=e,r=t[0];return{type:"overline",mode:n.mode,body:r}},htmlBuilder(e,t){var n=ve(e.body,t.havingCrampedStyle()),r=q.makeLineSpan("overline-line",t),i=t.fontMetrics().defaultRuleThickness,a=q.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:n},{type:"kern",size:3*i},{type:"elem",elem:r},{type:"kern",size:i}]},t);return q.makeSpan(["mord","overline"],[a],t)},mathmlBuilder(e,t){var n=new V.MathNode("mo",[new V.TextNode("‾")]);n.setAttribute("stretchy","true");var r=new V.MathNode("mover",[Ee(e.body,t),n]);return r.setAttribute("accent","true"),r}});Z({type:"phantom",names:["\\phantom"],props:{numArgs:1,allowedInText:!0},handler:(e,t)=>{var{parser:n}=e,r=t[0];return{type:"phantom",mode:n.mode,body:Ke(r)}},htmlBuilder:(e,t)=>{var n=tt(e.body,t.withPhantom(),!1);return q.makeFragment(n)},mathmlBuilder:(e,t)=>{var n=Ft(e.body,t);return new V.MathNode("mphantom",n)}});Z({type:"hphantom",names:["\\hphantom"],props:{numArgs:1,allowedInText:!0},handler:(e,t)=>{var{parser:n}=e,r=t[0];return{type:"hphantom",mode:n.mode,body:r}},htmlBuilder:(e,t)=>{var n=q.makeSpan([],[ve(e.body,t.withPhantom())]);if(n.height=0,n.depth=0,n.children)for(var r=0;r<n.children.length;r++)n.children[r].height=0,n.children[r].depth=0;return n=q.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:n}]},t),q.makeSpan(["mord"],[n],t)},mathmlBuilder:(e,t)=>{var n=Ft(Ke(e.body),t),r=new V.MathNode("mphantom",n),i=new V.MathNode("mpadded",[r]);return i.setAttribute("height","0px"),i.setAttribute("depth","0px"),i}});Z({type:"vphantom",names:["\\vphantom"],props:{numArgs:1,allowedInText:!0},handler:(e,t)=>{var{parser:n}=e,r=t[0];return{type:"vphantom",mode:n.mode,body:r}},htmlBuilder:(e,t)=>{var n=q.makeSpan(["inner"],[ve(e.body,t.withPhantom())]),r=q.makeSpan(["fix"],[]);return q.makeSpan(["mord","rlap"],[n,r],t)},mathmlBuilder:(e,t)=>{var n=Ft(Ke(e.body),t),r=new V.MathNode("mphantom",n),i=new V.MathNode("mpadded",[r]);return i.setAttribute("width","0px"),i}});Z({type:"raisebox",names:["\\raisebox"],props:{numArgs:2,argTypes:["size","hbox"],allowedInText:!0},handler(e,t){var{parser:n}=e,r=pe(t[0],"size").value,i=t[1];return{type:"raisebox",mode:n.mode,dy:r,body:i}},htmlBuilder(e,t){var n=ve(e.body,t),r=Be(e.dy,t);return q.makeVList({positionType:"shift",positionData:-r,children:[{type:"elem",elem:n}]},t)},mathmlBuilder(e,t){var n=new V.MathNode("mpadded",[Ee(e.body,t)]),r=e.dy.number+e.dy.unit;return n.setAttribute("voffset",r),n}});Z({type:"internal",names:["\\relax"],props:{numArgs:0,allowedInText:!0},handler(e){var{parser:t}=e;return{type:"internal",mode:t.mode}}});Z({type:"rule",names:["\\rule"],props:{numArgs:2,numOptionalArgs:1,allowedInText:!0,allowedInMath:!0,argTypes:["size","size","size"]},handler(e,t,n){var{parser:r}=e,i=n[0],a=pe(t[0],"size"),o=pe(t[1],"size");return{type:"rule",mode:r.mode,shift:i&&pe(i,"size").value,width:a.value,height:o.value}},htmlBuilder(e,t){var n=q.makeSpan(["mord","rule"],[],t),r=Be(e.width,t),i=Be(e.height,t),a=e.shift?Be(e.shift,t):0;return n.style.borderRightWidth=G(r),n.style.borderTopWidth=G(i),n.style.bottom=G(a),n.width=r,n.height=i+a,n.depth=-a,n.maxFontSize=i*1.125*t.sizeMultiplier,n},mathmlBuilder(e,t){var n=Be(e.width,t),r=Be(e.height,t),i=e.shift?Be(e.shift,t):0,a=t.color&&t.getColor()||"black",o=new V.MathNode("mspace");o.setAttribute("mathbackground",a),o.setAttribute("width",G(n)),o.setAttribute("height",G(r));var s=new V.MathNode("mpadded",[o]);return i>=0?s.setAttribute("height",G(i)):(s.setAttribute("height",G(i)),s.setAttribute("depth",G(-i))),s.setAttribute("voffset",G(i)),s}});function nv(e,t,n){for(var r=tt(e,t,!1),i=t.sizeMultiplier/n.sizeMultiplier,a=0;a<r.length;a++){var o=r[a].classes.indexOf("sizing");o<0?Array.prototype.push.apply(r[a].classes,t.sizingClasses(n)):r[a].classes[o+1]==="reset-size"+t.size&&(r[a].classes[o+1]="reset-size"+n.size),r[a].height*=i,r[a].depth*=i}return q.makeFragment(r)}var B1=["\\tiny","\\sixptsize","\\scriptsize","\\footnotesize","\\small","\\normalsize","\\large","\\Large","\\LARGE","\\huge","\\Huge"],VP=(e,t)=>{var n=t.havingSize(e.size);return nv(e.body,n,t)};Z({type:"sizing",names:B1,props:{numArgs:0,allowedInText:!0},handler:(e,t)=>{var{breakOnTokenText:n,funcName:r,parser:i}=e,a=i.parseExpression(!1,n);return{type:"sizing",mode:i.mode,size:B1.indexOf(r)+1,body:a}},htmlBuilder:VP,mathmlBuilder:(e,t)=>{var n=t.havingSize(e.size),r=Ft(e.body,n),i=new V.MathNode("mstyle",r);return i.setAttribute("mathsize",G(n.sizeMultiplier)),i}});Z({type:"smash",names:["\\smash"],props:{numArgs:1,numOptionalArgs:1,allowedInText:!0},handler:(e,t,n)=>{var{parser:r}=e,i=!1,a=!1,o=n[0]&&pe(n[0],"ordgroup");if(o)for(var s="",l=0;l<o.body.length;++l){var u=o.body[l];if(s=u.text,s==="t")i=!0;else if(s==="b")a=!0;else{i=!1,a=!1;break}}else i=!0,a=!0;var h=t[0];return{type:"smash",mode:r.mode,body:h,smashHeight:i,smashDepth:a}},htmlBuilder:(e,t)=>{var n=q.makeSpan([],[ve(e.body,t)]);if(!e.smashHeight&&!e.smashDepth)return n;if(e.smashHeight&&(n.height=0,n.children))for(var r=0;r<n.children.length;r++)n.children[r].height=0;if(e.smashDepth&&(n.depth=0,n.children))for(var i=0;i<n.children.length;i++)n.children[i].depth=0;var a=q.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:n}]},t);return q.makeSpan(["mord"],[a],t)},mathmlBuilder:(e,t)=>{var n=new V.MathNode("mpadded",[Ee(e.body,t)]);return e.smashHeight&&n.setAttribute("height","0px"),e.smashDepth&&n.setAttribute("depth","0px"),n}});Z({type:"sqrt",names:["\\sqrt"],props:{numArgs:1,numOptionalArgs:1},handler(e,t,n){var{parser:r}=e,i=n[0],a=t[0];return{type:"sqrt",mode:r.mode,body:a,index:i}},htmlBuilder(e,t){var n=ve(e.body,t.havingCrampedStyle());n.height===0&&(n.height=t.fontMetrics().xHeight),n=q.wrapFragment(n,t);var r=t.fontMetrics(),i=r.defaultRuleThickness,a=i;t.style.id<ie.TEXT.id&&(a=t.fontMetrics().xHeight);var o=i+a/4,s=n.height+n.depth+o+i,{span:l,ruleWidth:u,advanceWidth:h}=Qn.sqrtImage(s,t),c=l.height-u;c>n.height+n.depth+o&&(o=(o+c-n.height-n.depth)/2);var m=l.height-n.height-o-u;n.style.paddingLeft=G(h);var d=q.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:n,wrapperClasses:["svg-align"]},{type:"kern",size:-(n.height+m)},{type:"elem",elem:l},{type:"kern",size:u}]},t);if(e.index){var b=t.havingStyle(ie.SCRIPTSCRIPT),$=ve(e.index,b,t),w=.6*(d.height-d.depth),g=q.makeVList({positionType:"shift",positionData:-w,children:[{type:"elem",elem:$}]},t),y=q.makeSpan(["root"],[g]);return q.makeSpan(["mord","sqrt"],[y,d],t)}else return q.makeSpan(["mord","sqrt"],[d],t)},mathmlBuilder(e,t){var{body:n,index:r}=e;return r?new V.MathNode("mroot",[Ee(n,t),Ee(r,t)]):new V.MathNode("msqrt",[Ee(n,t)])}});var L1={display:ie.DISPLAY,text:ie.TEXT,script:ie.SCRIPT,scriptscript:ie.SCRIPTSCRIPT};Z({type:"styling",names:["\\displaystyle","\\textstyle","\\scriptstyle","\\scriptscriptstyle"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(e,t){var{breakOnTokenText:n,funcName:r,parser:i}=e,a=i.parseExpression(!0,n),o=r.slice(1,r.length-5);return{type:"styling",mode:i.mode,style:o,body:a}},htmlBuilder(e,t){var n=L1[e.style],r=t.havingStyle(n).withFont("");return nv(e.body,r,t)},mathmlBuilder(e,t){var n=L1[e.style],r=t.havingStyle(n),i=Ft(e.body,r),a=new V.MathNode("mstyle",i),o={display:["0","true"],text:["0","false"],script:["1","false"],scriptscript:["2","false"]},s=o[e.style];return a.setAttribute("scriptlevel",s[0]),a.setAttribute("displaystyle",s[1]),a}});var WP=function(t,n){var r=t.base;if(r)if(r.type==="op"){var i=r.limits&&(n.style.size===ie.DISPLAY.size||r.alwaysHandleSupSub);return i?Ea:null}else if(r.type==="operatorname"){var a=r.alwaysHandleSupSub&&(n.style.size===ie.DISPLAY.size||r.limits);return a?tv:null}else{if(r.type==="accent")return te.isCharacterBox(r.base)?sd:null;if(r.type==="horizBrace"){var o=!t.sub;return o===r.isOver?Q4:null}else return null}else return null};xi({type:"supsub",htmlBuilder(e,t){var n=WP(e,t);if(n)return n(e,t);var{base:r,sup:i,sub:a}=e,o=ve(r,t),s,l,u=t.fontMetrics(),h=0,c=0,m=r&&te.isCharacterBox(r);if(i){var d=t.havingStyle(t.style.sup());s=ve(i,d,t),m||(h=o.height-d.fontMetrics().supDrop*d.sizeMultiplier/t.sizeMultiplier)}if(a){var b=t.havingStyle(t.style.sub());l=ve(a,b,t),m||(c=o.depth+b.fontMetrics().subDrop*b.sizeMultiplier/t.sizeMultiplier)}var $;t.style===ie.DISPLAY?$=u.sup1:t.style.cramped?$=u.sup3:$=u.sup2;var w=t.sizeMultiplier,g=G(.5/u.ptPerEm/w),y=null;if(l){var _=e.base&&e.base.type==="op"&&e.base.name&&(e.base.name==="\\oiint"||e.base.name==="\\oiiint");(o instanceof on||_)&&(y=G(-o.italic))}var T;if(s&&l){h=Math.max(h,$,s.depth+.25*u.xHeight),c=Math.max(c,u.sub2);var D=u.defaultRuleThickness,C=4*D;if(h-s.depth-(l.height-c)<C){c=C-(h-s.depth)+l.height;var F=.8*u.xHeight-(h-s.depth);F>0&&(h+=F,c-=F)}var R=[{type:"elem",elem:l,shift:c,marginRight:g,marginLeft:y},{type:"elem",elem:s,shift:-h,marginRight:g}];T=q.makeVList({positionType:"individualShift",children:R},t)}else if(l){c=Math.max(c,u.sub1,l.height-.8*u.xHeight);var N=[{type:"elem",elem:l,marginLeft:y,marginRight:g}];T=q.makeVList({positionType:"shift",positionData:c,children:N},t)}else if(s)h=Math.max(h,$,s.depth+.25*u.xHeight),T=q.makeVList({positionType:"shift",positionData:-h,children:[{type:"elem",elem:s,marginRight:g}]},t);else throw new Error("supsub must have either sup or sub.");var O=l0(o,"right")||"mord";return q.makeSpan([O],[o,q.makeSpan(["msupsub"],[T])],t)},mathmlBuilder(e,t){var n=!1,r,i;e.base&&e.base.type==="horizBrace"&&(i=!!e.sup,i===e.base.isOver&&(n=!0,r=e.base.isOver)),e.base&&(e.base.type==="op"||e.base.type==="operatorname")&&(e.base.parentIsSupSub=!0);var a=[Ee(e.base,t)];e.sub&&a.push(Ee(e.sub,t)),e.sup&&a.push(Ee(e.sup,t));var o;if(n)o=r?"mover":"munder";else if(e.sub)if(e.sup){var u=e.base;u&&u.type==="op"&&u.limits&&t.style===ie.DISPLAY||u&&u.type==="operatorname"&&u.alwaysHandleSupSub&&(t.style===ie.DISPLAY||u.limits)?o="munderover":o="msubsup"}else{var l=e.base;l&&l.type==="op"&&l.limits&&(t.style===ie.DISPLAY||l.alwaysHandleSupSub)||l&&l.type==="operatorname"&&l.alwaysHandleSupSub&&(l.limits||t.style===ie.DISPLAY)?o="munder":o="msub"}else{var s=e.base;s&&s.type==="op"&&s.limits&&(t.style===ie.DISPLAY||s.alwaysHandleSupSub)||s&&s.type==="operatorname"&&s.alwaysHandleSupSub&&(s.limits||t.style===ie.DISPLAY)?o="mover":o="msup"}return new V.MathNode(o,a)}});xi({type:"atom",htmlBuilder(e,t){return q.mathsym(e.text,e.mode,t,["m"+e.family])},mathmlBuilder(e,t){var n=new V.MathNode("mo",[sn(e.text,e.mode)]);if(e.family==="bin"){var r=ad(e,t);r==="bold-italic"&&n.setAttribute("mathvariant",r)}else e.family==="punct"?n.setAttribute("separator","true"):(e.family==="open"||e.family==="close")&&n.setAttribute("stretchy","false");return n}});var rv={mi:"italic",mn:"normal",mtext:"normal"};xi({type:"mathord",htmlBuilder(e,t){return q.makeOrd(e,t,"mathord")},mathmlBuilder(e,t){var n=new V.MathNode("mi",[sn(e.text,e.mode,t)]),r=ad(e,t)||"italic";return r!==rv[n.type]&&n.setAttribute("mathvariant",r),n}});xi({type:"textord",htmlBuilder(e,t){return q.makeOrd(e,t,"textord")},mathmlBuilder(e,t){var n=sn(e.text,e.mode,t),r=ad(e,t)||"normal",i;return e.mode==="text"?i=new V.MathNode("mtext",[n]):/[0-9]/.test(e.text)?i=new V.MathNode("mn",[n]):e.text==="\\prime"?i=new V.MathNode("mo",[n]):i=new V.MathNode("mi",[n]),r!==rv[i.type]&&i.setAttribute("mathvariant",r),i}});var qh={"\\nobreak":"nobreak","\\allowbreak":"allowbreak"},Rh={" ":{},"\\ ":{},"~":{className:"nobreak"},"\\space":{},"\\nobreakspace":{className:"nobreak"}};xi({type:"spacing",htmlBuilder(e,t){if(Rh.hasOwnProperty(e.text)){var n=Rh[e.text].className||"";if(e.mode==="text"){var r=q.makeOrd(e,t,"textord");return r.classes.push(n),r}else return q.makeSpan(["mspace",n],[q.mathsym(e.text,e.mode,t)],t)}else{if(qh.hasOwnProperty(e.text))return q.makeSpan(["mspace",qh[e.text]],[],t);throw new X('Unknown type of space "'+e.text+'"')}},mathmlBuilder(e,t){var n;if(Rh.hasOwnProperty(e.text))n=new V.MathNode("mtext",[new V.TextNode(" ")]);else{if(qh.hasOwnProperty(e.text))return new V.MathNode("mspace");throw new X('Unknown type of space "'+e.text+'"')}return n}});var O1=()=>{var e=new V.MathNode("mtd",[]);return e.setAttribute("width","50%"),e};xi({type:"tag",mathmlBuilder(e,t){var n=new V.MathNode("mtable",[new V.MathNode("mtr",[O1(),new V.MathNode("mtd",[Br(e.body,t)]),O1(),new V.MathNode("mtd",[Br(e.tag,t)])])]);return n.setAttribute("width","100%"),n}});var j1={"\\text":void 0,"\\textrm":"textrm","\\textsf":"textsf","\\texttt":"texttt","\\textnormal":"textrm"},V1={"\\textbf":"textbf","\\textmd":"textmd"},XP={"\\textit":"textit","\\textup":"textup"},W1=(e,t)=>{var n=e.font;if(n){if(j1[n])return t.withTextFontFamily(j1[n]);if(V1[n])return t.withTextFontWeight(V1[n]);if(n==="\\emph")return t.fontShape==="textit"?t.withTextFontShape("textup"):t.withTextFontShape("textit")}else return t;return t.withTextFontShape(XP[n])};Z({type:"text",names:["\\text","\\textrm","\\textsf","\\texttt","\\textnormal","\\textbf","\\textmd","\\textit","\\textup","\\emph"],props:{numArgs:1,argTypes:["text"],allowedInArgument:!0,allowedInText:!0},handler(e,t){var{parser:n,funcName:r}=e,i=t[0];return{type:"text",mode:n.mode,body:Ke(i),font:r}},htmlBuilder(e,t){var n=W1(e,t),r=tt(e.body,n,!0);return q.makeSpan(["mord","text"],r,n)},mathmlBuilder(e,t){var n=W1(e,t);return Br(e.body,n)}});Z({type:"underline",names:["\\underline"],props:{numArgs:1,allowedInText:!0},handler(e,t){var{parser:n}=e;return{type:"underline",mode:n.mode,body:t[0]}},htmlBuilder(e,t){var n=ve(e.body,t),r=q.makeLineSpan("underline-line",t),i=t.fontMetrics().defaultRuleThickness,a=q.makeVList({positionType:"top",positionData:n.height,children:[{type:"kern",size:i},{type:"elem",elem:r},{type:"kern",size:3*i},{type:"elem",elem:n}]},t);return q.makeSpan(["mord","underline"],[a],t)},mathmlBuilder(e,t){var n=new V.MathNode("mo",[new V.TextNode("‾")]);n.setAttribute("stretchy","true");var r=new V.MathNode("munder",[Ee(e.body,t),n]);return r.setAttribute("accentunder","true"),r}});Z({type:"vcenter",names:["\\vcenter"],props:{numArgs:1,argTypes:["original"],allowedInText:!1},handler(e,t){var{parser:n}=e;return{type:"vcenter",mode:n.mode,body:t[0]}},htmlBuilder(e,t){var n=ve(e.body,t),r=t.fontMetrics().axisHeight,i=.5*(n.height-r-(n.depth+r));return q.makeVList({positionType:"shift",positionData:i,children:[{type:"elem",elem:n}]},t)},mathmlBuilder(e,t){return new V.MathNode("mpadded",[Ee(e.body,t)],["vcenter"])}});Z({type:"verb",names:["\\verb"],props:{numArgs:0,allowedInText:!0},handler(e,t,n){throw new X("\\verb ended by end of line instead of matching delimiter")},htmlBuilder(e,t){for(var n=X1(e),r=[],i=t.havingStyle(t.style.text()),a=0;a<n.length;a++){var o=n[a];o==="~"&&(o="\\textasciitilde"),r.push(q.makeSymbol(o,"Typewriter-Regular",e.mode,i,["mord","texttt"]))}return q.makeSpan(["mord","text"].concat(i.sizingClasses(t)),q.tryCombineChars(r),i)},mathmlBuilder(e,t){var n=new V.TextNode(X1(e)),r=new V.MathNode("mtext",[n]);return r.setAttribute("mathvariant","monospace"),r}});var X1=e=>e.body.replace(/ /g,e.star?"␣":" "),Sr=E4,iv=`[ \r
	]`,UP="\\\\[a-zA-Z@]+",HP="\\\\[^\uD800-\uDFFF]",GP="("+UP+")"+iv+"*",KP=`\\\\(
|[ \r	]+
?)[ \r	]*`,m0="[̀-ͯ]",ZP=new RegExp(m0+"+$"),YP="("+iv+"+)|"+(KP+"|")+"([!-\\[\\]-‧‪-퟿豈-￿]"+(m0+"*")+"|[\uD800-\uDBFF][\uDC00-\uDFFF]"+(m0+"*")+"|\\\\verb\\*([^]).*?\\4|\\\\verb([^*a-zA-Z]).*?\\5"+("|"+GP)+("|"+HP+")");class U1{constructor(t,n){this.input=void 0,this.settings=void 0,this.tokenRegex=void 0,this.catcodes=void 0,this.input=t,this.settings=n,this.tokenRegex=new RegExp(YP,"g"),this.catcodes={"%":14,"~":13}}setCatcode(t,n){this.catcodes[t]=n}lex(){var t=this.input,n=this.tokenRegex.lastIndex;if(n===t.length)return new nn("EOF",new It(this,n,n));var r=this.tokenRegex.exec(t);if(r===null||r.index!==n)throw new X("Unexpected character: '"+t[n]+"'",new nn(t[n],new It(this,n,n+1)));var i=r[6]||r[3]||(r[2]?"\\ ":" ");if(this.catcodes[i]===14){var a=t.indexOf(`
`,this.tokenRegex.lastIndex);return a===-1?(this.tokenRegex.lastIndex=t.length,this.settings.reportNonstrict("commentAtEnd","% comment has no terminating newline; LaTeX would fail because of commenting the end of math mode (e.g. $)")):this.tokenRegex.lastIndex=a+1,this.lex()}return new nn(i,new It(this,n,this.tokenRegex.lastIndex))}}class QP{constructor(t,n){t===void 0&&(t={}),n===void 0&&(n={}),this.current=void 0,this.builtins=void 0,this.undefStack=void 0,this.current=n,this.builtins=t,this.undefStack=[]}beginGroup(){this.undefStack.push({})}endGroup(){if(this.undefStack.length===0)throw new X("Unbalanced namespace destruction: attempt to pop global namespace; please report this as a bug");var t=this.undefStack.pop();for(var n in t)t.hasOwnProperty(n)&&(t[n]==null?delete this.current[n]:this.current[n]=t[n])}endGroups(){for(;this.undefStack.length>0;)this.endGroup()}has(t){return this.current.hasOwnProperty(t)||this.builtins.hasOwnProperty(t)}get(t){return this.current.hasOwnProperty(t)?this.current[t]:this.builtins[t]}set(t,n,r){if(r===void 0&&(r=!1),r){for(var i=0;i<this.undefStack.length;i++)delete this.undefStack[i][t];this.undefStack.length>0&&(this.undefStack[this.undefStack.length-1][t]=n)}else{var a=this.undefStack[this.undefStack.length-1];a&&!a.hasOwnProperty(t)&&(a[t]=this.current[t])}n==null?delete this.current[t]:this.current[t]=n}}var JP=H4;x("\\noexpand",function(e){var t=e.popToken();return e.isExpandable(t.text)&&(t.noexpand=!0,t.treatAsRelax=!0),{tokens:[t],numArgs:0}});x("\\expandafter",function(e){var t=e.popToken();return e.expandOnce(!0),{tokens:[t],numArgs:0}});x("\\@firstoftwo",function(e){var t=e.consumeArgs(2);return{tokens:t[0],numArgs:0}});x("\\@secondoftwo",function(e){var t=e.consumeArgs(2);return{tokens:t[1],numArgs:0}});x("\\@ifnextchar",function(e){var t=e.consumeArgs(3);e.consumeSpaces();var n=e.future();return t[0].length===1&&t[0][0].text===n.text?{tokens:t[1],numArgs:0}:{tokens:t[2],numArgs:0}});x("\\@ifstar","\\@ifnextchar *{\\@firstoftwo{#1}}");x("\\TextOrMath",function(e){var t=e.consumeArgs(2);return e.mode==="text"?{tokens:t[0],numArgs:0}:{tokens:t[1],numArgs:0}});var H1={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};x("\\char",function(e){var t=e.popToken(),n,r="";if(t.text==="'")n=8,t=e.popToken();else if(t.text==='"')n=16,t=e.popToken();else if(t.text==="`")if(t=e.popToken(),t.text[0]==="\\")r=t.text.charCodeAt(1);else{if(t.text==="EOF")throw new X("\\char` missing argument");r=t.text.charCodeAt(0)}else n=10;if(n){if(r=H1[t.text],r==null||r>=n)throw new X("Invalid base-"+n+" digit "+t.text);for(var i;(i=H1[e.future().text])!=null&&i<n;)r*=n,r+=i,e.popToken()}return"\\@char{"+r+"}"});var pd=(e,t,n)=>{var r=e.consumeArg().tokens;if(r.length!==1)throw new X("\\newcommand's first argument must be a macro name");var i=r[0].text,a=e.isDefined(i);if(a&&!t)throw new X("\\newcommand{"+i+"} attempting to redefine "+(i+"; use \\renewcommand"));if(!a&&!n)throw new X("\\renewcommand{"+i+"} when command "+i+" does not yet exist; use \\newcommand");var o=0;if(r=e.consumeArg().tokens,r.length===1&&r[0].text==="["){for(var s="",l=e.expandNextToken();l.text!=="]"&&l.text!=="EOF";)s+=l.text,l=e.expandNextToken();if(!s.match(/^\s*[0-9]+\s*$/))throw new X("Invalid number of arguments: "+s);o=parseInt(s),r=e.consumeArg().tokens}return e.macros.set(i,{tokens:r,numArgs:o}),""};x("\\newcommand",e=>pd(e,!1,!0));x("\\renewcommand",e=>pd(e,!0,!1));x("\\providecommand",e=>pd(e,!0,!0));x("\\message",e=>{var t=e.consumeArgs(1)[0];return console.log(t.reverse().map(n=>n.text).join("")),""});x("\\errmessage",e=>{var t=e.consumeArgs(1)[0];return console.error(t.reverse().map(n=>n.text).join("")),""});x("\\show",e=>{var t=e.popToken(),n=t.text;return console.log(t,e.macros.get(n),Sr[n],De.math[n],De.text[n]),""});x("\\bgroup","{");x("\\egroup","}");x("~","\\nobreakspace");x("\\lq","`");x("\\rq","'");x("\\aa","\\r a");x("\\AA","\\r A");x("\\textcopyright","\\html@mathml{\\textcircled{c}}{\\char`©}");x("\\copyright","\\TextOrMath{\\textcopyright}{\\text{\\textcopyright}}");x("\\textregistered","\\html@mathml{\\textcircled{\\scriptsize R}}{\\char`®}");x("ℬ","\\mathscr{B}");x("ℰ","\\mathscr{E}");x("ℱ","\\mathscr{F}");x("ℋ","\\mathscr{H}");x("ℐ","\\mathscr{I}");x("ℒ","\\mathscr{L}");x("ℳ","\\mathscr{M}");x("ℛ","\\mathscr{R}");x("ℭ","\\mathfrak{C}");x("ℌ","\\mathfrak{H}");x("ℨ","\\mathfrak{Z}");x("\\Bbbk","\\Bbb{k}");x("·","\\cdotp");x("\\llap","\\mathllap{\\textrm{#1}}");x("\\rlap","\\mathrlap{\\textrm{#1}}");x("\\clap","\\mathclap{\\textrm{#1}}");x("\\mathstrut","\\vphantom{(}");x("\\underbar","\\underline{\\text{#1}}");x("\\not",'\\html@mathml{\\mathrel{\\mathrlap\\@not}}{\\char"338}');x("\\neq","\\html@mathml{\\mathrel{\\not=}}{\\mathrel{\\char`≠}}");x("\\ne","\\neq");x("≠","\\neq");x("\\notin","\\html@mathml{\\mathrel{{\\in}\\mathllap{/\\mskip1mu}}}{\\mathrel{\\char`∉}}");x("∉","\\notin");x("≘","\\html@mathml{\\mathrel{=\\kern{-1em}\\raisebox{0.4em}{$\\scriptsize\\frown$}}}{\\mathrel{\\char`≘}}");x("≙","\\html@mathml{\\stackrel{\\tiny\\wedge}{=}}{\\mathrel{\\char`≘}}");x("≚","\\html@mathml{\\stackrel{\\tiny\\vee}{=}}{\\mathrel{\\char`≚}}");x("≛","\\html@mathml{\\stackrel{\\scriptsize\\star}{=}}{\\mathrel{\\char`≛}}");x("≝","\\html@mathml{\\stackrel{\\tiny\\mathrm{def}}{=}}{\\mathrel{\\char`≝}}");x("≞","\\html@mathml{\\stackrel{\\tiny\\mathrm{m}}{=}}{\\mathrel{\\char`≞}}");x("≟","\\html@mathml{\\stackrel{\\tiny?}{=}}{\\mathrel{\\char`≟}}");x("⟂","\\perp");x("‼","\\mathclose{!\\mkern-0.8mu!}");x("∌","\\notni");x("⌜","\\ulcorner");x("⌝","\\urcorner");x("⌞","\\llcorner");x("⌟","\\lrcorner");x("©","\\copyright");x("®","\\textregistered");x("️","\\textregistered");x("\\ulcorner",'\\html@mathml{\\@ulcorner}{\\mathop{\\char"231c}}');x("\\urcorner",'\\html@mathml{\\@urcorner}{\\mathop{\\char"231d}}');x("\\llcorner",'\\html@mathml{\\@llcorner}{\\mathop{\\char"231e}}');x("\\lrcorner",'\\html@mathml{\\@lrcorner}{\\mathop{\\char"231f}}');x("\\vdots","{\\varvdots\\rule{0pt}{15pt}}");x("⋮","\\vdots");x("\\varGamma","\\mathit{\\Gamma}");x("\\varDelta","\\mathit{\\Delta}");x("\\varTheta","\\mathit{\\Theta}");x("\\varLambda","\\mathit{\\Lambda}");x("\\varXi","\\mathit{\\Xi}");x("\\varPi","\\mathit{\\Pi}");x("\\varSigma","\\mathit{\\Sigma}");x("\\varUpsilon","\\mathit{\\Upsilon}");x("\\varPhi","\\mathit{\\Phi}");x("\\varPsi","\\mathit{\\Psi}");x("\\varOmega","\\mathit{\\Omega}");x("\\substack","\\begin{subarray}{c}#1\\end{subarray}");x("\\colon","\\nobreak\\mskip2mu\\mathpunct{}\\mathchoice{\\mkern-3mu}{\\mkern-3mu}{}{}{:}\\mskip6mu\\relax");x("\\boxed","\\fbox{$\\displaystyle{#1}$}");x("\\iff","\\DOTSB\\;\\Longleftrightarrow\\;");x("\\implies","\\DOTSB\\;\\Longrightarrow\\;");x("\\impliedby","\\DOTSB\\;\\Longleftarrow\\;");x("\\dddot","{\\overset{\\raisebox{-0.1ex}{\\normalsize ...}}{#1}}");x("\\ddddot","{\\overset{\\raisebox{-0.1ex}{\\normalsize ....}}{#1}}");var G1={",":"\\dotsc","\\not":"\\dotsb","+":"\\dotsb","=":"\\dotsb","<":"\\dotsb",">":"\\dotsb","-":"\\dotsb","*":"\\dotsb",":":"\\dotsb","\\DOTSB":"\\dotsb","\\coprod":"\\dotsb","\\bigvee":"\\dotsb","\\bigwedge":"\\dotsb","\\biguplus":"\\dotsb","\\bigcap":"\\dotsb","\\bigcup":"\\dotsb","\\prod":"\\dotsb","\\sum":"\\dotsb","\\bigotimes":"\\dotsb","\\bigoplus":"\\dotsb","\\bigodot":"\\dotsb","\\bigsqcup":"\\dotsb","\\And":"\\dotsb","\\longrightarrow":"\\dotsb","\\Longrightarrow":"\\dotsb","\\longleftarrow":"\\dotsb","\\Longleftarrow":"\\dotsb","\\longleftrightarrow":"\\dotsb","\\Longleftrightarrow":"\\dotsb","\\mapsto":"\\dotsb","\\longmapsto":"\\dotsb","\\hookrightarrow":"\\dotsb","\\doteq":"\\dotsb","\\mathbin":"\\dotsb","\\mathrel":"\\dotsb","\\relbar":"\\dotsb","\\Relbar":"\\dotsb","\\xrightarrow":"\\dotsb","\\xleftarrow":"\\dotsb","\\DOTSI":"\\dotsi","\\int":"\\dotsi","\\oint":"\\dotsi","\\iint":"\\dotsi","\\iiint":"\\dotsi","\\iiiint":"\\dotsi","\\idotsint":"\\dotsi","\\DOTSX":"\\dotsx"};x("\\dots",function(e){var t="\\dotso",n=e.expandAfterFuture().text;return n in G1?t=G1[n]:(n.slice(0,4)==="\\not"||n in De.math&&te.contains(["bin","rel"],De.math[n].group))&&(t="\\dotsb"),t});var gd={")":!0,"]":!0,"\\rbrack":!0,"\\}":!0,"\\rbrace":!0,"\\rangle":!0,"\\rceil":!0,"\\rfloor":!0,"\\rgroup":!0,"\\rmoustache":!0,"\\right":!0,"\\bigr":!0,"\\biggr":!0,"\\Bigr":!0,"\\Biggr":!0,$:!0,";":!0,".":!0,",":!0};x("\\dotso",function(e){var t=e.future().text;return t in gd?"\\ldots\\,":"\\ldots"});x("\\dotsc",function(e){var t=e.future().text;return t in gd&&t!==","?"\\ldots\\,":"\\ldots"});x("\\cdots",function(e){var t=e.future().text;return t in gd?"\\@cdots\\,":"\\@cdots"});x("\\dotsb","\\cdots");x("\\dotsm","\\cdots");x("\\dotsi","\\!\\cdots");x("\\dotsx","\\ldots\\,");x("\\DOTSI","\\relax");x("\\DOTSB","\\relax");x("\\DOTSX","\\relax");x("\\tmspace","\\TextOrMath{\\kern#1#3}{\\mskip#1#2}\\relax");x("\\,","\\tmspace+{3mu}{.1667em}");x("\\thinspace","\\,");x("\\>","\\mskip{4mu}");x("\\:","\\tmspace+{4mu}{.2222em}");x("\\medspace","\\:");x("\\;","\\tmspace+{5mu}{.2777em}");x("\\thickspace","\\;");x("\\!","\\tmspace-{3mu}{.1667em}");x("\\negthinspace","\\!");x("\\negmedspace","\\tmspace-{4mu}{.2222em}");x("\\negthickspace","\\tmspace-{5mu}{.277em}");x("\\enspace","\\kern.5em ");x("\\enskip","\\hskip.5em\\relax");x("\\quad","\\hskip1em\\relax");x("\\qquad","\\hskip2em\\relax");x("\\tag","\\@ifstar\\tag@literal\\tag@paren");x("\\tag@paren","\\tag@literal{({#1})}");x("\\tag@literal",e=>{if(e.macros.get("\\df@tag"))throw new X("Multiple \\tag");return"\\gdef\\df@tag{\\text{#1}}"});x("\\bmod","\\mathchoice{\\mskip1mu}{\\mskip1mu}{\\mskip5mu}{\\mskip5mu}\\mathbin{\\rm mod}\\mathchoice{\\mskip1mu}{\\mskip1mu}{\\mskip5mu}{\\mskip5mu}");x("\\pod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern8mu}{\\mkern8mu}{\\mkern8mu}(#1)");x("\\pmod","\\pod{{\\rm mod}\\mkern6mu#1}");x("\\mod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern12mu}{\\mkern12mu}{\\mkern12mu}{\\rm mod}\\,\\,#1");x("\\newline","\\\\\\relax");x("\\TeX","\\textrm{\\html@mathml{T\\kern-.1667em\\raisebox{-.5ex}{E}\\kern-.125emX}{TeX}}");var av=G(Dn["Main-Regular"][84][1]-.7*Dn["Main-Regular"][65][1]);x("\\LaTeX","\\textrm{\\html@mathml{"+("L\\kern-.36em\\raisebox{"+av+"}{\\scriptstyle A}")+"\\kern-.15em\\TeX}{LaTeX}}");x("\\KaTeX","\\textrm{\\html@mathml{"+("K\\kern-.17em\\raisebox{"+av+"}{\\scriptstyle A}")+"\\kern-.15em\\TeX}{KaTeX}}");x("\\hspace","\\@ifstar\\@hspacer\\@hspace");x("\\@hspace","\\hskip #1\\relax");x("\\@hspacer","\\rule{0pt}{0pt}\\hskip #1\\relax");x("\\ordinarycolon",":");x("\\vcentcolon","\\mathrel{\\mathop\\ordinarycolon}");x("\\dblcolon",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-.9mu}\\vcentcolon}}{\\mathop{\\char"2237}}');x("\\coloneqq",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}=}}{\\mathop{\\char"2254}}');x("\\Coloneqq",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}=}}{\\mathop{\\char"2237\\char"3d}}');x("\\coloneq",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}}{\\mathop{\\char"3a\\char"2212}}');x("\\Coloneq",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}}{\\mathop{\\char"2237\\char"2212}}');x("\\eqqcolon",'\\html@mathml{\\mathrel{=\\mathrel{\\mkern-1.2mu}\\vcentcolon}}{\\mathop{\\char"2255}}');x("\\Eqqcolon",'\\html@mathml{\\mathrel{=\\mathrel{\\mkern-1.2mu}\\dblcolon}}{\\mathop{\\char"3d\\char"2237}}');x("\\eqcolon",'\\html@mathml{\\mathrel{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\vcentcolon}}{\\mathop{\\char"2239}}');x("\\Eqcolon",'\\html@mathml{\\mathrel{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\dblcolon}}{\\mathop{\\char"2212\\char"2237}}');x("\\colonapprox",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\approx}}{\\mathop{\\char"3a\\char"2248}}');x("\\Colonapprox",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\approx}}{\\mathop{\\char"2237\\char"2248}}');x("\\colonsim",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\sim}}{\\mathop{\\char"3a\\char"223c}}');x("\\Colonsim",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\sim}}{\\mathop{\\char"2237\\char"223c}}');x("∷","\\dblcolon");x("∹","\\eqcolon");x("≔","\\coloneqq");x("≕","\\eqqcolon");x("⩴","\\Coloneqq");x("\\ratio","\\vcentcolon");x("\\coloncolon","\\dblcolon");x("\\colonequals","\\coloneqq");x("\\coloncolonequals","\\Coloneqq");x("\\equalscolon","\\eqqcolon");x("\\equalscoloncolon","\\Eqqcolon");x("\\colonminus","\\coloneq");x("\\coloncolonminus","\\Coloneq");x("\\minuscolon","\\eqcolon");x("\\minuscoloncolon","\\Eqcolon");x("\\coloncolonapprox","\\Colonapprox");x("\\coloncolonsim","\\Colonsim");x("\\simcolon","\\mathrel{\\sim\\mathrel{\\mkern-1.2mu}\\vcentcolon}");x("\\simcoloncolon","\\mathrel{\\sim\\mathrel{\\mkern-1.2mu}\\dblcolon}");x("\\approxcolon","\\mathrel{\\approx\\mathrel{\\mkern-1.2mu}\\vcentcolon}");x("\\approxcoloncolon","\\mathrel{\\approx\\mathrel{\\mkern-1.2mu}\\dblcolon}");x("\\notni","\\html@mathml{\\not\\ni}{\\mathrel{\\char`∌}}");x("\\limsup","\\DOTSB\\operatorname*{lim\\,sup}");x("\\liminf","\\DOTSB\\operatorname*{lim\\,inf}");x("\\injlim","\\DOTSB\\operatorname*{inj\\,lim}");x("\\projlim","\\DOTSB\\operatorname*{proj\\,lim}");x("\\varlimsup","\\DOTSB\\operatorname*{\\overline{lim}}");x("\\varliminf","\\DOTSB\\operatorname*{\\underline{lim}}");x("\\varinjlim","\\DOTSB\\operatorname*{\\underrightarrow{lim}}");x("\\varprojlim","\\DOTSB\\operatorname*{\\underleftarrow{lim}}");x("\\gvertneqq","\\html@mathml{\\@gvertneqq}{≩}");x("\\lvertneqq","\\html@mathml{\\@lvertneqq}{≨}");x("\\ngeqq","\\html@mathml{\\@ngeqq}{≱}");x("\\ngeqslant","\\html@mathml{\\@ngeqslant}{≱}");x("\\nleqq","\\html@mathml{\\@nleqq}{≰}");x("\\nleqslant","\\html@mathml{\\@nleqslant}{≰}");x("\\nshortmid","\\html@mathml{\\@nshortmid}{∤}");x("\\nshortparallel","\\html@mathml{\\@nshortparallel}{∦}");x("\\nsubseteqq","\\html@mathml{\\@nsubseteqq}{⊈}");x("\\nsupseteqq","\\html@mathml{\\@nsupseteqq}{⊉}");x("\\varsubsetneq","\\html@mathml{\\@varsubsetneq}{⊊}");x("\\varsubsetneqq","\\html@mathml{\\@varsubsetneqq}{⫋}");x("\\varsupsetneq","\\html@mathml{\\@varsupsetneq}{⊋}");x("\\varsupsetneqq","\\html@mathml{\\@varsupsetneqq}{⫌}");x("\\imath","\\html@mathml{\\@imath}{ı}");x("\\jmath","\\html@mathml{\\@jmath}{ȷ}");x("\\llbracket","\\html@mathml{\\mathopen{[\\mkern-3.2mu[}}{\\mathopen{\\char`⟦}}");x("\\rrbracket","\\html@mathml{\\mathclose{]\\mkern-3.2mu]}}{\\mathclose{\\char`⟧}}");x("⟦","\\llbracket");x("⟧","\\rrbracket");x("\\lBrace","\\html@mathml{\\mathopen{\\{\\mkern-3.2mu[}}{\\mathopen{\\char`⦃}}");x("\\rBrace","\\html@mathml{\\mathclose{]\\mkern-3.2mu\\}}}{\\mathclose{\\char`⦄}}");x("⦃","\\lBrace");x("⦄","\\rBrace");x("\\minuso","\\mathbin{\\html@mathml{{\\mathrlap{\\mathchoice{\\kern{0.145em}}{\\kern{0.145em}}{\\kern{0.1015em}}{\\kern{0.0725em}}\\circ}{-}}}{\\char`⦵}}");x("⦵","\\minuso");x("\\darr","\\downarrow");x("\\dArr","\\Downarrow");x("\\Darr","\\Downarrow");x("\\lang","\\langle");x("\\rang","\\rangle");x("\\uarr","\\uparrow");x("\\uArr","\\Uparrow");x("\\Uarr","\\Uparrow");x("\\N","\\mathbb{N}");x("\\R","\\mathbb{R}");x("\\Z","\\mathbb{Z}");x("\\alef","\\aleph");x("\\alefsym","\\aleph");x("\\Alpha","\\mathrm{A}");x("\\Beta","\\mathrm{B}");x("\\bull","\\bullet");x("\\Chi","\\mathrm{X}");x("\\clubs","\\clubsuit");x("\\cnums","\\mathbb{C}");x("\\Complex","\\mathbb{C}");x("\\Dagger","\\ddagger");x("\\diamonds","\\diamondsuit");x("\\empty","\\emptyset");x("\\Epsilon","\\mathrm{E}");x("\\Eta","\\mathrm{H}");x("\\exist","\\exists");x("\\harr","\\leftrightarrow");x("\\hArr","\\Leftrightarrow");x("\\Harr","\\Leftrightarrow");x("\\hearts","\\heartsuit");x("\\image","\\Im");x("\\infin","\\infty");x("\\Iota","\\mathrm{I}");x("\\isin","\\in");x("\\Kappa","\\mathrm{K}");x("\\larr","\\leftarrow");x("\\lArr","\\Leftarrow");x("\\Larr","\\Leftarrow");x("\\lrarr","\\leftrightarrow");x("\\lrArr","\\Leftrightarrow");x("\\Lrarr","\\Leftrightarrow");x("\\Mu","\\mathrm{M}");x("\\natnums","\\mathbb{N}");x("\\Nu","\\mathrm{N}");x("\\Omicron","\\mathrm{O}");x("\\plusmn","\\pm");x("\\rarr","\\rightarrow");x("\\rArr","\\Rightarrow");x("\\Rarr","\\Rightarrow");x("\\real","\\Re");x("\\reals","\\mathbb{R}");x("\\Reals","\\mathbb{R}");x("\\Rho","\\mathrm{P}");x("\\sdot","\\cdot");x("\\sect","\\S");x("\\spades","\\spadesuit");x("\\sub","\\subset");x("\\sube","\\subseteq");x("\\supe","\\supseteq");x("\\Tau","\\mathrm{T}");x("\\thetasym","\\vartheta");x("\\weierp","\\wp");x("\\Zeta","\\mathrm{Z}");x("\\argmin","\\DOTSB\\operatorname*{arg\\,min}");x("\\argmax","\\DOTSB\\operatorname*{arg\\,max}");x("\\plim","\\DOTSB\\mathop{\\operatorname{plim}}\\limits");x("\\bra","\\mathinner{\\langle{#1}|}");x("\\ket","\\mathinner{|{#1}\\rangle}");x("\\braket","\\mathinner{\\langle{#1}\\rangle}");x("\\Bra","\\left\\langle#1\\right|");x("\\Ket","\\left|#1\\right\\rangle");var ov=e=>t=>{var n=t.consumeArg().tokens,r=t.consumeArg().tokens,i=t.consumeArg().tokens,a=t.consumeArg().tokens,o=t.macros.get("|"),s=t.macros.get("\\|");t.macros.beginGroup();var l=c=>m=>{e&&(m.macros.set("|",o),i.length&&m.macros.set("\\|",s));var d=c;if(!c&&i.length){var b=m.future();b.text==="|"&&(m.popToken(),d=!0)}return{tokens:d?i:r,numArgs:0}};t.macros.set("|",l(!1)),i.length&&t.macros.set("\\|",l(!0));var u=t.consumeArg().tokens,h=t.expandTokens([...a,...u,...n]);return t.macros.endGroup(),{tokens:h.reverse(),numArgs:0}};x("\\bra@ket",ov(!1));x("\\bra@set",ov(!0));x("\\Braket","\\bra@ket{\\left\\langle}{\\,\\middle\\vert\\,}{\\,\\middle\\vert\\,}{\\right\\rangle}");x("\\Set","\\bra@set{\\left\\{\\:}{\\;\\middle\\vert\\;}{\\;\\middle\\Vert\\;}{\\:\\right\\}}");x("\\set","\\bra@set{\\{\\,}{\\mid}{}{\\,\\}}");x("\\angln","{\\angl n}");x("\\blue","\\textcolor{##6495ed}{#1}");x("\\orange","\\textcolor{##ffa500}{#1}");x("\\pink","\\textcolor{##ff00af}{#1}");x("\\red","\\textcolor{##df0030}{#1}");x("\\green","\\textcolor{##28ae7b}{#1}");x("\\gray","\\textcolor{gray}{#1}");x("\\purple","\\textcolor{##9d38bd}{#1}");x("\\blueA","\\textcolor{##ccfaff}{#1}");x("\\blueB","\\textcolor{##80f6ff}{#1}");x("\\blueC","\\textcolor{##63d9ea}{#1}");x("\\blueD","\\textcolor{##11accd}{#1}");x("\\blueE","\\textcolor{##0c7f99}{#1}");x("\\tealA","\\textcolor{##94fff5}{#1}");x("\\tealB","\\textcolor{##26edd5}{#1}");x("\\tealC","\\textcolor{##01d1c1}{#1}");x("\\tealD","\\textcolor{##01a995}{#1}");x("\\tealE","\\textcolor{##208170}{#1}");x("\\greenA","\\textcolor{##b6ffb0}{#1}");x("\\greenB","\\textcolor{##8af281}{#1}");x("\\greenC","\\textcolor{##74cf70}{#1}");x("\\greenD","\\textcolor{##1fab54}{#1}");x("\\greenE","\\textcolor{##0d923f}{#1}");x("\\goldA","\\textcolor{##ffd0a9}{#1}");x("\\goldB","\\textcolor{##ffbb71}{#1}");x("\\goldC","\\textcolor{##ff9c39}{#1}");x("\\goldD","\\textcolor{##e07d10}{#1}");x("\\goldE","\\textcolor{##a75a05}{#1}");x("\\redA","\\textcolor{##fca9a9}{#1}");x("\\redB","\\textcolor{##ff8482}{#1}");x("\\redC","\\textcolor{##f9685d}{#1}");x("\\redD","\\textcolor{##e84d39}{#1}");x("\\redE","\\textcolor{##bc2612}{#1}");x("\\maroonA","\\textcolor{##ffbde0}{#1}");x("\\maroonB","\\textcolor{##ff92c6}{#1}");x("\\maroonC","\\textcolor{##ed5fa6}{#1}");x("\\maroonD","\\textcolor{##ca337c}{#1}");x("\\maroonE","\\textcolor{##9e034e}{#1}");x("\\purpleA","\\textcolor{##ddd7ff}{#1}");x("\\purpleB","\\textcolor{##c6b9fc}{#1}");x("\\purpleC","\\textcolor{##aa87ff}{#1}");x("\\purpleD","\\textcolor{##7854ab}{#1}");x("\\purpleE","\\textcolor{##543b78}{#1}");x("\\mintA","\\textcolor{##f5f9e8}{#1}");x("\\mintB","\\textcolor{##edf2df}{#1}");x("\\mintC","\\textcolor{##e0e5cc}{#1}");x("\\grayA","\\textcolor{##f6f7f7}{#1}");x("\\grayB","\\textcolor{##f0f1f2}{#1}");x("\\grayC","\\textcolor{##e3e5e6}{#1}");x("\\grayD","\\textcolor{##d6d8da}{#1}");x("\\grayE","\\textcolor{##babec2}{#1}");x("\\grayF","\\textcolor{##888d93}{#1}");x("\\grayG","\\textcolor{##626569}{#1}");x("\\grayH","\\textcolor{##3b3e40}{#1}");x("\\grayI","\\textcolor{##21242c}{#1}");x("\\kaBlue","\\textcolor{##314453}{#1}");x("\\kaGreen","\\textcolor{##71B307}{#1}");var sv={"^":!0,_:!0,"\\limits":!0,"\\nolimits":!0};class eD{constructor(t,n,r){this.settings=void 0,this.expansionCount=void 0,this.lexer=void 0,this.macros=void 0,this.stack=void 0,this.mode=void 0,this.settings=n,this.expansionCount=0,this.feed(t),this.macros=new QP(JP,n.macros),this.mode=r,this.stack=[]}feed(t){this.lexer=new U1(t,this.settings)}switchMode(t){this.mode=t}beginGroup(){this.macros.beginGroup()}endGroup(){this.macros.endGroup()}endGroups(){this.macros.endGroups()}future(){return this.stack.length===0&&this.pushToken(this.lexer.lex()),this.stack[this.stack.length-1]}popToken(){return this.future(),this.stack.pop()}pushToken(t){this.stack.push(t)}pushTokens(t){this.stack.push(...t)}scanArgument(t){var n,r,i;if(t){if(this.consumeSpaces(),this.future().text!=="[")return null;n=this.popToken(),{tokens:i,end:r}=this.consumeArg(["]"])}else({tokens:i,start:n,end:r}=this.consumeArg());return this.pushToken(new nn("EOF",r.loc)),this.pushTokens(i),n.range(r,"")}consumeSpaces(){for(;;){var t=this.future();if(t.text===" ")this.stack.pop();else break}}consumeArg(t){var n=[],r=t&&t.length>0;r||this.consumeSpaces();var i=this.future(),a,o=0,s=0;do{if(a=this.popToken(),n.push(a),a.text==="{")++o;else if(a.text==="}"){if(--o,o===-1)throw new X("Extra }",a)}else if(a.text==="EOF")throw new X("Unexpected end of input in a macro argument, expected '"+(t&&r?t[s]:"}")+"'",a);if(t&&r)if((o===0||o===1&&t[s]==="{")&&a.text===t[s]){if(++s,s===t.length){n.splice(-s,s);break}}else s=0}while(o!==0||r);return i.text==="{"&&n[n.length-1].text==="}"&&(n.pop(),n.shift()),n.reverse(),{tokens:n,start:i,end:a}}consumeArgs(t,n){if(n){if(n.length!==t+1)throw new X("The length of delimiters doesn't match the number of args!");for(var r=n[0],i=0;i<r.length;i++){var a=this.popToken();if(r[i]!==a.text)throw new X("Use of the macro doesn't match its definition",a)}}for(var o=[],s=0;s<t;s++)o.push(this.consumeArg(n&&n[s+1]).tokens);return o}countExpansion(t){if(this.expansionCount+=t,this.expansionCount>this.settings.maxExpand)throw new X("Too many expansions: infinite loop or need to increase maxExpand setting")}expandOnce(t){var n=this.popToken(),r=n.text,i=n.noexpand?null:this._getExpansion(r);if(i==null||t&&i.unexpandable){if(t&&i==null&&r[0]==="\\"&&!this.isDefined(r))throw new X("Undefined control sequence: "+r);return this.pushToken(n),!1}this.countExpansion(1);var a=i.tokens,o=this.consumeArgs(i.numArgs,i.delimiters);if(i.numArgs){a=a.slice();for(var s=a.length-1;s>=0;--s){var l=a[s];if(l.text==="#"){if(s===0)throw new X("Incomplete placeholder at end of macro body",l);if(l=a[--s],l.text==="#")a.splice(s+1,1);else if(/^[1-9]$/.test(l.text))a.splice(s,2,...o[+l.text-1]);else throw new X("Not a valid argument number",l)}}}return this.pushTokens(a),a.length}expandAfterFuture(){return this.expandOnce(),this.future()}expandNextToken(){for(;;)if(this.expandOnce()===!1){var t=this.stack.pop();return t.treatAsRelax&&(t.text="\\relax"),t}throw new Error}expandMacro(t){return this.macros.has(t)?this.expandTokens([new nn(t)]):void 0}expandTokens(t){var n=[],r=this.stack.length;for(this.pushTokens(t);this.stack.length>r;)if(this.expandOnce(!0)===!1){var i=this.stack.pop();i.treatAsRelax&&(i.noexpand=!1,i.treatAsRelax=!1),n.push(i)}return this.countExpansion(n.length),n}expandMacroAsText(t){var n=this.expandMacro(t);return n&&n.map(r=>r.text).join("")}_getExpansion(t){var n=this.macros.get(t);if(n==null)return n;if(t.length===1){var r=this.lexer.catcodes[t];if(r!=null&&r!==13)return}var i=typeof n=="function"?n(this):n;if(typeof i=="string"){var a=0;if(i.indexOf("#")!==-1)for(var o=i.replace(/##/g,"");o.indexOf("#"+(a+1))!==-1;)++a;for(var s=new U1(i,this.settings),l=[],u=s.lex();u.text!=="EOF";)l.push(u),u=s.lex();l.reverse();var h={tokens:l,numArgs:a};return h}return i}isDefined(t){return this.macros.has(t)||Sr.hasOwnProperty(t)||De.math.hasOwnProperty(t)||De.text.hasOwnProperty(t)||sv.hasOwnProperty(t)}isExpandable(t){var n=this.macros.get(t);return n!=null?typeof n=="string"||typeof n=="function"||!n.unexpandable:Sr.hasOwnProperty(t)&&!Sr[t].primitive}}var K1=/^[₊₋₌₍₎₀₁₂₃₄₅₆₇₈₉ₐₑₕᵢⱼₖₗₘₙₒₚᵣₛₜᵤᵥₓᵦᵧᵨᵩᵪ]/,Os=Object.freeze({"₊":"+","₋":"-","₌":"=","₍":"(","₎":")","₀":"0","₁":"1","₂":"2","₃":"3","₄":"4","₅":"5","₆":"6","₇":"7","₈":"8","₉":"9","ₐ":"a","ₑ":"e","ₕ":"h","ᵢ":"i","ⱼ":"j","ₖ":"k","ₗ":"l","ₘ":"m","ₙ":"n","ₒ":"o","ₚ":"p","ᵣ":"r","ₛ":"s","ₜ":"t","ᵤ":"u","ᵥ":"v","ₓ":"x","ᵦ":"β","ᵧ":"γ","ᵨ":"ρ","ᵩ":"ϕ","ᵪ":"χ","⁺":"+","⁻":"-","⁼":"=","⁽":"(","⁾":")","⁰":"0","¹":"1","²":"2","³":"3","⁴":"4","⁵":"5","⁶":"6","⁷":"7","⁸":"8","⁹":"9","ᴬ":"A","ᴮ":"B","ᴰ":"D","ᴱ":"E","ᴳ":"G","ᴴ":"H","ᴵ":"I","ᴶ":"J","ᴷ":"K","ᴸ":"L","ᴹ":"M","ᴺ":"N","ᴼ":"O","ᴾ":"P","ᴿ":"R","ᵀ":"T","ᵁ":"U","ⱽ":"V","ᵂ":"W","ᵃ":"a","ᵇ":"b","ᶜ":"c","ᵈ":"d","ᵉ":"e","ᶠ":"f","ᵍ":"g",ʰ:"h","ⁱ":"i",ʲ:"j","ᵏ":"k",ˡ:"l","ᵐ":"m",ⁿ:"n","ᵒ":"o","ᵖ":"p",ʳ:"r",ˢ:"s","ᵗ":"t","ᵘ":"u","ᵛ":"v",ʷ:"w",ˣ:"x",ʸ:"y","ᶻ":"z","ᵝ":"β","ᵞ":"γ","ᵟ":"δ","ᵠ":"ϕ","ᵡ":"χ","ᶿ":"θ"}),Nh={"́":{text:"\\'",math:"\\acute"},"̀":{text:"\\`",math:"\\grave"},"̈":{text:'\\"',math:"\\ddot"},"̃":{text:"\\~",math:"\\tilde"},"̄":{text:"\\=",math:"\\bar"},"̆":{text:"\\u",math:"\\breve"},"̌":{text:"\\v",math:"\\check"},"̂":{text:"\\^",math:"\\hat"},"̇":{text:"\\.",math:"\\dot"},"̊":{text:"\\r",math:"\\mathring"},"̋":{text:"\\H"},"̧":{text:"\\c"}},Z1={á:"á",à:"à",ä:"ä",ǟ:"ǟ",ã:"ã",ā:"ā",ă:"ă",ắ:"ắ",ằ:"ằ",ẵ:"ẵ",ǎ:"ǎ",â:"â",ấ:"ấ",ầ:"ầ",ẫ:"ẫ",ȧ:"ȧ",ǡ:"ǡ",å:"å",ǻ:"ǻ",ḃ:"ḃ",ć:"ć",ḉ:"ḉ",č:"č",ĉ:"ĉ",ċ:"ċ",ç:"ç",ď:"ď",ḋ:"ḋ",ḑ:"ḑ",é:"é",è:"è",ë:"ë",ẽ:"ẽ",ē:"ē",ḗ:"ḗ",ḕ:"ḕ",ĕ:"ĕ",ḝ:"ḝ",ě:"ě",ê:"ê",ế:"ế",ề:"ề",ễ:"ễ",ė:"ė",ȩ:"ȩ",ḟ:"ḟ",ǵ:"ǵ",ḡ:"ḡ",ğ:"ğ",ǧ:"ǧ",ĝ:"ĝ",ġ:"ġ",ģ:"ģ",ḧ:"ḧ",ȟ:"ȟ",ĥ:"ĥ",ḣ:"ḣ",ḩ:"ḩ",í:"í",ì:"ì",ï:"ï",ḯ:"ḯ",ĩ:"ĩ",ī:"ī",ĭ:"ĭ",ǐ:"ǐ",î:"î",ǰ:"ǰ",ĵ:"ĵ",ḱ:"ḱ",ǩ:"ǩ",ķ:"ķ",ĺ:"ĺ",ľ:"ľ",ļ:"ļ",ḿ:"ḿ",ṁ:"ṁ",ń:"ń",ǹ:"ǹ",ñ:"ñ",ň:"ň",ṅ:"ṅ",ņ:"ņ",ó:"ó",ò:"ò",ö:"ö",ȫ:"ȫ",õ:"õ",ṍ:"ṍ",ṏ:"ṏ",ȭ:"ȭ",ō:"ō",ṓ:"ṓ",ṑ:"ṑ",ŏ:"ŏ",ǒ:"ǒ",ô:"ô",ố:"ố",ồ:"ồ",ỗ:"ỗ",ȯ:"ȯ",ȱ:"ȱ",ő:"ő",ṕ:"ṕ",ṗ:"ṗ",ŕ:"ŕ",ř:"ř",ṙ:"ṙ",ŗ:"ŗ",ś:"ś",ṥ:"ṥ",š:"š",ṧ:"ṧ",ŝ:"ŝ",ṡ:"ṡ",ş:"ş",ẗ:"ẗ",ť:"ť",ṫ:"ṫ",ţ:"ţ",ú:"ú",ù:"ù",ü:"ü",ǘ:"ǘ",ǜ:"ǜ",ǖ:"ǖ",ǚ:"ǚ",ũ:"ũ",ṹ:"ṹ",ū:"ū",ṻ:"ṻ",ŭ:"ŭ",ǔ:"ǔ",û:"û",ů:"ů",ű:"ű",ṽ:"ṽ",ẃ:"ẃ",ẁ:"ẁ",ẅ:"ẅ",ŵ:"ŵ",ẇ:"ẇ",ẘ:"ẘ",ẍ:"ẍ",ẋ:"ẋ",ý:"ý",ỳ:"ỳ",ÿ:"ÿ",ỹ:"ỹ",ȳ:"ȳ",ŷ:"ŷ",ẏ:"ẏ",ẙ:"ẙ",ź:"ź",ž:"ž",ẑ:"ẑ",ż:"ż",Á:"Á",À:"À",Ä:"Ä",Ǟ:"Ǟ",Ã:"Ã",Ā:"Ā",Ă:"Ă",Ắ:"Ắ",Ằ:"Ằ",Ẵ:"Ẵ",Ǎ:"Ǎ",Â:"Â",Ấ:"Ấ",Ầ:"Ầ",Ẫ:"Ẫ",Ȧ:"Ȧ",Ǡ:"Ǡ",Å:"Å",Ǻ:"Ǻ",Ḃ:"Ḃ",Ć:"Ć",Ḉ:"Ḉ",Č:"Č",Ĉ:"Ĉ",Ċ:"Ċ",Ç:"Ç",Ď:"Ď",Ḋ:"Ḋ",Ḑ:"Ḑ",É:"É",È:"È",Ë:"Ë",Ẽ:"Ẽ",Ē:"Ē",Ḗ:"Ḗ",Ḕ:"Ḕ",Ĕ:"Ĕ",Ḝ:"Ḝ",Ě:"Ě",Ê:"Ê",Ế:"Ế",Ề:"Ề",Ễ:"Ễ",Ė:"Ė",Ȩ:"Ȩ",Ḟ:"Ḟ",Ǵ:"Ǵ",Ḡ:"Ḡ",Ğ:"Ğ",Ǧ:"Ǧ",Ĝ:"Ĝ",Ġ:"Ġ",Ģ:"Ģ",Ḧ:"Ḧ",Ȟ:"Ȟ",Ĥ:"Ĥ",Ḣ:"Ḣ",Ḩ:"Ḩ",Í:"Í",Ì:"Ì",Ï:"Ï",Ḯ:"Ḯ",Ĩ:"Ĩ",Ī:"Ī",Ĭ:"Ĭ",Ǐ:"Ǐ",Î:"Î",İ:"İ",Ĵ:"Ĵ",Ḱ:"Ḱ",Ǩ:"Ǩ",Ķ:"Ķ",Ĺ:"Ĺ",Ľ:"Ľ",Ļ:"Ļ",Ḿ:"Ḿ",Ṁ:"Ṁ",Ń:"Ń",Ǹ:"Ǹ",Ñ:"Ñ",Ň:"Ň",Ṅ:"Ṅ",Ņ:"Ņ",Ó:"Ó",Ò:"Ò",Ö:"Ö",Ȫ:"Ȫ",Õ:"Õ",Ṍ:"Ṍ",Ṏ:"Ṏ",Ȭ:"Ȭ",Ō:"Ō",Ṓ:"Ṓ",Ṑ:"Ṑ",Ŏ:"Ŏ",Ǒ:"Ǒ",Ô:"Ô",Ố:"Ố",Ồ:"Ồ",Ỗ:"Ỗ",Ȯ:"Ȯ",Ȱ:"Ȱ",Ő:"Ő",Ṕ:"Ṕ",Ṗ:"Ṗ",Ŕ:"Ŕ",Ř:"Ř",Ṙ:"Ṙ",Ŗ:"Ŗ",Ś:"Ś",Ṥ:"Ṥ",Š:"Š",Ṧ:"Ṧ",Ŝ:"Ŝ",Ṡ:"Ṡ",Ş:"Ş",Ť:"Ť",Ṫ:"Ṫ",Ţ:"Ţ",Ú:"Ú",Ù:"Ù",Ü:"Ü",Ǘ:"Ǘ",Ǜ:"Ǜ",Ǖ:"Ǖ",Ǚ:"Ǚ",Ũ:"Ũ",Ṹ:"Ṹ",Ū:"Ū",Ṻ:"Ṻ",Ŭ:"Ŭ",Ǔ:"Ǔ",Û:"Û",Ů:"Ů",Ű:"Ű",Ṽ:"Ṽ",Ẃ:"Ẃ",Ẁ:"Ẁ",Ẅ:"Ẅ",Ŵ:"Ŵ",Ẇ:"Ẇ",Ẍ:"Ẍ",Ẋ:"Ẋ",Ý:"Ý",Ỳ:"Ỳ",Ÿ:"Ÿ",Ỹ:"Ỹ",Ȳ:"Ȳ",Ŷ:"Ŷ",Ẏ:"Ẏ",Ź:"Ź",Ž:"Ž",Ẑ:"Ẑ",Ż:"Ż",ά:"ά",ὰ:"ὰ",ᾱ:"ᾱ",ᾰ:"ᾰ",έ:"έ",ὲ:"ὲ",ή:"ή",ὴ:"ὴ",ί:"ί",ὶ:"ὶ",ϊ:"ϊ",ΐ:"ΐ",ῒ:"ῒ",ῑ:"ῑ",ῐ:"ῐ",ό:"ό",ὸ:"ὸ",ύ:"ύ",ὺ:"ὺ",ϋ:"ϋ",ΰ:"ΰ",ῢ:"ῢ",ῡ:"ῡ",ῠ:"ῠ",ώ:"ώ",ὼ:"ὼ",Ύ:"Ύ",Ὺ:"Ὺ",Ϋ:"Ϋ",Ῡ:"Ῡ",Ῠ:"Ῠ",Ώ:"Ώ",Ὼ:"Ὼ"};class Du{constructor(t,n){this.mode=void 0,this.gullet=void 0,this.settings=void 0,this.leftrightDepth=void 0,this.nextToken=void 0,this.mode="math",this.gullet=new eD(t,n,this.mode),this.settings=n,this.leftrightDepth=0}expect(t,n){if(n===void 0&&(n=!0),this.fetch().text!==t)throw new X("Expected '"+t+"', got '"+this.fetch().text+"'",this.fetch());n&&this.consume()}consume(){this.nextToken=null}fetch(){return this.nextToken==null&&(this.nextToken=this.gullet.expandNextToken()),this.nextToken}switchMode(t){this.mode=t,this.gullet.switchMode(t)}parse(){this.settings.globalGroup||this.gullet.beginGroup(),this.settings.colorIsTextColor&&this.gullet.macros.set("\\color","\\textcolor");try{var t=this.parseExpression(!1);return this.expect("EOF"),this.settings.globalGroup||this.gullet.endGroup(),t}finally{this.gullet.endGroups()}}subparse(t){var n=this.nextToken;this.consume(),this.gullet.pushToken(new nn("}")),this.gullet.pushTokens(t);var r=this.parseExpression(!1);return this.expect("}"),this.nextToken=n,r}parseExpression(t,n){for(var r=[];;){this.mode==="math"&&this.consumeSpaces();var i=this.fetch();if(Du.endOfExpression.indexOf(i.text)!==-1||n&&i.text===n||t&&Sr[i.text]&&Sr[i.text].infix)break;var a=this.parseAtom(n);if(a){if(a.type==="internal")continue}else break;r.push(a)}return this.mode==="text"&&this.formLigatures(r),this.handleInfixNodes(r)}handleInfixNodes(t){for(var n=-1,r,i=0;i<t.length;i++)if(t[i].type==="infix"){if(n!==-1)throw new X("only one infix operator per group",t[i].token);n=i,r=t[i].replaceWith}if(n!==-1&&r){var a,o,s=t.slice(0,n),l=t.slice(n+1);s.length===1&&s[0].type==="ordgroup"?a=s[0]:a={type:"ordgroup",mode:this.mode,body:s},l.length===1&&l[0].type==="ordgroup"?o=l[0]:o={type:"ordgroup",mode:this.mode,body:l};var u;return r==="\\\\abovefrac"?u=this.callFunction(r,[a,t[n],o],[]):u=this.callFunction(r,[a,o],[]),[u]}else return t}handleSupSubscript(t){var n=this.fetch(),r=n.text;this.consume(),this.consumeSpaces();var i=this.parseGroup(t);if(!i)throw new X("Expected group after '"+r+"'",n);return i}formatUnsupportedCmd(t){for(var n=[],r=0;r<t.length;r++)n.push({type:"textord",mode:"text",text:t[r]});var i={type:"text",mode:this.mode,body:n},a={type:"color",mode:this.mode,color:this.settings.errorColor,body:[i]};return a}parseAtom(t){var n=this.parseGroup("atom",t);if(this.mode==="text")return n;for(var r,i;;){this.consumeSpaces();var a=this.fetch();if(a.text==="\\limits"||a.text==="\\nolimits"){if(n&&n.type==="op"){var o=a.text==="\\limits";n.limits=o,n.alwaysHandleSupSub=!0}else if(n&&n.type==="operatorname")n.alwaysHandleSupSub&&(n.limits=a.text==="\\limits");else throw new X("Limit controls must follow a math operator",a);this.consume()}else if(a.text==="^"){if(r)throw new X("Double superscript",a);r=this.handleSupSubscript("superscript")}else if(a.text==="_"){if(i)throw new X("Double subscript",a);i=this.handleSupSubscript("subscript")}else if(a.text==="'"){if(r)throw new X("Double superscript",a);var s={type:"textord",mode:this.mode,text:"\\prime"},l=[s];for(this.consume();this.fetch().text==="'";)l.push(s),this.consume();this.fetch().text==="^"&&l.push(this.handleSupSubscript("superscript")),r={type:"ordgroup",mode:this.mode,body:l}}else if(Os[a.text]){var u=K1.test(a.text),h=[];for(h.push(new nn(Os[a.text])),this.consume();;){var c=this.fetch().text;if(!Os[c]||K1.test(c)!==u)break;h.unshift(new nn(Os[c])),this.consume()}var m=this.subparse(h);u?i={type:"ordgroup",mode:"math",body:m}:r={type:"ordgroup",mode:"math",body:m}}else break}return r||i?{type:"supsub",mode:this.mode,base:n,sup:r,sub:i}:n}parseFunction(t,n){var r=this.fetch(),i=r.text,a=Sr[i];if(!a)return null;if(this.consume(),n&&n!=="atom"&&!a.allowedInArgument)throw new X("Got function '"+i+"' with no arguments"+(n?" as "+n:""),r);if(this.mode==="text"&&!a.allowedInText)throw new X("Can't use function '"+i+"' in text mode",r);if(this.mode==="math"&&a.allowedInMath===!1)throw new X("Can't use function '"+i+"' in math mode",r);var{args:o,optArgs:s}=this.parseArguments(i,a);return this.callFunction(i,o,s,r,t)}callFunction(t,n,r,i,a){var o={funcName:t,parser:this,token:i,breakOnTokenText:a},s=Sr[t];if(s&&s.handler)return s.handler(o,n,r);throw new X("No function handler for "+t)}parseArguments(t,n){var r=n.numArgs+n.numOptionalArgs;if(r===0)return{args:[],optArgs:[]};for(var i=[],a=[],o=0;o<r;o++){var s=n.argTypes&&n.argTypes[o],l=o<n.numOptionalArgs;(n.primitive&&s==null||n.type==="sqrt"&&o===1&&a[0]==null)&&(s="primitive");var u=this.parseGroupOfType("argument to '"+t+"'",s,l);if(l)a.push(u);else if(u!=null)i.push(u);else throw new X("Null argument, please report this as a bug")}return{args:i,optArgs:a}}parseGroupOfType(t,n,r){switch(n){case"color":return this.parseColorGroup(r);case"size":return this.parseSizeGroup(r);case"url":return this.parseUrlGroup(r);case"math":case"text":return this.parseArgumentGroup(r,n);case"hbox":{var i=this.parseArgumentGroup(r,"text");return i!=null?{type:"styling",mode:i.mode,body:[i],style:"text"}:null}case"raw":{var a=this.parseStringGroup("raw",r);return a!=null?{type:"raw",mode:"text",string:a.text}:null}case"primitive":{if(r)throw new X("A primitive argument cannot be optional");var o=this.parseGroup(t);if(o==null)throw new X("Expected group as "+t,this.fetch());return o}case"original":case null:case void 0:return this.parseArgumentGroup(r);default:throw new X("Unknown group type as "+t,this.fetch())}}consumeSpaces(){for(;this.fetch().text===" ";)this.consume()}parseStringGroup(t,n){var r=this.gullet.scanArgument(n);if(r==null)return null;for(var i="",a;(a=this.fetch()).text!=="EOF";)i+=a.text,this.consume();return this.consume(),r.text=i,r}parseRegexGroup(t,n){for(var r=this.fetch(),i=r,a="",o;(o=this.fetch()).text!=="EOF"&&t.test(a+o.text);)i=o,a+=i.text,this.consume();if(a==="")throw new X("Invalid "+n+": '"+r.text+"'",r);return r.range(i,a)}parseColorGroup(t){var n=this.parseStringGroup("color",t);if(n==null)return null;var r=/^(#[a-f0-9]{3}|#?[a-f0-9]{6}|[a-z]+)$/i.exec(n.text);if(!r)throw new X("Invalid color: '"+n.text+"'",n);var i=r[0];return/^[0-9a-f]{6}$/i.test(i)&&(i="#"+i),{type:"color-token",mode:this.mode,color:i}}parseSizeGroup(t){var n,r=!1;if(this.gullet.consumeSpaces(),!t&&this.gullet.future().text!=="{"?n=this.parseRegexGroup(/^[-+]? *(?:$|\d+|\d+\.\d*|\.\d*) *[a-z]{0,2} *$/,"size"):n=this.parseStringGroup("size",t),!n)return null;!t&&n.text.length===0&&(n.text="0pt",r=!0);var i=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(n.text);if(!i)throw new X("Invalid size: '"+n.text+"'",n);var a={number:+(i[1]+i[2]),unit:i[3]};if(!b4(a))throw new X("Invalid unit: '"+a.unit+"'",n);return{type:"size",mode:this.mode,value:a,isBlank:r}}parseUrlGroup(t){this.gullet.lexer.setCatcode("%",13),this.gullet.lexer.setCatcode("~",12);var n=this.parseStringGroup("url",t);if(this.gullet.lexer.setCatcode("%",14),this.gullet.lexer.setCatcode("~",13),n==null)return null;var r=n.text.replace(/\\([#$%&~_^{}])/g,"$1");return{type:"url",mode:this.mode,url:r}}parseArgumentGroup(t,n){var r=this.gullet.scanArgument(t);if(r==null)return null;var i=this.mode;n&&this.switchMode(n),this.gullet.beginGroup();var a=this.parseExpression(!1,"EOF");this.expect("EOF"),this.gullet.endGroup();var o={type:"ordgroup",mode:this.mode,loc:r.loc,body:a};return n&&this.switchMode(i),o}parseGroup(t,n){var r=this.fetch(),i=r.text,a;if(i==="{"||i==="\\begingroup"){this.consume();var o=i==="{"?"}":"\\endgroup";this.gullet.beginGroup();var s=this.parseExpression(!1,o),l=this.fetch();this.expect(o),this.gullet.endGroup(),a={type:"ordgroup",mode:this.mode,loc:It.range(r,l),body:s,semisimple:i==="\\begingroup"||void 0}}else if(a=this.parseFunction(n,t)||this.parseSymbol(),a==null&&i[0]==="\\"&&!sv.hasOwnProperty(i)){if(this.settings.throwOnError)throw new X("Undefined control sequence: "+i,r);a=this.formatUnsupportedCmd(i),this.consume()}return a}formLigatures(t){for(var n=t.length-1,r=0;r<n;++r){var i=t[r],a=i.text;a==="-"&&t[r+1].text==="-"&&(r+1<n&&t[r+2].text==="-"?(t.splice(r,3,{type:"textord",mode:"text",loc:It.range(i,t[r+2]),text:"---"}),n-=2):(t.splice(r,2,{type:"textord",mode:"text",loc:It.range(i,t[r+1]),text:"--"}),n-=1)),(a==="'"||a==="`")&&t[r+1].text===a&&(t.splice(r,2,{type:"textord",mode:"text",loc:It.range(i,t[r+1]),text:a+a}),n-=1)}}parseSymbol(){var t=this.fetch(),n=t.text;if(/^\\verb[^a-zA-Z]/.test(n)){this.consume();var r=n.slice(5),i=r.charAt(0)==="*";if(i&&(r=r.slice(1)),r.length<2||r.charAt(0)!==r.slice(-1))throw new X(`\\verb assertion failed --
                    please report what input caused this bug`);return r=r.slice(1,-1),{type:"verb",mode:"text",body:r,star:i}}Z1.hasOwnProperty(n[0])&&!De[this.mode][n[0]]&&(this.settings.strict&&this.mode==="math"&&this.settings.reportNonstrict("unicodeTextInMathMode",'Accented Unicode text character "'+n[0]+'" used in math mode',t),n=Z1[n[0]]+n.slice(1));var a=ZP.exec(n);a&&(n=n.substring(0,a.index),n==="i"?n="ı":n==="j"&&(n="ȷ"));var o;if(De[this.mode][n]){this.settings.strict&&this.mode==="math"&&s0.indexOf(n)>=0&&this.settings.reportNonstrict("unicodeTextInMathMode",'Latin-1/Unicode text character "'+n[0]+'" used in math mode',t);var s=De[this.mode][n].group,l=It.range(t),u;if(jC.hasOwnProperty(s)){var h=s;u={type:"atom",mode:this.mode,family:h,loc:l,text:n}}else u={type:s,mode:this.mode,loc:l,text:n};o=u}else if(n.charCodeAt(0)>=128)this.settings.strict&&(g4(n.charCodeAt(0))?this.mode==="math"&&this.settings.reportNonstrict("unicodeTextInMathMode",'Unicode text character "'+n[0]+'" used in math mode',t):this.settings.reportNonstrict("unknownSymbol",'Unrecognized Unicode character "'+n[0]+'"'+(" ("+n.charCodeAt(0)+")"),t)),o={type:"textord",mode:"text",loc:It.range(t),text:n};else return null;if(this.consume(),a)for(var c=0;c<a[0].length;c++){var m=a[0][c];if(!Nh[m])throw new X("Unknown accent ' "+m+"'",t);var d=Nh[m][this.mode]||Nh[m].text;if(!d)throw new X("Accent "+m+" unsupported in "+this.mode+" mode",t);o={type:"accent",mode:this.mode,loc:It.range(t),label:d,isStretchy:!1,isShifty:!0,base:o}}return o}}Du.endOfExpression=["}","\\endgroup","\\end","\\right","&"];var bd=function(t,n){if(!(typeof t=="string"||t instanceof String))throw new TypeError("KaTeX can only parse string typed expression");var r=new Du(t,n);delete r.gullet.macros.current["\\df@tag"];var i=r.parse();if(delete r.gullet.macros.current["\\current@color"],delete r.gullet.macros.current["\\color"],r.gullet.macros.get("\\df@tag")){if(!n.displayMode)throw new X("\\tag works only in display equations");i=[{type:"tag",mode:"text",body:i,tag:r.subparse([new nn("\\df@tag")])}]}return i},lv=function(t,n,r){n.textContent="";var i=yd(t,r).toNode();n.appendChild(i)};typeof document<"u"&&document.compatMode!=="CSS1Compat"&&(typeof console<"u"&&console.warn("Warning: KaTeX doesn't work in quirks mode. Make sure your website has a suitable doctype."),lv=function(){throw new X("KaTeX doesn't work in quirks mode.")});var tD=function(t,n){var r=yd(t,n).toMarkup();return r},nD=function(t,n){var r=new Jm(n);return bd(t,r)},uv=function(t,n,r){if(r.throwOnError||!(t instanceof X))throw t;var i=q.makeSpan(["katex-error"],[new on(n)]);return i.setAttribute("title",t.toString()),i.setAttribute("style","color:"+r.errorColor),i},yd=function(t,n){var r=new Jm(n);try{var i=bd(t,r);return cP(i,t,r)}catch(a){return uv(a,t,r)}},rD=function(t,n){var r=new Jm(n);try{var i=bd(t,r);return mP(i,t,r)}catch(a){return uv(a,t,r)}},Y1={version:"0.16.15",render:lv,renderToString:tD,ParseError:X,SETTINGS_SCHEMA:ul,__parse:nD,__renderToDomTree:yd,__renderToHTMLTree:rD,__setFontMetrics:qC,__defineSymbol:f,__defineFunction:Z,__defineMacro:x,__domTree:{Span:os,Anchor:nd,SymbolNode:on,SvgNode:ar,PathNode:Ir,LineNode:o0}};const iD={};function aD(e){const t=this,n=e||iD,r=t.data(),i=r.micromarkExtensions||(r.micromarkExtensions=[]),a=r.fromMarkdownExtensions||(r.fromMarkdownExtensions=[]),o=r.toMarkdownExtensions||(r.toMarkdownExtensions=[]);i.push(oC(n)),a.push(QE()),o.push(JE(n))}const oD=/[\0-\x1F!-,\.\/:-@\[-\^`\{-\xA9\xAB-\xB4\xB6-\xB9\xBB-\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0378\u0379\u037E\u0380-\u0385\u0387\u038B\u038D\u03A2\u03F6\u0482\u0530\u0557\u0558\u055A-\u055F\u0589-\u0590\u05BE\u05C0\u05C3\u05C6\u05C8-\u05CF\u05EB-\u05EE\u05F3-\u060F\u061B-\u061F\u066A-\u066D\u06D4\u06DD\u06DE\u06E9\u06FD\u06FE\u0700-\u070F\u074B\u074C\u07B2-\u07BF\u07F6-\u07F9\u07FB\u07FC\u07FE\u07FF\u082E-\u083F\u085C-\u085F\u086B-\u089F\u08B5\u08C8-\u08D2\u08E2\u0964\u0965\u0970\u0984\u098D\u098E\u0991\u0992\u09A9\u09B1\u09B3-\u09B5\u09BA\u09BB\u09C5\u09C6\u09C9\u09CA\u09CF-\u09D6\u09D8-\u09DB\u09DE\u09E4\u09E5\u09F2-\u09FB\u09FD\u09FF\u0A00\u0A04\u0A0B-\u0A0E\u0A11\u0A12\u0A29\u0A31\u0A34\u0A37\u0A3A\u0A3B\u0A3D\u0A43-\u0A46\u0A49\u0A4A\u0A4E-\u0A50\u0A52-\u0A58\u0A5D\u0A5F-\u0A65\u0A76-\u0A80\u0A84\u0A8E\u0A92\u0AA9\u0AB1\u0AB4\u0ABA\u0ABB\u0AC6\u0ACA\u0ACE\u0ACF\u0AD1-\u0ADF\u0AE4\u0AE5\u0AF0-\u0AF8\u0B00\u0B04\u0B0D\u0B0E\u0B11\u0B12\u0B29\u0B31\u0B34\u0B3A\u0B3B\u0B45\u0B46\u0B49\u0B4A\u0B4E-\u0B54\u0B58-\u0B5B\u0B5E\u0B64\u0B65\u0B70\u0B72-\u0B81\u0B84\u0B8B-\u0B8D\u0B91\u0B96-\u0B98\u0B9B\u0B9D\u0BA0-\u0BA2\u0BA5-\u0BA7\u0BAB-\u0BAD\u0BBA-\u0BBD\u0BC3-\u0BC5\u0BC9\u0BCE\u0BCF\u0BD1-\u0BD6\u0BD8-\u0BE5\u0BF0-\u0BFF\u0C0D\u0C11\u0C29\u0C3A-\u0C3C\u0C45\u0C49\u0C4E-\u0C54\u0C57\u0C5B-\u0C5F\u0C64\u0C65\u0C70-\u0C7F\u0C84\u0C8D\u0C91\u0CA9\u0CB4\u0CBA\u0CBB\u0CC5\u0CC9\u0CCE-\u0CD4\u0CD7-\u0CDD\u0CDF\u0CE4\u0CE5\u0CF0\u0CF3-\u0CFF\u0D0D\u0D11\u0D45\u0D49\u0D4F-\u0D53\u0D58-\u0D5E\u0D64\u0D65\u0D70-\u0D79\u0D80\u0D84\u0D97-\u0D99\u0DB2\u0DBC\u0DBE\u0DBF\u0DC7-\u0DC9\u0DCB-\u0DCE\u0DD5\u0DD7\u0DE0-\u0DE5\u0DF0\u0DF1\u0DF4-\u0E00\u0E3B-\u0E3F\u0E4F\u0E5A-\u0E80\u0E83\u0E85\u0E8B\u0EA4\u0EA6\u0EBE\u0EBF\u0EC5\u0EC7\u0ECE\u0ECF\u0EDA\u0EDB\u0EE0-\u0EFF\u0F01-\u0F17\u0F1A-\u0F1F\u0F2A-\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F48\u0F6D-\u0F70\u0F85\u0F98\u0FBD-\u0FC5\u0FC7-\u0FFF\u104A-\u104F\u109E\u109F\u10C6\u10C8-\u10CC\u10CE\u10CF\u10FB\u1249\u124E\u124F\u1257\u1259\u125E\u125F\u1289\u128E\u128F\u12B1\u12B6\u12B7\u12BF\u12C1\u12C6\u12C7\u12D7\u1311\u1316\u1317\u135B\u135C\u1360-\u137F\u1390-\u139F\u13F6\u13F7\u13FE-\u1400\u166D\u166E\u1680\u169B-\u169F\u16EB-\u16ED\u16F9-\u16FF\u170D\u1715-\u171F\u1735-\u173F\u1754-\u175F\u176D\u1771\u1774-\u177F\u17D4-\u17D6\u17D8-\u17DB\u17DE\u17DF\u17EA-\u180A\u180E\u180F\u181A-\u181F\u1879-\u187F\u18AB-\u18AF\u18F6-\u18FF\u191F\u192C-\u192F\u193C-\u1945\u196E\u196F\u1975-\u197F\u19AC-\u19AF\u19CA-\u19CF\u19DA-\u19FF\u1A1C-\u1A1F\u1A5F\u1A7D\u1A7E\u1A8A-\u1A8F\u1A9A-\u1AA6\u1AA8-\u1AAF\u1AC1-\u1AFF\u1B4C-\u1B4F\u1B5A-\u1B6A\u1B74-\u1B7F\u1BF4-\u1BFF\u1C38-\u1C3F\u1C4A-\u1C4C\u1C7E\u1C7F\u1C89-\u1C8F\u1CBB\u1CBC\u1CC0-\u1CCF\u1CD3\u1CFB-\u1CFF\u1DFA\u1F16\u1F17\u1F1E\u1F1F\u1F46\u1F47\u1F4E\u1F4F\u1F58\u1F5A\u1F5C\u1F5E\u1F7E\u1F7F\u1FB5\u1FBD\u1FBF-\u1FC1\u1FC5\u1FCD-\u1FCF\u1FD4\u1FD5\u1FDC-\u1FDF\u1FED-\u1FF1\u1FF5\u1FFD-\u203E\u2041-\u2053\u2055-\u2070\u2072-\u207E\u2080-\u208F\u209D-\u20CF\u20F1-\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F-\u215F\u2189-\u24B5\u24EA-\u2BFF\u2C2F\u2C5F\u2CE5-\u2CEA\u2CF4-\u2CFF\u2D26\u2D28-\u2D2C\u2D2E\u2D2F\u2D68-\u2D6E\u2D70-\u2D7E\u2D97-\u2D9F\u2DA7\u2DAF\u2DB7\u2DBF\u2DC7\u2DCF\u2DD7\u2DDF\u2E00-\u2E2E\u2E30-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u3040\u3097\u3098\u309B\u309C\u30A0\u30FB\u3100-\u3104\u3130\u318F-\u319F\u31C0-\u31EF\u3200-\u33FF\u4DC0-\u4DFF\u9FFD-\u9FFF\uA48D-\uA4CF\uA4FE\uA4FF\uA60D-\uA60F\uA62C-\uA63F\uA673\uA67E\uA6F2-\uA716\uA720\uA721\uA789\uA78A\uA7C0\uA7C1\uA7CB-\uA7F4\uA828-\uA82B\uA82D-\uA83F\uA874-\uA87F\uA8C6-\uA8CF\uA8DA-\uA8DF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA954-\uA95F\uA97D-\uA97F\uA9C1-\uA9CE\uA9DA-\uA9DF\uA9FF\uAA37-\uAA3F\uAA4E\uAA4F\uAA5A-\uAA5F\uAA77-\uAA79\uAAC3-\uAADA\uAADE\uAADF\uAAF0\uAAF1\uAAF7-\uAB00\uAB07\uAB08\uAB0F\uAB10\uAB17-\uAB1F\uAB27\uAB2F\uAB5B\uAB6A-\uAB6F\uABEB\uABEE\uABEF\uABFA-\uABFF\uD7A4-\uD7AF\uD7C7-\uD7CA\uD7FC-\uD7FF\uE000-\uF8FF\uFA6E\uFA6F\uFADA-\uFAFF\uFB07-\uFB12\uFB18-\uFB1C\uFB29\uFB37\uFB3D\uFB3F\uFB42\uFB45\uFBB2-\uFBD2\uFD3E-\uFD4F\uFD90\uFD91\uFDC8-\uFDEF\uFDFC-\uFDFF\uFE10-\uFE1F\uFE30-\uFE32\uFE35-\uFE4C\uFE50-\uFE6F\uFE75\uFEFD-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF3E\uFF40\uFF5B-\uFF65\uFFBF-\uFFC1\uFFC8\uFFC9\uFFD0\uFFD1\uFFD8\uFFD9\uFFDD-\uFFFF]|\uD800[\uDC0C\uDC27\uDC3B\uDC3E\uDC4E\uDC4F\uDC5E-\uDC7F\uDCFB-\uDD3F\uDD75-\uDDFC\uDDFE-\uDE7F\uDE9D-\uDE9F\uDED1-\uDEDF\uDEE1-\uDEFF\uDF20-\uDF2C\uDF4B-\uDF4F\uDF7B-\uDF7F\uDF9E\uDF9F\uDFC4-\uDFC7\uDFD0\uDFD6-\uDFFF]|\uD801[\uDC9E\uDC9F\uDCAA-\uDCAF\uDCD4-\uDCD7\uDCFC-\uDCFF\uDD28-\uDD2F\uDD64-\uDDFF\uDF37-\uDF3F\uDF56-\uDF5F\uDF68-\uDFFF]|\uD802[\uDC06\uDC07\uDC09\uDC36\uDC39-\uDC3B\uDC3D\uDC3E\uDC56-\uDC5F\uDC77-\uDC7F\uDC9F-\uDCDF\uDCF3\uDCF6-\uDCFF\uDD16-\uDD1F\uDD3A-\uDD7F\uDDB8-\uDDBD\uDDC0-\uDDFF\uDE04\uDE07-\uDE0B\uDE14\uDE18\uDE36\uDE37\uDE3B-\uDE3E\uDE40-\uDE5F\uDE7D-\uDE7F\uDE9D-\uDEBF\uDEC8\uDEE7-\uDEFF\uDF36-\uDF3F\uDF56-\uDF5F\uDF73-\uDF7F\uDF92-\uDFFF]|\uD803[\uDC49-\uDC7F\uDCB3-\uDCBF\uDCF3-\uDCFF\uDD28-\uDD2F\uDD3A-\uDE7F\uDEAA\uDEAD-\uDEAF\uDEB2-\uDEFF\uDF1D-\uDF26\uDF28-\uDF2F\uDF51-\uDFAF\uDFC5-\uDFDF\uDFF7-\uDFFF]|\uD804[\uDC47-\uDC65\uDC70-\uDC7E\uDCBB-\uDCCF\uDCE9-\uDCEF\uDCFA-\uDCFF\uDD35\uDD40-\uDD43\uDD48-\uDD4F\uDD74\uDD75\uDD77-\uDD7F\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDFF\uDE12\uDE38-\uDE3D\uDE3F-\uDE7F\uDE87\uDE89\uDE8E\uDE9E\uDEA9-\uDEAF\uDEEB-\uDEEF\uDEFA-\uDEFF\uDF04\uDF0D\uDF0E\uDF11\uDF12\uDF29\uDF31\uDF34\uDF3A\uDF45\uDF46\uDF49\uDF4A\uDF4E\uDF4F\uDF51-\uDF56\uDF58-\uDF5C\uDF64\uDF65\uDF6D-\uDF6F\uDF75-\uDFFF]|\uD805[\uDC4B-\uDC4F\uDC5A-\uDC5D\uDC62-\uDC7F\uDCC6\uDCC8-\uDCCF\uDCDA-\uDD7F\uDDB6\uDDB7\uDDC1-\uDDD7\uDDDE-\uDDFF\uDE41-\uDE43\uDE45-\uDE4F\uDE5A-\uDE7F\uDEB9-\uDEBF\uDECA-\uDEFF\uDF1B\uDF1C\uDF2C-\uDF2F\uDF3A-\uDFFF]|\uD806[\uDC3B-\uDC9F\uDCEA-\uDCFE\uDD07\uDD08\uDD0A\uDD0B\uDD14\uDD17\uDD36\uDD39\uDD3A\uDD44-\uDD4F\uDD5A-\uDD9F\uDDA8\uDDA9\uDDD8\uDDD9\uDDE2\uDDE5-\uDDFF\uDE3F-\uDE46\uDE48-\uDE4F\uDE9A-\uDE9C\uDE9E-\uDEBF\uDEF9-\uDFFF]|\uD807[\uDC09\uDC37\uDC41-\uDC4F\uDC5A-\uDC71\uDC90\uDC91\uDCA8\uDCB7-\uDCFF\uDD07\uDD0A\uDD37-\uDD39\uDD3B\uDD3E\uDD48-\uDD4F\uDD5A-\uDD5F\uDD66\uDD69\uDD8F\uDD92\uDD99-\uDD9F\uDDAA-\uDEDF\uDEF7-\uDFAF\uDFB1-\uDFFF]|\uD808[\uDF9A-\uDFFF]|\uD809[\uDC6F-\uDC7F\uDD44-\uDFFF]|[\uD80A\uD80B\uD80E-\uD810\uD812-\uD819\uD824-\uD82B\uD82D\uD82E\uD830-\uD833\uD837\uD839\uD83D\uD83F\uD87B-\uD87D\uD87F\uD885-\uDB3F\uDB41-\uDBFF][\uDC00-\uDFFF]|\uD80D[\uDC2F-\uDFFF]|\uD811[\uDE47-\uDFFF]|\uD81A[\uDE39-\uDE3F\uDE5F\uDE6A-\uDECF\uDEEE\uDEEF\uDEF5-\uDEFF\uDF37-\uDF3F\uDF44-\uDF4F\uDF5A-\uDF62\uDF78-\uDF7C\uDF90-\uDFFF]|\uD81B[\uDC00-\uDE3F\uDE80-\uDEFF\uDF4B-\uDF4E\uDF88-\uDF8E\uDFA0-\uDFDF\uDFE2\uDFE5-\uDFEF\uDFF2-\uDFFF]|\uD821[\uDFF8-\uDFFF]|\uD823[\uDCD6-\uDCFF\uDD09-\uDFFF]|\uD82C[\uDD1F-\uDD4F\uDD53-\uDD63\uDD68-\uDD6F\uDEFC-\uDFFF]|\uD82F[\uDC6B-\uDC6F\uDC7D-\uDC7F\uDC89-\uDC8F\uDC9A-\uDC9C\uDC9F-\uDFFF]|\uD834[\uDC00-\uDD64\uDD6A-\uDD6C\uDD73-\uDD7A\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDE41\uDE45-\uDFFF]|\uD835[\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3\uDFCC\uDFCD]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE9A\uDEA0\uDEB0-\uDFFF]|\uD838[\uDC07\uDC19\uDC1A\uDC22\uDC25\uDC2B-\uDCFF\uDD2D-\uDD2F\uDD3E\uDD3F\uDD4A-\uDD4D\uDD4F-\uDEBF\uDEFA-\uDFFF]|\uD83A[\uDCC5-\uDCCF\uDCD7-\uDCFF\uDD4C-\uDD4F\uDD5A-\uDFFF]|\uD83B[\uDC00-\uDDFF\uDE04\uDE20\uDE23\uDE25\uDE26\uDE28\uDE33\uDE38\uDE3A\uDE3C-\uDE41\uDE43-\uDE46\uDE48\uDE4A\uDE4C\uDE50\uDE53\uDE55\uDE56\uDE58\uDE5A\uDE5C\uDE5E\uDE60\uDE63\uDE65\uDE66\uDE6B\uDE73\uDE78\uDE7D\uDE7F\uDE8A\uDE9C-\uDEA0\uDEA4\uDEAA\uDEBC-\uDFFF]|\uD83C[\uDC00-\uDD2F\uDD4A-\uDD4F\uDD6A-\uDD6F\uDD8A-\uDFFF]|\uD83E[\uDC00-\uDFEF\uDFFA-\uDFFF]|\uD869[\uDEDE-\uDEFF]|\uD86D[\uDF35-\uDF3F]|\uD86E[\uDC1E\uDC1F]|\uD873[\uDEA2-\uDEAF]|\uD87A[\uDFE1-\uDFFF]|\uD87E[\uDE1E-\uDFFF]|\uD884[\uDF4B-\uDFFF]|\uDB40[\uDC00-\uDCFF\uDDF0-\uDFFF]/g,sD=Object.hasOwnProperty;class lD{constructor(){this.occurrences,this.reset()}slug(t,n){const r=this;let i=uD(t,n===!0);const a=i;for(;sD.call(r.occurrences,i);)r.occurrences[a]++,i=a+"-"+r.occurrences[a];return r.occurrences[i]=0,i}reset(){this.occurrences=Object.create(null)}}function uD(e,t){return typeof e!="string"?"":(t||(e=e.toLowerCase()),e.replace(oD,"").replace(/ /g,"-"))}function hD(e){const t=e.type==="element"?e.tagName.toLowerCase():"",n=t.length===2&&t.charCodeAt(0)===104?t.charCodeAt(1):0;return n>48&&n<55?n-48:void 0}function cD(e){return"children"in e?hv(e):"value"in e?e.value:""}function mD(e){return e.type==="text"?e.value:"children"in e?hv(e):""}function hv(e){let t=-1;const n=[];for(;++t<e.children.length;)n[t]=mD(e.children[t]);return n.join("")}const dD={},Q1=new lD;function fD(e){const n=(e||dD).prefix||"";return function(r){Q1.reset(),Ym(r,"element",function(i){hD(i)&&!i.properties.id&&(i.properties.id=n+Q1.slug(cD(i)))})}}const J1=/[#.]/g;function pD(e,t){const n=e||"",r={};let i=0,a,o;for(;i<n.length;){J1.lastIndex=i;const s=J1.exec(n),l=n.slice(i,s?s.index:n.length);l&&(a?a==="#"?r.id=l:Array.isArray(r.className)?r.className.push(l):r.className=[l]:o=l,i+=l.length),s&&(a=s[0],i++)}return{type:"element",tagName:o||t||"div",properties:r,children:[]}}const d0={}.hasOwnProperty;function cv(e,t,n){const r=n&&$D(n);function i(a,o,...s){let l=-1,u;if(a==null){u={type:"root",children:[]};const h=o;s.unshift(h)}else if(u=pD(a,t),u.tagName=u.tagName.toLowerCase(),r&&d0.call(r,u.tagName)&&(u.tagName=r[u.tagName]),gD(o))s.unshift(o);else{let h;for(h in o)d0.call(o,h)&&bD(e,u.properties,h,o[h])}for(;++l<s.length;)f0(u.children,s[l]);return u.type==="element"&&u.tagName==="template"&&(u.content={type:"root",children:u.children},u.children=[]),u}return i}function gD(e){if(e===null||typeof e!="object"||Array.isArray(e))return!0;if(typeof e.type!="string")return!1;const t=e,n=Object.keys(e);for(const r of n){const i=t[r];if(i&&typeof i=="object"){if(!Array.isArray(i))return!0;const a=i;for(const o of a)if(typeof o!="number"&&typeof o!="string")return!0}}return!!("children"in e&&Array.isArray(e.children))}function bD(e,t,n,r){const i=N$(e,n);let a=-1,o;if(r!=null){if(typeof r=="number"){if(Number.isNaN(r))return;o=r}else typeof r=="boolean"?o=r:typeof r=="string"?i.spaceSeparated?o=Dp(r):i.commaSeparated?o=kp(r):i.commaOrSpaceSeparated?o=Dp(kp(r).join(" ")):o=eg(i,i.property,r):Array.isArray(r)?o=r.concat():o=i.property==="style"?yD(r):String(r);if(Array.isArray(o)){const s=[];for(;++a<o.length;){const l=eg(i,i.property,o[a]);s[a]=l}o=s}if(i.property==="className"&&Array.isArray(t.className)){const s=o;o=t.className.concat(s)}t[i.property]=o}}function f0(e,t){let n=-1;if(t!=null)if(typeof t=="string"||typeof t=="number")e.push({type:"text",value:String(t)});else if(Array.isArray(t))for(;++n<t.length;)f0(e,t[n]);else if(typeof t=="object"&&"type"in t)t.type==="root"?f0(e,t.children):e.push(t);else throw new Error("Expected node, nodes, or string, got `"+t+"`")}function eg(e,t,n){if(typeof n=="string"){if(e.number&&n&&!Number.isNaN(Number(n)))return Number(n);if((e.boolean||e.overloadedBoolean)&&(n===""||No(n)===No(t)))return!0}return n}function yD(e){const t=[];let n;for(n in e)d0.call(e,n)&&t.push([n,e[n]].join(": "));return t.join("; ")}function $D(e){const t={};let n=-1;for(;++n<e.length;)t[e[n].toLowerCase()]=e[n];return t}const vD=["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","solidColor","textArea","textPath"],_D=cv(I$,"div"),xD=cv($u,"g",vD),Ih={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function wD(e,t){return mv(e,{})||{type:"root",children:[]}}function mv(e,t){const n=kD(e,t);return n&&t.afterTransform&&t.afterTransform(e,n),n}function kD(e,t){switch(e.nodeType){case 1:return PD(e,t);case 3:return ED(e);case 8:return CD(e);case 9:return tg(e,t);case 10:return SD();case 11:return tg(e,t);default:return}}function tg(e,t){return{type:"root",children:dv(e,t)}}function SD(){return{type:"doctype"}}function ED(e){return{type:"text",value:e.nodeValue||""}}function CD(e){return{type:"comment",value:e.nodeValue||""}}function PD(e,t){const n=e.namespaceURI,r=n===Ih.svg?xD:_D,i=n===Ih.html?e.tagName.toLowerCase():e.tagName,a=n===Ih.html&&i==="template"?e.content:e,o=e.getAttributeNames(),s={};let l=-1;for(;++l<o.length;)s[o[l]]=e.getAttribute(o[l])||"";return r(i,s,dv(a,t))}function dv(e,t){const n=e.childNodes,r=[];let i=-1;for(;++i<n.length;){const a=mv(n[i],t);a!==void 0&&r.push(a)}return r}new DOMParser;function DD(e,t){const n=TD(e);return wD(n)}function TD(e){const t=document.createElement("template");return t.innerHTML=e,t.content}const ng=function(e,t,n){const r=Zm(n);if(!e||!e.type||!e.children)throw new Error("Expected parent node");if(typeof t=="number"){if(t<0||t===Number.POSITIVE_INFINITY)throw new Error("Expected positive finite number as index")}else if(t=e.children.indexOf(t),t<0)throw new Error("Expected child node or index");for(;++t<e.children.length;)if(r(e.children[t],t,e))return e.children[t]},wi=function(e){if(e==null)return MD;if(typeof e=="string")return zD(e);if(typeof e=="object")return AD(e);if(typeof e=="function")return $d(e);throw new Error("Expected function, string, or array as `test`")};function AD(e){const t=[];let n=-1;for(;++n<e.length;)t[n]=wi(e[n]);return $d(r);function r(...i){let a=-1;for(;++a<t.length;)if(t[a].apply(this,i))return!0;return!1}}function zD(e){return $d(t);function t(n){return n.tagName===e}}function $d(e){return t;function t(n,r,i){return!!(FD(n)&&e.call(this,n,typeof r=="number"?r:void 0,i||void 0))}}function MD(e){return!!(e&&typeof e=="object"&&"type"in e&&e.type==="element"&&"tagName"in e&&typeof e.tagName=="string")}function FD(e){return e!==null&&typeof e=="object"&&"type"in e&&"tagName"in e}const rg=/\n/g,ig=/[\t ]+/g,p0=wi("br"),ag=wi(jD),qD=wi("p"),og=wi("tr"),RD=wi(["datalist","head","noembed","noframes","noscript","rp","script","style","template","title",OD,VD]),fv=wi(["address","article","aside","blockquote","body","caption","center","dd","dialog","dir","dl","dt","div","figure","figcaption","footer","form,","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","legend","li","listing","main","menu","nav","ol","p","plaintext","pre","section","ul","xmp"]);function ND(e,t){const n=t||{},r="children"in e?e.children:[],i=fv(e),a=bv(e,{whitespace:n.whitespace||"normal",breakBefore:!1,breakAfter:!1}),o=[];(e.type==="text"||e.type==="comment")&&o.push(...gv(e,{whitespace:a,breakBefore:!0,breakAfter:!0}));let s=-1;for(;++s<r.length;)o.push(...pv(r[s],e,{whitespace:a,breakBefore:s?void 0:i,breakAfter:s<r.length-1?p0(r[s+1]):i}));const l=[];let u;for(s=-1;++s<o.length;){const h=o[s];typeof h=="number"?u!==void 0&&h>u&&(u=h):h&&(u!==void 0&&u>-1&&l.push(`
`.repeat(u)||" "),u=-1,l.push(h))}return l.join("")}function pv(e,t,n){return e.type==="element"?ID(e,t,n):e.type==="text"?n.whitespace==="normal"?gv(e,n):BD(e):[]}function ID(e,t,n){const r=bv(e,n),i=e.children||[];let a=-1,o=[];if(RD(e))return o;let s,l;for(p0(e)||og(e)&&ng(t,e,og)?l=`
`:qD(e)?(s=2,l=2):fv(e)&&(s=1,l=1);++a<i.length;)o=o.concat(pv(i[a],e,{whitespace:r,breakBefore:a?void 0:s,breakAfter:a<i.length-1?p0(i[a+1]):l}));return ag(e)&&ng(t,e,ag)&&o.push("	"),s&&o.unshift(s),l&&o.push(l),o}function gv(e,t){const n=String(e.value),r=[],i=[];let a=0;for(;a<=n.length;){rg.lastIndex=a;const l=rg.exec(n),u=l&&"index"in l?l.index:n.length;r.push(LD(n.slice(a,u).replace(/[\u061C\u200E\u200F\u202A-\u202E\u2066-\u2069]/g,""),a===0?t.breakBefore:!0,u===n.length?t.breakAfter:!0)),a=u+1}let o=-1,s;for(;++o<r.length;)r[o].charCodeAt(r[o].length-1)===8203||o<r.length-1&&r[o+1].charCodeAt(0)===8203?(i.push(r[o]),s=void 0):r[o]?(typeof s=="number"&&i.push(s),i.push(r[o]),s=0):(o===0||o===r.length-1)&&i.push(0);return i}function BD(e){return[String(e.value)]}function LD(e,t,n){const r=[];let i=0,a;for(;i<e.length;){ig.lastIndex=i;const o=ig.exec(e);a=o?o.index:e.length,!i&&!a&&o&&!t&&r.push(""),i!==a&&r.push(e.slice(i,a)),i=o?a+o[0].length:a}return i!==a&&!n&&r.push(""),r.join(" ")}function bv(e,t){if(e.type==="element"){const n=e.properties||{};switch(e.tagName){case"listing":case"plaintext":case"xmp":return"pre";case"nobr":return"nowrap";case"pre":return n.wrap?"pre-wrap":"pre";case"td":case"th":return n.noWrap?"nowrap":t.whitespace;case"textarea":return"pre-wrap"}}return t.whitespace}function OD(e){return!!(e.properties||{}).hidden}function jD(e){return e.tagName==="td"||e.tagName==="th"}function VD(e){return e.tagName==="dialog"&&!(e.properties||{}).open}const WD={},XD=[];function UD(e){const t=e||WD;return function(n,r){m4(n,"element",function(i,a){const o=Array.isArray(i.properties.className)?i.properties.className:XD,s=o.includes("language-math"),l=o.includes("math-display"),u=o.includes("math-inline");let h=l;if(!s&&!l&&!u)return;let c=a[a.length-1],m=i;if(i.tagName==="code"&&s&&c&&c.type==="element"&&c.tagName==="pre"&&(m=c,c=a[a.length-2],h=!0),!c)return;const d=ND(m,{whitespace:"pre"});let b;try{b=Y1.renderToString(d,{...t,displayMode:h,throwOnError:!0})}catch(w){const g=w,y=g.name.toLowerCase();r.message("Could not render math with KaTeX",{ancestors:[...a,i],cause:g,place:i.position,ruleId:y,source:"rehype-katex"});try{b=Y1.renderToString(d,{...t,displayMode:h,strict:"ignore",throwOnError:!1})}catch{b=[{type:"element",tagName:"span",properties:{className:["katex-error"],style:"color:"+(t.errorColor||"#cc0000"),title:String(w)},children:[{type:"text",value:d}]}]}}typeof b=="string"&&(b=DD(b).children);const $=c.children.indexOf(m);return c.children.splice($,1,...b),c4})}}const HD=({content:e,isOpen:t,setIsOpen:n,isMobile:r})=>{const[i,a]=S.useState([]),o=ts(),s=xn();S.useEffect(()=>{const m=document.querySelectorAll("h1, h2, h3, h4, h5, h6"),d=Array.from(m).map(b=>({id:b.id,text:b.textContent||"",level:parseInt(b.tagName[1])}));a(u(d))},[e]);const l=m=>{const d=document.getElementById(m);if(d){d.scrollIntoView({behavior:"smooth"}),n(!1);const b=new URLSearchParams(s.search);b.set("scrollTo",m),o(`${s.pathname}?${b.toString()}`,{replace:!0})}},u=m=>{const d=[],b=[];return m.forEach($=>{for(;b.length>0&&$.level<=b[b.length-1].level;)b.pop();if(b.length===0)d.push($),b.push($);else{const w=b[b.length-1];w.children||(w.children=[]),w.children.push($),b.push($)}}),d},h=m=>M.jsx("ul",{className:"space-y-1",children:m.map(d=>M.jsxs("li",{children:[M.jsx("div",{className:`cursor-pointer hover:bg-sky-200 rounded-md transition-colors ${c(d.level)} whitespace-normal break-words`,onClick:()=>l(d.id),children:d.text}),d.children&&h(d.children)]},d.id))}),c=m=>{switch(m){case 1:return"text-lg font-bold pl-0";case 2:return"text-base pl-4";case 3:return"text-sm pl-8";default:return"text-xs pl-12"}};return M.jsxs("div",{className:`sticky top-4 flex flex-col items-start mr-8 mt-4 transition-all duration-300 ease-in-out bg-sky-900 z-50
        ${r?"fixed right-0 top-16":"sticky"}`,style:{width:t?r?"90vw":"30rem":"3rem",borderRadius:t?"0.75rem":"1.5rem",right:r?t?"1rem":"-2rem":void 0,top:r?"4rem":void 0,boxShadow:r&&t?"0 4px 6px rgba(0, 0, 0, 0.1)":void 0},children:[M.jsx(ra,{variant:"default",className:`flex-shrink-0 w-12 h-12 bg-sky-900 hover:bg-sky-600 rounded-full shadow-lg focus:outline-none
          ${r?"fixed right-4 top-20 z-50":""}`,onClick:()=>n(!t),children:M.jsx(w$,{className:"h-4 w-4 text-white"})}),M.jsx("div",{className:"transition-all duration-300 ease-in-out overflow-hidden",style:{maxHeight:t?r?"70vh":"calc(100vh - 8rem)":"0px",margin:t?"1rem":"0px",width:r?"100%":void 0},children:M.jsx("div",{className:`transition-all duration-300 ease-in-out 
            ${t?"p-4 opacity-100":"p-0 opacity-0"}
            ${r?"max-h-[60vh]":""} bg-sky-100 rounded-md`,children:M.jsx("div",{className:"overflow-y-auto",style:{maxHeight:r?"60vh":"calc(100vh - 8rem)",WebkitOverflowScrolling:"touch"},children:h(i)})})}),r&&t&&M.jsx("div",{className:"fixed inset-0 bg-black/30 z-40",onClick:()=>n(!1)})]})},GD=({children:e})=>{const t=xn(),n=ts();return S.useEffect(()=>{const r=i=>{let a=i.target;for(;a&&a.tagName!=="A";)a=a.parentElement;if((a==null?void 0:a.tagName)==="A"){const o=a.getAttribute("href");if(o!=null&&o.startsWith("#")&&!o.startsWith("#/")){i.preventDefault();const s=o.slice(1),l=document.getElementById(s);if(l){l.scrollIntoView({behavior:"smooth"});const u=new URLSearchParams(t.search);u.set("scrollTo",s),n(`${t.pathname}?${u.toString()}`,{replace:!0})}}}};return document.addEventListener("click",r,!0),()=>document.removeEventListener("click",r,!0)},[t,n]),S.useEffect(()=>{const i=new URLSearchParams(t.search).get("scrollTo");if(i){const a=document.getElementById(i);a&&a.scrollIntoView({behavior:"smooth"})}},[t.search]),M.jsx("div",{className:"markdown-content",children:e})},KD=()=>e=>{const t=[];let n=[],r=null;const i=e;if(i.children.forEach(a=>{if(a.type==="heading"){const o=a;if(n.length>0){const s={type:"element",tagName:"div",properties:{className:[`section-level-${r}`]},children:n};t.push(s),n=[]}r=o.depth,n.push(a)}else n.push(a)}),n.length>0){const a={type:"element",tagName:"div",properties:{className:[`section-level-${r}`]},children:n};t.push(a)}i.children=t},sg=Object.assign({"../posts/A0_1.md":x7,"../posts/A0_2.md":w7,"../posts/AE_02.md":k7,"../posts/AE_1.md":S7,"../posts/CD_1.md":E7,"../posts/CD_2.md":C7,"../posts/CD_3.md":P7,"../posts/CD_4.md":D7,"../posts/CD_5.md":T7,"../posts/EC_09.md":A7,"../posts/EC_1.md":z7,"../posts/EC_2.md":M7,"../posts/EC_3.md":F7,"../posts/EC_4.md":q7,"../posts/EC_5.md":R7,"../posts/EC_6.md":N7,"../posts/EC_7.md":I7,"../posts/EC_8.md":B7,"../posts/FE_02.md":L7,"../posts/FE_02A.md":O7,"../posts/FE_04.md":j7,"../posts/FE_1.md":V7,"../posts/GT_02.md":W7,"../posts/GT_03.md":X7,"../posts/GT_03A.md":U7,"../posts/GT_03P.md":H7,"../posts/GT_04.md":G7,"../posts/GT_04A.md":K7,"../posts/GT_04P.md":Z7,"../posts/GT_05.md":Y7,"../posts/GT_1.md":Q7,"../posts/GT_A02.md":J7,"../posts/GT_A1.md":e8,"../posts/GT_P1.md":t8,"../posts/GT_P2.md":n8,"../posts/MA_1.md":r8,"../posts/NOTE_SCS_1.md":i8,"../posts/QC_1.md":a8,"../posts/QC_2.md":o8,"../posts/QC_3.md":s8,"../posts/QC_4.md":l8,"../posts/SCM_01.md":u8,"../posts/SCM_02.md":h8,"../posts/SCM_03.md":c8,"../posts/SCM_04.md":m8,"../posts/SCM_05.md":d8,"../posts/SCS_01.md":f8,"../posts/SCS_02.md":p8,"../posts/SCS_03.md":g8,"../posts/SGD_02.md":b8,"../posts/SP_02.md":y8,"../posts/SP_02A.md":$8,"../posts/SP_03.md":v8,"../posts/SP_03A.md":_8,"../posts/SP_04.md":x8,"../posts/SP_05.md":w8,"../posts/SP_1.md":k8,"../posts/SP_A1.md":S8,"../posts/post1.md":E8}),ZD=()=>{const{id:e}=l6(),[t,n]=S.useState(!1),[r,i]=S.useState(!1),[a,o]=S.useState(!1),[s,l]=S.useState("");S.useEffect(()=>{const m=d=>{d.key==="/"&&!a&&(d.preventDefault(),o(!0)),d.key==="Escape"&&a&&o(!1)};return document.addEventListener("keydown",m),()=>document.removeEventListener("keydown",m)},[a]),S.useEffect(()=>{const m=()=>{i(window.innerWidth<768)};return m(),window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)},[]);const u=Wi.find(m=>m.id===Number(e));if(!u)return M.jsx("div",{className:"container mx-auto mt-10 pt-16",children:M.jsx("h2",{className:"text-2xl font-bold text-sky-100",children:"404 NOT FOUND"})});const h={};for(const m in sg){const d=sg[m],b=m.match(/\/([a-zA-Z0-9_-]+)\.md$/);if(b){const $=b[1];h[$]=d}}const c=h[u.contentKey];return c?M.jsxs("div",{className:"flex items-start relative transition-all duration-300 ease-in-out",children:[M.jsx("div",{className:`flex-1 transition-all duration-300 ease-in-out ${r?"":t?"md:mr-[16rem]":"md:mr-[3rem]"}`,children:M.jsxs("div",{className:`container mx-auto mt-10 p-6 bg-sky-100 rounded-lg shadow pt-16 w-3/4
          max-md:w-full max-md:mt-2 max-md:pt-20 max-md:px-3`,children:[M.jsx("h1",{className:"text-3xl font-bold mb-4 text-sky-950",children:u.title}),M.jsxs("div",{className:"text-sm text-sky-950 mb-4",children:[u.date," • ",u.author]}),M.jsx(GD,{content:c,children:M.jsx("div",{className:"prose prose-sky max-w-full",children:M.jsx(KE,{remarkPlugins:[aD,KD],rehypePlugins:[UD,fD],children:c})})})]})}),M.jsx(HD,{content:c,isOpen:t,setIsOpen:n,isMobile:r}),a&&M.jsx(P$,{searchTerm:s,onSearchTermChange:l,onClose:()=>{o(!1),l("")},posts:Wi})]}):M.jsx("div",{className:"container mx-auto mt-10 pt-16",children:M.jsx("h2",{className:"text-2xl font-bold text-sky-100",children:"Content Not Found"})})},YD=()=>M.jsxs("div",{children:[M.jsx("div",{className:"mx-auto w-1/2 mt-10 p-6 bg-sky-100 rounded-lg shadow",children:M.jsx("a",{href:"https://www.cameudis.com/",className:`font-bold mb-0.5 text-sky-900
            text-xl
            sm:text-xl
            lg:text-3xl
            `,children:"Cameudis"})}),M.jsxs("div",{className:"mx-auto w-1/2 mt-10 p-6 bg-sky-100 rounded-lg shadow",children:[M.jsxs("div",{className:"flex items-center",children:[M.jsx("div",{className:` rounded-full overflow-hidden
          w-8 h-8 mr-3
          sm:w-8 sm:h-8 sm:mr-3
          lg:w-16 lg:h-16 lg:mr-6
          `,children:M.jsx("a",{href:"https://icelava.top",children:M.jsx("img",{src:"https://icelava.top/FkLog/@icon/icelava.jpg",alt:"Circular Image",className:"w-full h-full object-cover"})})}),M.jsx("a",{href:"https://icelava.top",className:`font-bold mb-0.5 text-sky-900
            text-xl
            sm:text-xl
            lg:text-3xl
            `,children:"IceLava Top"})]}),M.jsx("p",{className:`mt-4 mx-1 text-sky-900 leading-7
        text-sm
        sm:text-sm
        lg:text-base
        `,children:"No Code No Life"})]}),M.jsx("div",{className:"mx-auto w-1/2 mt-10 p-6 bg-sky-100 rounded-lg shadow",children:M.jsx("a",{href:"https://blog.iin0.cn/",className:`font-bold mb-0.5 text-sky-900
            text-xl
            sm:text-xl
            lg:text-3xl
            `,children:"暮色音铃"})}),M.jsx("div",{className:"mx-auto w-1/2 mt-10 p-6 bg-sky-100 rounded-lg shadow",children:M.jsx("a",{href:"https://www.sapium.site/wordpress/",className:`font-bold mb-0.5 text-sky-900
            text-xl
            sm:text-xl
            lg:text-3xl
            `,children:"乌桕Sapium"})})]}),QD=()=>{const{fontToggle:e}=$$(),t=["xd.png","fl.png","pr.png","vs.png","blender.png","rd.png","bp.png","sai.png","au.png","pc.png","ps.png","ds.png","unity.png","vsc.png","rr.png","ae.png","mma.png","cl.png"],n=3,r=Math.ceil(t.length/n),i=Array.from({length:n},(o,s)=>t.slice(s*r,(s+1)*r)),a=e?"/ico/pixel":"/ico/common";return M.jsx("div",{children:M.jsx("div",{className:"overflow-hidden",children:i.map((o,s)=>M.jsx("div",{className:`flex whitespace-nowrap my-4 ${s%2===0?"animate-scroll-left":"animate-scroll-right"}`,style:{"--animation-duration":`${300+s*5}s`},children:[...o,...o,...o,...o,...o,...o,...o,...o].map((l,u)=>M.jsx("img",{src:`${a}/${l}`,alt:l,className:"w-40 h-40 object-cover mx-2"},u))},s))})})},JD=()=>M.jsxs("div",{className:"container mx-auto mt-10",children:[M.jsx("h1",{className:`font-bold mb-8 text-center text-sky-100
      text-5xl
      sm:text-5xl
      lg:text-6xl
      `,children:"This is Luna's world."}),M.jsx(QD,{})]}),vd=S.createContext({});function _d(e){const t=S.useRef(null);return t.current===null&&(t.current=e()),t.current}const xd=typeof window<"u",yv=xd?S.useLayoutEffect:S.useEffect,Tu=S.createContext(null),wd=S.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class eT extends S.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const r=n.offsetParent,i=r instanceof HTMLElement&&r.offsetWidth||0,a=this.props.sizeRef.current;a.height=n.offsetHeight||0,a.width=n.offsetWidth||0,a.top=n.offsetTop,a.left=n.offsetLeft,a.right=i-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function tT({children:e,isPresent:t,anchorX:n}){const r=S.useId(),i=S.useRef(null),a=S.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=S.useContext(wd);return S.useInsertionEffect(()=>{const{width:s,height:l,top:u,left:h,right:c}=a.current;if(t||!i.current||!s||!l)return;const m=n==="left"?`left: ${h}`:`right: ${c}`;i.current.dataset.motionPopId=r;const d=document.createElement("style");return o&&(d.nonce=o),document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${s}px !important;
            height: ${l}px !important;
            ${m}px !important;
            top: ${u}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[t]),M.jsx(eT,{isPresent:t,childRef:i,sizeRef:a,children:S.cloneElement(e,{ref:i})})}const nT=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:i,presenceAffectsLayout:a,mode:o,anchorX:s})=>{const l=_d(rT),u=S.useId(),h=S.useCallback(m=>{l.set(m,!0);for(const d of l.values())if(!d)return;r&&r()},[l,r]),c=S.useMemo(()=>({id:u,initial:t,isPresent:n,custom:i,onExitComplete:h,register:m=>(l.set(m,!1),()=>l.delete(m))}),a?[Math.random(),h]:[n,h]);return S.useMemo(()=>{l.forEach((m,d)=>l.set(d,!1))},[n]),S.useEffect(()=>{!n&&!l.size&&r&&r()},[n]),o==="popLayout"&&(e=M.jsx(tT,{isPresent:n,anchorX:s,children:e})),M.jsx(Tu.Provider,{value:c,children:e})};function rT(){return new Map}function $v(e=!0){const t=S.useContext(Tu);if(t===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:i}=t,a=S.useId();S.useEffect(()=>{if(e)return i(a)},[e]);const o=S.useCallback(()=>e&&r&&r(a),[a,r,e]);return!n&&r?[!1,o]:[!0]}const js=e=>e.key||"";function lg(e){const t=[];return S.Children.forEach(e,n=>{S.isValidElement(n)&&t.push(n)}),t}const iT=({children:e,custom:t,initial:n=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:a="sync",propagate:o=!1,anchorX:s="left"})=>{const[l,u]=$v(o),h=S.useMemo(()=>lg(e),[e]),c=o&&!l?[]:h.map(js),m=S.useRef(!0),d=S.useRef(h),b=_d(()=>new Map),[$,w]=S.useState(h),[g,y]=S.useState(h);yv(()=>{m.current=!1,d.current=h;for(let D=0;D<g.length;D++){const C=js(g[D]);c.includes(C)?b.delete(C):b.get(C)!==!0&&b.set(C,!1)}},[g,c.length,c.join("-")]);const _=[];if(h!==$){let D=[...h];for(let C=0;C<g.length;C++){const F=g[C],R=js(F);c.includes(R)||(D.splice(C,0,F),_.push(F))}return a==="wait"&&_.length&&(D=_),y(lg(D)),w(h),null}const{forceRender:T}=S.useContext(vd);return M.jsx(M.Fragment,{children:g.map(D=>{const C=js(D),F=o&&!l?!1:h===g||c.includes(C),R=()=>{if(b.has(C))b.set(C,!0);else return;let N=!0;b.forEach(O=>{O||(N=!1)}),N&&(T==null||T(),y(d.current),o&&(u==null||u()),r&&r())};return M.jsx(nT,{isPresent:F,initial:!m.current||n?void 0:!1,custom:t,presenceAffectsLayout:i,mode:a,onExitComplete:F?void 0:R,anchorX:s,children:D},C)})})};function kd(e,t){e.indexOf(t)===-1&&e.push(t)}function Sd(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}const jt=e=>e;let g0=jt;const aT={skipAnimations:!1,useManualTiming:!1};function Ed(e){let t;return()=>(t===void 0&&(t=e()),t)}const pa=(e,t,n)=>{const r=t-e;return r===0?1:(n-e)/r};class Cd{constructor(){this.subscriptions=[]}add(t){return kd(this.subscriptions,t),()=>Sd(this.subscriptions,t)}notify(t,n,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](t,n,r);else for(let a=0;a<i;a++){const o=this.subscriptions[a];o&&o(t,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Jn=e=>e*1e3,er=e=>e/1e3;function vv(e,t){return t?e*(1e3/t):0}const oT=Ed(()=>window.ScrollTimeline!==void 0);class sT{constructor(t){this.stop=()=>this.runAll("stop"),this.animations=t.filter(Boolean)}get finished(){return Promise.all(this.animations.map(t=>"finished"in t?t.finished:t))}getAll(t){return this.animations[0][t]}setAll(t,n){for(let r=0;r<this.animations.length;r++)this.animations[r][t]=n}attachTimeline(t,n){const r=this.animations.map(i=>{if(oT()&&i.attachTimeline)return i.attachTimeline(t);if(typeof n=="function")return n(i)});return()=>{r.forEach((i,a)=>{i&&i(),this.animations[a].stop()})}}get time(){return this.getAll("time")}set time(t){this.setAll("time",t)}get speed(){return this.getAll("speed")}set speed(t){this.setAll("speed",t)}get startTime(){return this.getAll("startTime")}get duration(){let t=0;for(let n=0;n<this.animations.length;n++)t=Math.max(t,this.animations[n].duration);return t}runAll(t){this.animations.forEach(n=>n[t]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class lT extends sT{then(t,n){return Promise.all(this.animations).then(t).catch(n)}}function Pd(e,t){return e?e[t]||e.default||e:void 0}const b0=2e4;function _v(e){let t=0;const n=50;let r=e.next(t);for(;!r.done&&t<b0;)t+=n,r=e.next(t);return t>=b0?1/0:t}function Dd(e){return typeof e=="function"}function ug(e,t){e.timeline=t,e.onfinish=null}const Td=e=>Array.isArray(e)&&typeof e[0]=="number",uT={linearEasing:void 0};function hT(e,t){const n=Ed(e);return()=>{var r;return(r=uT[t])!==null&&r!==void 0?r:n()}}const Hl=hT(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),xv=(e,t,n=10)=>{let r="";const i=Math.max(Math.round(t/n),2);for(let a=0;a<i;a++)r+=e(pa(0,i-1,a))+", ";return`linear(${r.substring(0,r.length-2)})`};function wv(e){return!!(typeof e=="function"&&Hl()||!e||typeof e=="string"&&(e in y0||Hl())||Td(e)||Array.isArray(e)&&e.every(wv))}const Ja=([e,t,n,r])=>`cubic-bezier(${e}, ${t}, ${n}, ${r})`,y0={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Ja([0,.65,.55,1]),circOut:Ja([.55,0,1,.45]),backIn:Ja([.31,.01,.66,-.59]),backOut:Ja([.33,1.53,.69,.99])};function kv(e,t){if(e)return typeof e=="function"&&Hl()?xv(e,t):Td(e)?Ja(e):Array.isArray(e)?e.map(n=>kv(n,t)||y0.easeOut):y0[e]}const Vs=["read","resolveKeyframes","update","preRender","render","postRender"],hg={value:null,addProjectionMetrics:null};function cT(e,t){let n=new Set,r=new Set,i=!1,a=!1;const o=new WeakSet;let s={delta:0,timestamp:0,isProcessing:!1},l=0;function u(c){o.has(c)&&(h.schedule(c),e()),l++,c(s)}const h={schedule:(c,m=!1,d=!1)=>{const $=d&&i?n:r;return m&&o.add(c),$.has(c)||$.add(c),c},cancel:c=>{r.delete(c),o.delete(c)},process:c=>{if(s=c,i){a=!0;return}i=!0,[n,r]=[r,n],n.forEach(u),t&&hg.value&&hg.value.frameloop[t].push(l),l=0,n.clear(),i=!1,a&&(a=!1,h.process(c))}};return h}const mT=40;function Sv(e,t){let n=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},a=()=>n=!0,o=Vs.reduce((g,y)=>(g[y]=cT(a,t?y:void 0),g),{}),{read:s,resolveKeyframes:l,update:u,preRender:h,render:c,postRender:m}=o,d=()=>{const g=performance.now();n=!1,i.delta=r?1e3/60:Math.max(Math.min(g-i.timestamp,mT),1),i.timestamp=g,i.isProcessing=!0,s.process(i),l.process(i),u.process(i),h.process(i),c.process(i),m.process(i),i.isProcessing=!1,n&&t&&(r=!1,e(d))},b=()=>{n=!0,r=!0,i.isProcessing||e(d)};return{schedule:Vs.reduce((g,y)=>{const _=o[y];return g[y]=(T,D=!1,C=!1)=>(n||b(),_.schedule(T,D,C)),g},{}),cancel:g=>{for(let y=0;y<Vs.length;y++)o[Vs[y]].cancel(g)},state:i,steps:o}}const{schedule:Te,cancel:Lr,state:st,steps:Bh}=Sv(typeof requestAnimationFrame<"u"?requestAnimationFrame:jt,!0),{schedule:Ad,cancel:qF}=Sv(queueMicrotask,!1);let cl;function dT(){cl=void 0}const zn={now:()=>(cl===void 0&&zn.set(st.isProcessing||aT.useManualTiming?st.timestamp:performance.now()),cl),set:e=>{cl=e,queueMicrotask(dT)}},dn={x:!1,y:!1};function Ev(){return dn.x||dn.y}function fT(e){return e==="x"||e==="y"?dn[e]?null:(dn[e]=!0,()=>{dn[e]=!1}):dn.x||dn.y?null:(dn.x=dn.y=!0,()=>{dn.x=dn.y=!1})}function pT(e,t,n){var r;if(e instanceof EventTarget)return[e];if(typeof e=="string"){let i=document;const a=(r=void 0)!==null&&r!==void 0?r:i.querySelectorAll(e);return a?Array.from(a):[]}return Array.from(e)}function Cv(e,t){const n=pT(e),r=new AbortController,i={passive:!0,...t,signal:r.signal};return[n,i,()=>r.abort()]}function cg(e){return!(e.pointerType==="touch"||Ev())}function gT(e,t,n={}){const[r,i,a]=Cv(e,n),o=s=>{if(!cg(s))return;const{target:l}=s,u=t(l,s);if(typeof u!="function"||!l)return;const h=c=>{cg(c)&&(u(c),l.removeEventListener("pointerleave",h))};l.addEventListener("pointerleave",h,i)};return r.forEach(s=>{s.addEventListener("pointerenter",o,i)}),a}function mg(e,t){const n=`${t}PointerCapture`;if(e.target instanceof Element&&n in e.target&&e.pointerId!==void 0)try{e.target[n](e.pointerId)}catch{}}const Pv=(e,t)=>t?e===t?!0:Pv(e,t.parentElement):!1,zd=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,bT=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function yT(e){return bT.has(e.tagName)||e.tabIndex!==-1}const eo=new WeakSet;function dg(e){return t=>{t.key==="Enter"&&e(t)}}function Lh(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const $T=(e,t)=>{const n=e.currentTarget;if(!n)return;const r=dg(()=>{if(eo.has(n))return;Lh(n,"down");const i=dg(()=>{Lh(n,"up")}),a=()=>Lh(n,"cancel");n.addEventListener("keyup",i,t),n.addEventListener("blur",a,t)});n.addEventListener("keydown",r,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),t)};function fg(e){return zd(e)&&!Ev()}function vT(e,t,n={}){const[r,i,a]=Cv(e,n),o=s=>{const l=s.currentTarget;if(!l||!fg(s)||eo.has(l))return;eo.add(l),mg(s,"set");const u=t(l,s),h=(d,b)=>{l.removeEventListener("pointerup",c),l.removeEventListener("pointercancel",m),mg(d,"release"),!(!fg(d)||!eo.has(l))&&(eo.delete(l),typeof u=="function"&&u(d,{success:b}))},c=d=>{(d.isTrusted?_T(d,l instanceof Element?l.getBoundingClientRect():{left:0,top:0,right:window.innerWidth,bottom:window.innerHeight}):!1)?h(d,!1):h(d,!(l instanceof Element)||Pv(l,d.target))},m=d=>{h(d,!1)};l.addEventListener("pointerup",c,i),l.addEventListener("pointercancel",m,i),l.addEventListener("lostpointercapture",m,i)};return r.forEach(s=>{s=n.useGlobalTarget?window:s;let l=!1;s instanceof HTMLElement&&(l=!0,!yT(s)&&s.getAttribute("tabindex")===null&&(s.tabIndex=0)),s.addEventListener("pointerdown",o,i),l&&s.addEventListener("focus",u=>$T(u,i),i)}),a}function _T(e,t){return e.clientX<t.left||e.clientX>t.right||e.clientY<t.top||e.clientY>t.bottom}const pg=30,xT=e=>!isNaN(parseFloat(e));class wT{constructor(t,n={}){this.version="12.6.0",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,i=!0)=>{const a=zn.now();this.updatedAt!==a&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=zn.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=xT(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new Cd);const r=this.events[t].add(n);return t==="change"?()=>{r(),Te.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t,n=!0){!n||!this.passiveEffect?this.updateAndNotify(t,n):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-r}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=zn.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>pg)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,pg);return vv(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Oo(e,t){return new wT(e,t)}const Dv=S.createContext({strict:!1}),gg={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},ga={};for(const e in gg)ga[e]={isEnabled:t=>gg[e].some(n=>!!t[n])};function kT(e){for(const t in e)ga[t]={...ga[t],...e[t]}}const ST=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Gl(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||ST.has(e)}let Tv=e=>!Gl(e);function ET(e){e&&(Tv=t=>t.startsWith("on")?!Gl(t):e(t))}try{ET(require("@emotion/is-prop-valid").default)}catch{}function CT(e,t,n){const r={};for(const i in e)i==="values"&&typeof e.values=="object"||(Tv(i)||n===!0&&Gl(i)||!t&&!Gl(i)||e.draggable&&i.startsWith("onDrag"))&&(r[i]=e[i]);return r}function PT(e){if(typeof Proxy>"u")return e;const t=new Map,n=(...r)=>e(...r);return new Proxy(n,{get:(r,i)=>i==="create"?e:(t.has(i)||t.set(i,e(i)),t.get(i))})}const Au=S.createContext({});function zu(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function jo(e){return typeof e=="string"||Array.isArray(e)}const Md=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Fd=["initial",...Md];function Mu(e){return zu(e.animate)||Fd.some(t=>jo(e[t]))}function Av(e){return!!(Mu(e)||e.variants)}function DT(e,t){if(Mu(e)){const{initial:n,animate:r}=e;return{initial:n===!1||jo(n)?n:void 0,animate:jo(r)?r:void 0}}return e.inherit!==!1?t:{}}function TT(e){const{initial:t,animate:n}=DT(e,S.useContext(Au));return S.useMemo(()=>({initial:t,animate:n}),[bg(t),bg(n)])}function bg(e){return Array.isArray(e)?e.join(" "):e}const AT=Symbol.for("motionComponentSymbol");function Xi(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function zT(e,t,n){return S.useCallback(r=>{r&&e.onMount&&e.onMount(r),t&&(r?t.mount(r):t.unmount()),n&&(typeof n=="function"?n(r):Xi(n)&&(n.current=r))},[t])}const qd=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),MT="framerAppearId",zv="data-"+qd(MT),Mv=S.createContext({});function FT(e,t,n,r,i){var a,o;const{visualElement:s}=S.useContext(Au),l=S.useContext(Dv),u=S.useContext(Tu),h=S.useContext(wd).reducedMotion,c=S.useRef(null);r=r||l.renderer,!c.current&&r&&(c.current=r(e,{visualState:t,parent:s,props:n,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:h}));const m=c.current,d=S.useContext(Mv);m&&!m.projection&&i&&(m.type==="html"||m.type==="svg")&&qT(c.current,n,i,d);const b=S.useRef(!1);S.useInsertionEffect(()=>{m&&b.current&&m.update(n,u)});const $=n[zv],w=S.useRef(!!$&&!(!((a=window.MotionHandoffIsComplete)===null||a===void 0)&&a.call(window,$))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,$)));return yv(()=>{m&&(b.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),Ad.render(m.render),w.current&&m.animationState&&m.animationState.animateChanges())}),S.useEffect(()=>{m&&(!w.current&&m.animationState&&m.animationState.animateChanges(),w.current&&(queueMicrotask(()=>{var g;(g=window.MotionHandoffMarkAsComplete)===null||g===void 0||g.call(window,$)}),w.current=!1))}),m}function qT(e,t,n,r){const{layoutId:i,layout:a,drag:o,dragConstraints:s,layoutScroll:l,layoutRoot:u}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:Fv(e.parent)),e.projection.setOptions({layoutId:i,layout:a,alwaysMeasureLayout:!!o||s&&Xi(s),visualElement:e,animationType:typeof a=="string"?a:"both",initialPromotionConfig:r,layoutScroll:l,layoutRoot:u})}function Fv(e){if(e)return e.options.allowProjection!==!1?e.projection:Fv(e.parent)}function RT({preloadedFeatures:e,createVisualElement:t,useRender:n,useVisualState:r,Component:i}){var a,o;e&&kT(e);function s(u,h){let c;const m={...S.useContext(wd),...u,layoutId:NT(u)},{isStatic:d}=m,b=TT(u),$=r(u,d);if(!d&&xd){IT();const w=BT(m);c=w.MeasureLayout,b.visualElement=FT(i,$,m,t,w.ProjectionNode)}return M.jsxs(Au.Provider,{value:b,children:[c&&b.visualElement?M.jsx(c,{visualElement:b.visualElement,...m}):null,n(i,u,zT($,b.visualElement,h),$,d,b.visualElement)]})}s.displayName=`motion.${typeof i=="string"?i:`create(${(o=(a=i.displayName)!==null&&a!==void 0?a:i.name)!==null&&o!==void 0?o:""})`}`;const l=S.forwardRef(s);return l[AT]=i,l}function NT({layoutId:e}){const t=S.useContext(vd).id;return t&&e!==void 0?t+"-"+e:e}function IT(e,t){S.useContext(Dv).strict}function BT(e){const{drag:t,layout:n}=ga;if(!t&&!n)return{};const r={...t,...n};return{MeasureLayout:t!=null&&t.isEnabled(e)||n!=null&&n.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const qv=e=>t=>typeof t=="string"&&t.startsWith(e),Rd=qv("--"),LT=qv("var(--"),Nd=e=>LT(e)?OT.test(e.split("/*")[0].trim()):!1,OT=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Vo={};function jT(e){for(const t in e)Vo[t]=e[t],Rd(t)&&(Vo[t].isCSSVariable=!0)}const Ca=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],ki=new Set(Ca);function Rv(e,{layout:t,layoutId:n}){return ki.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!Vo[e]||e==="opacity")}const ft=e=>!!(e&&e.getVelocity),Nv=(e,t)=>t&&typeof e=="number"?t.transform(e):e,lr=(e,t,n)=>n>t?t:n<e?e:n,Pa={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Wo={...Pa,transform:e=>lr(0,1,e)},Ws={...Pa,default:1},ls=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),yr=ls("deg"),Mn=ls("%"),oe=ls("px"),VT=ls("vh"),WT=ls("vw"),yg={...Mn,parse:e=>Mn.parse(e)/100,transform:e=>Mn.transform(e*100)},XT={borderWidth:oe,borderTopWidth:oe,borderRightWidth:oe,borderBottomWidth:oe,borderLeftWidth:oe,borderRadius:oe,radius:oe,borderTopLeftRadius:oe,borderTopRightRadius:oe,borderBottomRightRadius:oe,borderBottomLeftRadius:oe,width:oe,maxWidth:oe,height:oe,maxHeight:oe,top:oe,right:oe,bottom:oe,left:oe,padding:oe,paddingTop:oe,paddingRight:oe,paddingBottom:oe,paddingLeft:oe,margin:oe,marginTop:oe,marginRight:oe,marginBottom:oe,marginLeft:oe,backgroundPositionX:oe,backgroundPositionY:oe},UT={rotate:yr,rotateX:yr,rotateY:yr,rotateZ:yr,scale:Ws,scaleX:Ws,scaleY:Ws,scaleZ:Ws,skew:yr,skewX:yr,skewY:yr,distance:oe,translateX:oe,translateY:oe,translateZ:oe,x:oe,y:oe,z:oe,perspective:oe,transformPerspective:oe,opacity:Wo,originX:yg,originY:yg,originZ:oe},$g={...Pa,transform:Math.round},Id={...XT,...UT,zIndex:$g,size:oe,fillOpacity:Wo,strokeOpacity:Wo,numOctaves:$g},HT={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},GT=Ca.length;function KT(e,t,n){let r="",i=!0;for(let a=0;a<GT;a++){const o=Ca[a],s=e[o];if(s===void 0)continue;let l=!0;if(typeof s=="number"?l=s===(o.startsWith("scale")?1:0):l=parseFloat(s)===0,!l||n){const u=Nv(s,Id[o]);if(!l){i=!1;const h=HT[o]||o;r+=`${h}(${u}) `}n&&(t[o]=u)}}return r=r.trim(),n?r=n(t,i?"":r):i&&(r="none"),r}function Bd(e,t,n){const{style:r,vars:i,transformOrigin:a}=e;let o=!1,s=!1;for(const l in t){const u=t[l];if(ki.has(l)){o=!0;continue}else if(Rd(l)){i[l]=u;continue}else{const h=Nv(u,Id[l]);l.startsWith("origin")?(s=!0,a[l]=h):r[l]=h}}if(t.transform||(o||n?r.transform=KT(t,e.transform,n):r.transform&&(r.transform="none")),s){const{originX:l="50%",originY:u="50%",originZ:h=0}=a;r.transformOrigin=`${l} ${u} ${h}`}}const Ld=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Iv(e,t,n){for(const r in t)!ft(t[r])&&!Rv(r,n)&&(e[r]=t[r])}function ZT({transformTemplate:e},t){return S.useMemo(()=>{const n=Ld();return Bd(n,t,e),Object.assign({},n.vars,n.style)},[t])}function YT(e,t){const n=e.style||{},r={};return Iv(r,n,e),Object.assign(r,ZT(e,t)),r}function QT(e,t){const n={},r=YT(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}const JT=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Od(e){return typeof e!="string"||e.includes("-")?!1:!!(JT.indexOf(e)>-1||/[A-Z]/u.test(e))}const eA={offset:"stroke-dashoffset",array:"stroke-dasharray"},tA={offset:"strokeDashoffset",array:"strokeDasharray"};function nA(e,t,n=1,r=0,i=!0){e.pathLength=1;const a=i?eA:tA;e[a.offset]=oe.transform(-r);const o=oe.transform(t),s=oe.transform(n);e[a.array]=`${o} ${s}`}function vg(e,t,n){return typeof e=="string"?e:oe.transform(t+n*e)}function rA(e,t,n){const r=vg(t,e.x,e.width),i=vg(n,e.y,e.height);return`${r} ${i}`}function jd(e,{attrX:t,attrY:n,attrScale:r,originX:i,originY:a,pathLength:o,pathSpacing:s=1,pathOffset:l=0,...u},h,c){if(Bd(e,u,c),h){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:m,style:d,dimensions:b}=e;m.transform&&(b&&(d.transform=m.transform),delete m.transform),b&&(i!==void 0||a!==void 0||d.transform)&&(d.transformOrigin=rA(b,i!==void 0?i:.5,a!==void 0?a:.5)),t!==void 0&&(m.x=t),n!==void 0&&(m.y=n),r!==void 0&&(m.scale=r),o!==void 0&&nA(m,o,s,l,!1)}const Bv=()=>({...Ld(),attrs:{}}),Vd=e=>typeof e=="string"&&e.toLowerCase()==="svg";function iA(e,t,n,r){const i=S.useMemo(()=>{const a=Bv();return jd(a,t,Vd(r),e.transformTemplate),{...a.attrs,style:{...a.style}}},[t]);if(e.style){const a={};Iv(a,e.style,e),i.style={...a,...i.style}}return i}function aA(e=!1){return(n,r,i,{latestValues:a},o)=>{const l=(Od(n)?iA:QT)(r,a,o,n),u=CT(r,typeof n=="string",e),h=n!==S.Fragment?{...u,...l,ref:i}:{},{children:c}=r,m=S.useMemo(()=>ft(c)?c.get():c,[c]);return S.createElement(n,{...h,children:m})}}function _g(e){const t=[{},{}];return e==null||e.values.forEach((n,r)=>{t[0][r]=n.get(),t[1][r]=n.getVelocity()}),t}function Wd(e,t,n,r){if(typeof t=="function"){const[i,a]=_g(r);t=t(n!==void 0?n:e.custom,i,a)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[i,a]=_g(r);t=t(n!==void 0?n:e.custom,i,a)}return t}const $0=e=>Array.isArray(e),oA=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),sA=e=>$0(e)?e[e.length-1]||0:e;function ml(e){const t=ft(e)?e.get():e;return oA(t)?t.toValue():t}function lA({scrapeMotionValuesFromProps:e,createRenderState:t,onUpdate:n},r,i,a){const o={latestValues:uA(r,i,a,e),renderState:t()};return n&&(o.onMount=s=>n({props:r,current:s,...o}),o.onUpdate=s=>n(s)),o}const Lv=e=>(t,n)=>{const r=S.useContext(Au),i=S.useContext(Tu),a=()=>lA(e,t,r,i);return n?a():_d(a)};function uA(e,t,n,r){const i={},a=r(e,{});for(const m in a)i[m]=ml(a[m]);let{initial:o,animate:s}=e;const l=Mu(e),u=Av(e);t&&u&&!l&&e.inherit!==!1&&(o===void 0&&(o=t.initial),s===void 0&&(s=t.animate));let h=n?n.initial===!1:!1;h=h||o===!1;const c=h?s:o;if(c&&typeof c!="boolean"&&!zu(c)){const m=Array.isArray(c)?c:[c];for(let d=0;d<m.length;d++){const b=Wd(e,m[d]);if(b){const{transitionEnd:$,transition:w,...g}=b;for(const y in g){let _=g[y];if(Array.isArray(_)){const T=h?_.length-1:0;_=_[T]}_!==null&&(i[y]=_)}for(const y in $)i[y]=$[y]}}}return i}function Xd(e,t,n){var r;const{style:i}=e,a={};for(const o in i)(ft(i[o])||t.style&&ft(t.style[o])||Rv(o,e)||((r=n==null?void 0:n.getValue(o))===null||r===void 0?void 0:r.liveStyle)!==void 0)&&(a[o]=i[o]);return a}const hA={useVisualState:Lv({scrapeMotionValuesFromProps:Xd,createRenderState:Ld})};function Ov(e,t){try{t.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{t.dimensions={x:0,y:0,width:0,height:0}}}function jv(e,{style:t,vars:n},r,i){Object.assign(e.style,t,i&&i.getProjectionStyles(r));for(const a in n)e.style.setProperty(a,n[a])}const Vv=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Wv(e,t,n,r){jv(e,t,void 0,r);for(const i in t.attrs)e.setAttribute(Vv.has(i)?i:qd(i),t.attrs[i])}function Xv(e,t,n){const r=Xd(e,t,n);for(const i in e)if(ft(e[i])||ft(t[i])){const a=Ca.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[a]=e[i]}return r}const xg=["x","y","width","height","cx","cy","r"],cA={useVisualState:Lv({scrapeMotionValuesFromProps:Xv,createRenderState:Bv,onUpdate:({props:e,prevProps:t,current:n,renderState:r,latestValues:i})=>{if(!n)return;let a=!!e.drag;if(!a){for(const s in i)if(ki.has(s)){a=!0;break}}if(!a)return;let o=!t;if(t)for(let s=0;s<xg.length;s++){const l=xg[s];e[l]!==t[l]&&(o=!0)}o&&Te.read(()=>{Ov(n,r),Te.render(()=>{jd(r,i,Vd(n.tagName),e.transformTemplate),Wv(n,r)})})}})};function mA(e,t){return function(r,{forwardMotionProps:i}={forwardMotionProps:!1}){const o={...Od(r)?cA:hA,preloadedFeatures:e,useRender:aA(i),createVisualElement:t,Component:r};return RT(o)}}function Xo(e,t,n){const r=e.getProps();return Wd(r,t,n!==void 0?n:r.custom,e)}const Uv=new Set(["width","height","top","left","right","bottom",...Ca]);function dA(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,Oo(n))}function fA(e,t){const n=Xo(e,t);let{transitionEnd:r={},transition:i={},...a}=n||{};a={...a,...r};for(const o in a){const s=sA(a[o]);dA(e,o,s)}}function pA(e){return!!(ft(e)&&e.add)}function v0(e,t){const n=e.getValue("willChange");if(pA(n))return n.add(t)}function Hv(e){return e.props[zv]}const Gv=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,gA=1e-7,bA=12;function yA(e,t,n,r,i){let a,o,s=0;do o=t+(n-t)/2,a=Gv(o,r,i)-e,a>0?n=o:t=o;while(Math.abs(a)>gA&&++s<bA);return o}function us(e,t,n,r){if(e===t&&n===r)return jt;const i=a=>yA(a,0,1,e,n);return a=>a===0||a===1?a:Gv(i(a),t,r)}const Kv=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,Zv=e=>t=>1-e(1-t),Yv=us(.33,1.53,.69,.99),Ud=Zv(Yv),Qv=Kv(Ud),Jv=e=>(e*=2)<1?.5*Ud(e):.5*(2-Math.pow(2,-10*(e-1))),Hd=e=>1-Math.sin(Math.acos(e)),e_=Zv(Hd),t_=Kv(Hd),n_=e=>/^0[^.\s]+$/u.test(e);function $A(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||n_(e):!0}const po=e=>Math.round(e*1e5)/1e5,Gd=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function vA(e){return e==null}const _A=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Kd=(e,t)=>n=>!!(typeof n=="string"&&_A.test(n)&&n.startsWith(e)||t&&!vA(n)&&Object.prototype.hasOwnProperty.call(n,t)),r_=(e,t,n)=>r=>{if(typeof r!="string")return r;const[i,a,o,s]=r.match(Gd);return{[e]:parseFloat(i),[t]:parseFloat(a),[n]:parseFloat(o),alpha:s!==void 0?parseFloat(s):1}},xA=e=>lr(0,255,e),Oh={...Pa,transform:e=>Math.round(xA(e))},li={test:Kd("rgb","red"),parse:r_("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:r=1})=>"rgba("+Oh.transform(e)+", "+Oh.transform(t)+", "+Oh.transform(n)+", "+po(Wo.transform(r))+")"};function wA(e){let t="",n="",r="",i="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),i=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),i=e.substring(4,5),t+=t,n+=n,r+=r,i+=i),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const _0={test:Kd("#"),parse:wA,transform:li.transform},Ui={test:Kd("hsl","hue"),parse:r_("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:r=1})=>"hsla("+Math.round(e)+", "+Mn.transform(po(t))+", "+Mn.transform(po(n))+", "+po(Wo.transform(r))+")"},mt={test:e=>li.test(e)||_0.test(e)||Ui.test(e),parse:e=>li.test(e)?li.parse(e):Ui.test(e)?Ui.parse(e):_0.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?li.transform(e):Ui.transform(e)},kA=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function SA(e){var t,n;return isNaN(e)&&typeof e=="string"&&(((t=e.match(Gd))===null||t===void 0?void 0:t.length)||0)+(((n=e.match(kA))===null||n===void 0?void 0:n.length)||0)>0}const i_="number",a_="color",EA="var",CA="var(",wg="${}",PA=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Uo(e){const t=e.toString(),n=[],r={color:[],number:[],var:[]},i=[];let a=0;const s=t.replace(PA,l=>(mt.test(l)?(r.color.push(a),i.push(a_),n.push(mt.parse(l))):l.startsWith(CA)?(r.var.push(a),i.push(EA),n.push(l)):(r.number.push(a),i.push(i_),n.push(parseFloat(l))),++a,wg)).split(wg);return{values:n,split:s,indexes:r,types:i}}function o_(e){return Uo(e).values}function s_(e){const{split:t,types:n}=Uo(e),r=t.length;return i=>{let a="";for(let o=0;o<r;o++)if(a+=t[o],i[o]!==void 0){const s=n[o];s===i_?a+=po(i[o]):s===a_?a+=mt.transform(i[o]):a+=i[o]}return a}}const DA=e=>typeof e=="number"?0:e;function TA(e){const t=o_(e);return s_(e)(t.map(DA))}const Or={test:SA,parse:o_,createTransformer:s_,getAnimatableNone:TA},AA=new Set(["brightness","contrast","saturate","opacity"]);function zA(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[r]=n.match(Gd)||[];if(!r)return e;const i=n.replace(r,"");let a=AA.has(t)?1:0;return r!==n&&(a*=100),t+"("+a+i+")"}const MA=/\b([a-z-]*)\(.*?\)/gu,x0={...Or,getAnimatableNone:e=>{const t=e.match(MA);return t?t.map(zA).join(" "):e}},FA={...Id,color:mt,backgroundColor:mt,outlineColor:mt,fill:mt,stroke:mt,borderColor:mt,borderTopColor:mt,borderRightColor:mt,borderBottomColor:mt,borderLeftColor:mt,filter:x0,WebkitFilter:x0},l_=e=>FA[e];function u_(e,t){let n=l_(e);return n!==x0&&(n=Or),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const qA=new Set(["auto","none","0"]);function RA(e,t,n){let r=0,i;for(;r<e.length&&!i;){const a=e[r];typeof a=="string"&&!qA.has(a)&&Uo(a).values.length&&(i=e[r]),r++}if(i&&n)for(const a of t)e[a]=u_(n,i)}const ui=e=>e*180/Math.PI,w0=e=>{const t=ui(Math.atan2(e[1],e[0]));return k0(t)},NA={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:w0,rotateZ:w0,skewX:e=>ui(Math.atan(e[1])),skewY:e=>ui(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},k0=e=>(e=e%360,e<0&&(e+=360),e),kg=w0,Sg=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),Eg=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),IA={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Sg,scaleY:Eg,scale:e=>(Sg(e)+Eg(e))/2,rotateX:e=>k0(ui(Math.atan2(e[6],e[5]))),rotateY:e=>k0(ui(Math.atan2(-e[2],e[0]))),rotateZ:kg,rotate:kg,skewX:e=>ui(Math.atan(e[4])),skewY:e=>ui(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function Cg(e){return e.includes("scale")?1:0}function S0(e,t){if(!e||e==="none")return Cg(t);const n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,i;if(n)r=IA,i=n;else{const s=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=NA,i=s}if(!i)return Cg(t);const a=r[t],o=i[1].split(",").map(LA);return typeof a=="function"?a(o):o[a]}const BA=(e,t)=>{const{transform:n="none"}=getComputedStyle(e);return S0(n,t)};function LA(e){return parseFloat(e.trim())}const Pg=e=>e===Pa||e===oe,OA=new Set(["x","y","z"]),jA=Ca.filter(e=>!OA.has(e));function VA(e){const t=[];return jA.forEach(n=>{const r=e.getValue(n);r!==void 0&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t}const ba={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>S0(t,"x"),y:(e,{transform:t})=>S0(t,"y")};ba.translateX=ba.x;ba.translateY=ba.y;const mi=new Set;let E0=!1,C0=!1;function h_(){if(C0){const e=Array.from(mi).filter(r=>r.needsMeasurement),t=new Set(e.map(r=>r.element)),n=new Map;t.forEach(r=>{const i=VA(r);i.length&&(n.set(r,i),r.render())}),e.forEach(r=>r.measureInitialState()),t.forEach(r=>{r.render();const i=n.get(r);i&&i.forEach(([a,o])=>{var s;(s=r.getValue(a))===null||s===void 0||s.set(o)})}),e.forEach(r=>r.measureEndState()),e.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}C0=!1,E0=!1,mi.forEach(e=>e.complete()),mi.clear()}function c_(){mi.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(C0=!0)})}function WA(){c_(),h_()}class Zd{constructor(t,n,r,i,a,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=r,this.motionValue=i,this.element=a,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(mi.add(this),E0||(E0=!0,Te.read(c_),Te.resolveKeyframes(h_))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:n,element:r,motionValue:i}=this;for(let a=0;a<t.length;a++)if(t[a]===null)if(a===0){const o=i==null?void 0:i.get(),s=t[t.length-1];if(o!==void 0)t[0]=o;else if(r&&n){const l=r.readValue(n,s);l!=null&&(t[0]=l)}t[0]===void 0&&(t[0]=s),i&&o===void 0&&i.set(t[0])}else t[a]=t[a-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),mi.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,mi.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const m_=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),XA=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function UA(e){const t=XA.exec(e);if(!t)return[,];const[,n,r,i]=t;return[`--${n??r}`,i]}function d_(e,t,n=1){const[r,i]=UA(e);if(!r)return;const a=window.getComputedStyle(t).getPropertyValue(r);if(a){const o=a.trim();return m_(o)?parseFloat(o):o}return Nd(i)?d_(i,t,n+1):i}const f_=e=>t=>t.test(e),HA={test:e=>e==="auto",parse:e=>e},p_=[Pa,oe,Mn,yr,WT,VT,HA],Dg=e=>p_.find(f_(e));class g_ extends Zd{constructor(t,n,r,i,a){super(t,n,r,i,a,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<t.length;l++){let u=t[l];if(typeof u=="string"&&(u=u.trim(),Nd(u))){const h=d_(u,n.current);h!==void 0&&(t[l]=h),l===t.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!Uv.has(r)||t.length!==2)return;const[i,a]=t,o=Dg(i),s=Dg(a);if(o!==s)if(Pg(o)&&Pg(s))for(let l=0;l<t.length;l++){const u=t[l];typeof u=="string"&&(t[l]=parseFloat(u))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:n}=this,r=[];for(let i=0;i<t.length;i++)$A(t[i])&&r.push(i);r.length&&RA(t,r,n)}measureInitialState(){const{element:t,unresolvedKeyframes:n,name:r}=this;if(!t||!t.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=ba[r](t.measureViewportBox(),window.getComputedStyle(t.current)),n[0]=this.measuredOrigin;const i=n[n.length-1];i!==void 0&&t.getValue(r,i).jump(i,!1)}measureEndState(){var t;const{element:n,name:r,unresolvedKeyframes:i}=this;if(!n||!n.current)return;const a=n.getValue(r);a&&a.jump(this.measuredOrigin,!1);const o=i.length-1,s=i[o];i[o]=ba[r](n.measureViewportBox(),window.getComputedStyle(n.current)),s!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=s),!((t=this.removedTransforms)===null||t===void 0)&&t.length&&this.removedTransforms.forEach(([l,u])=>{n.getValue(l).set(u)}),this.resolveNoneKeyframes()}}const Tg=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Or.test(e)||e==="0")&&!e.startsWith("url("));function GA(e){const t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function KA(e,t,n,r){const i=e[0];if(i===null)return!1;if(t==="display"||t==="visibility")return!0;const a=e[e.length-1],o=Tg(i,t),s=Tg(a,t);return!o||!s?!1:GA(e)||(n==="spring"||Dd(n))&&r}const ZA=e=>e!==null;function Fu(e,{repeat:t,repeatType:n="loop"},r){const i=e.filter(ZA),a=t&&n!=="loop"&&t%2===1?0:i.length-1;return!a||r===void 0?i[a]:r}const YA=40;class b_{constructor({autoplay:t=!0,delay:n=0,type:r="keyframes",repeat:i=0,repeatDelay:a=0,repeatType:o="loop",...s}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=zn.now(),this.options={autoplay:t,delay:n,type:r,repeat:i,repeatDelay:a,repeatType:o,...s},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>YA?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&WA(),this._resolved}onKeyframesResolved(t,n){this.resolvedAt=zn.now(),this.hasAttemptedResolve=!0;const{name:r,type:i,velocity:a,delay:o,onComplete:s,onUpdate:l,isGenerator:u}=this.options;if(!u&&!KA(t,r,i,a))if(o)this.options.duration=0;else{l&&l(Fu(t,this.options,n)),s&&s(),this.resolveFinishedPromise();return}const h=this.initPlayback(t,n);h!==!1&&(this._resolved={keyframes:t,finalKeyframe:n,...h},this.onPostResolved())}onPostResolved(){}then(t,n){return this.currentFinishedPromise.then(t,n)}flatten(){this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear")}updateFinishedPromise(){this.currentFinishedPromise=new Promise(t=>{this.resolveFinishedPromise=t})}}const Le=(e,t,n)=>e+(t-e)*n;function jh(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function QA({hue:e,saturation:t,lightness:n,alpha:r}){e/=360,t/=100,n/=100;let i=0,a=0,o=0;if(!t)i=a=o=n;else{const s=n<.5?n*(1+t):n+t-n*t,l=2*n-s;i=jh(l,s,e+1/3),a=jh(l,s,e),o=jh(l,s,e-1/3)}return{red:Math.round(i*255),green:Math.round(a*255),blue:Math.round(o*255),alpha:r}}function Kl(e,t){return n=>n>0?t:e}const Vh=(e,t,n)=>{const r=e*e,i=n*(t*t-r)+r;return i<0?0:Math.sqrt(i)},JA=[_0,li,Ui],ez=e=>JA.find(t=>t.test(e));function Ag(e){const t=ez(e);if(!t)return!1;let n=t.parse(e);return t===Ui&&(n=QA(n)),n}const zg=(e,t)=>{const n=Ag(e),r=Ag(t);if(!n||!r)return Kl(e,t);const i={...n};return a=>(i.red=Vh(n.red,r.red,a),i.green=Vh(n.green,r.green,a),i.blue=Vh(n.blue,r.blue,a),i.alpha=Le(n.alpha,r.alpha,a),li.transform(i))},tz=(e,t)=>n=>t(e(n)),hs=(...e)=>e.reduce(tz),P0=new Set(["none","hidden"]);function nz(e,t){return P0.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}function rz(e,t){return n=>Le(e,t,n)}function Yd(e){return typeof e=="number"?rz:typeof e=="string"?Nd(e)?Kl:mt.test(e)?zg:oz:Array.isArray(e)?y_:typeof e=="object"?mt.test(e)?zg:iz:Kl}function y_(e,t){const n=[...e],r=n.length,i=e.map((a,o)=>Yd(a)(a,t[o]));return a=>{for(let o=0;o<r;o++)n[o]=i[o](a);return n}}function iz(e,t){const n={...e,...t},r={};for(const i in n)e[i]!==void 0&&t[i]!==void 0&&(r[i]=Yd(e[i])(e[i],t[i]));return i=>{for(const a in r)n[a]=r[a](i);return n}}function az(e,t){var n;const r=[],i={color:0,var:0,number:0};for(let a=0;a<t.values.length;a++){const o=t.types[a],s=e.indexes[o][i[o]],l=(n=e.values[s])!==null&&n!==void 0?n:0;r[a]=l,i[o]++}return r}const oz=(e,t)=>{const n=Or.createTransformer(t),r=Uo(e),i=Uo(t);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?P0.has(e)&&!i.values.length||P0.has(t)&&!r.values.length?nz(e,t):hs(y_(az(r,i),i.values),n):Kl(e,t)};function $_(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?Le(e,t,n):Yd(e)(e,t)}const sz=5;function v_(e,t,n){const r=Math.max(t-sz,0);return vv(n-e(r),t-r)}const Xe={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Wh=.001;function lz({duration:e=Xe.duration,bounce:t=Xe.bounce,velocity:n=Xe.velocity,mass:r=Xe.mass}){let i,a,o=1-t;o=lr(Xe.minDamping,Xe.maxDamping,o),e=lr(Xe.minDuration,Xe.maxDuration,er(e)),o<1?(i=u=>{const h=u*o,c=h*e,m=h-n,d=D0(u,o),b=Math.exp(-c);return Wh-m/d*b},a=u=>{const c=u*o*e,m=c*n+n,d=Math.pow(o,2)*Math.pow(u,2)*e,b=Math.exp(-c),$=D0(Math.pow(u,2),o);return(-i(u)+Wh>0?-1:1)*((m-d)*b)/$}):(i=u=>{const h=Math.exp(-u*e),c=(u-n)*e+1;return-Wh+h*c},a=u=>{const h=Math.exp(-u*e),c=(n-u)*(e*e);return h*c});const s=5/e,l=hz(i,a,s);if(e=Jn(e),isNaN(l))return{stiffness:Xe.stiffness,damping:Xe.damping,duration:e};{const u=Math.pow(l,2)*r;return{stiffness:u,damping:o*2*Math.sqrt(r*u),duration:e}}}const uz=12;function hz(e,t,n){let r=n;for(let i=1;i<uz;i++)r=r-e(r)/t(r);return r}function D0(e,t){return e*Math.sqrt(1-t*t)}const cz=["duration","bounce"],mz=["stiffness","damping","mass"];function Mg(e,t){return t.some(n=>e[n]!==void 0)}function dz(e){let t={velocity:Xe.velocity,stiffness:Xe.stiffness,damping:Xe.damping,mass:Xe.mass,isResolvedFromDuration:!1,...e};if(!Mg(e,mz)&&Mg(e,cz))if(e.visualDuration){const n=e.visualDuration,r=2*Math.PI/(n*1.2),i=r*r,a=2*lr(.05,1,1-(e.bounce||0))*Math.sqrt(i);t={...t,mass:Xe.mass,stiffness:i,damping:a}}else{const n=lz(e);t={...t,...n,mass:Xe.mass},t.isResolvedFromDuration=!0}return t}function __(e=Xe.visualDuration,t=Xe.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:i}=n;const a=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],s={done:!1,value:a},{stiffness:l,damping:u,mass:h,duration:c,velocity:m,isResolvedFromDuration:d}=dz({...n,velocity:-er(n.velocity||0)}),b=m||0,$=u/(2*Math.sqrt(l*h)),w=o-a,g=er(Math.sqrt(l/h)),y=Math.abs(w)<5;r||(r=y?Xe.restSpeed.granular:Xe.restSpeed.default),i||(i=y?Xe.restDelta.granular:Xe.restDelta.default);let _;if($<1){const D=D0(g,$);_=C=>{const F=Math.exp(-$*g*C);return o-F*((b+$*g*w)/D*Math.sin(D*C)+w*Math.cos(D*C))}}else if($===1)_=D=>o-Math.exp(-g*D)*(w+(b+g*w)*D);else{const D=g*Math.sqrt($*$-1);_=C=>{const F=Math.exp(-$*g*C),R=Math.min(D*C,300);return o-F*((b+$*g*w)*Math.sinh(R)+D*w*Math.cosh(R))/D}}const T={calculatedDuration:d&&c||null,next:D=>{const C=_(D);if(d)s.done=D>=c;else{let F=0;$<1&&(F=D===0?Jn(b):v_(_,D,C));const R=Math.abs(F)<=r,N=Math.abs(o-C)<=i;s.done=R&&N}return s.value=s.done?o:C,s},toString:()=>{const D=Math.min(_v(T),b0),C=xv(F=>T.next(D*F).value,D,30);return D+"ms "+C}};return T}function Fg({keyframes:e,velocity:t=0,power:n=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:a=500,modifyTarget:o,min:s,max:l,restDelta:u=.5,restSpeed:h}){const c=e[0],m={done:!1,value:c},d=R=>s!==void 0&&R<s||l!==void 0&&R>l,b=R=>s===void 0?l:l===void 0||Math.abs(s-R)<Math.abs(l-R)?s:l;let $=n*t;const w=c+$,g=o===void 0?w:o(w);g!==w&&($=g-c);const y=R=>-$*Math.exp(-R/r),_=R=>g+y(R),T=R=>{const N=y(R),O=_(R);m.done=Math.abs(N)<=u,m.value=m.done?g:O};let D,C;const F=R=>{d(m.value)&&(D=R,C=__({keyframes:[m.value,b(m.value)],velocity:v_(_,R,m.value),damping:i,stiffness:a,restDelta:u,restSpeed:h}))};return F(0),{calculatedDuration:null,next:R=>{let N=!1;return!C&&D===void 0&&(N=!0,T(R),F(R)),D!==void 0&&R>=D?C.next(R-D):(!N&&T(R),m)}}}const fz=us(.42,0,1,1),pz=us(0,0,.58,1),x_=us(.42,0,.58,1),gz=e=>Array.isArray(e)&&typeof e[0]!="number",qg={linear:jt,easeIn:fz,easeInOut:x_,easeOut:pz,circIn:Hd,circInOut:t_,circOut:e_,backIn:Ud,backInOut:Qv,backOut:Yv,anticipate:Jv},Rg=e=>{if(Td(e)){g0(e.length===4);const[t,n,r,i]=e;return us(t,n,r,i)}else if(typeof e=="string")return g0(qg[e]!==void 0),qg[e];return e};function bz(e,t,n){const r=[],i=n||$_,a=e.length-1;for(let o=0;o<a;o++){let s=i(e[o],e[o+1]);if(t){const l=Array.isArray(t)?t[o]||jt:t;s=hs(l,s)}r.push(s)}return r}function yz(e,t,{clamp:n=!0,ease:r,mixer:i}={}){const a=e.length;if(g0(a===t.length),a===1)return()=>t[0];if(a===2&&t[0]===t[1])return()=>t[1];const o=e[0]===e[1];e[0]>e[a-1]&&(e=[...e].reverse(),t=[...t].reverse());const s=bz(t,r,i),l=s.length,u=h=>{if(o&&h<e[0])return t[0];let c=0;if(l>1)for(;c<e.length-2&&!(h<e[c+1]);c++);const m=pa(e[c],e[c+1],h);return s[c](m)};return n?h=>u(lr(e[0],e[a-1],h)):u}function $z(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const i=pa(0,t,r);e.push(Le(n,1,i))}}function vz(e){const t=[0];return $z(t,e.length-1),t}function _z(e,t){return e.map(n=>n*t)}function xz(e,t){return e.map(()=>t||x_).splice(0,e.length-1)}function Zl({duration:e=300,keyframes:t,times:n,ease:r="easeInOut"}){const i=gz(r)?r.map(Rg):Rg(r),a={done:!1,value:t[0]},o=_z(n&&n.length===t.length?n:vz(t),e),s=yz(o,t,{ease:Array.isArray(i)?i:xz(t,i)});return{calculatedDuration:e,next:l=>(a.value=s(l),a.done=l>=e,a)}}const wz=e=>{const t=({timestamp:n})=>e(n);return{start:()=>Te.update(t,!0),stop:()=>Lr(t),now:()=>st.isProcessing?st.timestamp:zn.now()}},kz={decay:Fg,inertia:Fg,tween:Zl,keyframes:Zl,spring:__},Sz=e=>e/100;class Qd extends b_{constructor(t){super(t),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:n,motionValue:r,element:i,keyframes:a}=this.options,o=(i==null?void 0:i.KeyframeResolver)||Zd,s=(l,u)=>this.onKeyframesResolved(l,u);this.resolver=new o(a,s,n,r,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(t){const{type:n="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:a,velocity:o=0}=this.options,s=Dd(n)?n:kz[n]||Zl;let l,u;s!==Zl&&typeof t[0]!="number"&&(l=hs(Sz,$_(t[0],t[1])),t=[0,100]);const h=s({...this.options,keyframes:t});a==="mirror"&&(u=s({...this.options,keyframes:[...t].reverse(),velocity:-o})),h.calculatedDuration===null&&(h.calculatedDuration=_v(h));const{calculatedDuration:c}=h,m=c+i,d=m*(r+1)-i;return{generator:h,mirroredGenerator:u,mapPercentToKeyframes:l,calculatedDuration:c,resolvedDuration:m,totalDuration:d}}onPostResolved(){const{autoplay:t=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!t?this.pause():this.state=this.pendingPlayState}tick(t,n=!1){const{resolved:r}=this;if(!r){const{keyframes:R}=this.options;return{done:!0,value:R[R.length-1]}}const{finalKeyframe:i,generator:a,mirroredGenerator:o,mapPercentToKeyframes:s,keyframes:l,calculatedDuration:u,totalDuration:h,resolvedDuration:c}=r;if(this.startTime===null)return a.next(0);const{delay:m,repeat:d,repeatType:b,repeatDelay:$,onUpdate:w}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-h/this.speed,this.startTime)),n?this.currentTime=t:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(t-this.startTime)*this.speed;const g=this.currentTime-m*(this.speed>=0?1:-1),y=this.speed>=0?g<0:g>h;this.currentTime=Math.max(g,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=h);let _=this.currentTime,T=a;if(d){const R=Math.min(this.currentTime,h)/c;let N=Math.floor(R),O=R%1;!O&&R>=1&&(O=1),O===1&&N--,N=Math.min(N,d+1),!!(N%2)&&(b==="reverse"?(O=1-O,$&&(O-=$/c)):b==="mirror"&&(T=o)),_=lr(0,1,O)*c}const D=y?{done:!1,value:l[0]}:T.next(_);s&&(D.value=s(D.value));let{done:C}=D;!y&&u!==null&&(C=this.speed>=0?this.currentTime>=h:this.currentTime<=0);const F=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&C);return F&&i!==void 0&&(D.value=Fu(l,this.options,i)),w&&w(D.value),F&&this.finish(),D}get duration(){const{resolved:t}=this;return t?er(t.calculatedDuration):0}get time(){return er(this.currentTime)}set time(t){t=Jn(t),this.currentTime=t,this.holdTime!==null||this.speed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.speed)}get speed(){return this.playbackSpeed}set speed(t){const n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=er(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:t=wz,onPlay:n,startTime:r}=this.options;this.driver||(this.driver=t(a=>this.tick(a))),n&&n();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=r??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var t;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(t=this.currentTime)!==null&&t!==void 0?t:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}}const Ez=new Set(["opacity","clipPath","filter","transform"]);function Cz(e,t,n,{delay:r=0,duration:i=300,repeat:a=0,repeatType:o="loop",ease:s="easeInOut",times:l}={}){const u={[t]:n};l&&(u.offset=l);const h=kv(s,i);return Array.isArray(h)&&(u.easing=h),e.animate(u,{delay:r,duration:i,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:a+1,direction:o==="reverse"?"alternate":"normal"})}const Pz=Ed(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Yl=10,Dz=2e4;function Tz(e){return Dd(e.type)||e.type==="spring"||!wv(e.ease)}function Az(e,t){const n=new Qd({...t,keyframes:e,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:e[0]};const i=[];let a=0;for(;!r.done&&a<Dz;)r=n.sample(a),i.push(r.value),a+=Yl;return{times:void 0,keyframes:i,duration:a-Yl,ease:"linear"}}const w_={anticipate:Jv,backInOut:Qv,circInOut:t_};function zz(e){return e in w_}class Ng extends b_{constructor(t){super(t);const{name:n,motionValue:r,element:i,keyframes:a}=this.options;this.resolver=new g_(a,(o,s)=>this.onKeyframesResolved(o,s),n,r,i),this.resolver.scheduleResolve()}initPlayback(t,n){let{duration:r=300,times:i,ease:a,type:o,motionValue:s,name:l,startTime:u}=this.options;if(!s.owner||!s.owner.current)return!1;if(typeof a=="string"&&Hl()&&zz(a)&&(a=w_[a]),Tz(this.options)){const{onComplete:c,onUpdate:m,motionValue:d,element:b,...$}=this.options,w=Az(t,$);t=w.keyframes,t.length===1&&(t[1]=t[0]),r=w.duration,i=w.times,a=w.ease,o="keyframes"}const h=Cz(s.owner.current,l,t,{...this.options,duration:r,times:i,ease:a});return h.startTime=u??this.calcStartTime(),this.pendingTimeline?(ug(h,this.pendingTimeline),this.pendingTimeline=void 0):h.onfinish=()=>{const{onComplete:c}=this.options;s.set(Fu(t,this.options,n)),c&&c(),this.cancel(),this.resolveFinishedPromise()},{animation:h,duration:r,times:i,type:o,ease:a,keyframes:t}}get duration(){const{resolved:t}=this;if(!t)return 0;const{duration:n}=t;return er(n)}get time(){const{resolved:t}=this;if(!t)return 0;const{animation:n}=t;return er(n.currentTime||0)}set time(t){const{resolved:n}=this;if(!n)return;const{animation:r}=n;r.currentTime=Jn(t)}get speed(){const{resolved:t}=this;if(!t)return 1;const{animation:n}=t;return n.playbackRate}set speed(t){const{resolved:n}=this;if(!n)return;const{animation:r}=n;r.playbackRate=t}get state(){const{resolved:t}=this;if(!t)return"idle";const{animation:n}=t;return n.playState}get startTime(){const{resolved:t}=this;if(!t)return null;const{animation:n}=t;return n.startTime}attachTimeline(t){if(!this._resolved)this.pendingTimeline=t;else{const{resolved:n}=this;if(!n)return jt;const{animation:r}=n;ug(r,t)}return jt}play(){if(this.isStopped)return;const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.playState==="finished"&&this.updateFinishedPromise(),n.play()}pause(){const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:t}=this;if(!t)return;const{animation:n,keyframes:r,duration:i,type:a,ease:o,times:s}=t;if(n.playState==="idle"||n.playState==="finished")return;if(this.time){const{motionValue:u,onUpdate:h,onComplete:c,element:m,...d}=this.options,b=new Qd({...d,keyframes:r,duration:i,type:a,ease:o,times:s,isGenerator:!0}),$=Jn(this.time);u.setWithVelocity(b.sample($-Yl).value,b.sample($).value,Yl)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:t}=this;t&&t.animation.finish()}cancel(){const{resolved:t}=this;t&&t.animation.cancel()}static supports(t){const{motionValue:n,name:r,repeatDelay:i,repeatType:a,damping:o,type:s}=t;if(!n||!n.owner||!(n.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:u}=n.owner.getProps();return Pz()&&r&&Ez.has(r)&&!l&&!u&&!i&&a!=="mirror"&&o!==0&&s!=="inertia"}}const Mz={type:"spring",stiffness:500,damping:25,restSpeed:10},Fz=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),qz={type:"keyframes",duration:.8},Rz={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Nz=(e,{keyframes:t})=>t.length>2?qz:ki.has(e)?e.startsWith("scale")?Fz(t[1]):Mz:Rz;function Iz({when:e,delay:t,delayChildren:n,staggerChildren:r,staggerDirection:i,repeat:a,repeatType:o,repeatDelay:s,from:l,elapsed:u,...h}){return!!Object.keys(h).length}const Jd=(e,t,n,r={},i,a)=>o=>{const s=Pd(r,e)||{},l=s.delay||r.delay||0;let{elapsed:u=0}=r;u=u-Jn(l);let h={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...s,delay:-u,onUpdate:m=>{t.set(m),s.onUpdate&&s.onUpdate(m)},onComplete:()=>{o(),s.onComplete&&s.onComplete()},name:e,motionValue:t,element:a?void 0:i};Iz(s)||(h={...h,...Nz(e,h)}),h.duration&&(h.duration=Jn(h.duration)),h.repeatDelay&&(h.repeatDelay=Jn(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let c=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(h.duration=0,h.delay===0&&(c=!0)),h.allowFlatten=!s.type&&!s.ease,c&&!a&&t.get()!==void 0){const m=Fu(h.keyframes,s);if(m!==void 0)return Te.update(()=>{h.onUpdate(m),h.onComplete()}),new lT([])}return!a&&Ng.supports(h)?new Ng(h):new Qd(h)};function Bz({protectedKeys:e,needsAnimating:t},n){const r=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,r}function k_(e,t,{delay:n=0,transitionOverride:r,type:i}={}){var a;let{transition:o=e.getDefaultTransition(),transitionEnd:s,...l}=t;r&&(o=r);const u=[],h=i&&e.animationState&&e.animationState.getState()[i];for(const c in l){const m=e.getValue(c,(a=e.latestValues[c])!==null&&a!==void 0?a:null),d=l[c];if(d===void 0||h&&Bz(h,c))continue;const b={delay:n,...Pd(o||{},c)};let $=!1;if(window.MotionHandoffAnimation){const g=Hv(e);if(g){const y=window.MotionHandoffAnimation(g,c,Te);y!==null&&(b.startTime=y,$=!0)}}v0(e,c),m.start(Jd(c,m,d,e.shouldReduceMotion&&Uv.has(c)?{type:!1}:b,e,$));const w=m.animation;w&&u.push(w)}return s&&Promise.all(u).then(()=>{Te.update(()=>{s&&fA(e,s)})}),u}function T0(e,t,n={}){var r;const i=Xo(e,t,n.type==="exit"?(r=e.presenceContext)===null||r===void 0?void 0:r.custom:void 0);let{transition:a=e.getDefaultTransition()||{}}=i||{};n.transitionOverride&&(a=n.transitionOverride);const o=i?()=>Promise.all(k_(e,i,n)):()=>Promise.resolve(),s=e.variantChildren&&e.variantChildren.size?(u=0)=>{const{delayChildren:h=0,staggerChildren:c,staggerDirection:m}=a;return Lz(e,t,h+u,c,m,n)}:()=>Promise.resolve(),{when:l}=a;if(l){const[u,h]=l==="beforeChildren"?[o,s]:[s,o];return u().then(()=>h())}else return Promise.all([o(),s(n.delay)])}function Lz(e,t,n=0,r=0,i=1,a){const o=[],s=(e.variantChildren.size-1)*r,l=i===1?(u=0)=>u*r:(u=0)=>s-u*r;return Array.from(e.variantChildren).sort(Oz).forEach((u,h)=>{u.notify("AnimationStart",t),o.push(T0(u,t,{...a,delay:n+l(h)}).then(()=>u.notify("AnimationComplete",t)))}),Promise.all(o)}function Oz(e,t){return e.sortNodePosition(t)}function jz(e,t,n={}){e.notify("AnimationStart",t);let r;if(Array.isArray(t)){const i=t.map(a=>T0(e,a,n));r=Promise.all(i)}else if(typeof t=="string")r=T0(e,t,n);else{const i=typeof t=="function"?Xo(e,t,n.custom):t;r=Promise.all(k_(e,i,n))}return r.then(()=>{e.notify("AnimationComplete",t)})}function S_(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}const Vz=Fd.length;function E_(e){if(!e)return;if(!e.isControllingVariants){const n=e.parent?E_(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}const t={};for(let n=0;n<Vz;n++){const r=Fd[n],i=e.props[r];(jo(i)||i===!1)&&(t[r]=i)}return t}const Wz=[...Md].reverse(),Xz=Md.length;function Uz(e){return t=>Promise.all(t.map(({animation:n,options:r})=>jz(e,n,r)))}function Hz(e){let t=Uz(e),n=Ig(),r=!0;const i=l=>(u,h)=>{var c;const m=Xo(e,h,l==="exit"?(c=e.presenceContext)===null||c===void 0?void 0:c.custom:void 0);if(m){const{transition:d,transitionEnd:b,...$}=m;u={...u,...$,...b}}return u};function a(l){t=l(e)}function o(l){const{props:u}=e,h=E_(e.parent)||{},c=[],m=new Set;let d={},b=1/0;for(let w=0;w<Xz;w++){const g=Wz[w],y=n[g],_=u[g]!==void 0?u[g]:h[g],T=jo(_),D=g===l?y.isActive:null;D===!1&&(b=w);let C=_===h[g]&&_!==u[g]&&T;if(C&&r&&e.manuallyAnimateOnMount&&(C=!1),y.protectedKeys={...d},!y.isActive&&D===null||!_&&!y.prevProp||zu(_)||typeof _=="boolean")continue;const F=Gz(y.prevProp,_);let R=F||g===l&&y.isActive&&!C&&T||w>b&&T,N=!1;const O=Array.isArray(_)?_:[_];let U=O.reduce(i(g),{});D===!1&&(U={});const{prevResolvedValues:B={}}=y,he={...B,...U},ue=le=>{R=!0,m.has(le)&&(N=!0,m.delete(le)),y.needsAnimating[le]=!0;const j=e.getValue(le);j&&(j.liveStyle=!1)};for(const le in he){const j=U[le],J=B[le];if(d.hasOwnProperty(le))continue;let k=!1;$0(j)&&$0(J)?k=!S_(j,J):k=j!==J,k?j!=null?ue(le):m.add(le):j!==void 0&&m.has(le)?ue(le):y.protectedKeys[le]=!0}y.prevProp=_,y.prevResolvedValues=U,y.isActive&&(d={...d,...U}),r&&e.blockInitialAnimation&&(R=!1),R&&(!(C&&F)||N)&&c.push(...O.map(le=>({animation:le,options:{type:g}})))}if(m.size){const w={};if(typeof u.initial!="boolean"){const g=Xo(e,Array.isArray(u.initial)?u.initial[0]:u.initial);g&&g.transition&&(w.transition=g.transition)}m.forEach(g=>{const y=e.getBaseTarget(g),_=e.getValue(g);_&&(_.liveStyle=!0),w[g]=y??null}),c.push({animation:w})}let $=!!c.length;return r&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&($=!1),r=!1,$?t(c):Promise.resolve()}function s(l,u){var h;if(n[l].isActive===u)return Promise.resolve();(h=e.variantChildren)===null||h===void 0||h.forEach(m=>{var d;return(d=m.animationState)===null||d===void 0?void 0:d.setActive(l,u)}),n[l].isActive=u;const c=o(l);for(const m in n)n[m].protectedKeys={};return c}return{animateChanges:o,setActive:s,setAnimateFunction:a,getState:()=>n,reset:()=>{n=Ig(),r=!0}}}function Gz(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!S_(t,e):!1}function Qr(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Ig(){return{animate:Qr(!0),whileInView:Qr(),whileHover:Qr(),whileTap:Qr(),whileDrag:Qr(),whileFocus:Qr(),exit:Qr()}}class Hr{constructor(t){this.isMounted=!1,this.node=t}update(){}}class Kz extends Hr{constructor(t){super(t),t.animationState||(t.animationState=Hz(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();zu(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)===null||t===void 0||t.call(this)}}let Zz=0;class Yz extends Hr{constructor(){super(...arguments),this.id=Zz++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===r)return;const i=this.node.animationState.setActive("exit",!t);n&&!t&&i.then(()=>{n(this.id)})}mount(){const{register:t,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const Qz={animation:{Feature:Kz},exit:{Feature:Yz}};function Ho(e,t,n,r={passive:!0}){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}function cs(e){return{point:{x:e.pageX,y:e.pageY}}}const Jz=e=>t=>zd(t)&&e(t,cs(t));function go(e,t,n,r){return Ho(e,t,Jz(n),r)}function C_({top:e,left:t,right:n,bottom:r}){return{x:{min:t,max:n},y:{min:e,max:r}}}function eM({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function tM(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}const P_=1e-4,nM=1-P_,rM=1+P_,D_=.01,iM=0-D_,aM=0+D_;function _t(e){return e.max-e.min}function oM(e,t,n){return Math.abs(e-t)<=n}function Bg(e,t,n,r=.5){e.origin=r,e.originPoint=Le(t.min,t.max,e.origin),e.scale=_t(n)/_t(t),e.translate=Le(n.min,n.max,e.origin)-e.originPoint,(e.scale>=nM&&e.scale<=rM||isNaN(e.scale))&&(e.scale=1),(e.translate>=iM&&e.translate<=aM||isNaN(e.translate))&&(e.translate=0)}function bo(e,t,n,r){Bg(e.x,t.x,n.x,r?r.originX:void 0),Bg(e.y,t.y,n.y,r?r.originY:void 0)}function Lg(e,t,n){e.min=n.min+t.min,e.max=e.min+_t(t)}function sM(e,t,n){Lg(e.x,t.x,n.x),Lg(e.y,t.y,n.y)}function Og(e,t,n){e.min=t.min-n.min,e.max=e.min+_t(t)}function yo(e,t,n){Og(e.x,t.x,n.x),Og(e.y,t.y,n.y)}const jg=()=>({translate:0,scale:1,origin:0,originPoint:0}),Hi=()=>({x:jg(),y:jg()}),Vg=()=>({min:0,max:0}),He=()=>({x:Vg(),y:Vg()});function Gt(e){return[e("x"),e("y")]}function Xh(e){return e===void 0||e===1}function A0({scale:e,scaleX:t,scaleY:n}){return!Xh(e)||!Xh(t)||!Xh(n)}function ni(e){return A0(e)||T_(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function T_(e){return Wg(e.x)||Wg(e.y)}function Wg(e){return e&&e!=="0%"}function Ql(e,t,n){const r=e-n,i=t*r;return n+i}function Xg(e,t,n,r,i){return i!==void 0&&(e=Ql(e,i,r)),Ql(e,n,r)+t}function z0(e,t=0,n=1,r,i){e.min=Xg(e.min,t,n,r,i),e.max=Xg(e.max,t,n,r,i)}function A_(e,{x:t,y:n}){z0(e.x,t.translate,t.scale,t.originPoint),z0(e.y,n.translate,n.scale,n.originPoint)}const Ug=.999999999999,Hg=1.0000000000001;function lM(e,t,n,r=!1){const i=n.length;if(!i)return;t.x=t.y=1;let a,o;for(let s=0;s<i;s++){a=n[s],o=a.projectionDelta;const{visualElement:l}=a.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&a.options.layoutScroll&&a.scroll&&a!==a.root&&Ki(e,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),o&&(t.x*=o.x.scale,t.y*=o.y.scale,A_(e,o)),r&&ni(a.latestValues)&&Ki(e,a.latestValues))}t.x<Hg&&t.x>Ug&&(t.x=1),t.y<Hg&&t.y>Ug&&(t.y=1)}function Gi(e,t){e.min=e.min+t,e.max=e.max+t}function Gg(e,t,n,r,i=.5){const a=Le(e.min,e.max,i);z0(e,t,n,a,r)}function Ki(e,t){Gg(e.x,t.x,t.scaleX,t.scale,t.originX),Gg(e.y,t.y,t.scaleY,t.scale,t.originY)}function z_(e,t){return C_(tM(e.getBoundingClientRect(),t))}function uM(e,t,n){const r=z_(e,n),{scroll:i}=t;return i&&(Gi(r.x,i.offset.x),Gi(r.y,i.offset.y)),r}const M_=({current:e})=>e?e.ownerDocument.defaultView:null,Kg=(e,t)=>Math.abs(e-t);function hM(e,t){const n=Kg(e.x,t.x),r=Kg(e.y,t.y);return Math.sqrt(n**2+r**2)}class F_{constructor(t,n,{transformPagePoint:r,contextWindow:i,dragSnapToOrigin:a=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const c=Hh(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,d=hM(c.offset,{x:0,y:0})>=3;if(!m&&!d)return;const{point:b}=c,{timestamp:$}=st;this.history.push({...b,timestamp:$});const{onStart:w,onMove:g}=this.handlers;m||(w&&w(this.lastMoveEvent,c),this.startEvent=this.lastMoveEvent),g&&g(this.lastMoveEvent,c)},this.handlePointerMove=(c,m)=>{this.lastMoveEvent=c,this.lastMoveEventInfo=Uh(m,this.transformPagePoint),Te.update(this.updatePoint,!0)},this.handlePointerUp=(c,m)=>{this.end();const{onEnd:d,onSessionEnd:b,resumeAnimation:$}=this.handlers;if(this.dragSnapToOrigin&&$&&$(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=Hh(c.type==="pointercancel"?this.lastMoveEventInfo:Uh(m,this.transformPagePoint),this.history);this.startEvent&&d&&d(c,w),b&&b(c,w)},!zd(t))return;this.dragSnapToOrigin=a,this.handlers=n,this.transformPagePoint=r,this.contextWindow=i||window;const o=cs(t),s=Uh(o,this.transformPagePoint),{point:l}=s,{timestamp:u}=st;this.history=[{...l,timestamp:u}];const{onSessionStart:h}=n;h&&h(t,Hh(s,this.history)),this.removeListeners=hs(go(this.contextWindow,"pointermove",this.handlePointerMove),go(this.contextWindow,"pointerup",this.handlePointerUp),go(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Lr(this.updatePoint)}}function Uh(e,t){return t?{point:t(e.point)}:e}function Zg(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Hh({point:e},t){return{point:e,delta:Zg(e,q_(t)),offset:Zg(e,cM(t)),velocity:mM(t,.1)}}function cM(e){return e[0]}function q_(e){return e[e.length-1]}function mM(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null;const i=q_(e);for(;n>=0&&(r=e[n],!(i.timestamp-r.timestamp>Jn(t)));)n--;if(!r)return{x:0,y:0};const a=er(i.timestamp-r.timestamp);if(a===0)return{x:0,y:0};const o={x:(i.x-r.x)/a,y:(i.y-r.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function dM(e,{min:t,max:n},r){return t!==void 0&&e<t?e=r?Le(t,e,r.min):Math.max(e,t):n!==void 0&&e>n&&(e=r?Le(n,e,r.max):Math.min(e,n)),e}function Yg(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function fM(e,{top:t,left:n,bottom:r,right:i}){return{x:Yg(e.x,n,i),y:Yg(e.y,t,r)}}function Qg(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}function pM(e,t){return{x:Qg(e.x,t.x),y:Qg(e.y,t.y)}}function gM(e,t){let n=.5;const r=_t(e),i=_t(t);return i>r?n=pa(t.min,t.max-r,e.min):r>i&&(n=pa(e.min,e.max-i,t.min)),lr(0,1,n)}function bM(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const M0=.35;function yM(e=M0){return e===!1?e=0:e===!0&&(e=M0),{x:Jg(e,"left","right"),y:Jg(e,"top","bottom")}}function Jg(e,t,n){return{min:eb(e,t),max:eb(e,n)}}function eb(e,t){return typeof e=="number"?e:e[t]||0}const $M=new WeakMap;class vM{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=He(),this.visualElement=t}start(t,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const i=h=>{const{dragSnapToOrigin:c}=this.getProps();c?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(cs(h).point)},a=(h,c)=>{const{drag:m,dragPropagation:d,onDragStart:b}=this.getProps();if(m&&!d&&(this.openDragLock&&this.openDragLock(),this.openDragLock=fT(m),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Gt(w=>{let g=this.getAxisMotionValue(w).get()||0;if(Mn.test(g)){const{projection:y}=this.visualElement;if(y&&y.layout){const _=y.layout.layoutBox[w];_&&(g=_t(_)*(parseFloat(g)/100))}}this.originPoint[w]=g}),b&&Te.postRender(()=>b(h,c)),v0(this.visualElement,"transform");const{animationState:$}=this.visualElement;$&&$.setActive("whileDrag",!0)},o=(h,c)=>{const{dragPropagation:m,dragDirectionLock:d,onDirectionLock:b,onDrag:$}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:w}=c;if(d&&this.currentDirection===null){this.currentDirection=_M(w),this.currentDirection!==null&&b&&b(this.currentDirection);return}this.updateAxis("x",c.point,w),this.updateAxis("y",c.point,w),this.visualElement.render(),$&&$(h,c)},s=(h,c)=>this.stop(h,c),l=()=>Gt(h=>{var c;return this.getAnimationState(h)==="paused"&&((c=this.getAxisMotionValue(h).animation)===null||c===void 0?void 0:c.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new F_(t,{onSessionStart:i,onStart:a,onMove:o,onSessionEnd:s,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:M_(this.visualElement)})}stop(t,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:i}=n;this.startAnimation(i);const{onDragEnd:a}=this.getProps();a&&Te.postRender(()=>a(t,n))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,r){const{drag:i}=this.getProps();if(!r||!Xs(t,i,this.currentDirection))return;const a=this.getAxisMotionValue(t);let o=this.originPoint[t]+r[t];this.constraints&&this.constraints[t]&&(o=dM(o,this.constraints[t],this.elastic[t])),a.set(o)}resolveConstraints(){var t;const{dragConstraints:n,dragElastic:r}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,a=this.constraints;n&&Xi(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&i?this.constraints=fM(i.layoutBox,n):this.constraints=!1,this.elastic=yM(r),a!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&Gt(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=bM(i.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!Xi(t))return!1;const r=t.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const a=uM(r,i.root,this.visualElement.getTransformPagePoint());let o=pM(i.layout.layoutBox,a);if(n){const s=n(eM(o));this.hasMutatedConstraints=!!s,s&&(o=C_(s))}return o}startAnimation(t){const{drag:n,dragMomentum:r,dragElastic:i,dragTransition:a,dragSnapToOrigin:o,onDragTransitionEnd:s}=this.getProps(),l=this.constraints||{},u=Gt(h=>{if(!Xs(h,n,this.currentDirection))return;let c=l&&l[h]||{};o&&(c={min:0,max:0});const m=i?200:1e6,d=i?40:1e7,b={type:"inertia",velocity:r?t[h]:0,bounceStiffness:m,bounceDamping:d,timeConstant:750,restDelta:1,restSpeed:10,...a,...c};return this.startAxisValueAnimation(h,b)});return Promise.all(u).then(s)}startAxisValueAnimation(t,n){const r=this.getAxisMotionValue(t);return v0(this.visualElement,t),r.start(Jd(t,r,0,n,this.visualElement,!1))}stopAnimation(){Gt(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Gt(t=>{var n;return(n=this.getAxisMotionValue(t).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(t){var n;return(n=this.getAxisMotionValue(t).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(t){const n=`_drag${t.toUpperCase()}`,r=this.visualElement.getProps(),i=r[n];return i||this.visualElement.getValue(t,(r.initial?r.initial[t]:void 0)||0)}snapToCursor(t){Gt(n=>{const{drag:r}=this.getProps();if(!Xs(n,r,this.currentDirection))return;const{projection:i}=this.visualElement,a=this.getAxisMotionValue(n);if(i&&i.layout){const{min:o,max:s}=i.layout.layoutBox[n];a.set(t[n]-Le(o,s,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!Xi(n)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Gt(o=>{const s=this.getAxisMotionValue(o);if(s&&this.constraints!==!1){const l=s.get();i[o]=gM({min:l,max:l},this.constraints[o])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Gt(o=>{if(!Xs(o,t,null))return;const s=this.getAxisMotionValue(o),{min:l,max:u}=this.constraints[o];s.set(Le(l,u,i[o]))})}addListeners(){if(!this.visualElement.current)return;$M.set(this.visualElement,this);const t=this.visualElement.current,n=go(t,"pointerdown",l=>{const{drag:u,dragListener:h=!0}=this.getProps();u&&h&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();Xi(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,a=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),Te.read(r);const o=Ho(window,"resize",()=>this.scalePositionWithinConstraints()),s=i.addEventListener("didUpdate",({delta:l,hasLayoutChanged:u})=>{this.isDragging&&u&&(Gt(h=>{const c=this.getAxisMotionValue(h);c&&(this.originPoint[h]+=l[h].translate,c.set(c.get()+l[h].translate))}),this.visualElement.render())});return()=>{o(),n(),a(),s&&s()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:a=!1,dragElastic:o=M0,dragMomentum:s=!0}=t;return{...t,drag:n,dragDirectionLock:r,dragPropagation:i,dragConstraints:a,dragElastic:o,dragMomentum:s}}}function Xs(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function _M(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class xM extends Hr{constructor(t){super(t),this.removeGroupControls=jt,this.removeListeners=jt,this.controls=new vM(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||jt}unmount(){this.removeGroupControls(),this.removeListeners()}}const tb=e=>(t,n)=>{e&&Te.postRender(()=>e(t,n))};class wM extends Hr{constructor(){super(...arguments),this.removePointerDownListener=jt}onPointerDown(t){this.session=new F_(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:M_(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:tb(t),onStart:tb(n),onMove:r,onEnd:(a,o)=>{delete this.session,i&&Te.postRender(()=>i(a,o))}}}mount(){this.removePointerDownListener=go(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const dl={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function nb(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Ha={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(oe.test(e))e=parseFloat(e);else return e;const n=nb(e,t.target.x),r=nb(e,t.target.y);return`${n}% ${r}%`}},kM={correct:(e,{treeScale:t,projectionDelta:n})=>{const r=e,i=Or.parse(e);if(i.length>5)return r;const a=Or.createTransformer(e),o=typeof i[0]!="number"?1:0,s=n.x.scale*t.x,l=n.y.scale*t.y;i[0+o]/=s,i[1+o]/=l;const u=Le(s,l,.5);return typeof i[2+o]=="number"&&(i[2+o]/=u),typeof i[3+o]=="number"&&(i[3+o]/=u),a(i)}};class SM extends S.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r,layoutId:i}=this.props,{projection:a}=t;jT(EM),a&&(n.group&&n.group.add(a),r&&r.register&&i&&r.register(a),a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),dl.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:r,drag:i,isPresent:a}=this.props,o=r.projection;return o&&(o.isPresent=a,i||t.layoutDependency!==n||n===void 0||t.isPresent!==a?o.willUpdate():this.safeToRemove(),t.isPresent!==a&&(a?o.promote():o.relegate()||Te.postRender(()=>{const s=o.getStack();(!s||!s.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),Ad.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:i}=t;i&&(i.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function R_(e){const[t,n]=$v(),r=S.useContext(vd);return M.jsx(SM,{...e,layoutGroup:r,switchLayoutGroup:S.useContext(Mv),isPresent:t,safeToRemove:n})}const EM={borderRadius:{...Ha,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Ha,borderTopRightRadius:Ha,borderBottomLeftRadius:Ha,borderBottomRightRadius:Ha,boxShadow:kM};function CM(e,t,n){const r=ft(e)?e:Oo(e);return r.start(Jd("",r,t,n)),r.animation}function PM(e){return e instanceof SVGElement&&e.tagName!=="svg"}const DM=(e,t)=>e.depth-t.depth;class TM{constructor(){this.children=[],this.isDirty=!1}add(t){kd(this.children,t),this.isDirty=!0}remove(t){Sd(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(DM),this.isDirty=!1,this.children.forEach(t)}}function AM(e,t){const n=zn.now(),r=({timestamp:i})=>{const a=i-n;a>=t&&(Lr(r),e(a-t))};return Te.read(r,!0),()=>Lr(r)}const N_=["TopLeft","TopRight","BottomLeft","BottomRight"],zM=N_.length,rb=e=>typeof e=="string"?parseFloat(e):e,ib=e=>typeof e=="number"||oe.test(e);function MM(e,t,n,r,i,a){i?(e.opacity=Le(0,n.opacity!==void 0?n.opacity:1,FM(r)),e.opacityExit=Le(t.opacity!==void 0?t.opacity:1,0,qM(r))):a&&(e.opacity=Le(t.opacity!==void 0?t.opacity:1,n.opacity!==void 0?n.opacity:1,r));for(let o=0;o<zM;o++){const s=`border${N_[o]}Radius`;let l=ab(t,s),u=ab(n,s);if(l===void 0&&u===void 0)continue;l||(l=0),u||(u=0),l===0||u===0||ib(l)===ib(u)?(e[s]=Math.max(Le(rb(l),rb(u),r),0),(Mn.test(u)||Mn.test(l))&&(e[s]+="%")):e[s]=u}(t.rotate||n.rotate)&&(e.rotate=Le(t.rotate||0,n.rotate||0,r))}function ab(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const FM=I_(0,.5,e_),qM=I_(.5,.95,jt);function I_(e,t,n){return r=>r<e?0:r>t?1:n(pa(e,t,r))}function ob(e,t){e.min=t.min,e.max=t.max}function Ht(e,t){ob(e.x,t.x),ob(e.y,t.y)}function sb(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function lb(e,t,n,r,i){return e-=t,e=Ql(e,1/n,r),i!==void 0&&(e=Ql(e,1/i,r)),e}function RM(e,t=0,n=1,r=.5,i,a=e,o=e){if(Mn.test(t)&&(t=parseFloat(t),t=Le(o.min,o.max,t/100)-o.min),typeof t!="number")return;let s=Le(a.min,a.max,r);e===a&&(s-=t),e.min=lb(e.min,t,n,s,i),e.max=lb(e.max,t,n,s,i)}function ub(e,t,[n,r,i],a,o){RM(e,t[n],t[r],t[i],t.scale,a,o)}const NM=["x","scaleX","originX"],IM=["y","scaleY","originY"];function hb(e,t,n,r){ub(e.x,t,NM,n?n.x:void 0,r?r.x:void 0),ub(e.y,t,IM,n?n.y:void 0,r?r.y:void 0)}function cb(e){return e.translate===0&&e.scale===1}function B_(e){return cb(e.x)&&cb(e.y)}function mb(e,t){return e.min===t.min&&e.max===t.max}function BM(e,t){return mb(e.x,t.x)&&mb(e.y,t.y)}function db(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function L_(e,t){return db(e.x,t.x)&&db(e.y,t.y)}function fb(e){return _t(e.x)/_t(e.y)}function pb(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class LM{constructor(){this.members=[]}add(t){kd(this.members,t),t.scheduleRender()}remove(t){if(Sd(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(i=>t===i);if(n===0)return!1;let r;for(let i=n;i>=0;i--){const a=this.members[i];if(a.isPresent!==!1){r=a;break}}return r?(this.promote(r),!0):!1}promote(t,n){const r=this.lead;if(t!==r&&(this.prevLead=r,this.lead=t,t.show(),r)){r.instance&&r.scheduleRender(),t.scheduleRender(),t.resumeFrom=r,n&&(t.resumeFrom.preserveOpacity=!0),r.snapshot&&(t.snapshot=r.snapshot,t.snapshot.latestValues=r.animationValues||r.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:i}=t.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:r}=t;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function OM(e,t,n){let r="";const i=e.x.translate/t.x,a=e.y.translate/t.y,o=(n==null?void 0:n.z)||0;if((i||a||o)&&(r=`translate3d(${i}px, ${a}px, ${o}px) `),(t.x!==1||t.y!==1)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:u,rotate:h,rotateX:c,rotateY:m,skewX:d,skewY:b}=n;u&&(r=`perspective(${u}px) ${r}`),h&&(r+=`rotate(${h}deg) `),c&&(r+=`rotateX(${c}deg) `),m&&(r+=`rotateY(${m}deg) `),d&&(r+=`skewX(${d}deg) `),b&&(r+=`skewY(${b}deg) `)}const s=e.x.scale*t.x,l=e.y.scale*t.y;return(s!==1||l!==1)&&(r+=`scale(${s}, ${l})`),r||"none"}const Gh=["","X","Y","Z"],jM={visibility:"hidden"},gb=1e3;let VM=0;function Kh(e,t,n,r){const{latestValues:i}=t;i[e]&&(n[e]=i[e],t.setStaticValue(e,0),r&&(r[e]=0))}function O_(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=Hv(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:i,layoutId:a}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",Te,!(i||a))}const{parent:r}=e;r&&!r.hasCheckedOptimisedAppear&&O_(r)}function j_({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(o={},s=t==null?void 0:t()){this.id=VM++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(UM),this.nodes.forEach(YM),this.nodes.forEach(QM),this.nodes.forEach(HM)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=s?s.root||s:this,this.path=s?[...s.path,s]:[],this.parent=s,this.depth=s?s.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new TM)}addEventListener(o,s){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new Cd),this.eventHandlers.get(o).add(s)}notifyListeners(o,...s){const l=this.eventHandlers.get(o);l&&l.notify(...s)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,s=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=PM(o),this.instance=o;const{layoutId:l,layout:u,visualElement:h}=this.options;if(h&&!h.current&&h.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),s&&(u||l)&&(this.isLayoutDirty=!0),e){let c;const m=()=>this.root.updateBlockedByResize=!1;e(o,()=>{this.root.updateBlockedByResize=!0,c&&c(),c=AM(m,250),dl.hasAnimatedSinceResize&&(dl.hasAnimatedSinceResize=!1,this.nodes.forEach(yb))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&h&&(l||u)&&this.addEventListener("didUpdate",({delta:c,hasLayoutChanged:m,hasRelativeLayoutChanged:d,layout:b})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const $=this.options.transition||h.getDefaultTransition()||rF,{onLayoutAnimationStart:w,onLayoutAnimationComplete:g}=h.getProps(),y=!this.targetLayout||!L_(this.targetLayout,b),_=!m&&d;if(this.options.layoutRoot||this.resumeFrom||_||m&&(y||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(c,_);const T={...Pd($,"layout"),onPlay:w,onComplete:g};(h.shouldReduceMotion||this.options.layoutRoot)&&(T.delay=0,T.type=!1),this.startAnimation(T)}else m||yb(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=b})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Lr(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(JM),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&O_(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const c=this.path[h];c.shouldResetTransform=!0,c.updateScroll("snapshot"),c.options.layoutRoot&&c.willUpdate(!1)}const{layoutId:s,layout:l}=this.options;if(s===void 0&&!l)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(bb);return}this.isUpdating||this.nodes.forEach(KM),this.isUpdating=!1,this.nodes.forEach(ZM),this.nodes.forEach(WM),this.nodes.forEach(XM),this.clearAllSnapshots();const s=zn.now();st.delta=lr(0,1e3/60,s-st.timestamp),st.timestamp=s,st.isProcessing=!0,Bh.update.process(st),Bh.preRender.process(st),Bh.render.process(st),st.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Ad.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(GM),this.sharedNodes.forEach(eF)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Te.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Te.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!_t(this.snapshot.measuredBox.x)&&!_t(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=He(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:s}=this.options;s&&s.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let s=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(s=!1),s){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,s=this.projectionDelta&&!B_(this.projectionDelta),l=this.getTransformTemplate(),u=l?l(this.latestValues,""):void 0,h=u!==this.prevTransformTemplateValue;o&&(s||ni(this.latestValues)||h)&&(i(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const s=this.measurePageBox();let l=this.removeElementScroll(s);return o&&(l=this.removeTransform(l)),iF(l),{animationId:this.root.animationId,measuredBox:s,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:s}=this.options;if(!s)return He();const l=s.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(aF))){const{scroll:h}=this.root;h&&(Gi(l.x,h.offset.x),Gi(l.y,h.offset.y))}return l}removeElementScroll(o){var s;const l=He();if(Ht(l,o),!((s=this.scroll)===null||s===void 0)&&s.wasRoot)return l;for(let u=0;u<this.path.length;u++){const h=this.path[u],{scroll:c,options:m}=h;h!==this.root&&c&&m.layoutScroll&&(c.wasRoot&&Ht(l,o),Gi(l.x,c.offset.x),Gi(l.y,c.offset.y))}return l}applyTransform(o,s=!1){const l=He();Ht(l,o);for(let u=0;u<this.path.length;u++){const h=this.path[u];!s&&h.options.layoutScroll&&h.scroll&&h!==h.root&&Ki(l,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),ni(h.latestValues)&&Ki(l,h.latestValues)}return ni(this.latestValues)&&Ki(l,this.latestValues),l}removeTransform(o){const s=He();Ht(s,o);for(let l=0;l<this.path.length;l++){const u=this.path[l];if(!u.instance||!ni(u.latestValues))continue;A0(u.latestValues)&&u.updateSnapshot();const h=He(),c=u.measurePageBox();Ht(h,c),hb(s,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,h)}return ni(this.latestValues)&&hb(s,this.latestValues),s}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==st.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var s;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==l;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((s=this.parent)===null||s===void 0)&&s.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:c,layoutId:m}=this.options;if(!(!this.layout||!(c||m))){if(this.resolvedRelativeTargetAt=st.timestamp,!this.targetDelta&&!this.relativeTarget){const d=this.getClosestProjectingParent();d&&d.layout&&this.animationProgress!==1?(this.relativeParent=d,this.forceRelativeParentToResolveTarget(),this.relativeTarget=He(),this.relativeTargetOrigin=He(),yo(this.relativeTargetOrigin,this.layout.layoutBox,d.layout.layoutBox),Ht(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=He(),this.targetWithTransforms=He()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),sM(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ht(this.target,this.layout.layoutBox),A_(this.target,this.targetDelta)):Ht(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const d=this.getClosestProjectingParent();d&&!!d.resumingFrom==!!this.resumingFrom&&!d.options.layoutScroll&&d.target&&this.animationProgress!==1?(this.relativeParent=d,this.forceRelativeParentToResolveTarget(),this.relativeTarget=He(),this.relativeTargetOrigin=He(),yo(this.relativeTargetOrigin,this.target,d.target),Ht(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||A0(this.parent.latestValues)||T_(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const s=this.getLead(),l=!!this.resumingFrom||this!==s;let u=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(u=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===st.timestamp&&(u=!1),u)return;const{layout:h,layoutId:c}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||c))return;Ht(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,d=this.treeScale.y;lM(this.layoutCorrected,this.treeScale,this.path,l),s.layout&&!s.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(s.target=s.layout.layoutBox,s.targetWithTransforms=He());const{target:b}=s;if(!b){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(sb(this.prevProjectionDelta.x,this.projectionDelta.x),sb(this.prevProjectionDelta.y,this.projectionDelta.y)),bo(this.projectionDelta,this.layoutCorrected,b,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==d||!pb(this.projectionDelta.x,this.prevProjectionDelta.x)||!pb(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",b))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var s;if((s=this.options.visualElement)===null||s===void 0||s.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Hi(),this.projectionDelta=Hi(),this.projectionDeltaWithTransform=Hi()}setAnimationOrigin(o,s=!1){const l=this.snapshot,u=l?l.latestValues:{},h={...this.latestValues},c=Hi();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!s;const m=He(),d=l?l.source:void 0,b=this.layout?this.layout.source:void 0,$=d!==b,w=this.getStack(),g=!w||w.members.length<=1,y=!!($&&!g&&this.options.crossfade===!0&&!this.path.some(nF));this.animationProgress=0;let _;this.mixTargetDelta=T=>{const D=T/1e3;$b(c.x,o.x,D),$b(c.y,o.y,D),this.setTargetDelta(c),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(yo(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),tF(this.relativeTarget,this.relativeTargetOrigin,m,D),_&&BM(this.relativeTarget,_)&&(this.isProjectionDirty=!1),_||(_=He()),Ht(_,this.relativeTarget)),$&&(this.animationValues=h,MM(h,u,this.latestValues,D,y,g)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=D},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Lr(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Te.update(()=>{dl.hasAnimatedSinceResize=!0,this.currentAnimation=CM(0,gb,{...o,onUpdate:s=>{this.mixTargetDelta(s),o.onUpdate&&o.onUpdate(s)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(gb),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:s,target:l,layout:u,latestValues:h}=o;if(!(!s||!l||!u)){if(this!==o&&this.layout&&u&&V_(this.options.animationType,this.layout.layoutBox,u.layoutBox)){l=this.target||He();const c=_t(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+c;const m=_t(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+m}Ht(s,l),Ki(s,h),bo(this.projectionDeltaWithTransform,this.layoutCorrected,s,h)}}registerSharedNode(o,s){this.sharedNodes.has(o)||this.sharedNodes.set(o,new LM),this.sharedNodes.get(o).add(s);const u=s.options.initialPromotionConfig;s.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(s):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:s}=this.options;return s?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:s}=this.options;return s?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:s,preserveFollowOpacity:l}={}){const u=this.getStack();u&&u.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),s&&this.setOptions({transition:s})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let s=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(s=!0),!s)return;const u={};l.z&&Kh("z",o,u,this.animationValues);for(let h=0;h<Gh.length;h++)Kh(`rotate${Gh[h]}`,o,u,this.animationValues),Kh(`skew${Gh[h]}`,o,u,this.animationValues);o.render();for(const h in u)o.setStaticValue(h,u[h]),this.animationValues&&(this.animationValues[h]=u[h]);o.scheduleRender()}getProjectionStyles(o){var s,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return jM;const u={visibility:""},h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=ml(o==null?void 0:o.pointerEvents)||"",u.transform=h?h(this.latestValues,""):"none",u;const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){const $={};return this.options.layoutId&&($.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,$.pointerEvents=ml(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!ni(this.latestValues)&&($.transform=h?h({},""):"none",this.hasProjected=!1),$}const m=c.animationValues||c.latestValues;this.applyTransformsToTarget(),u.transform=OM(this.projectionDeltaWithTransform,this.treeScale,m),h&&(u.transform=h(m,u.transform));const{x:d,y:b}=this.projectionDelta;u.transformOrigin=`${d.origin*100}% ${b.origin*100}% 0`,c.animationValues?u.opacity=c===this?(l=(s=m.opacity)!==null&&s!==void 0?s:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:u.opacity=c===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const $ in Vo){if(m[$]===void 0)continue;const{correct:w,applyTo:g,isCSSVariable:y}=Vo[$],_=u.transform==="none"?m[$]:w(m[$],c);if(g){const T=g.length;for(let D=0;D<T;D++)u[g[D]]=_}else y?this.options.visualElement.renderState.vars[$]=_:u[$]=_}return this.options.layoutId&&(u.pointerEvents=c===this?ml(o==null?void 0:o.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var s;return(s=o.currentAnimation)===null||s===void 0?void 0:s.stop()}),this.root.nodes.forEach(bb),this.root.sharedNodes.clear()}}}function WM(e){e.updateLayout()}function XM(e){var t;const n=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&n&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=e.layout,{animationType:a}=e.options,o=n.source!==e.layout.source;a==="size"?Gt(c=>{const m=o?n.measuredBox[c]:n.layoutBox[c],d=_t(m);m.min=r[c].min,m.max=m.min+d}):V_(a,n.layoutBox,r)&&Gt(c=>{const m=o?n.measuredBox[c]:n.layoutBox[c],d=_t(r[c]);m.max=m.min+d,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[c].max=e.relativeTarget[c].min+d)});const s=Hi();bo(s,r,n.layoutBox);const l=Hi();o?bo(l,e.applyTransform(i,!0),n.measuredBox):bo(l,r,n.layoutBox);const u=!B_(s);let h=!1;if(!e.resumeFrom){const c=e.getClosestProjectingParent();if(c&&!c.resumeFrom){const{snapshot:m,layout:d}=c;if(m&&d){const b=He();yo(b,n.layoutBox,m.layoutBox);const $=He();yo($,r,d.layoutBox),L_(b,$)||(h=!0),c.options.layoutRoot&&(e.relativeTarget=$,e.relativeTargetOrigin=b,e.relativeParent=c)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:n,delta:l,layoutDelta:s,hasLayoutChanged:u,hasRelativeLayoutChanged:h})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function UM(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function HM(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function GM(e){e.clearSnapshot()}function bb(e){e.clearMeasurements()}function KM(e){e.isLayoutDirty=!1}function ZM(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function yb(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function YM(e){e.resolveTargetDelta()}function QM(e){e.calcProjection()}function JM(e){e.resetSkewAndRotation()}function eF(e){e.removeLeadSnapshot()}function $b(e,t,n){e.translate=Le(t.translate,0,n),e.scale=Le(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function vb(e,t,n,r){e.min=Le(t.min,n.min,r),e.max=Le(t.max,n.max,r)}function tF(e,t,n,r){vb(e.x,t.x,n.x,r),vb(e.y,t.y,n.y,r)}function nF(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const rF={duration:.45,ease:[.4,0,.1,1]},_b=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),xb=_b("applewebkit/")&&!_b("chrome/")?Math.round:jt;function wb(e){e.min=xb(e.min),e.max=xb(e.max)}function iF(e){wb(e.x),wb(e.y)}function V_(e,t,n){return e==="position"||e==="preserve-aspect"&&!oM(fb(t),fb(n),.2)}function aF(e){var t;return e!==e.root&&((t=e.scroll)===null||t===void 0?void 0:t.wasRoot)}const oF=j_({attachResizeListener:(e,t)=>Ho(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Zh={current:void 0},W_=j_({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!Zh.current){const e=new oF({});e.mount(window),e.setOptions({layoutScroll:!0}),Zh.current=e}return Zh.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),sF={pan:{Feature:wM},drag:{Feature:xM,ProjectionNode:W_,MeasureLayout:R_}};function kb(e,t,n){const{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover",n==="Start");const i="onHover"+n,a=r[i];a&&Te.postRender(()=>a(t,cs(t)))}class lF extends Hr{mount(){const{current:t}=this.node;t&&(this.unmount=gT(t,(n,r)=>(kb(this.node,r,"Start"),i=>kb(this.node,i,"End"))))}unmount(){}}class uF extends Hr{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=hs(Ho(this.node.current,"focus",()=>this.onFocus()),Ho(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Sb(e,t,n){const{props:r}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap",n==="Start");const i="onTap"+(n==="End"?"":n),a=r[i];a&&Te.postRender(()=>a(t,cs(t)))}class hF extends Hr{mount(){const{current:t}=this.node;t&&(this.unmount=vT(t,(n,r)=>(Sb(this.node,r,"Start"),(i,{success:a})=>Sb(this.node,i,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const F0=new WeakMap,Yh=new WeakMap,cF=e=>{const t=F0.get(e.target);t&&t(e)},mF=e=>{e.forEach(cF)};function dF({root:e,...t}){const n=e||document;Yh.has(n)||Yh.set(n,{});const r=Yh.get(n),i=JSON.stringify(t);return r[i]||(r[i]=new IntersectionObserver(mF,{root:e,...t})),r[i]}function fF(e,t,n){const r=dF(t);return F0.set(e,n),r.observe(e),()=>{F0.delete(e),r.unobserve(e)}}const pF={some:0,all:1};class gF extends Hr{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:r,amount:i="some",once:a}=t,o={root:n?n.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:pF[i]},s=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,a&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:h,onViewportLeave:c}=this.node.getProps(),m=u?h:c;m&&m(l)};return fF(this.node.current,o,s)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(bF(t,n))&&this.startObserver()}unmount(){}}function bF({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const yF={inView:{Feature:gF},tap:{Feature:hF},focus:{Feature:uF},hover:{Feature:lF}},$F={layout:{ProjectionNode:W_,MeasureLayout:R_}},q0={current:null},X_={current:!1};function vF(){if(X_.current=!0,!!xd)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>q0.current=e.matches;e.addListener(t),t()}else q0.current=!1}const _F=[...p_,mt,Or],xF=e=>_F.find(f_(e)),wF=new WeakMap;function kF(e,t,n){for(const r in t){const i=t[r],a=n[r];if(ft(i))e.addValue(r,i);else if(ft(a))e.addValue(r,Oo(i,{owner:e}));else if(a!==i)if(e.hasValue(r)){const o=e.getValue(r);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=e.getStaticValue(r);e.addValue(r,Oo(o!==void 0?o:i,{owner:e}))}}for(const r in n)t[r]===void 0&&e.removeValue(r);return t}const Eb=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class SF{scrapeMotionValuesFromProps(t,n,r){return{}}constructor({parent:t,props:n,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:a,visualState:o},s={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Zd,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const d=zn.now();this.renderScheduledAt<d&&(this.renderScheduledAt=d,Te.render(this.render,!1,!0))};const{latestValues:l,renderState:u,onUpdate:h}=o;this.onUpdate=h,this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=u,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=i,this.options=s,this.blockInitialAnimation=!!a,this.isControllingVariants=Mu(n),this.isVariantNode=Av(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:c,...m}=this.scrapeMotionValuesFromProps(n,{},this);for(const d in m){const b=m[d];l[d]!==void 0&&ft(b)&&b.set(l[d],!1)}}mount(t){this.current=t,wF.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),X_.current||vF(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:q0.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Lr(this.notifyUpdate),Lr(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const n=this.features[t];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(t,n){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const r=ki.has(t);r&&this.onBindTransform&&this.onBindTransform();const i=n.on("change",s=>{this.latestValues[t]=s,this.props.onUpdate&&Te.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),a=n.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,t,n)),this.valueSubscriptions.set(t,()=>{i(),a(),o&&o(),n.owner&&n.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in ga){const n=ga[t];if(!n)continue;const{isEnabled:r,Feature:i}=n;if(!this.features[t]&&i&&r(this.props)&&(this.features[t]=new i(this)),this.features[t]){const a=this.features[t];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):He()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<Eb.length;r++){const i=Eb[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const a="on"+i,o=t[a];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=kF(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){const r=this.values.get(t);n!==r&&(r&&this.removeValue(t),this.bindToMotionValue(t,n),this.values.set(t,n),this.latestValues[t]=n.get())}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let r=this.values.get(t);return r===void 0&&n!==void 0&&(r=Oo(n===null?void 0:n,{owner:this}),this.addValue(t,r)),r}readValue(t,n){var r;let i=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(r=this.getBaseTargetFromProps(this.props,t))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,t,this.options);return i!=null&&(typeof i=="string"&&(m_(i)||n_(i))?i=parseFloat(i):!xF(i)&&Or.test(n)&&(i=u_(t,n)),this.setBaseTarget(t,ft(i)?i.get():i)),ft(i)?i.get():i}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){var n;const{initial:r}=this.props;let i;if(typeof r=="string"||typeof r=="object"){const o=Wd(this.props,r,(n=this.presenceContext)===null||n===void 0?void 0:n.custom);o&&(i=o[t])}if(r&&i!==void 0)return i;const a=this.getBaseTargetFromProps(this.props,t);return a!==void 0&&!ft(a)?a:this.initialValues[t]!==void 0&&i===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new Cd),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}}class U_ extends SF{constructor(){super(...arguments),this.KeyframeResolver=g_}sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){return t.style?t.style[n]:void 0}removeValueFromRenderState(t,{vars:n,style:r}){delete n[t],delete r[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;ft(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function EF(e){return window.getComputedStyle(e)}class CF extends U_{constructor(){super(...arguments),this.type="html",this.renderInstance=jv}readValueFromInstance(t,n){if(ki.has(n))return BA(t,n);{const r=EF(t),i=(Rd(n)?r.getPropertyValue(n):r[n])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(t,{transformPagePoint:n}){return z_(t,n)}build(t,n,r){Bd(t,n,r.transformTemplate)}scrapeMotionValuesFromProps(t,n,r){return Xd(t,n,r)}}class PF extends U_{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=He,this.updateDimensions=()=>{this.current&&!this.renderState.dimensions&&Ov(this.current,this.renderState)}}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(ki.has(n)){const r=l_(n);return r&&r.default||0}return n=Vv.has(n)?n:qd(n),t.getAttribute(n)}scrapeMotionValuesFromProps(t,n,r){return Xv(t,n,r)}onBindTransform(){this.current&&!this.renderState.dimensions&&Te.postRender(this.updateDimensions)}build(t,n,r){jd(t,n,this.isSVGTag,r.transformTemplate)}renderInstance(t,n,r,i){Wv(t,n,r,i)}mount(t){this.isSVGTag=Vd(t.tagName),super.mount(t)}}const DF=(e,t)=>Od(e)?new PF(t):new CF(t,{allowProjection:e!==S.Fragment}),TF=mA({...Qz,...yF,...sF,...$F},DF),Cb=PT(TF),AF=({imageUrl:e,name:t,shortDescription:n,longDescription:r})=>{const[i,a]=S.useState(!1),o=()=>{a(!i)};return M.jsxs(Cb.div,{className:"bg-sky-100 border border-sky-200 rounded-lg overflow-hidden shadow-md cursor-pointer transition-all duration-300 hover:bg-sky-200",onClick:o,layout:!0,children:[M.jsx("img",{src:e,alt:t,className:"w-full h-48 object-cover rounded-t-lg"}),M.jsxs("div",{className:"p-4",children:[M.jsx("h2",{className:"text-xl font-bold text-sky-900",children:t}),M.jsx("p",{className:"text-sky-700 mt-1",children:n}),M.jsx(iT,{children:i&&M.jsx(Cb.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"mt-4 text-sky-800",children:M.jsx("p",{children:r})})})]})]})},zF=()=>{const e=[{imageUrl:"/assets/magic/Dice.jpg",name:"打扁骰子",shortDescription:"打扁骰子123456",longDescription:"打扁骰子123456789123456789"},{imageUrl:"/assets/magic/Handcuff.jpg",name:"千里眼1",shortDescription:"千里眼123455678",longDescription:"千里眼1123145468794651231"},{imageUrl:"/assets/magic/SeeThrough.jpg",name:"逃脱手铐",shortDescription:"逃脱手铐12654",longDescription:"逃脱手铐45645498465123"}];return M.jsx("div",{className:"container mx-auto p-4",children:M.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:e.map((t,n)=>M.jsx(AF,{imageUrl:t.imageUrl,name:t.name,shortDescription:t.shortDescription,longDescription:t.longDescription},n))})})};function MF(){return M.jsx(n7,{children:M.jsxs("div",{className:"flex flex-col w-screen min-h-screen bg-sky-600",children:[M.jsx(r7,{}),M.jsx("main",{className:"flex-grow",children:M.jsxs(k6,{children:[M.jsx(ti,{path:"/",element:M.jsx(v7,{})}),M.jsx(ti,{path:"/warp",element:M.jsx(YD,{})}),M.jsx(ti,{path:"/show",element:M.jsx(JD,{})}),M.jsx(ti,{path:"/about",element:M.jsx(_7,{})}),M.jsx(ti,{path:"/posts/:id",element:M.jsx(ZD,{})}),M.jsx(ti,{path:"/magic",element:M.jsx(zF,{})})]})}),M.jsx(i7,{})]})})}Qh.createRoot(document.getElementById("root")).render(M.jsx(Bb.StrictMode,{children:M.jsx(G6,{children:M.jsx(MF,{})})}));
